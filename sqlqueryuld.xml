<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<!-- The SQL in these maps files has purposely been typed with more verbosity than is actually required.
 For example, many of the selects could have just used SELECT * FROM... instead of listing all of the columns.
 This is to demonstrate that even complex SQL can be handled and coded and formatted the way SQL was meant
 to be (i.e. not a bunch of concatenated strings in a Java class). 

Version No	Changed By	Changed On	Purpose
==============================================================
1.0			Mayank		12Mar07		change in query sqlAWBInvByULDNoQuery FLT_TYPE to AWB_TYPE
1.1			Mayank		12Mar07		change in query getuldforcommonuldrulevalidations add Owned Inv

 -->


<sqlMap namespace="ULD">
	<select id="validateSrfforUserAccess" parameterClass="map" resultClass="cargo.cms.common.bo.StdAccessBO">
		select AWB_NO as awbNo, ULD_KEY as uldKey from EXP_RTN_HD where SRF_NO = #rclNo#
	</select>
	
	<select id="validateRclforUserAccess" parameterClass="map" resultClass="cargo.cms.common.bo.StdAccessBO">
		select AWB_NO as awbNo, ULD_KEY as uldKey from EXP_RCL_HD where RCL_NO = #rclNo#
	</select>
	
	<parameterMap id="uldflightMap" class="map" >
		<parameter property="ULDKEY"  jdbcType="VARCHAR"	javaType="java.lang.String"	mode="IN"/>
		<parameter property="CHKINFLT"  jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
		<parameter property="CHKINFLTDATE" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
		<parameter property="ATA" jdbcType="VARCHAR"	        javaType="java.lang.String"	mode="OUT"/>
		<parameter property="CHKOUTFLT"  jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
		<parameter property="CHKOUTFLTDATE" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
		<parameter property="ETD"   jdbcType="VARCHAR"		javaType="java.lang.String"	mode="OUT"/>
		<parameter property="LUCNO" jdbcType="VARCHAR"		javaType="java.lang.String"	mode="OUT"/>
		<parameter property="RECPTNO" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
		<parameter property="INCARR" jdbcType="VARCHAR"		javaType="java.lang.String"	mode="OUT"/>
		<parameter property="OUTCARR" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
		<parameter property="BASEPLT" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
	</parameterMap>
	<procedure id="sqlgetflightforuld" parameterMap="uldflightMap" >
		{call PKG_ULD.get_enquire_uld_flt_luc(?,?,?,?,?,?,?,?,?,?,?,?)  }
	</procedure>

<!-- ====================== ULD Storage Start BY ZhuNing ==================================== -->
	<select id="sqlvalidateuldunreserve" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #PARAM# and NVL(RESV_FLG,'N') = 'Y'
   	</select>
	<!-- Onsite Changed on 20 May 2006 by mayank Starts here -->
	<insert id="sqlemptyuldacceptance" parameterClass="java.util.HashMap">
		insert into uld_inventory(
			uld_key,
			uld_type,
			uld_no,
			uld_carr,
			loc_code,
			DAM_IND,
			owner_id,
            PARENT_OWNER,
			source_code,
			gen_rmk,
			dam_rmk,
			eic_flg,
			empty_flg,
			STRG_DATE,
			PPK_IND,
			LM_USER_ID,
			LM_DATE,
			AGENT_INV,
			CFM_STATUS,
			RESV_FLG,
			OWNED_INV,
			CONTR_CODE,

			REF_TR_NO, 
			REF_TR_TYPE, 
			REF_TR_DATE, 
			REF_IN_CARR, 
			REF_OUT_CARR, 
			REF_DOC_LINE_NO, 
			REF_LOC_FROM, 
			REF_TR_EVENT, 
			REF_RMK,
			BASE_PLT,
			AGENT_ID,
			SER_IND,
			EIC_TYPE ,
			BASE_PAL_FLG,
			OFLD_FLG,
			TRANSIT_FLG,
			BB_IND,
			MIX_PPK_IND,
			DG_IND,
			HANDLING_MODE,
			TRANSIT_TYPE,
			tare_weight,
		    gross_weight,
		    TR_TYPE,
		    FINAL_WEIGHT,
		    DOUBLE_WGT_RSLT,
		    X_RAY_RES,X_RAY_REQ ,ENTRY_TIME     
			
			) 
			values (
			#uld_key#,
			#uld_type#,
			#uld_no#,
			#uld_carr#,
			#loc_code#,
			#condn_code#,
			#owner_id#,
                        #owner_id#,
			#source_code#,
			#gen_rmk#,
			#dam_rmk#,
			#eic_flg#,
			'Y',
			SYSDATE,
			#PPK_IND#,
			#LM_USER_ID#,
			SYSDATE,
			#AGENT_INV#,
			#CFM_STATUS#,
			#RESV_FLG#,
			'Y',
			null,

			ULD_TR_SEQ.NEXTVAL,
			'EU',
			SYSDATE,
			'',
			null,
			1,
			#loc_code#,
			'INSERT',
			#gen_rmk#,
			#BASE_PLT#,
		#AGENT_ID#,
		#ser_ind#,
		#EIC_TYPE#,
		#BASE_PLT_FLG#,
		'N','N','N','N','N',null,null,#TARE_WEIGHT#,
		#GROSS_WEIGHT#,
		#TR_TYPE#,
		'N',null,null,null ,SYSDATE   
		)
	</insert>
	<!-- Onsite Changed on 20 May 2006 by mayank Ends here -->
	 <update id="sqlupdateacceptemptyuld" parameterClass="java.util.HashMap">
		UPDATE ULD_INVENTORY SET 
		uld_type=#uld_type#, 
		uld_no=#uld_no#, 
		uld_carr=#uld_carr#, 
		FLT_NO = null, 
		FLT_TYPE = null, 
		FLT_DATE = null, 
		FLT_KEY = null,
		loc_code=#loc_code#, 
		DAM_IND=#condn_code#, 
		CONTR_CODE = null,
		owner_id=#owner_id#, 
        PARENT_OWNER=#owner_id#,
		source_code=#source_code#, 
		gen_rmk=#gen_rmk#, 
		dam_rmk=#dam_rmk#, 
		eic_flg=#eic_flg#, 
		empty_flg='Y', 
		tare_weight = #TARE_WEIGHT#,
		gross_weight = #GROSS_WEIGHT#,
		STRG_DATE=sysdate, 
		PPK_IND=#PPK_IND#, 
		LM_USER_ID=#LM_USER_ID#, 
		LM_DATE=sysdate, 
		AGENT_INV='N',
		OWNED_INV='Y',
		AGENT_ID =null, 
		CFM_STATUS=#CFM_STATUS#, 
		REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
		REF_DOC_LINE_NO = '1',
		REF_TR_TYPE = 'EU',
		REF_TR_DATE = SYSDATE, 
		REF_OUT_CARR = '', 
		REF_TR_EVENT = 'UPDATE', 
		REF_RMK = #gen_rmk#,     
		BASE_PLT     = #BASE_PLT#,
		SER_IND=#ser_ind#,
		RESV_FLG = 'N',
		RESV_DATE='', 
		RESV_RMK='', 
		RMV_RMK='', 
		IMP_FLT_CARR='',
		IMP_FLT_DATE='',
		IMP_FLT_KEY='',
		IMP_FLT_NO='', 
		TARGET='', 
		FIRST_WT='', 
		SECOND_WT='', 
		THIRD_WT='', 
		REF_WT='', 
		ULD_FLOW='' ,
		EIC_TYPE=#EIC_TYPE#,
		BASE_PAL_FLG=#BASE_PLT_FLG#,
		ASV_INV='N',
		OFLD_FLG='N',
		TRANSIT_FLG='N',
		BB_IND='N',
		MIX_PPK_IND='N',
		DG_IND='N',
		HANDLING_MODE=null,
		TRANSIT_TYPE=null,
		TR_TYPE = #trtype#,
		FINAL_WEIGHT = 'N',
		DOUBLE_WGT_RSLT = null,
		MAN_WT_IND2 = 'N',
   		MAN_WT_IND3 = 'N',
    	ULDENTRY_MSG_RCVD_YN = 'N',
    	DIRECT_TOW = 'N' , X_RAY_RES = null, X_RAY_REQ = null, ENTRY_TIME = sysdate   
		WHERE ULD_KEY = #ULD_KEY#
	</update>
	 <update id="UpdateULDRelData" parameterClass="java.util.HashMap">
	    update uld_rel_dtl 
        set status = 'RETURNED',
        ret_date = SYSDATE,
        ret_user = #LM_USER_ID#
        where  uld_key = #ULD_KEY#
        and   status = 'RELEASED'
        and   tr_no in (select max(TO_NUMBER(tr_no)) from  uld_rel_dtl b where uld_key = #ULD_KEY#)
	</update>
	
	<select id="sqlremoveuld" parameterClass="java.lang.String" resultClass="java.util.HashMap">
 SELECT t1.ULD_KEY ,
  t1.LOC_CODE     ,
  t1.EIC_FLG      ,
  t1.EMPTY_FLG    ,
  t1.DAM_IND      ,
  t1.SER_IND      ,
  t1.OWNER_ID     ,
  t1.GEN_RMK      ,
  t1.DAM_RMK      , 
  TO_CHAR(t1.LM_DATE, 'ddMMYY HH24:MI:SS') as LM_DATE,
  t2.WH_GROUP  ,
  t3.WH_AREA      
   FROM ULD_INVENTORY t1 
   left join  MAST_WH_LOC t2 on t1.LOC_CODE = t2.CODE 
   left join MAST_WH_Group t3  on t2.WH_GROUP = t3.WH_GROUP
   left join MAST_WH_Area t4  on t4.WH_AREA  = t3.WH_AREA	
   WHERE t1.ULD_KEY = #ULD_KEY#
   </select>
	
	
	<select id="sqlquerylocationuld" parameterClass="java.lang.String" resultClass="java.util.HashMap">
		SELECT CODE AS codeId FROM MAST_WH_LOC_CODE WHERE WH_LOC=#PARAM#
	</select>

<!-- Onsite Changed on 11 May 2006 by mayank Starts here change ULD TYPE to not mandatory -->
<select id="sqlreserveuldownertype" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT ULD_KEY, CONTR_CODE, LOC_CODE, EIC_FLG,  
		EMPTY_FLG, RESV_FLG, TO_CHAR(RESV_DATE,'DDMONYY') RESV_DATE, 
		RESV_USER_ID, RESV_RMK , CFM_Status, Flt_type,TO_CHAR(LM_DATE, 'ddMMYY HH24:MI:SS') as LM_DATE 
		FROM ULD_INVENTORY WHERE OWNER_ID = #OWNER_ID# AND LOC_CODE IS NOT NULL 
		AND NVL(Agent_Inv, 'N') = 'N' AND 
		UPPER(CFM_Status) != 'LUC_RESERVED' 
		AND (UPPER(CFM_Status) = 'CONFIRMED' 
		OR UPPER(CFM_Status) = 'RESERVED') 
		<!--AND (EIC_Flg = 'N' OR Base_Pal_FLG = 'Y') 
		AND Base_Pal_FLG = 'N' -->
		AND NVL(FLT_Type, 'NULL') != 'E'
		AND base_plt is NULL
		<isNotEmpty property="ULD_TYPE">
			AND ULD_TYPE = #ULD_TYPE# 
		</isNotEmpty>	
		<isNotEmpty property="ULD_GROUP">
			AND ULD_TYPE in (select uld_type from ULD_GROUP_CARR where ULD_GROUP = #ULD_GROUP#) 
		</isNotEmpty>
		ORDER BY ULD_KEY ASC
	</select>
<!-- Onsite Changed on 11 May 2006 by mayank Ends here change ULD TYPE to not mandatory -->
<!-- Updated onsite lokesh 11May06 For the BUG:TF1005006 Starts -->
<update id="sqlupdateremoveuld" parameterClass="cargo.cms.uld.bo.ULDBO">
		UPDATE ULD_INVENTORY SET 
		DEST_CODE=#sdestination#, 
		RMV_RMK=#srmvRem#, 
		CFM_STATUS=#scfmStatus#, 
		LM_USER_ID=#lmUserId#, 
		LM_DATE=SYSDATE,
		LOC_CODE=NULL,
		CONTR_CODE=null,
		GEN_RMK	 = null, 
		RESV_RMK	 = null, 
		DAM_RMK	 = null,
		EMPTY_FLG = 'Y',
		EIC_FLG = 'N',
		AGENT_ID = NULL,
		OWNED_INV = 'N',
		REF_TR_NO = #suldNumber#,
		REF_TR_TYPE = 'UV',
		REF_TR_DATE = SYSDATE, 
		REF_OUT_CARR = #uldCarr#, 
		REF_TR_EVENT = 'UPDATE', 
		REF_RMK = #srmvRem# ,   
		BASE_PLT = null,
		EIC_TYPE = null,
		ASV_INV = 'N',
		RESV_FLG = 'N',
		URF_RESV='N',
		TR_TYPE=#trtype#,
		ULDENTRY_MSG_RCVD_YN = 'N'
		WHERE ULD_KEY=#suldNumber# AND
		to_char(LM_DATE, 'ddMMYY HH24:MI:SS')=#lmDate#
</update>
  
<!-- Updated onsite lokesh 11May06 For the BUG:TF1005006 Ends -->

	<select id="sqlcheckuldtype" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM MAST_ULD_TYPE WHERE CODE=#PARAM#
	</select>

	<select id="sqlcheckuldcarrier" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM MAST_CARRIER WHERE CODE=#PARAM#
	</select>

	<select id="sqlcheckuld" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM#
	</select>

	<select id="sqlcheckulddetail1" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# AND LOC_CODE IS NOT NULL
	</select>
	<select id="sqlcheckulddetail2" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# AND EIC_FLG='Y' AND LOC_CODE IS NOT NULL 
	</select>
	<!-- Onsite Changed on 20 May 2006 by mayank Starts here -->
	<select id="sqlcheckulddetail3" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# 
	</select>
	<!-- Onsite Changed on 20 May 2006 by mayank Ends here -->
	<select id="sqlcheckulddetail4" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# AND UPPER(CFM_Status)!='UNCONFIRMED'
	</select>
	<select id="sqlcheckulddetail5" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# AND RESV_FLG='Y' AND LOC_CODE IS NOT NULL 
	</select>
	<select id="sqlcheckulddetail6" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# AND AGENT_INV='Y'
	</select>

	<select id="sqlvalidateuldremove00" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM#
	</select>
	<select id="sqlvalidateuldremove0" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# AND NVL(AGENT_INV, 'N') ='N' 
	</select>
	<select id="sqlvalidateuldremove01" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# AND ((FLT_TYPE = 'E' AND FLT_KEY IS NOT NULL) OR (FLT_TYPE = 'I' and empty_flg = 'N'))
	</select>
	<select id="sqlvalidateuldremove0101" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY U
		LEFT JOIN FLT_OPR F ON U.FLT_KEY = F.FLT_KEY AND U.FLT_DATE = F.SCH_DATE AND F.FLT_TYPE = decode(U.FLT_TYPE,'E','D','A')
		WHERE U.ULD_KEY=#PARAM# AND ((U.FLT_TYPE = 'E' AND U.FLT_KEY IS NOT NULL) OR (U.FLT_TYPE = 'I' and U.empty_flg = 'N')) AND F.FLT_KEY IS NOT NULL
	</select>
	<select id="sqlvalidateuldremove1" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# AND LOC_CODE IS NOT NULL
	</select>
	<select id="sqlvalidateuldremove2" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# AND (EIC_FLG='N' OR (EIC_FLG = 'Y' AND EIC_TYPE = 'PS' AND BASE_PAL_FLG = 'N'))
	</select>
	<select id="sqlvalidateuldremove3" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# AND EMPTY_FLG='Y'
	</select>
	<select id="sqlvalidateuldremove6" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# AND UPPER(CFM_Status) LIKE 'RCL%' 
	</select>
	<select id="sqlvalidateuldremove4" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# AND UPPER(CFM_Status)='UNCONFIRMED'
	</select>
	<select id="sqlvalidateuldremove5" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# AND (RESV_FLG='N' OR RESV_FLG IS NULL)
	</select>

	<select id="sqlreserveuldno" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT ULD_KEY, CONTR_CODE, LOC_CODE, EIC_FLG, DAM_IND, EMPTY_FLG, RESV_FLG, to_char(RESV_DATE,'DDMONYY') RESV_DATE, RESV_USER_ID, RESV_RMK,TO_CHAR(LM_DATE, 'ddMMYY HH24:MI:SS') as LM_DATE  FROM ULD_INVENTORY WHERE ULD_KEY=#suldNumber# 
		<isNotEmpty property="loginCarrier">
			and ULD_CARR = #loginCarrier#
		</isNotEmpty>
		ORDER BY ULD_KEY ASC
	</select>
	<select id="sqlemptyuldacceptancereport" parameterClass="java.util.HashMap" resultClass="cargo.cms.uld.bo.ULDBO">
		SELECT ULD_KEY as suldNumber, LM_USER_ID as sStaffId, AGENT_ID as sAgentId FROM ULD_INVENTORY WHERE ULD_KEY=#suldNumber#
	</select>

	<select id="sqlemptyuldacceptancereporteir" parameterClass="java.util.HashMap" resultClass="cargo.cms.uld.bo.ULDBO">
		SELECT EIR_NO as sEIRNumber, TR_NO as sTRNo FROM ULD_REL_DTL WHERE ULD_KEY=#suldNumber# AND TR_NO = (select max(to_number(tr_no)) from ULD_Rel_Dtl where Status = 'RELEASED' and ULD_Key = #suldNumber#)
	</select>
		
	<select id="validateULDExistsForURF" parameterClass="java.util.HashMap" resultClass="java.lang.Integer">
		SELECT count(*) FROM ULD_REL_DTL WHERE ULD_KEY=#ULD_KEY# AND EIR_NO = #URF_NO#
	</select>
	
	<update id="sqlemptyuldacceptancereporteirupdate" parameterClass="java.util.HashMap">
		UPDATE ULD_REL_DTL SET 	
		STATUS=#status# 
		WHERE ULD_KEY = #uld_key# AND EIR_NO = #eir_no# AND TR_NO = #tr_no#
	</update>

	<select id="sqlemptyuldacceptancereporteirdate" parameterClass="java.util.HashMap" resultClass="cargo.cms.uld.bo.ULDBO">
		SELECT to_char(EIR_DATE,'ddmonyy HH24:MI') as sEIRDate FROM ULD_ISS_HD WHERE EIR_NO=#sEIRNumber#
	</select>

	<select id="sqlvalidateuldreserve1" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #PARAM# and LOC_CODE IS NOT NULL and NVL(Agent_Inv, 'N') = 'N'
	</select>
	<select id="sqlvalidateuldreserve2" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #PARAM# and LOC_CODE is not null 
	</select>
	<select id="sqlvalidateuldreserve3" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #PARAM# and Base_Pal_Flg = 'Y'
	</select>
	<select id="sqlvalidateuldreserve4" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #PARAM# and FLT_KEY is null and UPPER(CFM_Status) != 'ASSIGNED'
	</select>
	<select id="sqlvalidateuldreserve5" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key Like (select ULD_Key from ULD_Inventory where ULD_KEY= #PARAM#) and Resv_Flg = 'Y' and UPPER(CFM_Status) = 'RESERVED'
	</select>
	<select id="sqlvalidateuldreserve6" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #PARAM# and EMPTY_FLG = 'Y'
	</select>

	<select id="sqlvalidateuldreserve7" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #PARAM# and LOC_CODE is not null and UPPER(CFM_Status) != 'LUC_RESERVED'
	</select>
	<select id="sqlvalidateuldreserve8" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #PARAM# and LOC_CODE is not null and BASE_PLT is not null and EIC_FLG='Y'
	</select>
	<!-- Onsite Changed on 06 June 2006 by mayank Start here add lmUserid and lmdate -->
	<update id="sqlupdatereserveuld" parameterClass="cargo.cms.uld.bo.ULDBO">
		update ULD_Inventory set 
		CFM_Status = 'RESERVED',
		RESV_USER_ID = #sresvUserId#,
		Resv_Date = sysdate, 
		Resv_Rmk = #sresvRem#, 
		RESV_FLG='Y' ,
		LM_USER_ID = #lmUserId#,
		LM_DATE = SYSDATE,
		REF_TR_NO = #suldNumber#, 
		REF_DOC_LINE_NO = 1,
		REF_TR_DATE = SYSDATE, 
		REF_TR_TYPE = 'US',
		REF_OUT_CARR = #uldCarr#, 
		REF_TR_EVENT = 'UPDATE', 
		REF_RMK = #sresvRem#,
		TR_TYPE='ERSRV'
		where 
		((ULD_Key = #suldNumber#) OR 
		(ULD_KEY IN 
			(SELECT ULD_KEY FROM 
				ULD_INVENTORY WHERE BASE_PLT = 
				(SELECT ULD_KEY FROM ULD_INVENTORY 
				WHERE ULD_Key = #suldNumber# 
				AND EIC_FLG = 'Y' and 
				Base_Pal_Flg = 'Y')))) AND to_char(LM_DATE, 'ddMMYY hh24:mi:ss')=#lmDate#  
	</update>
	<!-- Onsite Changed on 06 June 2006 by mayank Ends here add lmUserid and lmdate -->
	<!-- Onsite Changed on 24 May 2006 by mayank Start here add lmUserid and lmdate -->
	<update id="sqlupdateunreserveuld" parameterClass="cargo.cms.uld.bo.ULDBO">
		update ULD_Inventory set 
		CFM_Status = 'CONFIRMED', 
		RESV_USER_ID = #sresvUserId#,
		Resv_Date = sysdate, 
		Resv_Rmk = #sresvRem#, 
		RESV_FLG='N' ,
		LM_USER_ID = #lmUserId#,
		LM_DATE = SYSDATE,
		REF_TR_NO = #suldNumber#, 
		REF_DOC_LINE_NO = 1,
		REF_TR_DATE = SYSDATE, 
		REF_TR_TYPE = 'UU',
		REF_OUT_CARR = #uldCarr#, 
		REF_TR_EVENT = 'UPDATE', 
		REF_RMK = #sresvRem#,
		TR_TYPE='UNRSV'
		where ((ULD_Key = #suldNumber#) OR (ULD_KEY IN (SELECT ULD_KEY FROM ULD_INVENTORY WHERE BASE_PLT = (SELECT ULD_KEY FROM ULD_INVENTORY WHERE ULD_Key = #suldNumber# AND EIC_FLG = 'Y' and Base_Pal_Flg = 'Y')))) AND to_char(LM_DATE, 'ddMMYY hh24:mi:ss')=#lmDate# 
	</update>
	<!-- Onsite Changed on 24 May 2006 by mayank Ends here add lmUserid and lmdate -->

	<select id="sqlvalidateuldretrieve" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #PARAM# AND LOC_CODE in (select t1.CODE from 
	 	MAST_WH_LOC t1, mast_wh_group t2 where t1.wh_group = t2.WH_GROUP and t2.wh_type = 'MHS')
	</select>
	<select id="sqlvalidateuldretrieve1" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #PARAM# and CFM_Status != 'UNCONFIRMED'
	</select>
	<select id="sqlvalidateuldretrieve2" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM#
	</select>
	<select id="sqlvalidateuldretrieve3" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM# and CFM_Status != 'RESERVED'
	</select>

	<select id="sqlretrieveretrieveuld" parameterClass="java.lang.String" resultClass="java.util.HashMap">
		SELECT ULD_TYPE,ULD_NO,ULD_KEY, LOC_CODE, CFM_STATUS,OWNER_ID FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM#
	</select>

	<update id="sqlupdateretrieveuld" parameterClass="java.util.HashMap">
		UPDATE ULD_INVENTORY SET 	
		loc_code=null,
		LM_DATE=SYSDATE,
		
		REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
		REF_DOC_LINE_NO = 1,
		REF_TR_DATE = SYSDATE, 
		REF_TR_TYPE = 'EU',
		REF_OUT_CARR = #uld_carr#, 
		REF_TR_EVENT = 'RETRIEVE', 
		REF_RMK = #gen_rmk#     
		
		WHERE ULD_KEY = #uld_key#
	</update>

	
<insert id="retrieveuldmhs" parameterClass="java.util.HashMap">
	insert into uld_mov
		   (tr_type, tr_no, tr_date, doc_line_no, uld_no,
		uld_type, uld_carr, uld_key, 
		mov_from, mov_to, flt_carr,
		flt_no, flt_type, flt_key, flt_date, DAM_IND,
		eic_iss, empty_iss, contr_ccode, owner_id, cr_user_id, cr_date, lm_user_id,
		lm_date, iss_recv, uld_status, seq_no, event_id
		)
	select 'RU', uld_key, sysdate, 1, uld_no,
		uld_type, uld_carr, uld_key, 
		 LOC_CODE, #TARGET#, carr_CODE,
		flt_no, flt_type, flt_key, flt_date, DAM_IND,
		EIC_FLG, EMPTY_FLG, contr_code, owner_id, #USER#, sysdate, #USER#,
		sysdate, 'I', CFM_status, uld_mov_seq.nextval, 'RUL'
		   from uld_inventory
		   where uld_key = #uld_key#
	</insert>

<update id="sqlRtrvMoveOrderStatus1" parameterClass="java.lang.String" >
<![CDATA[
		UPDATE rtrv_move_order
		SET status='CANCELLED'
		where UPPER(ULD) = UPPER(#uld_key#)
		AND (status IS NULL OR(status <> 'E' AND status <>'CANCELLED' AND status <>'COMPLETED'))
]]>
</update>
	<insert id="insrtintortrvmovorder" parameterClass="java.util.HashMap">
	Insert into RTRV_MOVE_ORDER 
		(FUNC,REF_NO,AWB_NO,CURR_LOCN,LSP,ULD,
		PC,WT,TARGET,STATUS,CR_USER_ID,
		CR_DATE,LM_USER_ID,LM_DATE,TYPE,INV_TYPE) 
		values (#FUNC# ,#REF_NO# ,#AWB_NO#,#TARGET#,#LSP# ,#uld_key# ,
    #LOCN_PCS#,#LOCN_WT#,#CURR_LOCN# ,#STATUS# ,#CR_USER_ID# ,SYSDATE,#LM_USER_ID# ,SYSDATE,'M',#INV_TYPE#)
	</insert>
	
	<update id="updateUldInvMHS" parameterClass="java.util.HashMap">
	
	Update ULD_INVENTORY
	set TARGET = #CURR_LOCN#,
		LM_USER_ID = #LM_USER_ID#,
		LM_DATE = SYSDATE
	WHERE ULD_KEY = #uld_key# 
	
	</update>
	<!-- Onsite Changed on 26 May 2006 by mayank Starts here (Add Event_ID)  -->
	<!--<insert id="sqlemptyuldacceptancemov" parameterClass="java.util.HashMap">
		insert into uld_mov
			(EVENT_ID,
			tr_type, 
			tr_no, 
			tr_date, 
			doc_line_no, 
			uld_key, 
			uld_type, 
			uld_no, 
			uld_carr,
			mov_from,
			mov_to,
			mov_loc_from,
			mov_loc_to,
			cond_code,
			eic_iss,
			empty_iss,
			owner_id,
			rmk, 
			STRG_DATE, 
			LM_USER_ID, 
			LM_DATE, 
			CR_USER_ID, 
			CR_DATE,
			iss_recv,
			uld_status) values 
			(#tr_type#, 
			#tr_type#,
			ULD_AEMPTY_SEQ.NEXTVAL, 
			sysdate, 
			#doc_line_no#, 
			#uld_key#, 
			#uld_type#, 
			#uld_no#, 
			#uld_carr#, 
			#mov_from#, 
			#mov_to#, 
			#mov_loc_from#, 
			#mov_loc_to#, 
			#cond_code#, 
			#eic_iss#,
			#empty_iss#, 
			#owner_id#, 
			#rmk#,
			sysdate, 
			#lm_user_id#, 
			sysdate, 
			#cr_user_id#, 
			sysdate,
			#iss_recv#, 
			#uld_status#)
	</insert>-->
	<!-- Onsite Changed on 26 May 2006 by mayank Ends here (Add Event_ID)  -->
	<!-- Onsite Changed on 26 May 2006 by mayank Starts here (Add Event_ID)  -->
	<!--<insert id="sqlemptyuldacceptancermk" parameterClass="java.util.HashMap">
		insert into uld_rmk
			(EVENT_ID,
			tr_type, 
			tr_no, 
			doc_line_no, 
			uld_key, 
			uld_type, 
			uld_no, 
			uld_carr,
			uld_rmk, 
			LM_USER_ID, 
			LM_DATE, 
			CR_USER_ID, 
			CR_DATE) values 
			(#tr_type#,
			#tr_type#, 
			(select max(to_number(tr_no)) from uld_mov where 
			tr_type = #tr_type# and 
			EVENT_ID = #tr_type# and 
			doc_line_no = '1' and 
			uld_key = #uld_key# and 
			uld_type = #uld_type# and 
			uld_no = #uld_no# and 
			uld_carr = #uld_carr# and 
			lm_user_id = #lm_user_id# and 
			cr_user_id = #cr_user_id#), 
			#doc_line_no#, 
			#uld_key#, 
			#uld_type#, 
			#uld_no#, 
			#uld_carr#, 
			#uld_rmk#,
			#lm_user_id#, 
			sysdate, 
			#cr_user_id#, 
			sysdate)
	</insert>


	<insert id="sqlupdateremoveuldmov" parameterClass="java.util.HashMap">
		insert into uld_mov
			(EVENT_ID,
			tr_type, 
			tr_no, 
			tr_date, 
			doc_line_no, 
			uld_key, 
			uld_type, 
			uld_no, 
			uld_carr,
			mov_from,
			mov_to,
			mov_loc_from,
			mov_loc_to,
			cond_code,
			eic_iss,
			empty_iss,
			owner_id,
			rmk, 
			STRG_DATE, 
			LM_USER_ID, 
			LM_DATE, 
			CR_USER_ID, 
			CR_DATE,
			iss_recv,
			uld_status) values 
			(#tr_type#, 
			#tr_type#, 
			ULD_AEMPTY_SEQ.NEXTVAL, 
			sysdate, 
			#doc_line_no#, 
			#uld_key#, 
			#uld_type#, 
			#uld_no#, 
			#uld_carr#, 
			#mov_from#, 
			#mov_to#, 
			#mov_loc_from#, 
			#mov_loc_to#, 
			#cond_code#, 
			#eic_iss#,
			#empty_iss#, 
			#owner_id#, 
			#rmk#,
			sysdate, 
			#lm_user_id#, 
			sysdate, 
			#cr_user_id#, 
			sysdate,
			#iss_recv#, 
			#uld_status#)
	</insert>

	<insert id="sqlupdateremoveuldrmk" parameterClass="java.util.HashMap">
		insert into uld_rmk
			(EVENT_ID,
			tr_type, 
			tr_no, 
			doc_line_no, 
			uld_key, 
			uld_type, 
			uld_no, 
			uld_carr,
			uld_rmk, 
			LM_USER_ID, 
			LM_DATE, 
			CR_USER_ID, 
			CR_DATE) values 
			(#tr_type#,
			#tr_type#, 
			(select max(to_number(tr_no)) from uld_mov where 
			tr_type = #tr_type# and 
			EVENT_ID = #tr_type# and 
			doc_line_no = #doc_line_no# and 
			uld_key = #uld_key# and 
			uld_type = #uld_type# and 
			uld_no = #uld_no# and 
			uld_carr = #uld_carr# and 
			lm_user_id = #lm_user_id# and 
			cr_user_id = #cr_user_id#),  
			#doc_line_no#, 
			#uld_key#, 
			#uld_type#, 
			#uld_no#, 
			#uld_carr#, 
			#uld_rmk#,
			#lm_user_id#, 
			sysdate, 
			#cr_user_id#, 
			sysdate)
	</insert>-->
	<!-- Onsite Changed on 26 May 2006 by mayank Ends here (Add Event_ID)  -->



	<select id="sqlcheckprinterid" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM MAST_PRT_DTL WHERE upper(CODE)=upper(#PARAM#)
	</select>


	<select id="sqlcheckwarehousedestination" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM MAST_WH_LOC WHERE CODE=#PARAM#
	</select>


	<select id="sqlcheckwarehouselocation" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT CODE FROM MAST_WH_LOC WHERE CODE=#CODE#
	</select>


	<select id="sqlcheckownercode" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM MAST_CARRIER WHERE CODE=#PARAM#
	</select>

	<select id="sqlremoveulduco" parameterClass="java.lang.String" resultClass="java.util.HashMap">
		SELECT u.EMAIL FROM SEC_USER u, SEC_USER_ROLE ur, SEC_ROLE r WHERE u.Code = ur.User_Id AND ur.Role_Name = r.Code AND r.Code = #PARAM#
	</select>



<!-- ====================== ULD Storage END BY ZhuNing ==================================== -->


<!--#######################################################################
					BEGIN ULD\LUC 
#######################################################################-->

<parameterMap id="hmGenerateNumberMap" class="map" >
	<parameter property="NUMBER" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
	<parameter property="TYPE" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="IN"/>
</parameterMap>

<procedure id="generatenumber" parameterMap="hmGenerateNumberMap" >
	{? = call FUN_GET_TR_NO(?)}
</procedure>
<!--<select id="UTNumber" parameterClass="java.lang.Object" resultClass="java.lang.String">
	SELECT trim(to_char(UT_NO_SEQ.NEXTVAL, '00000')) LUC FROM DUAL
</select>-->
<select id="UTNumber" parameterClass="java.lang.Object" resultClass="java.lang.String">
	SELECT trim(lpad(LUC_NO_SEQ.NEXTVAL,5,'0')) LUC FROM DUAL
</select>
<update id="updateLucHD" parameterClass="cargo.cms.uld.bo.LucBO" >
update LUC_HD set TRANS_DATE=TO_DATE(#transDateTime#, 'DDMONYY HH24:MI'), RMK= #lucRemark# ,  LM_USER_ID=#lmUserId#, UPLOAD_DOC=#transactionId#,
LM_DATE=SYSDATE
WHERE LUC_NO=#lucNumber# AND to_char(LM_DATE, 'ddMMYY hh24:mi:ss')=#lmDate#
</update>

<update id="updateLucDtl" parameterClass="cargo.cms.uld.bo.ULDBO" >
	update LUC_DTL set   RECPT_NO = UPPER(#controlRecNumber#) , DEST_CODE = UPPER(#lucLoc#) , 
	LM_USER_ID=#lmUserId#,
	LM_DATE=SYSDATE,
	TR_TYPE = 'LUCUP'
	WHERE LUC_NO=#lucNumber# AND DOC_LINE_NO = #docLineNo#  AND to_char(LM_DATE, 'ddMMYY hh24:mi:ss')=#lmDate#
</update>

<update id="updateLucHDvoid" parameterClass="cargo.cms.uld.bo.LucBO" >
update LUC_HD set LUC_STAT = 'V' , TRANS_DATE=TO_DATE(#transDateTime#, 'DDMONYY HH24:MI'), RMK= #lucRemark# ,  LM_USER_ID=#lmUserId#, 
LM_DATE=SYSDATE
WHERE LUC_NO=#lucNumber# AND to_char(LM_DATE, 'ddMMYY hh24:mi:ss')=#lmDate#
</update>

<update id="updateLucHDpost" parameterClass="cargo.cms.uld.bo.LucBO" >
	update LUC_HD set LUC_STAT = 'P' , TR_POST_DATE= TO_Date(#postDateTime#, 'ddMMYY hh24:mi'),
	TR_POST_TIME = #postTime# , TR_POST_RMK= #postRemark# ,    LM_USER_ID= #lmUserId# , UPLOAD_DOC=#transactionId#,
	TR_POST_USER_ID = #lmUserId# , LM_DATE=SYSDATE  ,TR_POSTED = 'Y'
	WHERE LUC_NO=#lucNumber#  AND to_char(LM_DATE, 'ddMMYY hh24:mi:ss')=#lmDate#
	
</update>


<delete id="daleteLuchd" parameterClass="cargo.cms.uld.bo.LucBO" >
	delete from LUC_HD
	WHERE LUC_NO=#lucNumber# AND to_char(LM_DATE, 'ddMMYY hh24:mi:ss')=#lmDate#
</delete>

<delete id="daleteLucDtl" parameterClass="cargo.cms.uld.bo.ULDBO" >
	delete from LUC_DTL 
	WHERE LUC_NO=#lucNumber# AND DOC_LINE_NO = #docLineNo#  AND to_char(LM_DATE, 'ddMMYY hh24:mi:ss')=#lmDate#
</delete>



<delete id="deleteLucDetail" parameterClass="cargo.cms.uld.bo.LucBO" >
	DELETE luc_dtl WHERE luc_no=#lucNumber# AND to_char(LM_DATE, 'ddMMYY hh24:mi:ss')=#lmDate#
</delete> 
	<!-- Onsite Changed on 20 May 2006 by mayank Starts here -->
<select id="LucNumber" parameterClass="java.lang.Object" resultClass="java.lang.String">
	SELECT to_char(sysdate,'ddmmyy')||trim(to_char(LUC_SEQ.NEXTVAL, '00009')) LUC FROM DUAL
</select>

<!--  CPCT-->
<select id="ctrlRcptNo" parameterClass="java.lang.Object" resultClass="java.lang.String">
	SELECT trim(to_char(CREATE_UT_SEQ.NEXTVAL)) CPCT FROM DUAL
</select>
<select id="rcvnumber" parameterClass="cargo.cms.uld.bo.LucBO" resultClass="java.lang.String">
	SELECT handled_by_terminal from mast_carrier where code=#recCarr#
</select>
<select id="sysgmtsysdate" parameterClass="map" resultClass="java.lang.String">
	SELECT TO_CHAR(SYSDATE  - 1/3,'DDHHMI') FROM DUAL
</select>
<select id="getBasePort" parameterClass="map" resultClass="java.lang.String">
	SELECT BASE_PORT LUC FROM SYS_PARAM
</select>	

<select id="getSITAAddr" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.GenerateScmBO">
	select d.sita_addr AS sitaAddress from cust_company c left join cust_airl_sita_cimp_msg m 
	on m.cust_no =c.code left join cust_airl_sita_cimp_dtl d on d.tr_no=m.tr_no
	where m.msg_type='LUC' and c.carr_code=#PARAM#
</select>
<select id="getEmailFax" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.GenerateScmBO">
	select c.email1 AS emailAddress1 , c.fax1 AS faxNumber1  from cust_company c left join cust_airl_sita_cimp_msg m 
	on m.cust_no =c.code left join cust_airl_sita_cimp_dtl d on d.tr_no=m.tr_no
	where m.msg_type='LUC' and c.carr_code=#PARAM# and rownum=1
</select>	
<!-- Onsite Changed on 20 May 2006 by mayank Ends here -->
<!-- Onsite Changed on 20 May 2006 by mayank Starts here -->	
<insert id="insertLUC_HD" parameterClass="cargo.cms.uld.bo.LucBO" >
	insert into LUC_HD 
	 (LUC_NO , LUC_DATE, LUC_STAT, OUT_CARR_CODE,IN_CARR_CODE,   
	  TRANS_POINT, TRANS_DATE, RMK, 
	  CR_USER_ID, CR_DATE, LM_USER_ID, LM_DATE,TRANS_USER_ID,RCV_CARR_TERM,UPLOAD_DOC)
	 VALUES(#lucNumber#, SYSDATE,'I',UPPER(#isueCarr#),UPPER(#recCarr#),#basePort#, TO_DATE(#transDateTime#, 'DDMONYY HH24:MI'), #lucRemark#, #crUserId#, SYSDATE, #lmUserId#, SYSDATE,#crUserId#,UPPER(#rcvCarrTerm#),#transactionId#)
</insert>
<!-- Onsite Changed on 20 May 2006 by mayank Ends here -->
<insert id="insertLUC_DTL" parameterClass="cargo.cms.uld.bo.ULDBO" >
	insert into luc_dtl(LUC_NO, DOC_LINE_NO,  ULD_TYPE,     ULD_NO,       ULD_CARR,     
	 ULD_KEY,     RECPT_NO,     DEST_CODE,    CR_USER_ID,   CR_DATE,      LM_USER_ID,   LM_DATE,TR_TYPE)     
	values(#lucNumber#, #docLineNo#,  UPPER(#uldType#) , #uldNo#,UPPER(#uldCarr#),     
	 UPPER(#uldNumber#) , UPPER(#controlRecNumber#) , UPPER(#lucLoc#), #crUserId#, SYSDATE, #lmUserId#, SYSDATE,'LUCCR')
</insert>
<!-- Added by Arun on 17-06-10-->
<update id="updateuldrsvd" parameterClass="cargo.cms.uld.bo.ULDBO" >
update uld_inventory set
CFM_STATUS='LUC_RESERVED' , RESV_FLG='Y'  WHERE ULD_KEY=UPPER(#uldNumber#)
</update>
<update id="updateuldrsvd1" parameterClass="cargo.cms.uld.bo.ULDBO" >
update uld_inventory set
CFM_STATUS='CONFIRMED' , RESV_FLG='N'  WHERE ULD_KEY=UPPER(#uldNumber#)
</update>
<!-- Added by Arun on 17-06-10-->
<!-- Onsite Changed on 20 May 2006 by mayank Ends here -->
<select id="selectLucHeader" parameterClass="cargo.cms.uld.bo.LucBO" resultClass="cargo.cms.uld.bo.LucBO">
select   luc_hd.LUC_NO AS lucNumber, luc_hd.RCV_CARR_TERM AS rcvCarrTerm,luc_hd.UPLOAD_DOC AS transactionId, LUC_DATE As lucDate, LUC_STAT AS lucStat, RMK AS remark,  RMK AS lucRemark,
to_char(luc_hd.LM_DATE, 'ddMMYY hh24:mi:ss') As lmDate ,   OUT_CARR_CODE as isueCarr, IN_CARR_CODE as recCarr,
to_CHAR(TRANS_DATE, 'DDMONYY') As transferDate, TO_CHAR(TRANS_DATE, 'hh24:mi') As transferTime, 
TO_CHAR(TRANS_DATE, 'hh24') As transferTimeHH, TO_CHAR(TRANS_DATE, 'MI') As transferTimeMM,  
ULD_key As uldKey, RECPT_NO As controlRecNumber, DEST_CODE As lucLoc, c.luc_send as lucSend ,
LUC_STAT AS lucStat, decode(LUC_STAT, 'I', 'Issued', 'V', 'Void', 'P', 'Posted') AS status, TRANS_USER_ID AS transUser,to_char(TR_POST_DATE, 'ddMONyy hh24:mi') AS postDateTime , 
TR_POST_USER_ID AS postUser, TR_POST_RMK AS postRemark , sys_param.BASE_PORT AS basePort,sys_param.EDI_ORI_ADD AS ediOriAdd ,
luc_hd.LM_USER_ID as lmUserId , luc_hd.CR_USER_ID AS crUserId , to_char(luc_hd.LM_DATE, 'ddMMYY hh24:mi') As lmDate, to_char(luc_hd.CR_DATE, 'ddMMYY hh24:mi')  as crDate,
to_char(TR_POST_DATE,'DDMONYY') postDate,to_char(TR_POST_DATE,'HH24') postTimeHH,to_char(TR_POST_DATE,'MI') postTimeMM 
from luc_hd left join luc c on luc_hd.luc_no = c.luc_no , 
luc_dtl , sys_param 
where luc_hd.luc_no=luc_dtl.luc_no 
<isNotEmpty property="lucNumber"  >
	and luc_hd.LUC_NO=UPPER(#lucNumber#)
</isNotEmpty>
<isNotEmpty property="uldNo" >
	and luc_dtl.uld_key=UPPER(#uldNo#)
</isNotEmpty>
<isNotEmpty property="loginCarrier">
	AND ((OUT_CARR_CODE = #loginCarrier#
	OR OUT_CARR_CODE IN (SELECT CARR_CODE FROM MAST_CARR_GRP 
	WHERE GRP_CARR_CODE	= #loginCarrier#))	
	OR 
	(IN_CARR_CODE = #loginCarrier#
	OR IN_CARR_CODE IN (SELECT CARR_CODE FROM MAST_CARR_GRP 
	WHERE GRP_CARR_CODE	= #loginCarrier#)))	 	 	
</isNotEmpty> 
 order by luc_hd.LM_DATE DESC
</select>
<!-- Onsite Changed on 20 May 2006 by mayank Ends here 
left join Mast_Code_Dtl m on m.Code = c.Condn_Code and m.Code_Type = 'ULD_CONDITION'-->
<select id="selectLucDetail" parameterClass="cargo.cms.uld.bo.LucBO" resultClass="cargo.cms.uld.bo.LucBO">
select   luc_dtl.LUC_NO AS lucNumber, DOC_LINE_NO AS docLineNo , luc_dtl.ULD_KEY As uldKey , RECPT_NO As controlRecNumber ,   
luc_dtl.DEST_CODE As lucLoc, 
luc_dtl.LM_USER_ID as lmUserId , luc_dtl.CR_USER_ID AS crUserId , to_char(luc_dtl.LM_DATE, 'ddMMYY hh24:mi:ss') As lmDate,
to_char(luc_dtl.CR_DATE, 'ddMMYY hh24:mi')  as crDate , c.DAM_IND as condnCode
from luc_hd , luc_dtl left join uld_inventory  c on luc_dtl.ULD_KEY = c.ULD_KEY  
where 
luc_hd.luc_no=luc_dtl.luc_no
<isNotEmpty property="lucNumber" >
	and luc_hd.LUC_NO=UPPER(#lucNumber#)</isNotEmpty>
<isNotEmpty property="uldNo" >
	and luc_dtl.uld_key=UPPER(#uldNo#)
</isNotEmpty>
<isNotEmpty property="loginCarrier">
	AND	((OUT_CARR_CODE = #loginCarrier#
	OR OUT_CARR_CODE IN (SELECT CARR_CODE FROM MAST_CARR_GRP 
	WHERE GRP_CARR_CODE	= #loginCarrier#))
	or
	(IN_CARR_CODE = #loginCarrier#
	OR IN_CARR_CODE IN (SELECT CARR_CODE FROM MAST_CARR_GRP 
	WHERE GRP_CARR_CODE	= #loginCarrier#)))						
</isNotEmpty>

</select>

<!--<select id="lucCity" parameterClass="java.lang.String" resultClass="java.lang.Integer">
select count(1) from mast_city WHERE UPPER(CODE)=UPPER(#PARAM#)
</select>-->
<select id="lucCity" parameterClass="java.lang.String" resultClass="java.lang.Integer">
select count(1) from mast_arpt WHERE UPPER(CODE)=UPPER(#PARAM#)
</select>

<update id="postLuc" parameterClass="cargo.cms.uld.bo.LucBO" >
update LUC_HD set 
TR_POST_DATE=to_date(#postDateTime#,'DDMONYY HH24:MI'),TR_POST_USER_ID=#postUser#,
TR_POST_RMK=#postRemark#,
LUC_STAT='P', TR_POSTED='Y', LM_USER_ID=#lmUserId#, LM_DATE=SYSDATE WHERE LUC_NO=#lucNumber#
</update>

<!-- <sqlcheckuldtype><query>SELECT CODE FROM MAST_ULD_TYPE WHERE CODE=?</query></sqlcheckuldtype>
<sqlcheckuldcarrier><query>SELECT CODE FROM MAST_CARRIER WHERE CODE=?</query></sqlcheckuldcarrier>
 -->
<select id="aatCarrierHandlers"  parameterClass="java.lang.Object" resultClass="cargo.cms.uld.bo.CarrierBO">
	SELECT CODE AS carrCode, CODE_DESC AS carrName FROM MAST_CARRIER WHERE OWNED_CARR = 'Y' ORDER BY CODE
</select>

<select id="aatCarrier" parameterClass="java.lang.String" resultClass="java.lang.String">
select OWNED_CARR AS code from mast_carrier where code=#PARAM#
</select>
<!-- Onsite Changed on 20 May 2006 by mayank Starts here -->	
<select id="getcarrname" parameterClass="java.lang.String" resultClass="java.lang.String">
	SELECT CODE_DESC FROM MAST_CARRIER WHERE UPPER(CODE) = UPPER(#PARAM#)
</select>
<!-- Onsite Changed on 20 May 2006 by mayank Ends here -->	
<select id="aatCarrierInt" parameterClass="java.lang.String" resultClass="java.lang.Integer">
select count(1) from mast_carrier where code=#PARAM#
</select>

<!-- Validation for Void -->
<select id="voidcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
select count(1) from LUC_HD where LUC_NO=#lucNumber# AND LUC_STAT != 'P'
</select>
<!-- Validation for Void -->


<select id="uldForLuc" parameterClass="map" resultClass="cargo.cms.uld.bo.ULDBO">
select ULD_KEY as uldNumber, EIC_FLG AS eicFlag, OWNED_INV As aatInv, CFM_STATUS As cfmStatus , RESV_FLG AS resvFlag, OWNER_ID As ownerId from uld_inventory 
where uld_key=#uldNumber# AND OWNER_ID=#ownerId#
</select>

<!-- <sysDateTime><query>select TO_CHAR(SYSDATE, 'DDMONYY') DT, TO_CHAR(SYSDATE, 'HH24:MI') TM FROM DUAL</query>
</sysDateTime>
 -->
<!-- <sysDateTimeddmmyy><query>SELECT TO_CHAR(SYSDATE,'DDMMYY') DT, 'Notime' FROM DUAL</query></sysDateTimeddmmyy>
 -->


<update id="voidLuc" parameterClass="cargo.cms.uld.bo.LucBO" >
update LUC_HD set LUC_STAT='V',	 LM_USER_ID=#lmUserId#, LM_DATE=SYSDATE WHERE LUC_NO=#lucNumber#
</update>

<!-- <enqLuc1>
<query>select LUC_NO, OUT_CARR_CODE, IN_CARR_CODE, LUC_STAT, 
to_CHAR(TRANS_DATE, 'DDMONYY') TRN_DT, TO_CHAR(TRANS_DATE, 'hh24:mi') TRN_TIME, TR_USER_ID, 
to_CHAR(TR_POST_DATE, 'DDMONYY') POST_DT, TO_CHAR(TR_POST_DATE, 'hh24:mi') POST_TIME, TR_POST_USER_ID, 
LM_DATE  from luc_hd where upper(LUC_NO) LIKE upper(?)</query>
</enqLuc1>

<enqLuc2>
<query>select LUC_NO, OUT_CARR_CODE, IN_CARR_CODE, LUC_STAT, 
to_CHAR(TRANS_DATE, 'DDMONYY') TRN_DT, TO_CHAR(TRANS_DATE, 'hh24:mi') TRN_TIME, TR_USER_ID, 
to_CHAR(TR_POST_DATE, 'DDMONYY') POST_DT, TO_CHAR(TR_POST_DATE, 'hh24:mi') POST_TIME, TR_POST_USER_ID, 
LM_DATE  from luc_hd 
where upper(LUC_NO) LIKE upper(?)</query>
</enqLuc2>
 -->
<!-- Validations for Create LUC Starts Here -->
<!-- 3. To check if ULD RESV_FLG is not 'N' and it can be transferedflag is 'N' -->
<select id="sqluldresvflgcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory	where ULD_Key = #ULD_No# and RESV_FLG = 'N'
</select>
<select id="sqluldreleasecfmstatuscheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory 	where ULD_Key = #ULD_No# and UPPER(CFM_Status) != 'LUC_RESERVED' 
</select>
<!--	Error Msg: Cannot transfer ULD as ULD is already reserved --> 

<!-- 4. To check if ULD is not EIC and it can be transfered--> 
	<select id="sqluldeicflgcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #ULD_No# and EIC_TYPE = 'EIC'
	</select>	
	<select id="sqluldreleaseeicflgcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #ULD_No# and EIC_TYPE = 'EIC' and BASE_PAL_FLG ='N' 
	</select>
	<select id="sqluldreleaseeicflgcheck1" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #ULD_No# and EIC_TYPE = 'PS' and BASE_PAL_FLG ='Y' 
	</select>
<!--	Error Msg: Cannot transfer ULD as ULD is part of EIC -->
<!-- To check base Pallet of EIC  -->
	<select id="sqluldbasepltflgcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #PARAM# and EIC_TYPE = 'EIC' and BASE_PAL_FLG ='Y' 
	</select>
	
<!-- 5 .The check if ULD is belongs to issuing Carr -->
<select id="sqluldissuecarrcheck" parameterClass="map" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #ULDNo# and Owner_Id = #IssuingCarr#
</select>
<!--	Error Msg: Cannot transfer ULD as ULD does not belong to the issuing carrier. -->

<!-- 6 . To check if ULD is in inventory and it can be transfered -->
<select id="sqluldAatInventoryCheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #param#
</select>
<select id="sqluldagentinvcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory where ULD_Key = #ULD_No# and LOC_CODE is not null and NVL(Agent_Inv,'N') = 'N'
</select>
<!--	Error Msg: Cannot transfer ULD as ULD is not in AAT inventory --> 

<!-- 7 .The check if ULD is not pre-manifested on an export flight. -->
<select id="sqluldflttypecheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory 	where ULD_Key = #ULD_No# and FLT_TYPE = 'E' and FLT_KEY is not null
</select>
<select id="sqluldfltcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory 	where ULD_Key = #ULD_No# and FLT_KEY is not null
</select>
<!--	Error Msg: Cannot transfer ULD as ULD is used in Export process. -->

<!-- Added by arun 0n 17-06-10  -->
<!-- 8.To check uld in process of being  breakdown from import flight  -->
<select id="bdimport_inprcs" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM imp_ramp_chk_dtl chk, uld_inventory inv WHERE 
		chk.flt_key = inv.imp_flt_key and chk.flt_date = inv.imp_flt_date and chk.uld_key = inv.uld_key
		AND chk.uld_key = #ULD_No# AND inv.empty_flg = 'N' AND chk.brkdn_compl_date  IS NULL
</select>

<!-- To check issuing carrier and receiving are under Same group -->
<select id="carr_grpCheck" parameterClass="java.lang.String" resultClass="java.lang.String">
select nvl((select grp_carr_code from mast_carr_grp where carr_code= #PARAM#), #PARAM#) from dual
</select>
<select id="sqlgetAatInv" parameterClass="java.lang.String" resultClass="java.lang.String">
SELECT OWNED_CARR  FROM MAST_CARRIER   WHERE CODE = #PARAM#
</select>

<!-- To check Receiving Carr is handeled by CPCT  -->
<select id="uldcarrCPCTCheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
SELECT COUNT(1) FROM mast_carrier WHERE code= #PARAM#  and owned_carr='Y' and handled_by_terminal='CPCT'
</select>
<!-- Added by arun 0n 17-06-10 -->

<!-- To check Uld is Empty -->
<select id="luc_uldEmptyCheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory 	where ULD_Key = #ULD_No# and NVL(EMPTY_FLG,'N') = 'N'
</select>
<!--	Error Msg: Cannot transfer ULD as ULD is not Empty. -->

<!--  To check if ULD location is confirmed and it can be transfered
 <select id="sqluldconfirmedwhdestcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory 	where ULD_Key = #ULD_No# and UPPER(CFM_Status) != 'UNCONFIRMED' and LOC_CODE IS NOT NULL
</select>
 Error Msg: Cannot transfer ULD as ULD location is not Confirmed -->

<!-- Added by arun 0n 22-06-10 -->
<!-- To get all uld of base pallet of EIC -->
<select id="sqluldgetgtoppalets" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.ULDBO">
		select ULD_KEY AS uldNumber from uld_inventory where base_plt=#PARAM#
</select>
<!-- AFTER  INSERT ON LUC_DTL FOR EACH ROW -->
<update id="LUC_DTL_INS_ULD_INVENTORY" parameterClass="cargo.cms.uld.bo.ULDBO">
UPDATE ULD_INVENTORY
   SET CFM_STATUS = 'LUC_RESERVED',
       LM_USER_ID = #lmUserId#,
       LM_DATE    = SYSDATE,
       REF_TR_NO      = UPPER(#lucNumber#),
       REF_TR_TYPE    = 'LU',
       REF_TR_DATE    = SYSDATE,
       REF_IN_CARR    = #recCarr#,
       REF_OUT_CARR   = #issCarr#,
       REF_TR_EVENT     = 'LU', 
       RESV_FLG = 'Y',
       RESV_DATE=SYSDATE,
       RESV_USER_ID= #crUserId#,
       REF_RMK = #lucRemark#,
       TR_TYPE = ''
       WHERE ULD_KEY = UPPER(#uldNumber#)or ULD_KEY in (select ULD_KEY from uld_inventory where base_plt = UPPER(#uldNumber#))
</update>

<!-- AFTER  UPDATE ON LUC_DTL FOR EACH ROW -->
<update id="LUC_DTL_UPD_ULD_INVENTORY" parameterClass="cargo.cms.uld.bo.ULDBO">
UPDATE ULD_INVENTORY
   SET CFM_STATUS = 'LUC_RESERVED',
       LM_USER_ID = #lmUserId#,
       LM_DATE    = SYSDATE,
       REF_TR_NO      = UPPER(#lucNumber#),
       REF_TR_TYPE    = 'LU',
       REF_TR_DATE    = SYSDATE,
       REF_IN_CARR    = #recCarr#,
       REF_OUT_CARR   = #issCarr#,
       REF_TR_EVENT     = 'ALU', 
       REF_RMK =#lucRemark#,
       TR_TYPE = ''
       WHERE ULD_KEY = UPPER(#uldNumber#) or ULD_KEY in (select ULD_KEY from uld_inventory where base_plt = UPPER(#uldNumber#))

</update>
                 
                 
                 
<!--BEFORE  DELETE ON LUC_DTL -->
<update id="LUC_DTL_DEL_ULD_INVENTORY" parameterClass="cargo.cms.uld.bo.ULDBO">
UPDATE ULD_INVENTORY
   SET CFM_STATUS = 'CONFIRMED',
     LM_USER_ID =  #lmUserId#,
     LM_DATE    = SYSDATE,
     REF_TR_NO      = UPPER(#lucNumber#),
     REF_TR_TYPE    = 'LU',
     REF_TR_DATE    = SYSDATE,
     REF_IN_CARR    = #recCarr#,
     REF_OUT_CARR   = #issCarr#,
     REF_TR_EVENT     = 'DELETE',
     RESV_FLG = 'N',
     REF_RMK          = #lucRemark#
     WHERE ULD_KEY = UPPER(#uldNumber#) or ULD_KEY in (select ULD_KEY from uld_inventory where base_plt = UPPER(#uldNumber#))
</update>          
                 
                                
<!-- AFTER UPDATE OF TR_POSTED in LUC_HD -->
<update id="LUC_HD_POST_UPD_ULD_INVENTORY" parameterClass="cargo.cms.uld.bo.ULDBO"> 
UPDATE ULD_INVENTORY
    SET CFM_STATUS= DECODE(NVL(#aatInv#,'N'),'N','REMOVED','CONFIRMED'),
      LOC_CODE    = DECODE(NVL(#aatInv#,'N'),'N',NULL,LOC_CODE),
      OWNED_INV   = DECODE(NVL(#aatInv#,'N'),'N','N','Y'),
	  OWNER_ID    = #recCarr#,
      REF_TR_NO      =UPPER(#lucNumber#),
      REF_TR_TYPE    = 'LU',
      LM_DATE    = SYSDATE,
      REF_TR_DATE    = SYSDATE,
      REF_IN_CARR    =#recCarr#,
      REF_OUT_CARR   = #issCarr#,
	  REF_TR_EVENT     = 'POST',
	  RESV_FLG = 'N',
      REF_RMK          = #postRemark#,
      base_plt=null,
      eic_type=null,
      eic_flg='N' ,
      TR_TYPE='POLUC'
      <isEqual property="aatInv" compareValue="Y">		
 		,ENTRY_TIME = sysdate
	  </isEqual>
      WHERE ULD_KEY = UPPER(#uldNumber#) or ULD_KEY in (select ULD_KEY from uld_inventory where base_plt = UPPER(#uldNumber#))
</update>    
                                          
                                  
<!-- AFTER UPDATE OF LUC_STAT ON LUC_HD  -->
<update id="LUC_HD_VOID_UPD_ULD_INVENTORY" 	parameterClass="cargo.cms.uld.bo.ULDBO">        
UPDATE ULD_INVENTORY
    SET CFM_STATUS = 'CONFIRMED',
      LM_USER_ID = #lmUserId#,
      LM_DATE    = SYSDATE,
      REF_TR_NO      = UPPER(#lucNumber#),
      REF_TR_TYPE    = 'LU',
      REF_TR_DATE    = SYSDATE,
      REF_IN_CARR    = #recCarr#,
      REF_OUT_CARR   = #issCarr#,
      REF_TR_EVENT     = 'VLUC',
      RESV_FLG = 'N',
      RESV_DATE=null,
      RESV_USER_ID=null,
      REF_RMK          =#lucRemark#,
      TR_TYPE = 'VOLUC'
      WHERE ULD_KEY  = UPPER(#uldNumber#) AND CFM_STATUS = 'LUC_RESERVED' or ULD_KEY in (select ULD_KEY from uld_inventory where base_plt = UPPER(#uldNumber#))
</update>    
     
<!--Added by arun 0n 22-06-10 -->
	<!-- Onsite Changed on 20 May 2006 by mayank Starts here -->	
<insert id="insertLUCAddressDetails" parameterClass="cargo.cms.uld.bo.GenerateScmBO" >
	<![CDATA[
		INSERT INTO LUC_ADDR (TR_NO, ADDR_TYPE, MSG_ADDR, CR_USER_ID, CR_DATE, LM_USER_ID, 
			LM_DATE	)
		VALUES(#transactionNo#, #addressType#, #sitaAddress#,#createdBy#, SYSDATE, #createdBy#, SYSDATE)
	]]>
</insert>
<insert id="insertIntoLUC" parameterClass="cargo.cms.uld.bo.LucBO" >
	<![CDATA[
	 	INSERT INTO  LUC 
		(TR_NO, LUC_NO,MSG,LUC_SEND,CR_USER_ID,CR_DATE,LM_USER_ID,LM_DATE) 
		VALUES(#trNo#, #lucNumber#, #message#,'N',#crUserId#,SYSDATE,#crUserId#, SYSDATE)
	]]>		
</insert>
<select id="getluctrno" parameterClass="java.lang.String" resultClass="java.lang.String">
	SELECT TR_NO FROM LUC WHERE LUC_NO = #PARAM#
</select>
<select id="getcountcheckluctrno" parameterClass="cargo.cms.uld.bo.GenerateScmBO" resultClass="java.lang.Integer">
	select count(1) from luc_addr where TR_NO = #transactionNo# AND ADDR_TYPE = #addressType# AND MSG_ADDR =#sitaAddress#
</select>
<update id="updateLucMsg" parameterClass="cargo.cms.uld.bo.GenerateScmBO">
	UPdate LUC set msg = #scm# , PRT_CODE = #printerId# , LUC_SEND = 'Y' , ADDR_GRP = #originAddress# ,
	LM_USER_ID = #createdBy#  , LM_DATE = SYSDATE WHERE LUC_NO = #lucNumber# 
</update>
<select id="getsitaaddrreslist" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.GenerateScmBO">
	SELECT SITA_ADDR AS #sitaAddress# FROM CUST_AIRL_SITA_GRPDTL WHERE ADDR_GROUP = #PARAM# 
</select>

<select id="checkValidSitaAddress" parameterClass="cargo.cms.uld.bo.GenerateScmBO" resultClass="java.lang.Integer">
	SELECT count(1) FROM CUST_AIRL_SITA_GRPDTL WHERE SITA_ADDR = #sitaAddress#   
</select>
<select id="checkValidOriginAddress" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT count(1) from sys_param WHERE EDI_ORI_ADD = #PARAM#  
</select>

<!--	<update id ="updateLUCAddressDetails" parameterClass="cargo.cms.uld.bo.GenerateScmBO">
	UPDATE LUC_ADDR SET
		MSG_ADDR = #sitaAddress#, 
		LM_USER_ID = #createdBy#,  
		LM_DATE = SYSDATE
	WHERE  
		TR_NO = #transactionNo# AND
		ADDR_TYPE = #addressType# 
</update>
<select id="addressesLuc"  parameterClass="java.lang.String" 
	resultClass="cargo.cms.uld.bo.GenerateScmBO">
	SELECT  ADDR_TYPE AS #addressType#, MSG_ADDR AS #address# FROM LUC_ADDR WHERE TR_NO = #PARAM# 
</select> -->
<!-- Onsite Changed on 20 May 2006 by mayank Ends here -->
<!-- Validations for Create LUC Ends Here -->

<!-- ======================	CREATE MULD STARTS HERE BY MAYANK  ==================================== -->
	<insert id="sqlinsertuldrequestexternal" parameterClass="cargo.cms.uld.bo.ULDRequestBO">
		INSERT INTO ULD_ISS_HD(TR_NO,ISS_NO,EIR_NO,CARR_CODE,REQ_BY_CARR,FLT_NO,FLT_DATE,ISS_RMK,AGENT_CUST_NO,STP_EFAX,PRT_CODE,TR_TYPE,TR_STATUS,CR_USER_ID,CR_DATE,LM_USER_ID,LM_DATE,STATUS,ORIG_EIR_NO)VALUES (#trNo#,#issNo#,#eirNo#,#carrCode#,#requestByFlag#,#fltNo#,#fltDate#,#reqRem#,#agentName#,#emailFaxStop#,#boPrinter#,#trType#,#trStatus#,#crUserId#,SYSDATE,#lmUserId#,SYSDATE,#status#,#parentEIRNo#)
	</insert>
	
	<insert id="sqlinsertuldrequestinternal" parameterClass="cargo.cms.uld.bo.ULDRequestBO">
		INSERT INTO ULD_ISS_HD(TR_NO,ISS_NO,EIR_NO,CARR_CODE,REQ_BY_CARR,FLT_NO,FLT_DATE,ISS_RMK,AGENT_CUST_NO,STP_EFAX,PRT_CODE,TR_TYPE,TR_STATUS,CR_USER_ID,CR_DATE,LM_USER_ID,LM_DATE,EIR_DATE,EIR_TIME,STATUS,EIR_EXPIRY_DATE,ORIG_EIR_NO)VALUES (#trNo#,#issNo#,#eirNo#,#carrCode#,#requestByFlag#,#fltNo#,#fltDate#,#reqRem#,#agentName#,#emailFaxStop#,#boPrinter#,#trType#,#trStatus#,#crUserId#,SYSDATE,#lmUserId#,SYSDATE,SYSDATE,TO_CHAR(SYSDATE,'HH24MISS'),#status#,(SYSDATE + (#extendEirHrs#/24)),#parentEIRNo#)
	</insert>
	
	<insert id="sqlinsertspliteirinternal" parameterClass="cargo.cms.uld.bo.ULDRequestBO">
		INSERT INTO ULD_ISS_HD(TR_NO,ISS_NO,EIR_NO,CARR_CODE,REQ_BY_CARR,FLT_NO,FLT_DATE,ISS_RMK,AGENT_CUST_NO,STP_EFAX,PRT_CODE,TR_TYPE,TR_STATUS,CR_USER_ID,CR_DATE,LM_USER_ID,LM_DATE,EIR_DATE,EIR_TIME,STATUS,EIR_EXPIRY_DATE,ORIG_EIR_NO)VALUES (#trNo#,#issNo#,#eirNo#,#carrCode#,#requestByFlag#,#fltNo#,#fltDate#,#reqRem#,#agentName#,#emailFaxStop#,#boPrinter#,#trType#,#trStatus#,#crUserId#,SYSDATE,#lmUserId#,SYSDATE,SYSDATE,TO_CHAR(SYSDATE,'HH24MISS'),#status#,TO_DATE(#expiryDate#,'DDMONYY HH24:MI'),#parentEIRNo#)
	</insert>

	<insert id="sqlinsertspliteirexternal" parameterClass="cargo.cms.uld.bo.ULDRequestBO">
		INSERT INTO ULD_ISS_HD(TR_NO,ISS_NO,EIR_NO,CARR_CODE,REQ_BY_CARR,FLT_NO,FLT_DATE,ISS_RMK,AGENT_CUST_NO,STP_EFAX,PRT_CODE,TR_TYPE,TR_STATUS,CR_USER_ID,CR_DATE,LM_USER_ID,LM_DATE,EIR_DATE,EIR_TIME,STATUS,ORIG_EIR_NO,EIR_EXPIRY_DATE)VALUES (#trNo#,#issNo#,#eirNo#,#carrCode#,#requestByFlag#,#fltNo#,#fltDate#,#reqRem#,#agentName#,#emailFaxStop#,#boPrinter#,#trType#,#trStatus#,#crUserId#,SYSDATE,#lmUserId#,SYSDATE,SYSDATE,TO_CHAR(SYSDATE,'HH24MISS'),#status#,#parentEIRNo#,TO_DATE(#expiryDate#,'DDMONYY HH24:MI'))
	</insert>

	<insert id="sqlinsertuldgroup" parameterClass="cargo.cms.uld.bo.ULDTypeBO">
		INSERT INTO ULD_ISS_DTL (TR_NO,ISS_NO,EIR_NO,DOC_LINE_NO,ULD_EQUIP,ULD_GROUP,ULD_TYPE,ULD_REQ_QTY,TR_TYPE,TR_STATUS, CR_USER_ID,CR_DATE, LM_USER_ID,LM_DATE) VALUES (#trNo#,#issNo#,#eirNo#,#docLineNo#,#recType#,#uldGroup#,#uldType#,#iqty#,#trType#,#trStatus#,#crUserId#,SYSDATE,#lmUserId#,SYSDATE)
	</insert>

	<insert id="sqlinsertaccgroup" parameterClass="cargo.cms.uld.bo.AccessoryBO">
		INSERT INTO ULD_ISS_DTL (TR_NO,ISS_NO,EIR_NO,DOC_LINE_NO,ULD_EQUIP,EQUIP_TYPE,EQUIP_REQ_QTY,TR_TYPE,TR_STATUS, CR_USER_ID,CR_DATE, LM_USER_ID,LM_DATE) VALUES (#trNo#,#issNo#,#eirNo#,#docLineNo#,#recType#,#accessoryType#,#iqty#,#trType#,#trStatus#,#crUserId#,SYSDATE,#lmUserId#,SYSDATE)
	</insert>

	<select id="sqlmaxissno" parameterClass="java.lang.String" resultClass="java.lang.String">
		SELECT NVL(MAX(SUBSTR(ISS_NO,5,9)),'00000') FROM ULD_ISS_HD WHERE TO_CHAR(CR_DATE,'DDMONYY') = TO_CHAR(SYSDATE,'DDMONYY')
	</select>
	
	<select id="sqlmaxeirno" parameterClass="java.lang.String" resultClass="java.lang.String">
		SELECT NVL(MAX(SUBSTR(EIR_NO,7,11)),'00000') FROM ULD_ISS_HD WHERE TO_CHAR(CR_DATE,'DDMONYY') = TO_CHAR(SYSDATE,'DDMONYY')
	</select>
	
	<select id="sqluldtypecheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM MAST_ULD_TYPE WHERE CODE = #PARAM#
	</select>
	
	<select id="sqluldgroupcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM MAST_ULD_GROUP WHERE ULD_GROUP = #PARAM#
	</select>
	<!-- Onsite Changed on 22 May 2006 by mayank Starts here -->
	<select id="getreleaseeirdoclineno" parameterClass="java.lang.String" resultClass="java.lang.Integer">
			SELECT NVL(MAX(DOC_LINE_NO),0) FROM ULD_REL_DTL WHERE EIR_NO = #PARAM#
	</select>
	<select id="acclistdata" parameterClass="map" resultClass="cargo.cms.uld.bo.ULDRequestBO">	 	
		SELECT DOC_LINE_NO AS relDocLineNo , EQUIP_QTY AS iaccQty , EQUIP_TYPE accessoryType FROM ULD_REL_DTL   
		WHERE EQUIP_TYPE = #accessoryType# AND EIR_NO = #eirNo#
	</select>
	<update id="updateAcclistdata" parameterClass="cargo.cms.uld.bo.ULDRequestBO">
		UPDATE ULD_REL_DTL SET EQUIP_QTY = #iaccQty# 
		WHERE EQUIP_TYPE = #accessoryType# AND EIR_NO = #eirNo# and DOC_LINE_NO = #relDocLineNo#
	</update>
	<!-- Onsite Changed on 22 May 2006 by mayank Ends here -->
	<select id="sqlcarrfltcheck" parameterClass="java.lang.String" resultClass="java.lang.String">
		SELECT ULD_FLT_RQD FROM MAST_CARRIER WHERE CODE = #PARAM#
	</select>
	
	<select id="sqlforcustnumber" parameterClass="map" resultClass="java.lang.String">
		SELECT CUST_NO FROM SEC_USER WHERE USER_TYPE = #userType# AND CODE = #userId# 
	</select>

	<select id="sqlforcarrier" parameterClass="map" resultClass="java.lang.String">
			SELECT CARR_CODE FROM CUST_COMPANY WHERE CODE = #custcode# AND AIRLINE_YN='Y'
	</select>
	<select id="sqlgetagentname" parameterClass="java.lang.String" resultClass="java.lang.String">
		SELECT CODE FROM CUST_COMPANY WHERE Upper(CODE_DESC) = #PARAM# AND AGENT_YN = 'Y'
	</select>

	<select id="sqlgetagentcount" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT COUNT(1) CODE FROM CUST_COMPANY WHERE Upper(CODE_DESC) = #PARAM# AND AGENT_YN = 'Y'
	</select>
	<!-- Onsite Changed on 25 May 2006 by mayank Starts here -->
	<select id="sqlagentcodecount" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT COUNT(1) CODE FROM CUST_COMPANY WHERE Upper(CODE) = #PARAM# AND AGENT_YN = 'Y'
	</select>
	
	<select id="sqlagentcountcheck" parameterClass="map" resultClass="java.lang.Integer">
		SELECT COUNT(1) CODE FROM CUST_COMPANY WHERE Upper(CODE_DESC) = #agentIdName# AND Upper(CODE) = #agentName# AND AGENT_YN = 'Y'
	</select>
	<select id="aatCarrierHandlersCheck"  parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM MAST_CARRIER WHERE CODE = #PARAM# AND OWNED_CARR = 'Y' ORDER BY CODE
	</select>
	<!-- Onsite Changed on 25 May 2006 by mayank Starts here -->
	<!-- Onsite Changed on 20 May 2006 by mayank Starts here -->
	<!-- <select id="sqlfltvalidate" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="java.lang.Integer">
		SELECT count(1) from FLT_OPR where UPPER(CARR_CODE) = UPPER(#carrName#) AND  
		UPPER(FLT_NO) = UPPER(#fltNo#) AND SCH_DATE = to_date(#fltDate#,'DDMONYY')		
	</select> -->
	<select id="sqlfltvalidate" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="java.lang.Integer">
		SELECT count(1) from FLT_OPR where flt_key  = UPPER(#fltNo#) AND SCH_DATE = to_date(#fltDate#,'DDMONYY') 
	</select>
	<select id="sqlcarriervalidate" parameterClass="cargo.cms.uld.bo.FlightDetailsBO" resultClass="java.lang.Integer">		
		SELECT count(*) FROM FLT_OPR WHERE SCH_DATE = TO_DATE(#scheduledDate#,'DDMONYY') AND CARR_CODE=#carrierCode# 
	</select>	
	<select id="sqlflightnumbervalidate" parameterClass="cargo.cms.uld.bo.FlightDetailsBO" resultClass="java.lang.Integer">
		SELECT count(*) FROM FLT_OPR WHERE UPPER(FLT_NO) = UPPER(#flightNo#) AND SCH_DATE = TO_DATE(#scheduledDate#,'DDMONYY') AND CARR_CODE=#carrierCode#
	</select>
	<select id="sqlstopemailfax" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.GenerateScmBO">
		SELECT 
		EMAIL1 AS emailAddress1 ,EMAIL2 AS emailAddress2 , 
		EMAIL3 AS emailAddress3 , EMAIL4 AS emailAddress4 , 
		EMAIL5 AS emailAddress5 , 
		FAX1 AS faxNumber1 ,FAX2 AS faxNumber2 ,
		FAX3 AS faxNumber3 , FAX4 AS faxNumber4 , FAX5 AS faxNumber5 
		FROM CUST_CONTACT WHERE CONTACT_TYPE = 'EIR' AND CUST_NO = #PARAM#
	</select>
	<!-- <select id="sqlfltdatevalidate" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) from dual where sysdate &lt;= #PARAM#
	</select> 

	<select id="insertCheck" parameterClass="java.lang.Object">
			COMMIT
	</select> -->
<!-- ======================	CREATE MULD ENDS HERE BY MAYANK  ==================================== -->
<!-- ======================	Maintain mULD Starts HERE BY MAYANK  ==================================== -->

<select id="sqlmuldlist" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">	 	
	SELECT a.TR_NO AS trNo, a.ISS_NO AS issNo, a.EIR_NO AS eirNo, 
	to_char(a.EIR_DATE,'DDMONYY HH24:MI') AS eirDate,
	a.CARR_CODE AS carrCode ,  pkg_uld.get_eir_info(a.ISS_NO, 'U') uldGroupType, 
	pkg_uld.get_eir_info(a.ISS_NO, 'E') accName, 
	a.CR_USER_ID AS crUserId , to_char(a.CR_DATE, 'DDMONYY hh24:mi') AS crDate, 
	to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate, a.ISS_RMK AS reqRem, a.TR_STATUS as trStatus ,     
	a.status as status , c.CODE_DESC AS agentIdName, c.CODE as agentName,
	a.EXTENDED_YN AS extendEirFlag , ORIG_EIR_NO AS parentEIRNo , TO_CHAR(a.EIR_EXPIRY_DATE,'DDMONYY HH24:MI') expiryDate
	FROM ULD_ISS_HD a 
	LEFT JOIN CUST_COMPANY c ON a.AGENT_CUST_NO = c.CODE  
	where 1 = 1  
	<isNotEmpty property="issNo"> AND a.ISS_NO = #issNo# </isNotEmpty>		
	<isNotEmpty property="eirNo"> AND a.EIR_NO = #eirNo# </isNotEmpty>		
	<isNotEmpty property="carrCode"> AND a.CARR_CODE = Upper(#carrCode#) </isNotEmpty>		 
	<isNotEmpty property="agentName"> AND c.CODE = #agentName#</isNotEmpty>
	<isNotEmpty property="coIataCode"> AND c.CO_IATA_CODE = #coIataCode#</isNotEmpty>
	<isNotEmpty property="agentIdName"> AND UPPER(c.CODE_DESC) = UPPER(#agentIdName#)</isNotEmpty>	 
	<isNotEmpty property="crDateFrom">
		<isNotEmpty property="crDateTo"> 
			AND TO_CHAR(a.CR_DATE,'DDMONYY') &gt;= TO_DATE(#crDateFrom#, 'DDMONYY') 
			AND TO_CHAR(a.CR_DATE,'DDMONYY') &lt; TO_DATE(#crDateTo#, 'DDMONYY') + 1  
		</isNotEmpty>
	</isNotEmpty>
	<isNotEqual property="status" compareValue="ALL"> AND a.STATUS LIKE #status# </isNotEqual>	
	<isNotEmpty property="loginCarrier"> AND a.CARR_CODE = #loginCarrier# </isNotEmpty>
	<isNotEmpty property="loginAgentCode"> and c.code = #loginAgentCode#</isNotEmpty>
	Order By c.CODE_DESC
</select>

<select id="sqleirlist" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">	 	
	SELECT a.TR_NO AS trNo, a.ISS_NO AS issNo, a.EIR_NO AS eirNo, 
	to_char(a.EIR_DATE,'DDMONYY HH24:MI') AS eirDate,
	a.CARR_CODE AS carrCode , b.ULD_GROUP||b.ULD_TYPE AS uldGroup ,  
	b.ULD_REQ_QTY AS iuldQty ,  b.EQUIP_TYPE as accessoryType, b.EQUIP_REQ_QTY AS iaccQty ,    
	a.EIR_NO AS eirNo, a.CR_USER_ID AS crUserId , to_char(a.CR_DATE, 'DDMONYY hh24:mi') AS crDate, 
	to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate, a.ISS_RMK AS reqRem, a.TR_STATUS as trStatus ,     
	b.DOC_LINE_NO AS docLineNo,	a.status as status , c.CODE_DESC AS agentIdName, c.CODE as agentName,
	a.EXTENDED_YN AS extendEirFlag , ORIG_EIR_NO AS parentEIRNo , TO_CHAR(a.EIR_EXPIRY_DATE,'DDMONYY HH24:MI') expiryDate
	FROM ULD_ISS_HD a LEFT JOIN CUST_COMPANY c ON a.AGENT_CUST_NO = c.CODE  , ULD_ISS_DTL b     
	where a.TR_NO = b.TR_NO AND a.ISS_NO = b.ISS_NO 
	<isNotEmpty property="issNo"> AND a.ISS_NO = #issNo# </isNotEmpty>		
	<isNotEmpty property="eirNo"> AND a.EIR_NO = #eirNo# </isNotEmpty>		
	<isNotEmpty property="carrCode"> AND a.CARR_CODE = Upper(#carrCode#) </isNotEmpty>		 
	<isNotEmpty property="agentName"> AND c.CODE = #agentName#</isNotEmpty>
	<isNotEmpty property="coIataCode"> AND c.CO_IATA_CODE = #coIataCode#</isNotEmpty>
	<isNotEmpty property="agentIdName"> AND UPPER(c.CODE_DESC) = UPPER(#agentIdName#)</isNotEmpty>	 
	<isNotEmpty property="crDateFrom">
		<isNotEmpty property="crDateTo"> 
			AND TO_CHAR(a.CR_DATE,'DDMONYY') &gt;= TO_DATE(#crDateFrom#, 'DDMONYY') 
			AND TO_CHAR(a.CR_DATE,'DDMONYY') &lt; TO_DATE(#crDateTo#, 'DDMONYY') + 1  
		</isNotEmpty>
	</isNotEmpty>
	<isNotEqual property="status" compareValue="ALL"> AND a.STATUS LIKE #status# </isNotEqual>
	<isNotEmpty property="loginCarrier"> AND a.CARR_CODE = #loginCarrier# </isNotEmpty>
	<isNotEmpty property="loginAgentCode"> AND c.CODE = #loginAgentCode#</isNotEmpty>
	Order By c.CODE_DESC
</select>

<select id="sqlprocesseirlist" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">	 	
	SELECT a.TR_NO AS trNo, a.ISS_NO AS issNo, a.EIR_NO AS eirNo, 
	to_char(a.EIR_DATE,'DDMONYY HH24:MI') AS eirDate,
	a.CARR_CODE AS carrCode , b.ULD_GROUP||b.ULD_TYPE AS uldGroup ,  
	b.ULD_REQ_QTY AS iuldQty ,  b.EQUIP_TYPE as accessoryType, b.EQUIP_REQ_QTY AS iaccQty ,    
	a.EIR_NO AS eirNo, a.CR_USER_ID AS crUserId , to_char(a.CR_DATE, 'DDMONYY hh24:mi') AS crDate, 
	to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate, a.ISS_RMK AS reqRem, a.TR_STATUS as trStatus ,     
	b.DOC_LINE_NO AS docLineNo,	a.status as status , c.CODE_DESC AS agentIdName, c.CODE as agentName,
	a.EXTENDED_YN AS extendEirFlag , ORIG_EIR_NO AS parentEIRNo , TO_CHAR(a.EIR_EXPIRY_DATE,'DDMONYY HH24:MI') expiryDate
	FROM ULD_ISS_HD a LEFT JOIN CUST_COMPANY c ON a.AGENT_CUST_NO = c.CODE  , ULD_ISS_DTL b     
	where a.TR_NO = b.TR_NO AND a.ISS_NO = b.ISS_NO AND a.STATUS = 'PENDING'
	<isNotEmpty property="issNo"> AND a.ISS_NO = #issNo# </isNotEmpty>		
	<isNotEmpty property="eirNo"> AND a.EIR_NO = #eirNo# </isNotEmpty>		
	<isNotEmpty property="carrCode"> AND a.CARR_CODE = Upper(#carrCode#) </isNotEmpty>		 
	<isNotEmpty property="agentName"> AND c.CODE = #agentName#</isNotEmpty>
	<isNotEmpty property="coIataCode"> AND c.CO_IATA_CODE = #coIataCode#</isNotEmpty>
	<isNotEmpty property="agentIdName"> AND UPPER(c.CODE_DESC) = UPPER(#agentIdName#)</isNotEmpty>	 
	<isNotEmpty property="crDateFrom">
		<isNotEmpty property="crDateTo"> 
			AND TO_CHAR(a.CR_DATE,'DDMONYY') &gt;= TO_DATE(#crDateFrom#, 'DDMONYY') 
			AND TO_CHAR(a.CR_DATE,'DDMONYY') &lt; TO_DATE(#crDateTo#, 'DDMONYY') + 1  
		</isNotEmpty>
	</isNotEmpty>
	<isNotEmpty property="loginCarrier"> AND a.CARR_CODE = #loginCarrier# </isNotEmpty>
	<isNotEmpty property="loginAgentCode"> AND c.CODE = #loginAgentCode#</isNotEmpty>
	Order By c.CODE_DESC
</select>

<select id="sqlmuldinterfacelist" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">	 	
	SELECT a.TR_NO AS trNo, a.ISS_NO AS issNo, a.EIR_NO AS eirNo, 
	to_char(a.EIR_DATE,'DDMONYY HH24:MI') AS eirDate,
	a.CARR_CODE AS carrCode , b.ULD_GROUP AS uldGroup ,    b.ULD_TYPE AS uldType ,
	b.ULD_REQ_QTY AS iuldQty ,  b.EQUIP_TYPE as accessoryType, b.EQUIP_REQ_QTY AS iaccQty ,    
	a.EIR_NO AS eirNo, a.CR_USER_ID AS crUserId , to_char(a.CR_DATE, 'DDMONYY hh24:mi') AS crDate, 
	to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate, a.ISS_RMK AS reqRem, a.TR_STATUS as trStatus ,     
	b.DOC_LINE_NO AS docLineNo,	a.status as status , c.CODE_DESC AS agentIdName, c.CODE as agentName,
	a.EXTENDED_YN AS extendEirFlag    
	FROM ULD_ISS_HD a LEFT JOIN CUST_COMPANY c ON a.AGENT_CUST_NO = c.CODE  , ULD_ISS_DTL b     
	where a.TR_NO = b.TR_NO AND a.ISS_NO = b.ISS_NO AND a.EIR_NO = b.EIR_NO 
	<isNotEmpty property="issNo"> AND a.ISS_NO = #issNo# </isNotEmpty>	
	<isNotEmpty property="eirNo"> AND a.EIR_NO = #eirNo# </isNotEmpty>		
	<isNotEmpty property="carrCode"> AND a.CARR_CODE = Upper(#carrCode#) </isNotEmpty>		 
	<isNotEmpty property="agentName"> AND c.CODE = #agentName#</isNotEmpty>
	<isNotEmpty property="coIataCode"> AND c.CO_IATA_CODE = #coIataCode#</isNotEmpty>
	<isNotEmpty property="agentIdName"> AND UPPER(c.CODE_DESC) = UPPER(#agentIdName#)</isNotEmpty>	 
	<isNotEmpty property="crDateFrom">
		<isNotEmpty property="crDateTo"> 
			AND TO_CHAR(a.CR_DATE,'DDMONYY') &gt;= TO_DATE(#crDateFrom#, 'DDMONYY') 
			AND TO_CHAR(a.CR_DATE,'DDMONYY') &lt; TO_DATE(#crDateTo#, 'DDMONYY') + 1  
		</isNotEmpty>
	</isNotEmpty>
	<isNotEqual property="status" compareValue="ALL"> AND a.STATUS LIKE #status# </isNotEqual>	
	<isNotEmpty property="loginCarrier"> AND a.CARR_CODE = #loginCarrier# </isNotEmpty>
	<isNotEmpty property="loginAgentCode"> AND c.CODE = #loginAgentCode#</isNotEmpty>
</select>	
		
<select id="sqlmuldlisttotal" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">	 	
	SELECT b.ULD_GROUP||b.ULD_TYPE AS uldGroup , sum(b.ULD_REQ_QTY) AS iuldQty ,
	b.EQUIP_TYPE as accessoryType , sum(b.EQUIP_REQ_QTY) AS iaccQty
	FROM ULD_ISS_HD a LEFT JOIN CUST_COMPANY c ON a.AGENT_CUST_NO = c.CODE  , ULD_ISS_DTL b     
	where a.TR_NO = b.TR_NO AND a.ISS_NO = b.ISS_NO 
	<isNotEmpty property="issNo"> AND a.ISS_NO = #issNo# </isNotEmpty>	
	<isNotEmpty property="eirNo"> AND a.EIR_NO = #eirNo# </isNotEmpty>			
	<isNotEmpty property="carrCode"> AND a.CARR_CODE = Upper(#carrCode#) </isNotEmpty>		 
	<isNotEmpty property="agentName"> AND c.CODE = #agentName#</isNotEmpty>
	<isNotEmpty property="coIataCode"> AND c.CO_IATA_CODE = #coIataCode#</isNotEmpty>
	<isNotEmpty property="agentIdName"> AND UPPER(c.CODE_DESC) = UPPER(#agentIdName#)</isNotEmpty>	 
	<isNotEmpty property="loginCarrier"> AND a.CARR_CODE = #loginCarrier# </isNotEmpty>
	<isNotEmpty property="loginAgentCode"> AND c.CODE = #loginAgentCode#</isNotEmpty>
	<isNotEmpty property="crDateFrom">
	<isNotEmpty property="crDateTo"> 
		AND a.CR_DATE &gt;= TO_DATE(#crDateFrom#, 'DDMONYY') AND 
		a.CR_DATE &lt; TO_DATE(#crDateTo#, 'DDMONYY') + 1  
	</isNotEmpty>
	</isNotEmpty>
	<isNotEqual property="status" compareValue="ALL"> AND a.STATUS LIKE #status# </isNotEqual>	
	AND	(b.ULD_REQ_QTY is not null  OR b.EQUIP_REQ_QTY is not null) group by b.ULD_GROUP , b.ULD_TYPE , b.EQUIP_TYPE 
</select>
	
<select id="sqlmulddata" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">
	SELECT a.TR_NO AS trNo, a.ISS_NO AS issNo, a.EIR_NO AS eirNo,a.CARR_CODE AS carrCode , b.ULD_GROUP AS uldGroup ,
	b.ULD_TYPE AS uldType ,
	b.ULD_REQ_QTY AS iuldQty ,  b.EQUIP_TYPE as accessoryType, b.EQUIP_REQ_QTY AS iaccQty ,a.AGENT_CUST_NO AS agentName, c.CODE_DESC AS agentIdname , a.EIR_NO AS eirNo, a.CR_USER_ID AS crUserId , to_char(a.CR_DATE, 'DDMONYY hh24:mi') AS crDate, a.LM_USER_ID AS lmUserId , to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate, a.ISS_RMK AS reqRem, a.STATUS as trStatus , b.DOC_LINE_NO AS docLineNo,  a.STATUS AS status ,b.DOC_LINE_NO AS docLineNo
	FROM ULD_ISS_HD a LEFT JOIN CUST_COMPANY c ON a.AGENT_CUST_NO = c.CODE , ULD_ISS_DTL b 
	where a.TR_NO = b.TR_NO AND a.ISS_NO = b.ISS_NO 
	<isNotEmpty property="agentName"> AND c.CODE = #agentName#</isNotEmpty>
	<isNotEmpty property="coIataCode"> AND c.CO_IATA_CODE = #coIataCode#</isNotEmpty>
	<isNotEmpty property="agentIdName"> AND UPPER(c.CODE_DESC) = UPPER(#agentIdName#)</isNotEmpty>
	<isNotEmpty property="loginCarrier"> AND a.CARR_CODE = #loginCarrier# </isNotEmpty>
	<isNotEmpty property="loginAgentCode"> AND c.CODE = #loginAgentCode#</isNotEmpty>
	AND a.TR_NO = #trNo# 
</select>

<update id="sqlupdateuldrequest" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	UPDATE ULD_ISS_HD SET CARR_CODE = #carrCode# , REQ_BY_CARR = #requestByFlag#, FLT_NO = #fltNo# , FLT_DATE = #fltDate# ,   EIR_NO = #eirNo# , AGENT_CUST_NO = #agentName# ,STP_EFAX = #emailFaxStop# , LM_DATE = SYSDATE , LM_USER_ID = #lmUserId#,
	STATUS = UPPER(#status#), TR_STATUS = #trStatus# , ISS_RMK = #reqRem#	
	WHERE TR_NO = #trNo# AND ISS_NO = #issNo# AND to_char(LM_DATE, 'ddMMYY hh24:mi') = #lmDate# 
</update>

<update id="sqlupdateuldgroup" parameterClass="cargo.cms.uld.bo.ULDTypeBO">
	UPDATE ULD_ISS_DTL SET ULD_EQUIP = #recType# , ULD_GROUP = #uldGroup#, ULD_TYPE = #uldType#, ULD_REQ_QTY = #iqty# , TR_TYPE = #trType# ,TR_STATUS = #trStatus#,  EIR_NO = #eirNo# ,
	LM_DATE = SYSDATE , LM_USER_ID = #lmUserId#  
	WHERE TR_NO = #trNo# AND ISS_NO = #issNo# AND DOC_LINE_NO = #docLineNo#
</update>


<update id="sqlupdateaccgroup" parameterClass="cargo.cms.uld.bo.AccessoryBO" >
	UPDATE ULD_ISS_DTL SET ULD_EQUIP = #recType# , EQUIP_TYPE = #accessoryType#, EQUIP_REQ_QTY = #iqty# , TR_TYPE = #trType# ,TR_STATUS = #trStatus#,  EIR_NO = #eirNo# , 
	LM_DATE = SYSDATE, LM_USER_ID = #lmUserId#  
	WHERE TR_NO = #trNo# AND ISS_NO = #issNo# AND DOC_LINE_NO = #docLineNo#
</update>

<delete id="sqlulddelete" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	DELETE ULD_ISS_HD WHERE TR_NO = #trNo# AND ISS_NO = #issNo#
</delete>

<delete id="sqldeleteuldacc" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	DELETE ULD_ISS_DTL WHERE TR_NO = #trNo# AND ISS_NO = #issNo# 
</delete>
<!-- ======================	Maintain mULD ENDS HERE BY MAYANK  ==================================== -->
<!-- ======================	 Processed mULD Starts Here Mayank			==================================== -->	
<update id="sqluldupdate" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	UPDATE ULD_ISS_HD SET TR_STATUS = 'E',  STATUS = 'PROCESSED' ,ISS_RMK = #reqRem# , LM_DATE = SYSDATE ,
	LM_USER_ID = #lmUserId# , EIR_NO = #eirNo# , EIR_EXPIRY_DATE = SYSDATE + #extendEirHrs#/24 , 	EIR_DATE = SYSDATE , EIR_TIME = TO_CHAR(SYSDATE,'HH24MISS') 
	WHERE TR_NO = #trNo# AND ISS_NO = #issNo# 
</update>
<!-- Changed on 24 FEB 2007 by mayank for add parameter process muld -->
<update id="sqlupdateuldacc" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	UPDATE ULD_ISS_DTL SET TR_STATUS = 'E', EIR_NO = #eirNo# , LM_DATE = SYSDATE , LM_USER_ID = #lmUserId# WHERE TR_NO = #trNo# AND ISS_NO = #issNo#
</update>
<!-- ======================					Processed mULD Ends Here Mayank			==================================== -->

<!-- ======================					Cancel mULD Starts Here Mayank			==================================== -->
<update id="sqlcanceleir" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	UPDATE ULD_ISS_HD SET TR_STATUS = 'E',STATUS = 'CANCELLED', LM_DATE = SYSDATE , LM_USER_ID = #lmUserId# WHERE TR_NO = #trNo# AND ISS_NO = #issNo# AND EIR_NO = #eirNo# 
</update>

<update id="sqlcanceleiruldacc" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	UPDATE ULD_ISS_DTL SET TR_STATUS = 'E', LM_DATE = SYSDATE , LM_USER_ID = #lmUserId# WHERE TR_NO = #trNo# AND ISS_NO = #issNo# AND EIR_NO = #eirNo# 
</update>
<!-- Onsite Changed on 20 May 2006 by mayank Starts here -->
<select id="sqlselectcanceleir" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">
	SELECT a.TR_NO AS trNo , b.TR_NO AS trNo1, a.ISS_NO AS issNo, b.ISS_NO AS issNo1 , a.EIR_NO AS eirNo,
	a.CARR_CODE AS carrCode ,b.ULD_EQUIP AS uldEquip ,	b.ULD_GROUP AS uldGroup , b.ULD_TYPE AS uldType , 
	TO_CHAR(a.EIR_DATE,'DDMONYY HH24:MI') as eirDate ,
	TO_CHAR(c.REL_DATE,'DDMONYY HH24:MI') as relDate , 
	b.ULD_REQ_QTY AS iuldQty ,  b.EQUIP_TYPE as accessoryType, b.EQUIP_REQ_QTY AS iaccQty ,
	d.CODE_DESC AS agentIdName, d.CODE AS agentName, a.EIR_NO AS eirNo, a.CR_USER_ID AS crUserId ,
	a.LM_USER_ID AS lmUserId , to_char(a.CR_DATE, 'DDMONYY hh24:mi') AS crDate, 
	to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate,	a.ISS_RMK AS reqRem, a.TR_STATUS as trStatus ,
	b.DOC_LINE_NO AS docLineNo , a.STATUS AS status , a.EXTENDED_YN AS extendEirFlag
	FROM ULD_ISS_HD a 
	LEFT JOIN  ULD_REL_HD c ON a.EIR_NO = c.EIR_NO  
	LEFT JOIN  CUST_COMPANY d  ON d.CODE = a.AGENT_CUST_NO , ULD_ISS_DTL b    
	where a.TR_NO = b.TR_NO AND a.ISS_NO = b.ISS_NO   AND  a.EIR_NO =  #eirNo#
</select>
<!-- Onsite Changed on 20 May 2006 by mayank Ends here -->
<!-- ======================					Cancel mULD Ends Here Mayank			==================================== -->
<!-- Onsite Changed on 20 May 2006 by mayank Starts here -->
<!-- ======================					Release mULD Starts Here Mayank			==================================== -->
<select id="printreleaseeir" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">
	SELECT a.TR_NO AS trNo , a.ISS_NO AS issNo, a.EIR_NO AS eirNo,a.CARR_CODE AS carrCode ,
	b.ULD_EQUIP AS recType , b.ULD_GROUP AS uldGroup ,b.ULD_TYPE AS uldType , 
	TO_CHAR(a.EIR_DATE,'DDMONYY HH24:MI') as eirDate ,  a.REPT_VER AS printVer,
	b.DOC_LINE_NO as docLineNo ,b.ULD_REQ_QTY AS iuldQty ,  b.EQUIP_TYPE as accessoryType, 
	b.EQUIP_REQ_QTY AS iaccQty ,d.CODE_DESC AS agentIdName, d.CODE AS agentName, a.EIR_NO AS eirNo, 
	a.CR_USER_ID AS crUserId ,a.LM_USER_ID AS lmUserId , to_char(a.LM_DATE, 'DDMONYY hh24:mi') AS cancelDate,
	to_char(a.CR_DATE, 'DDMONYY hh24:mi') AS crDate, to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate,
	a.ISS_RMK AS reqRem, a.TR_STATUS as trStatus , b.DOC_LINE_NO AS docLineNo , a.STATUS AS status , 
	a.EXTENDED_YN AS extendEirFlag ,  to_char(c.REL_DATE, 'DDMONYY') AS relDate, 	c.REL_TIME AS relTime
	FROM ULD_ISS_HD a 
	LEFT JOIN  ULD_REL_HD c ON a.EIR_NO = c.EIR_NO  
	LEFT JOIN  CUST_COMPANY d ON d.CODE = a.AGENT_CUST_NO	, ULD_ISS_DTL b 
	where a.TR_NO = b.TR_NO AND a.ISS_NO = b.ISS_NO	AND	a.EIR_NO =   #eirNo#
</select>	
<select id="printeir" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">
	SELECT a.TR_NO AS trNo  , a.EIR_NO AS eirNo , to_char(a.REL_DATE, 'DDMONYY HH24:MI') AS relDate , 
	a.TRUCK_NO AS truckNo , a.AGENT_CUST_NO as agentName, a.CR_USER_ID AS crUserId , 
	to_char(a.CR_DATE, 'ddMMYY hh24:mi') AS crDate , c.REPT_VER AS printVer, a.PRT_CODE AS boPrinter , 
	a.CORR_REL_FLG , a.LM_USER_ID AS lmUserId , to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate , a.RMK AS reqRem , 
	a.TR_STATUS AS trStatus , a.TR_TYPE as trType, b.DOC_LINE_NO AS relDocLineNo , b.IDOC_LINE_NO as docLineNo , 
	b.EQUIP_TYPE AS accessoryType , b.EQUIP_QTY iaccQty , b.ULD_NO AS uldNo , b.ULD_CARR AS uldCarr , 
	b.ULD_EQUIP AS recType , b.ULD_KEY AS uldKey , b.ULD_NO AS uldNo, b.ULD_TYPE  AS uldType ,
	TO_CHAR(b.RET_DATE, 'DDMONYY') AS returnDate , b.RET_USER AS returnUserId
	FROM ULD_REL_HD a 
	LEFT JOIN ULD_ISS_HD c ON a.EIR_NO = c.EIR_NO , 
	ULD_REL_DTL b 
	WHERE a.TR_NO = b.TR_NO AND a.EIR_NO = b.EIR_NO AND 
	a.EIR_NO = #eirNo# 
</select>
<!-- ======================					Print mULD Starts Here Mayank			==================================== -->
<!-- ======================					Release mULD Starts Here Mayank			==================================== -->
<select id="sqlselectforenquireeir" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">
	SELECT a.TR_NO AS trNo , a.ISS_NO AS issNo, a.EIR_NO AS eirNo,a.CARR_CODE AS carrCode ,
	b.ULD_EQUIP AS recType , b.ULD_GROUP AS uldGroup ,b.ULD_TYPE AS uldType , 
	TO_CHAR(a.EIR_DATE,'DDMONYY HH24:MI') as eirDate , a.REPT_VER AS printVer,
	b.DOC_LINE_NO as docLineNo ,b.ULD_REQ_QTY AS iuldQty ,  b.EQUIP_TYPE as accessoryType, 
	b.EQUIP_REQ_QTY AS iaccQty ,d.CODE_DESC AS agentIdName, d.CODE AS agentName, a.EIR_NO AS eirNo, 
	a.CR_USER_ID AS crUserId ,a.LM_USER_ID AS lmUserId , to_char(a.LM_DATE, 'DDMONYY hh24:mi') AS cancelDate,
	to_char(a.CR_DATE, 'DDMONYY hh24:mi') AS crDate, to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate,
	a.ISS_RMK AS reqRem, a.TR_STATUS as trStatus , b.DOC_LINE_NO AS docLineNo , a.STATUS AS status , 
	a.EXTENDED_YN AS extendEirFlag ,  to_char(c.REL_DATE, 'DDMONYY HH24:MI') AS relDate
	FROM ULD_ISS_HD a 
	LEFT JOIN  ULD_REL_HD c ON a.EIR_NO = c.EIR_NO  
	LEFT JOIN  CUST_COMPANY d ON d.CODE = a.AGENT_CUST_NO	, ULD_ISS_DTL b 
	where a.TR_NO = b.TR_NO AND a.ISS_NO = b.ISS_NO	AND	a.EIR_NO =   #eirNo#
</select>	
<select id="sqlselectforreleaseeir" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">
	SELECT a.TR_NO AS trNo , a.ISS_NO AS issNo, a.EIR_NO AS eirNo,a.CARR_CODE AS carrCode ,
	b.ULD_EQUIP AS recType , b.ULD_GROUP AS uldGroup ,b.ULD_TYPE AS uldType , 
	TO_CHAR(a.EIR_DATE,'DDMONYY HH24:MI') as eirDate , c.PRT_VER AS printVer,
	b.DOC_LINE_NO as docLineNo ,b.ULD_REQ_QTY AS iuldQty ,  b.EQUIP_TYPE as accessoryType, 
	b.EQUIP_REQ_QTY AS iaccQty ,d.CODE_DESC AS agentIdName, d.CODE AS agentName, a.EIR_NO AS eirNo, 
	a.CR_USER_ID AS crUserId ,a.LM_USER_ID AS lmUserId , to_char(a.LM_DATE, 'DDMONYY hh24:mi') AS cancelDate,
	to_char(a.CR_DATE, 'DDMONYY hh24:mi') AS crDate, to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate,
	a.ISS_RMK AS reqRem, a.TR_STATUS as trStatus , b.DOC_LINE_NO AS docLineNo , a.STATUS AS status , 
	a.EXTENDED_YN AS extendEirFlag ,  to_char(c.REL_DATE, 'DDMONYY HH24:MI') AS relDate
	FROM ULD_ISS_HD a 
	LEFT JOIN  ULD_REL_HD c ON a.EIR_NO = c.EIR_NO  
	LEFT JOIN  CUST_COMPANY d ON d.CODE = a.AGENT_CUST_NO	, ULD_ISS_DTL b 
	where a.TR_NO = b.TR_NO AND a.ISS_NO = b.ISS_NO	AND	a.EIR_NO =   #eirNo#
</select>
<!-- Onsite Changed on 20 May 2006 by mayank Ends here -->
<!-- Onsite Changed on 20 May 2006 by mayank Starts here -->	
<select id="sqlreleasedata" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">
	SELECT a.TR_NO AS trNo  , a.EIR_NO AS eirNo , to_char(a.REL_DATE, 'DDMONYY HH24:MI') AS relDate , 
	a.TRUCK_NO AS truckNo , a.AGENT_CUST_NO as agentName, a.CR_USER_ID AS crUserId , 
	to_char(a.CR_DATE, 'ddMMYY hh24:mi') AS crDate , c.REPT_VER AS printVer, a.PRT_CODE AS boPrinter , 
	a.CORR_REL_FLG , a.LM_USER_ID AS lmUserId , to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate , a.RMK AS reqRem , 
	a.TR_STATUS AS trStatus , a.TR_TYPE as trType, b.DOC_LINE_NO AS relDocLineNo , b.IDOC_LINE_NO as docLineNo , 
	b.EQUIP_TYPE AS accessoryType , b.EQUIP_QTY iaccQty , b.ULD_NO AS uldNo , b.ULD_CARR AS uldCarr , 
	b.ULD_EQUIP AS recType , b.ULD_KEY AS uldKey , b.ULD_NO AS uldNo, b.ULD_TYPE  AS uldType ,
	TO_CHAR(b.RET_DATE, 'DDMONYY HH24:MI') AS returnDate , b.RET_USER AS returnUserId
	FROM ULD_REL_HD a 
	LEFT JOIN ULD_ISS_HD c ON a.EIR_NO = c.EIR_NO , 
	ULD_REL_DTL b 
	WHERE a.TR_NO = b.TR_NO AND a.EIR_NO = b.EIR_NO AND 
	a.EIR_NO = #eirNo# 
	<!-- Onsite Changed on 23 May 2006 by mayank Starts here -->
	<!-- <isNotEmpty property="truckNo"> AND a.TRUCK_NO = #truckNo#</isNotEmpty> -->	
	<!-- Onsite Changed on 23 May 2006 by mayank Starts here -->
</select>

<select id="enquireeirdata" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">
	SELECT a.TR_NO AS trNo  , a.EIR_NO AS eirNo , to_char(b.CR_DATE, 'DDMONYY HH24:MI') AS relDate , 
	a.TRUCK_NO AS truckNo , a.AGENT_CUST_NO as agentName, a.CR_USER_ID AS crUserId , 
	to_char(a.CR_DATE, 'ddMMYY hh24:mi') AS crDate , c.REPT_VER AS printVer, a.PRT_CODE AS boPrinter , 
	a.CORR_REL_FLG , a.LM_USER_ID AS lmUserId , to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate , a.RMK AS reqRem , 
	a.TR_STATUS AS trStatus , a.TR_TYPE as trType, b.DOC_LINE_NO AS relDocLineNo , b.IDOC_LINE_NO as docLineNo , 
	b.EQUIP_TYPE AS accessoryType , b.EQUIP_QTY iaccQty , b.ULD_NO AS uldNo , b.ULD_CARR AS uldCarr , 
	b.ULD_EQUIP AS recType , b.ULD_KEY AS uldKey , b.ULD_NO AS uldNo, b.ULD_TYPE  AS uldType ,
	TO_CHAR(b.RET_DATE, 'DDMONYY HH24:MI') AS returnDate , b.RET_USER AS returnUserId
	FROM ULD_REL_HD a 
	LEFT JOIN ULD_ISS_HD c ON a.EIR_NO = c.EIR_NO , 
	ULD_REL_DTL b 
	WHERE a.TR_NO = b.TR_NO AND a.EIR_NO = b.EIR_NO AND 
	a.EIR_NO = #eirNo# 	
</select>

<!-- Onsite Changed on 20 May 2006 by mayank Ends here -->

<select id="eirtotalQty" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT  NVL(SUM(ULD_REQ_QTY),0) FROM ULD_ISS_DTL WHERE EIR_NO = #eirNo# 
</select>

<select id="eirRelRmk" parameterClass="java.lang.String" resultClass="java.lang.String">
		SELECT  RMK issueRmk  FROM ULD_REL_HD WHERE EIR_NO = #eirNo#
</select>

<select id="eirIssueQty" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT  count(1)  FROM ULD_REL_DTL WHERE EIR_NO = #eir_no# and ULD_KEY is not null
</select>	
	
<update id="sqlupdatereleaseheaderdata" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	UPDATE ULD_REL_HD SET 
	REL_DATE = SYSDATE, REL_TIME =TO_CHAR(SYSDATE,'HH24MI') , 
	TR_TYPE = 'RU' , TR_STATUS = 'E' ,LM_USER_ID = #lmUserId# , LM_DATE = SYSDATE , 
	RMK = #processRem# 
	where TR_NO = #trNo# AND EIR_NO = #eirNo#
</update>

<insert id="sqlinsertreleaseheaderdata" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	INSERT INTO ULD_REL_HD 
	(TR_NO, EIR_NO, REL_DATE, REL_TIME, TRUCK_NO, CORR_REL_FLG, PRT_VER, PRT_CODE, RMK, TR_TYPE, TR_STATUS, CR_USER_ID, CR_DATE, LM_USER_ID, 
	LM_DATE, AGENT_CUST_NO,REF_ISS_NO,CARR_CODE )
	VALUES 	(#trNo#,#eirNo#,SYSDATE,TO_CHAR(SYSDATE,'HH24MI'),#truckNo#,#correctionRelease#,#printVer#,#boPrinter#,#processRem#,
	#trType#,#trStatus#,#crUserId#,SYSDATE,#lmUserId#,SYSDATE,#agentName#,#issNo#,#carrName#)
</insert>


<insert id="sqlinsertreleasedetailsdata" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	INSERT INTO ULD_REL_DTL 	(TR_NO,DOC_LINE_NO,IDOC_LINE_NO,EIR_NO,ULD_EQUIP,ULD_TYPE,ULD_NO,ULD_CARR,ULD_KEY,EQUIP_TYPE,EQUIP_QTY,TR_TYPE,TR_STATUS,CR_USER_ID,CR_DATE, 
	  LM_USER_ID,LM_DATE) 
	VALUES	(#trNo#,#relDocLineNo#,#docLineNo#,#eirNo#,#recType#,#uldType#,#uldNo#,#uldCarr#,#uldKey#,#accessoryType#,#iaccQty#,
	#trType#,#trStatus#,#crUserId#,SYSDATE,#lmUserId#,SYSDATE)
</insert>

<update id="sqlreleaseeir" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	UPDATE ULD_ISS_HD 
	SET TR_STATUS = 'E', STATUS = #status#, EIR_EXPIRY_DATE = decode(#status#, 'PARTRELEASED',EIR_DATE + #extendEirHrs#/24, EIR_EXPIRY_DATE),
		    LM_DATE = SYSDATE, LM_USER_ID = #lmUserId# 
	WHERE TR_NO = #trNo# AND ISS_NO = #issNo# AND EIR_NO = #eirNo# 
</update>


<!-- ====================================VALIDATION FOR RELEASE ULD START     ========================================-->
<select id="uldgrptyprelereqcheck" parameterClass="map" resultClass="java.lang.Integer">
	SELECT COUNT(1) FROM ULD_GROUP_TYPE WHERE ULD_GROUP = #ULDGROUP# AND ULD_TYPE =  #ULDTYPE#
</select>
<!-- 	***To check if ULD is in inventory and it can be released  -->	 
<select id="sqluldreleasewhdestcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT COUNT(1) FROM ULD_INVENTORY WHERE LOC_CODE IS NULL AND ULD_KEY = #PARAM# 
</select>
<!-- 	Error Msg: Cannot release ULD as ULD is not in inventory -->	 
	 
<!-- 	***To check if ULD is not assigned to flight and it can be released --> 
<select id="sqluldreleasefltcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT COUNT(1) FROM ULD_INVENTORY
	WHERE (FLT_KEY IS NULL OR FLT_TYPE = 'I') AND ULD_KEY = #PARAM#  
</select>
<!-- 	Error Msg: Cannot release ULD as ULD is assigned to flight -->	 
	 
<!-- ***To check if ULD is with agent and it can be released --> 
<select id="sqluldreleaseagentinvcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT COUNT(1) FROM ULD_INVENTORY
	WHERE NVL(AGENT_INV, 'N') = 'N' AND ULD_KEY = #PARAM#  
</select>
<!-- Error Msg: Cannot release ULD as ULD is in agent inv		-->
	 
<!-- 	***To check if ULD is empty and it can be released  -->
<select id="sqluldreleaseemptyflgcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT COUNT(1) 
	FROM (SELECT CASE WHEN A.CFM_STATUS LIKE 'RCL%' THEN 'N' 
	WHEN A.CFM_STATUS LIKE 'UNCONFIRMED%' THEN '' 
	ELSE A.EMPTY_FLG END EMPTY
	FROM ULD_INVENTORY A
	WHERE ULD_KEY = #PARAM#) a
	WHERE EMPTY = 'N' 
</select>
<!-- 	Error Msg: Cannot release ULD as ULD is not empty -->

<!-- 	 ***To check if ULD is reserved and it can be released  -->
<select id="sqluldreleaseresvflgcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT COUNT(1) FROM ULD_INVENTORY
	WHERE RESV_FLG = 'N' AND ULD_KEY = #PARAM#   
</select>
<!-- 	Error Msg: Cannot release ULD as ULD is reserved -->

<!-- 	***To check if ULD is damaged and it can be released  -->
<select id="sqluldreleasecondncodecheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT COUNT(1) FROM ULD_INVENTORY
	WHERE CONDN_CODE != 'DAM' AND ULD_KEY = #PARAM#   
</select>
<!-- 	Error Msg: Cannot release ULD as ULD is damaged -->

<!-- ***To check if ULD location is confirmed and it can be released -->
<select id="sqluldreleasecfmstatuswhdestcheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT COUNT(1) FROM ULD_INVENTORY
	WHERE	UPPER(CFM_STATUS) != 'UNCONFIRMED' AND LOC_CODE IS NOT NULL AND ULD_KEY = #PARAM#   
</select>
<!-- Error Msg: Cannot release ULD as ULD location is not Confirmed -->

<!-- ***To check if ULD location is confirmed and it can be released -->
<select id="sqluldkeycheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT COUNT(1) FROM ULD_INVENTORY
	WHERE	ULD_KEY = #PARAM#   
</select>
<!-- Error Msg: Cannot release ULD as ULD location is not Confirmed -->


<!-- =======================VALIDATION FOR RELEASE ULD END=================================-->
<!-- ======================	Release mULD Starts Mayank =================================== --> 
<!-- ======================	Enquir EIR Starts Mayank   =================================== --> 
<select id="sqleiroutstddata" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">
<![CDATA[
	SELECT a.tr_no AS trno, a.iss_no AS issno, a.eir_no AS eirno,
       a.carr_code AS carrcode, b.uld_equip AS rectype,
       b.uld_group AS uldgroup, b.uld_type AS uldtype,
       TO_CHAR (a.eir_date, 'DDMONYY HH24:MI') AS eirdate, 
       b.doc_line_no AS doclineno, b.uld_req_qty AS iuldqty,
       b.equip_type AS accessorytype, b.equip_req_qty AS iaccqty,
       d.code_desc AS agentidname, d.code AS agentname, a.eir_no AS eirno,
       a.cr_user_id AS cruserid, a.lm_user_id AS lmuserid,
       TO_CHAR (a.cr_date, 'ddMONYY hh24:mi') AS crdate,
       TO_CHAR (a.lm_date, 'ddMONYY hh24:mi') AS lmdate, a.iss_rmk AS reqrem,
       a.tr_status AS trstatus, b.doc_line_no AS doclineno,
       a.status AS status, a.extended_yn AS extendeirflag,
       TO_CHAR (c.rel_date, 'DDMONYY HH24:MI') AS reldate
  FROM uld_iss_hd a LEFT JOIN uld_rel_hd c ON a.tr_no = c.tr_no AND a.eir_no = c.eir_no,
       uld_iss_dtl b, cust_company d
 WHERE a.tr_no = b.tr_no
   AND d.code = a.agent_cust_no
   AND eir_expiry_date >= SYSDATE  AND (upper(a.status) = 'PROCESSED' or upper(a.status) = 'PARTRELEASED')
 	]]>
	<isNotEmpty property="carrCode" > AND a.CARR_CODE = #carrCode# </isNotEmpty>	
	<isNotEmpty property="agentName"> AND d.CODE = #agentName#</isNotEmpty>
	<isNotEmpty property="coIataCode"> AND d.CO_IATA_CODE = #coIataCode#</isNotEmpty>
	<isNotEmpty property="agentIdName"> AND UPPER(d.CODE_DESC) = UPPER(#agentIdName#)</isNotEmpty>
	<isNotEmpty property="loginCarrier"> AND a.CARR_CODE = #loginCarrier# </isNotEmpty>
	<isNotEmpty property="loginAgentCode"> AND d.code = #loginAgentCode# </isNotEmpty>
</select>

<select id="sqleiroutstduldcount" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT COUNT(1)
	FROM ULD_REL_HD a , ULD_REL_DTL b
	WHERE a.TR_NO = b.TR_NO AND a.EIR_NO = b.EIR_NO AND 
	(b.ULD_EQUIP = 'G' or b.ULD_EQUIP = 'T') AND a.EIR_NO = #PARAM#  
</select>
<select id="sqleiroutstdacccount" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT COUNT(1)
	FROM ULD_REL_HD a , ULD_REL_DTL b
	WHERE a.TR_NO = b.TR_NO AND a.EIR_NO = b.EIR_NO AND 
	b.ULD_EQUIP = 'E' AND a.EIR_NO = #PARAM#  
</select>

<select id="UldKeyCheck"  parameterClass="map"  resultClass="java.lang.String">
<![CDATA[
	SELECT FUN_VALIDATE_ULD(#FUNVALIDATEULD#,'U','Y') from DUAL
	]]>
</select>	
<select id="sqlCarrierCodesQuery"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.ULDCodeBO">
	SELECT CODE codeVal,CODE_DESC codeDesc from MAST_CARRIER where OWNED_CARR = 'Y' ORDER BY CODE
</select>
<!--	Onsite Changed on 24 May 2006 by mayank Starts here -->
<select id="sqlAgentHoldingsQuery"  parameterClass="cargo.cms.uld.bo.ULDRequestBO"  resultClass="cargo.cms.uld.bo.ULDRequestBO">
	
	SELECT u.ULD_CARR carrCode, sub.EIR_NO eirNo,
		ROUND((SYSDATE-sub.REL_DATE),0) elapsedDays, u.ULD_KEY uldKey, e.CODE_DESC agentName, e.CODE  agentIdName, 	
		TO_CHAR(sub.EIR_DATE, 'DDMONYY HH24:MI') eirDate 
	FROM CUST_COMPANY e, ULD_INVENTORY u
	LEFT JOIN (SELECT rd.*, i.CARR_CODE, i.EIR_NO, i.EIR_DATE, i.EIR_TIME, r.REL_DATE ,i.AGENT_CUST_NO 
		 	  	FROM (SELECT MAX(to_number(Tr_No)) Tr_No, ULD_KEY, ULD_TYPE  FROM ULD_REL_DTL a 	
			  		 GROUP BY ULD_KEY, ULD_TYPE) rd , 	
				ULD_REL_HD r, ULD_ISS_HD i	
				WHERE rd.TR_NO = r.TR_NO AND r.EIR_NO = i.EIR_NO
			   ) sub	
			on u.ULD_KEY = sub.ULD_KEY, 
	ULD_GROUP_TYPE g	
	WHERE u.Agent_Inv = 'Y'	
	AND e.CODE = u.AGENT_ID	
	AND u.ULD_TYPE = g.ULD_TYPE	
	<isNotEmpty property="loginCarrier">
			and u.OWNER_ID = #loginCarrier#
	</isNotEmpty>
	<isNotEmpty property="loginAgentCode"> 
		AND e.CODE = #loginAgentCode#
	</isNotEmpty>
	<isNotEmpty property="uldType">
			and g.ULD_TYPE = #uldType#
	</isNotEmpty>
	<isNotEmpty property="uldGroup">
			and g.ULD_GROUP = #uldGroup#
	</isNotEmpty>
	<isNotEmpty property="carrCode">
		and u.OWNER_ID = #carrCode#
	</isNotEmpty>
	<isNotEmpty property="agentIdName">
		and e.CODE = #agentName#
	</isNotEmpty>
	order by '1' 
	<isNotEmpty property="sortOption1">
		,$sortOption1$  
	</isNotEmpty>
	<isNotEmpty property="sortOption2">
		,$sortOption2$ 
	</isNotEmpty>
	<isNotEmpty property="sortOption3">
		,$sortOption3$ 
	</isNotEmpty>
	,u.ULD_KEY 
</select>

<!--	Onsite Changed on 24 May 2006 by mayank Ends here -->
<!-- ======================					Enquir EIR  Starts Mayank			 ==================================== --> 
<!-- ======================	Split EIR  Starts Mayank ==================================== --> 

<update id="sqlspliteirupdhd" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	UPDATE ULD_ISS_HD SET STATUS = 'SPLIT EIR' , TR_STATUS = 'E', EIR_NO = #eirNo#, LM_DATE = SYSDATE , LM_USER_ID = #lmUserId# WHERE TR_NO = #trNo# AND  to_char(LM_DATE, 'ddMMYY hh24:mi')=#lmDate#
</update>

<insert id="sqlinsertissuedetail" parameterClass="cargo.cms.uld.bo.ULDRequestBO">
	INSERT INTO ULD_ISS_DTL (TR_NO,ISS_NO,EIR_NO,DOC_LINE_NO,ULD_EQUIP,ULD_GROUP,ULD_TYPE,ULD_REQ_QTY,EQUIP_TYPE,EQUIP_REQ_QTY,TR_TYPE,TR_STATUS, CR_USER_ID,CR_DATE, LM_USER_ID,LM_DATE) VALUES (#trNo#,#issNo#,#eirNo#,#docLineNo#,#recType#,#uldGroup#,#uldType#,#iuldQty#,#accessoryType#,#iaccQty#,#trType#,#trStatus#,#crUserId#,TO_DATE(SYSDATE,'DD/MM/YYYY HH24MISS'),#lmUserId#,TO_DATE(SYSDATE,'DD/MM/YYYY HH24MISS'))
</insert>

<update id="sqlspliteirupddtl" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	UPDATE ULD_ISS_DTL SET TR_STATUS = 'E', EIR_NO = #eirNo#, LM_DATE = SYSDATE , LM_USER_ID = #lmUserId# WHERE TR_NO = #trNo# AND  to_char(LM_DATE, 'ddMMYY hh24:mi')=#lmDate#
</update>

<update id="sqlupdatesplitheaderdata" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	UPDATE ULD_REL_HD SET TR_STATUS = 'E', EIR_NO = #eirNo#, LM_DATE = SYSDATE , LM_USER_ID = #lmUserId# WHERE TR_NO = #trNo# AND  to_char(LM_DATE, 'ddMMYY hh24:mi')=#lmDate#
</update>


<select id="sqlreleaseheadertrno" parameterClass="java.lang.String" resultClass="java.lang.String">
	SELECT TR_NO FROM ULD_REL_HD WHERE EIR_NO = #PARAM#
</select>

<select id="sqlreleasedoclineno" parameterClass="java.lang.Long" resultClass="java.lang.String">
	SELECT MAX(DOC_LINE_NO) FROM ULD_REL_DTL WHERE TR_NO = #PARAM#
</select>

<select id="sqlsplitdatalist" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">
	SELECT a.TR_NO AS trNo, a.ISS_NO AS issNo, a.EIR_NO AS eirNo,a.CARR_CODE AS carrCode , b.ULD_GROUP AS uldGroup ,
	b.ULD_TYPE AS uldType ,
	b.ULD_REQ_QTY AS iuldQty ,  b.EQUIP_TYPE as accessoryType, b.EQUIP_REQ_QTY AS iaccQty ,a.AGENT_CUST_NO AS agentName, 
	c.CODE_DESC AS agentIdname , 
	a.EIR_NO AS eirNo, a.CR_USER_ID AS crUserId , to_char(a.CR_DATE, 'DDMONYY hh24:mi') AS crDate, a.LM_USER_ID AS lmUserId ,
	 to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate, a.ISS_RMK AS reqRem, a.STATUS as trStatus , b.DOC_LINE_NO AS docLineNo,  a.STATUS AS status ,b.DOC_LINE_NO AS docLineNo
	FROM ULD_ISS_HD a LEFT JOIN CUST_COMPANY c ON a.AGENT_CUST_NO = c.CODE , ULD_ISS_DTL b 
	where a.TR_NO = b.TR_NO AND a.AGENT_CUST_NO = #agentName#
	AND a.TR_NO = #trNo# AND a.CARR_CODE = #carrCode# 
</select>

<select id="sqlspilteirdata" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">
	SELECT a.TR_NO AS trNo, a.ISS_NO AS issNo, a.EIR_NO AS eirNo,a.CARR_CODE AS carrCode , b.ULD_GROUP AS uldGroup ,
	b.ULD_TYPE AS uldType ,
	b.ULD_REQ_QTY AS iuldQty ,  b.EQUIP_TYPE as accessoryType, b.EQUIP_REQ_QTY AS iaccQty ,a.AGENT_CUST_NO AS agentName, 
	c.CODE_DESC AS agentIdname , 
	a.EIR_NO AS eirNo, a.CR_USER_ID AS crUserId , to_char(a.CR_DATE, 'DDMONYY hh24:mi') AS crDate, a.LM_USER_ID AS lmUserId ,
	to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate, a.ISS_RMK AS reqRem, a.STATUS as trStatus , 
	b.DOC_LINE_NO AS docLineNo,  a.STATUS AS status ,b.DOC_LINE_NO AS docLineNo
	FROM ULD_ISS_HD a LEFT JOIN CUST_COMPANY c ON a.AGENT_CUST_NO = c.CODE , ULD_ISS_DTL b 
	where a.TR_NO = b.TR_NO AND a.ISS_NO = b.ISS_NO AND a.AGENT_CUST_NO = #agentName#
	AND a.TR_NO = #trNo# AND a.CARR_CODE = #carrCode# AND a.EIR_NO = #eirNo#
	
</select>

<select id="sqlspilteirtrno" parameterClass="java.lang.String" resultClass="java.lang.String">
	SELECT TR_NO FROM ULD_REL_HD WHERE EIR_NO = #PARAM#
</select>

<select id="sqlspiltagentname" parameterClass="java.lang.String" resultClass="java.lang.String">
SELECT CODE_DESC FROM CUST_COMPANY WHERE CODE = #PARAM#
</select>


<select id="sqlspilteircustno" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.ULDRequestBO">
SELECT DISTINCT  AGENT_CUST_NO AS agentName 
FROM ULD_REL_HD A , ULD_REL_DTL  B 
WHERE A.TR_NO = #trNo# AND A.TR_NO=B.TR_NO
</select>

<select id="sqlspilteiruldkeydata" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">
SELECT ULD_KEY AS uldKey, COUNT(ULD_KEY) AS iuldQty
FROM ULD_REL_HD A , ULD_REL_DTL  B 
WHERE A.TR_NO=B.TR_NO AND ULD_KEY IS NOT NULL AND A.TR_NO = #trNo# 
AND AGENT_CUST_NO = #agentName# GROUP BY ULD_KEY 
</select>

<select id="sqlspilteirulddata" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">
SELECT B.EIR_NO AS uldEirNo , IDOC_LINE_NO AS uldDocLineNo , 
to_char(B.LM_DATE, 'ddMMYY hh24:mi') AS uldLmDate
FROM ULD_REL_HD A , ULD_REL_DTL  B 
WHERE A.TR_NO=B.TR_NO AND ULD_KEY IS NOT NULL AND A.TR_NO = #trNo#  
AND AGENT_CUST_NO = #agentName# AND ULD_KEY = #uldKey# GROUP BY B.EIR_NO ,IDOC_LINE_NO , B.LM_DATE
</select>

<select id="sqlspilteiraccdata" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">
SELECT B.EIR_NO AS accEirNo, EQUIP_TYPE AS accessoryType, EQUIP_QTY AS iaccQty, DOC_LINE_NO AS accDocLineNo , IDOC_LINE_NO , to_char(B.LM_DATE, 'ddMMYY hh24:mi') AS accLmDate
FROM ULD_REL_HD A , ULD_REL_DTL  B 
WHERE A.TR_NO=B.TR_NO  AND EQUIP_TYPE IS NOT NULL AND A.TR_NO = #trNo#  
AND AGENT_CUST_NO = #agentName#
</select>

<!-- ======================	Split EIR  Ends Mayank ==================================== --> 

<!-- EIC murugan -->
	<select id="sqlgetuldinventorygetbasepaletteexport"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.uld.bo.ULDEICBO">
   SELECT 
    UI.ULD_KEY as uldKey, UI.ULD_TYPE as uldType, UI.ULD_NO as uldNo, UI.ULD_CARR as uldCarr, UI.FLT_NO as fltNo, 
    UI.FLT_TYPE as fltType, TO_CHAR(UI.FLT_DATE,'DDMONYY') as fltDate, 
    UI.FLT_KEY as fltKey, UI.TARE_WEIGHT as tareWeight, UI.GROSS_WEIGHT as grossWeight, 
    UI.GEN_RMK as genRem,
    UI.EIC_FLG as eicFLG,
    UI.BASE_PAL_FLG as basePalFLG,
    UI.CFM_STATUS as cfmStatus,
    UI.CARR_CODE as carrCode,
    UI.OWNER_ID as ownerId,
    UI.LOC_CODE as locCode,
    UI.FLT_DATE as fltDateOri,
    UI.AGENT_INV as agentInv,
    UI.CONTR_CODE as contrCode,
    UI.EIC_UNLDG_PT as eicUnloadingPt,
    UI.RESV_FLG as resvFLG,
    UI.BASE_PLT as basePlt,
    UI.EIC_TYPE as eicType,
    UI.EIC_TYPE as eicTypeOld,
    PKG_COMMON.GET_FLT_ATA(UI.FLT_KEY,UI.FLT_DATE,decode(UI.FLT_TYPE, 'I', 'A', 'E', 'D')) AS ata,
    PKG_COMMON.flt_ports(UI.FLT_KEY,UI.FLT_DATE,decode(UI.FLT_TYPE, 'I', 'A', 'E', 'D')) AS portOfCall,
    UI.EMPTY_FLG emptyYN ,
     (SELECT BLDUP_COMPLETE  from  EXP_PMANIFEST_ULD WHERE ULD_BT_NO = #uldKey#
    <isNotEmpty prepend="AND" property="fltKey">
    	flt_key = #fltKey#	and    flt_date = to_date(#fltDate#,'DDMONYY')
   	</isNotEmpty>
   	<isEmpty prepend="AND" property="fltKey">
    	flt_key = UI.FLT_KEY	and    flt_date = TO_CHAR(UI.FLT_DATE,'DDMONYY')
   	</isEmpty>
    ) buildUpCmplt,
    (SELECT VOL_IND  from  EXP_PMANIFEST_ULD WHERE ULD_BT_NO = #uldKey#
    <isNotEmpty prepend="AND" property="fltKey">
    flt_key = #fltKey#	and    flt_date = to_date(#fltDate#,'DDMONYY')
   </isNotEmpty>
   	<isEmpty prepend="AND" property="fltKey">
    	flt_key = UI.FLT_KEY	and    flt_date = TO_CHAR(UI.FLT_DATE,'DDMONYY')
   	</isEmpty>
    ) volInd
    FROM ULD_INVENTORY UI
   WHERE UI.ULD_KEY = #uldKey#
    </select>
	
	<!-- Offshore changed by Murugan on 15 May 06 starts - Defect no TC1505005-->
	<select id="sqlgetuldinventorygetbasepalette"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.uld.bo.ULDEICBO">
  SELECT 
    UI.ULD_KEY as uldKey, UI.ULD_TYPE as uldType, UI.ULD_NO as uldNo, UI.ULD_CARR as uldCarr, UI.FLT_NO as fltNo, UI.ULD_CARR as carrCode,
    UI.FLT_TYPE as fltType, TO_CHAR(UI.FLT_DATE,'DDMONYY') as fltDate, 
    UI.FLT_KEY as fltKey, UI.TARE_WEIGHT as tareWeight, UI.GROSS_WEIGHT as grossWeight, 
    UI.GEN_RMK as genRem,
    UI.EIC_FLG as eicFLG,
    UI.BASE_PAL_FLG as basePalFLG,
    UI.CFM_STATUS as cfmStatus,
    UI.CARR_CODE as carrCode,
    UI.OWNER_ID as ownerId,
    UI.LOC_CODE as locCode,
    UI.FLT_DATE as fltDateOri,
    UI.AGENT_INV as agentInv,
    UI.CONTR_CODE as contrCode,
    UI.EIC_UNLDG_PT as eicUnloadingPt,
    UI.RESV_FLG as resvFLG,
    UI.BASE_PLT as basePlt,
    UI.EIC_TYPE as eicType,
    UI.EIC_TYPE as eicTypeOld,
    UI.OWNED_INV as ownedInvFlg,
    PKG_COMMON.GET_FLT_ATA(UI.FLT_KEY,UI.FLT_DATE,decode(UI.FLT_TYPE, 'I', 'A', 'E', 'D')) AS ata,
    PKG_COMMON.flt_ports(UI.FLT_KEY,UI.FLT_DATE,decode(UI.FLT_TYPE, 'I', 'A', 'E', 'D')) AS portOfCall,
    (SELECT BLDUP_COMPLETE  from  EXP_PMANIFEST_ULD WHERE ULD_BT_NO = #uldKey#
    <isNotEmpty prepend="AND" property="fltKey">
    	flt_key = #fltKey#	and    flt_date = to_date(#fltDate#,'DDMONYY')
   	</isNotEmpty>
   	<isEmpty prepend="AND" property="fltKey">
    	flt_key = UI.FLT_KEY	and    flt_date = TO_CHAR(UI.FLT_DATE,'DDMONYY')
   	</isEmpty>
    ) buildUpCmplt,
    (SELECT VOL_IND  from  EXP_PMANIFEST_ULD WHERE ULD_BT_NO = #uldKey#
    <isNotEmpty prepend="AND" property="fltKey">
    flt_key = #fltKey#	and    flt_date = to_date(#fltDate#,'DDMONYY')
   </isNotEmpty>
   <isEmpty prepend="AND" property="fltKey">
    	flt_key = UI.FLT_KEY	and    flt_date = TO_CHAR(UI.FLT_DATE,'DDMONYY')
   	</isEmpty>
    ) volInd
    FROM ULD_INVENTORY UI 
   WHERE UI.ULD_KEY = #uldKey#
    </select>
	<!-- Offshore changed by Murugan on 15 May 06 ends -->
	
	
	<select id="sqlgettareweightforbasepalette"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.uld.bo.ULDEICBO">
		SELECT TARE_WEIGHT as tareWeight
			 FROM ULD_TYPE_CARR_TARE_WT
			  where UPPER(ULD_TYPE)=UPPER(#uldType#) and UPPER(ULD_CARR)=UPPER(#carrCode#) 
		 and UPPER(#uldNo#) between ULD_NO_FROM and ULD_NO_TO
   	</select>

	<select id="checkforunloadingpoint"  parameterClass="cargo.cms.uld.bo.ULDEICBO" 
			 resultClass="java.lang.String">
	 	SELECT OFF_POINT AS lblCodeDesc 
			FROM FLT_OPR_LEG WHERE UPPER(FLT_KEY) = UPPER(#fltKey#) 
			AND SCH_DATE = TO_DATE(#fltDate#,'DDMONYY') 
			AND OFF_POINT = #eicUnloadingPt#
	</select>


	<select id="sqlgetmaxweight"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.uld.bo.ULDEICBO">
		SELECT MAX_WEIGHT as maxWeight
			 FROM ULD_GROUP_CARR
			  WHERE CARR_CODE=#carrCode# AND ULD_TYPE=#uldType#
   	</select>
	
	<select id="sqlcheckuldtypedefinedinuldprofileforthecarrier"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="java.lang.String">
		SELECT NVL(count(1), 0) as count
			 FROM ULD_GROUP_CARR
			  WHERE CARR_CODE=#carrCode# AND ULD_TYPE=#uldType#
   	</select>

	<select id="sqlcheckforeicallowed"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.uld.bo.ULDEICBO">
		SELECT BASE_PAL_FLG as basePalFLG
			 FROM ULD_GROUP_CARR
			  WHERE CARR_CODE=#carrCode# AND ULD_TYPE=#uldType#
   	</select>
	
	<select id="sqlgettopalleteic"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.uld.bo.ULDEICBO">
		<![CDATA[
		SELECT 
				ULD_KEY as uldKey, ULD_TYPE as uldType, ULD_NO as uldNo, FLT_NO as fltNo, 
				FLT_TYPE as fltType, TO_CHAR(FLT_DATE,'DDMONYY') as fltDate, 
				FLT_KEY as fltKey, TARE_WEIGHT as tareWeight, GROSS_WEIGHT as grossWeight, 
				GEN_RMK as genRem,
				EIC_FLG as eicFLG,
				BASE_PAL_FLG as basePalFLG,
				CFM_STATUS as cfmStatus,
			    CARR_CODE as carrCode,
				OWNER_ID as ownerId,
				LOC_CODE as locCode,
				FLT_DATE as fltDateOri,
				AGENT_INV as agentInv,
				EMPTY_FLG as emptyFLG,
				RESV_FLG as resvFLG,
				ULD_KEY as selList,    
				LOC_CODE as locCodeOld,
				OWNED_INV as ownedInvFlg
			 FROM ULD_INVENTORY
			WHERE ULD_KEY = #uldKey# 	 
			]]>
   	</select>

	
	<!-- Offshore changes by Murugan on 18 May 06 Starts -->
	<select id="sqlgetacttime"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.uld.bo.ULDEICBO">
		SELECT  decode(ACT_TIME,null,'',((SUBSTR(TRIM(TO_CHAR(NVL(ACT_TIME,0),'0000')),0,2)|| ':'|| SUBSTR(TRIM(TO_CHAR(NVL(ACT_TIME,0),'0000')),3,4))
    		|| decode(act_date, null, '', decode(sch_date, nvl(act_date, sch_date), '', '/'||to_char(nvl(act_date, sch_date), 'DD'))))) as ata
			FROM FLT_OPR
		WHERE 
		  CARR_CODE = #carrCode# AND 
		  FLT_NO    = #fltNo# AND 
		  FLT_KEY   = #fltKey# AND
		  FLT_TYPE  = DECODE(#fltType#,'E','D','A') AND
		  TO_CHAR(SCH_DATE,'DDMONYY') = #fltDate#
   	</select>
	<!-- Offshore changes by Murugan on 18 May 06 Ends -->

	<select id="sqlgetetd"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.uld.bo.ULDEICBO">
		SELECT    SUBSTR(TRIM(TO_CHAR(NVL(ACT_TIME,0),'0000')),0,2)|| ':'|| SUBSTR(TRIM(TO_CHAR(NVL(ACT_TIME,0),'0000')),3,4) as actTime,
			TO_CHAR(ACT_DATE,'DDMONYY') as actDate				
			FROM FLT_OPR
		WHERE 
		  CARR_CODE = #carrCode# AND 
		  FLT_NO    = #fltNo# AND 
		  FLT_KEY   = #fltKey# AND
		  TO_CHAR(SCH_DATE,'DDMONYY') = #fltDate#
   	</select>

	<select id="sqlgettrno"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="java.lang.String">
		SELECT  TR_NO as trNo
			FROM FLT_OPR
		WHERE 
		  CARR_CODE = #carrCode# AND 
		  FLT_NO    = #fltNo# AND 
		  FLT_KEY   = #fltKey# AND
		  TO_CHAR(SCH_DATE,'DDMONYY') = #fltDate#
		  AND FLT_TYPE = #fltType#	
   	</select>

	<select id="sqlgetaircrafttype"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="java.lang.String">
		SELECT   ACFT_TYPE
			FROM FLT_OPR
		WHERE 
		  CARR_CODE = #carrCode# AND 
		  FLT_NO    = #fltNo# AND 
		  FLT_KEY   = #fltKey# AND
		  TO_CHAR(SCH_DATE,'DDMONYY') = #fltDate# AND 
		  FLT_TYPE = #fltType#	
   	</select>

	<select id="sqlgetuldinventorygeteiclistbyuldkey"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.uld.bo.ULDEICBO">
			SELECT 
			   ULD_KEY as uldKey, ULD_TYPE as uldType, ULD_NO as uldNo,OWNER_ID ownerId, 'Y' as topPalletInd 
			FROM ULD_INVENTORY
		   WHERE BASE_PLT  = #uldKey#	
   	</select>

	<select id="sqlgetuldinventorygeteiclistbyuldkeyforimport"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.uld.bo.ULDEICBO">
			SELECT 
			   ULD_KEY as uldKey
			FROM IMP_EIC
		   WHERE BASE_PLT  = #uldKey# AND FLT_KEY = #fltKey# AND FLT_DATE = TO_DATE(#fltDate#,'DDMONYY')
	</select>

	<select id="sqlcheckforuldexist"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.uld.bo.ULDEICBO">
			SELECT 
			   ULD_KEY as uldKey
			FROM ULD_INVENTORY
		   WHERE ULD_KEY  = #uldKey#		   
   	</select>

		<select id="sqlgetfordismantle"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.uld.bo.ULDEICBO">
		SELECT 
				ULD_KEY as uldKey,   
				LOC_CODE as locCode,
				OWNER_ID as ownerId,
				GEN_RMK as genRem,
				DAM_RMK as damRem,
				IMAGE_REF as imageRef,
				DAM_IND as condnCode,
				EMPTY_FLG as emptyFLG,
				LOC_CODE as locCodeOld,
				GEN_RMK as genRemOld,
				DAM_RMK as damRemOld
			FROM ULD_INVENTORY
			
			WHERE ULD_KEY  = #uldKey#		   
	   	</select>

		<select id="sqlwarehousedesteic"  parameterClass="java.lang.String"  resultClass="cargo.cms.afw.bo.MasterBO">
			SELECT CODE AS codeId, CODE_DESC AS codeDesc FROM MAST_WH_LOC where CODE = #code# 	   
	   	</select>

		<select id="sqllovmasterownereic"  parameterClass="java.lang.String"  resultClass="cargo.cms.afw.bo.MasterBO">
			SELECT CODE AS codeId, CODE_DESC AS codeDesc FROM MAST_CARRIER where CODE = #code#  AND OWNED_CARR = 'Y' 	   
	   	</select>

		<select id="eic_location_list_for_whdest"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.afw.bo.MasterBO">
			SELECT CODE as codeId, CODE as codeDesc  FROM MAST_WH_LOC_CODE WHERE WH_LOC =#whDest#	   
	   	</select>

		<select id="eic_location_list"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.afw.bo.MasterBO">
			SELECT CODE as codeId, CODE as codeDesc  FROM MAST_WH_LOC_CODE WHERE WH_LOC =#whDest# AND CODE = #locCode#	   
	   	</select>

		<select id="sqlcheckuldtypeeic"  parameterClass="java.lang.String"  resultClass="java.lang.String">
			SELECT CODE FROM MAST_ULD_TYPE WHERE CODE=#uldTypeInput#	   
	   	</select>

		<select id="sqlcheckuldcarriereic"  parameterClass="java.lang.String"  resultClass="java.lang.String">
			SELECT CODE FROM MAST_CARRIER WHERE CODE=#carrierCodeInput#	   
	   	</select>

		<select id="sqlcontourcodelisteic"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.afw.bo.MasterBO">
			SELECT CONTR_CODE as codeId, CONTR_CODE as codeDesc FROM ULD_TYPE_CONTR WHERE ULD_TYPE=#uldType# AND CONTR_CODE = #contrCode#	   
	   	</select>

		<select id="sqlcheckforprotaircrafttype"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="java.lang.String">
			SELECT ACFT_TYPE as acftType
		
			FROM ULD_TYPE_PROH_ACFT
	
			WHERE ULD_TYPE = #uldType# AND 
				  CONTR_CODE = #contrCode# AND   
				  ACFT_TYPE = #aircraftType# AND
				  NVL(CARR_CODE,#carrCode#) = #carrCode#
	   	</select>
<!-- Onsite Changed on 12 May 2006 by mayank Starts here (FLT_TYPE like #fltType#  to NVL(FLT_TYPE, '%') like #fltType#  )-->
		<!-- Service error log select query starts -->
		
		<select id="ServiceErrorLog_CheckDate"  parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO" resultClass="java.lang.String" >
			SELECT TO_CHAR(TO_DATE(#dateTo#,'DDMONYY') - TO_DATE(#dateFrom#,'DD-MON-YY')) DAYDIFF FROM DUAL
	</select>
	
	<select id="ServiceErrorLog_CheckSysDate"  parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO" resultClass="java.lang.String" >
			SELECT TO_CHAR(TO_DATE(#dateTo#,'DDMONYY') - TO_DATE(SYSDATE,'DD-MON-YY')) DAYDIFF FROM DUAL
	</select>	
		
		<select id="sqlserviceerrorlogsearch1"  parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO"  resultClass="cargo.cms.uld.bo.ServiceErrorLogBO">
			<![CDATA[
			SELECT  to_char(TR_DATE, 'DDMONYY HH24:MI') as trDate, 
				CR_USER_ID as lmUserId, 
				ULD_KEY as uldKey,
				ULD_KEY as uldKey1, 
				TR_NO as trNo, 
				TR_NO as urfNo,
				TR_TYPE as trType,
			    ERR_REASON as errorReason, 
				SVC_USER_ID as svcUserId, 
				to_char(SVC_DATE, 'DDMONYY hh24:mi') as svcDate, 
				FLT_TYPE as fltType,
				DOC_LINE_NO as docLineNo,
			    to_char(FLT_DATE,'DDMONYY') as fltDate, 
				FLT_KEY as fltKey
			FROM SERVICE_ERR_LOG
			
			WHERE TR_DATE >= to_date(#dateFrom#,'DDMONYY') and TR_DATE < (to_date(#dateTo#,'DDMONYY')+1)
			
			and NVL(FLT_TYPE, '%') like #fltType# 
			
			AND SVC_DATE is not null
			]]>
			 <dynamic prepend="ORDER BY ">
			 	  <isEmpty property="sortOrder.sortField">
                     TR_DATE DESC 
                  </isEmpty>
                  <isNotEmpty property="sortOrder.sortField">
                      $sortOrder.sortField$
                  </isNotEmpty>
            </dynamic>
		</select>
		<select id="sqlserviceerrorlogsearch1COUNT"  parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO"  resultClass="java.lang.Integer">
			<![CDATA[
			SELECT COUNT(*) AS totalRowCount FROM (
			SELECT  to_char(TR_DATE, 'DDMONYY HH24:MI') as trDate, 
				CR_USER_ID as lmUserId, 
				ULD_KEY as uldKey,
				ULD_KEY as uldKey1, 
				TR_NO as trNo, 
				TR_NO as urfNo,
				TR_TYPE as trType,
			    ERR_REASON as errorReason, 
				SVC_USER_ID as svcUserId, 
				to_char(SVC_DATE, 'DDMONYY hh24:mi') as svcDate, 
				FLT_TYPE as fltType,
				DOC_LINE_NO as docLineNo,
			    to_char(FLT_DATE,'DDMONYY') as fltDate, 
				FLT_KEY as fltKey
			FROM SERVICE_ERR_LOG
			
			WHERE TR_DATE >= to_date(#dateFrom#,'DDMONYY') and TR_DATE < (to_date(#dateTo#,'DDMONYY')+1)
			
			and NVL(FLT_TYPE, '%') like #fltType# 
			
			AND SVC_DATE is not null order by TR_DATE DESC ) 
			]]>
		</select>
		
		<select id="sqlserviceerrorlogsearch2"  parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO"  resultClass="cargo.cms.uld.bo.ServiceErrorLogBO">
			<![CDATA[
				SELECT  to_char(TR_DATE, 'DDMONYY hh24:mi') as trDate, 
					CR_USER_ID as lmUserId, 
					ULD_KEY as uldKey, 
					ULD_KEY as uldKey1,
					TR_NO as trNo,
					TR_NO as urfNo, 
					TR_TYPE as trType,
					ERR_REASON as errorReason, 
					SVC_USER_ID as svcUserId, 
					to_char(SVC_DATE, 'DDMONYY hh24:mi') as svcDate, 
					FLT_TYPE as fltType,
					DOC_LINE_NO as docLineNo,
				    to_char(FLT_DATE,'DDMONYY') as fltDate, 
					FLT_KEY as fltKey
			  
			FROM SERVICE_ERR_LOG
			
			WHERE TR_DATE >= to_date(#dateFrom#,'ddmonyy') and TR_DATE < (to_date(#dateTo#,'ddmonyy')+1)
			
			and NVL(FLT_TYPE, '%') like #fltType#
			]]>
			<dynamic prepend="ORDER BY ">
			 	  <isEmpty property="sortOrder.sortField">
                     TR_DATE DESC 
                  </isEmpty>
                  <isNotEmpty property="sortOrder.sortField">
                      $sortOrder.sortField$
                  </isNotEmpty>
            </dynamic>
		</select>
		<select id="sqlserviceerrorlogsearch2COUNT"  parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO"  resultClass="java.lang.Integer">
			<![CDATA[
			SELECT COUNT(*) AS totalRowCount FROM (
				SELECT  to_char(TR_DATE, 'DDMONYY hh24:mi') as trDate, 
					CR_USER_ID as lmUserId, 
					ULD_KEY as uldKey, 
					ULD_KEY as uldKey1,
					TR_NO as trNo,
					TR_NO as urfNo, 
					TR_TYPE as trType,
					ERR_REASON as errorReason, 
					SVC_USER_ID as svcUserId, 
					to_char(SVC_DATE, 'DDMONYY hh24:mi') as svcDate, 
					FLT_TYPE as fltType,
					DOC_LINE_NO as docLineNo,
				    to_char(FLT_DATE,'DDMONYY') as fltDate, 
					FLT_KEY as fltKey
			  
			FROM SERVICE_ERR_LOG
			
			WHERE TR_DATE >= to_date(#dateFrom#,'ddmonyy') and TR_DATE < (to_date(#dateTo#,'ddmonyy')+1)
			
			and NVL(FLT_TYPE, '%') like #fltType# order by TR_DATE DESC )
			]]>
		</select>

		<!-- Service error log select query starts -->
		<select id="sqlserviceerrorlogsearch3"  parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO"  resultClass="cargo.cms.uld.bo.ServiceErrorLogBO">
			<![CDATA[
			SELECT  to_char(TR_DATE, 'ddMonyy hh24:mi') as trDate, 
				CR_USER_ID as lmUserId, 
				ULD_KEY as uldKey, 
				ULD_KEY as uldKey1,
				TR_NO as trNo, 
				TR_NO as urfNo,
				TR_TYPE as trType,
			    ERR_REASON as errorReason, 
				SVC_USER_ID as svcUserId, 
				to_char(SVC_DATE, 'ddMonyy hh24:mi') as svcDate, 
				FLT_TYPE as fltType,
				DOC_LINE_NO as docLineNo,
			    to_char(FLT_DATE,'ddMonyy') as fltDate, 
				FLT_KEY as fltKey
			FROM SERVICE_ERR_LOG
			
			WHERE TR_DATE >= to_date(#dateFrom#,'ddmonyy') and TR_DATE < (to_date(#dateTo#,'ddmonyy')+1)
			
			and NVL(FLT_TYPE, '%') like #fltType# 
			
			AND SVC_DATE is null
			]]>
			<dynamic prepend="ORDER BY ">
			 	  <isEmpty property="sortOrder.sortField">
                     TR_DATE DESC 
                  </isEmpty>
                  <isNotEmpty property="sortOrder.sortField">
                      $sortOrder.sortField$
                  </isNotEmpty>
            </dynamic>
		</select>
		<select id="sqlserviceerrorlogsearch3COUNT"  parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO"  resultClass="java.lang.Integer">
			<![CDATA[
			SELECT COUNT(*) AS totalRowCount FROM (
			SELECT  to_char(TR_DATE, 'ddMonyy hh24:mi') as trDate, 
				CR_USER_ID as lmUserId, 
				ULD_KEY as uldKey, 
				ULD_KEY as uldKey1,
				TR_NO as trNo, 
				TR_NO as urfNo,
				TR_TYPE as trType,
			    ERR_REASON as errorReason, 
				SVC_USER_ID as svcUserId, 
				to_char(SVC_DATE, 'ddMonyy hh24:mi') as svcDate, 
				FLT_TYPE as fltType,
				DOC_LINE_NO as docLineNo,
			    to_char(FLT_DATE,'ddMonyy') as fltDate, 
				FLT_KEY as fltKey
			FROM SERVICE_ERR_LOG
			
			WHERE TR_DATE >= to_date(#dateFrom#,'ddmonyy') and TR_DATE < (to_date(#dateTo#,'ddmonyy')+1)
			
			and NVL(FLT_TYPE, '%') like #fltType# 
			
			AND SVC_DATE is null order by TR_DATE DESC )
			]]>
		</select>
		


		<select id="sqlserviceerrorlogsearch4"  parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO"  resultClass="cargo.cms.uld.bo.ServiceErrorLogBO">
			<![CDATA[
			SELECT  to_char(TR_DATE, 'ddMonyy hh24:mi') as trDate, 
				CR_USER_ID as lmUserId, 
				ULD_KEY as uldKey, 
				ULD_KEY as uldKey1,
				TR_NO as trNo, 
				TR_NO as urfNo,
				TR_TYPE as trType,
			    RMK1 as errorReason, 
				SVC_USER_ID as svcUserId, 
				to_char(SVC_DATE, 'ddMonyy hh24:mi') as svcDate, 
				FLT_TYPE as fltType,
				DOC_LINE_NO as docLineNo,
			    to_char(FLT_DATE,'ddMonyy') as fltDate, 
				FLT_KEY as fltKey
			FROM SERVICE_ERR_LOG			
			WHERE TR_DATE >= to_date(#dateFrom#,'ddmonyy') and TR_DATE < (to_date(#dateTo#,'ddmonyy')+1)			
			and TR_TYPE = #selectedtype#
			]]>
			<dynamic prepend="ORDER BY ">
			 	  <isEmpty property="sortOrder.sortField">
                     TR_DATE DESC 
                  </isEmpty>
                  <isNotEmpty property="sortOrder.sortField">
                      $sortOrder.sortField$
                  </isNotEmpty>
            </dynamic>
		</select>
	
	<select id="sqlserviceerrorlogsearch4COUNT"  parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO"  resultClass="java.lang.Integer">
			<![CDATA[
			SELECT COUNT(*) AS totalRowCount FROM (
			SELECT  to_char(TR_DATE, 'ddMonyy hh24:mi') as trDate, 
				CR_USER_ID as lmUserId, 
				ULD_KEY as uldKey, 
				ULD_KEY as uldKey1,
				TR_NO as trNo, 
				TR_NO as urfNo,
				TR_TYPE as trType,
			    RMK1 as errorReason, 
				SVC_USER_ID as svcUserId, 
				to_char(SVC_DATE, 'ddMonyy hh24:mi') as svcDate, 
				FLT_TYPE as fltType,
				DOC_LINE_NO as docLineNo,
			    to_char(FLT_DATE,'ddMonyy') as fltDate, 
				FLT_KEY as fltKey
			FROM SERVICE_ERR_LOG			
			WHERE TR_DATE >= to_date(#dateFrom#,'ddmonyy') and TR_DATE < (to_date(#dateTo#,'ddmonyy')+1)			
			and TR_TYPE = #selectedtype# order by TR_DATE DESC )
			]]>
		</select>
		
		<select id="sqlserviceerrorlogget"  parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO"  resultClass="cargo.cms.uld.bo.ServiceErrorLogBO">
			SELECT  to_char(TR_DATE, 'ddMonyy hh24:mi') as trDate, CR_USER_ID as lmUserId, ULD_KEY as uldKey, TR_NO as trNo, TR_TYPE as trtype,
			  ERR_REASON as errorReason, SVC_USER_ID as svcUserId, SVC_DATE as svcDate, FLT_TYPE as fltType,
			  DOC_LINE_NO as docLineNo, RMK1 as rmk1, RMK2 as rmk2,TO_CHAR(LM_DATE , 'DDMMYY HH24:MI:SS') AS lastModifiedDate
			  
			FROM SERVICE_ERR_LOG
			
			WHERE TR_NO = #trNo# AND TR_TYPE = nvl(#trType#,TR_TYPE) AND DOC_LINE_NO = #docLineNo#
		</select>

	<!-- Service error log select query ends -->
<!-- Onsite Changed on 12 May 2006 by mayank Ends here (FLT_TYPE like #fltType#  to NVL(FLT_TYPE, '%') like #fltType#  )-->
	<insert id="sqlinserttoppalette" parameterClass="cargo.cms.uld.bo.ULDEICBO" >
    INSERT INTO ULD_INVENTORY(ULD_KEY,ULD_TYPE,
           ULD_NO,ULD_CARR,
           CARR_CODE,FLT_NO, 
           FLT_TYPE, FLT_DATE, 
           FLT_KEY, BASE_PLT, 
           LOC_CODE, 
           EIC_FLG, EMPTY_FLG, 
           BASE_PAL_FLG, DAM_IND, 
            OWNER_ID, PARENT_OWNER, STRG_DATE,
           LM_USER_ID, LM_DATE, CFM_STATUS,
           EIC_UNLDG_PT,
         
          REF_TR_NO, 
          REF_TR_TYPE, 
          REF_TR_DATE, 
          REF_IN_CARR, 
          REF_OUT_CARR, 
          REF_DOC_LINE_NO, 
          REF_LOC_FROM, 
          REF_TR_EVENT, 
          REF_RMK,
          EIC_TYPE,FINAL_WEIGHT,
		    DOUBLE_WGT_RSLT ,X_RAY_RES,X_RAY_REQ     
 
    )
   VALUES(
      #uldKey#, #uldType#, 
      #uldNo#,  #uldCarr#, 
      #carrCode#, #fltNo#, 
      #fltType#, to_date(#fltDate#,'DDMONYY') ,
      #fltKey#, #basePlt#,
       #locCode#,
      'Y', 'Y',
      'N','SER',
       #ownerId#, #ownerId#,sysdate,
      #userId#, sysdate,
      'CONFIRMED',
       #eicUnloadingPt#,
  
      ULD_TR_SEQ.NEXTVAL,
      'EI',
      SYSDATE,
      #carrCode#,
      null,
      1,
      #locCode#,
      #trEvent#,
      #genRem#,
      'EIC','N',null,null,null  
     ) 
 </insert>

	<insert id="sqlinserttoppaletteimport" parameterClass="cargo.cms.uld.bo.ULDEICBO" >
    INSERT INTO ULD_INVENTORY(ULD_KEY,ULD_TYPE,
           ULD_NO,ULD_CARR,
           CARR_CODE,FLT_NO, 
           FLT_TYPE, FLT_DATE, 
           FLT_KEY, IMP_FLT_CARR, 
           IMP_FLT_NO, IMP_FLT_DATE, 
           IMP_FLT_KEY, BASE_PLT, 
           LOC_CODE, 
           EIC_FLG, EMPTY_FLG, 
           BASE_PAL_FLG, DAM_IND, 
           OWNER_ID, PARENT_OWNER ,STRG_DATE,
           LM_USER_ID, LM_DATE, CFM_STATUS,

          REF_TR_NO, 
          REF_TR_TYPE, 
          REF_TR_DATE, 
          REF_IN_CARR, 
          REF_OUT_CARR, 
          REF_DOC_LINE_NO, 
          REF_LOC_FROM, 
          REF_TR_EVENT, 
          REF_RMK,
          OWNED_INV,
          EIC_TYPE ,
          tare_weight,
	      gross_weight,
	      ULD_FLOW,
	      TR_TYPE,FINAL_WEIGHT,
		    DOUBLE_WGT_RSLT, X_RAY_RES,X_RAY_REQ ,ENTRY_TIME       
 
    )
   VALUES(
      #uldKey#, #uldType#, 
      #uldNo#,  #uldCarr#, 
      #carrCode#, #fltNo#, 
      #fltType#, to_date(#fltDate#,'DDMONYY') ,
      #fltKey#, #uldCarr#,
      #fltNo#, to_date(#fltDate#,'DDMONYY'), 
      #fltKey#, #basePlt#,
       #locCode#,
      'Y', 'Y',
      'N','N',
       #ownerId#, #ownerId#,sysdate,
      #userId#, sysdate,
      'CONFIRMED',
  
      ULD_TR_SEQ.NEXTVAL,
      'EI',
      SYSDATE,
      #carrCode#,
      null,
      1,
      #locCode#,
      #refTrEvent#,
      #genRem#,
      'Y',
      'EIC',
      NVL(#tareWeight#,0), 
      NVL(#grossWeight#,0),
	  'I',
	  #refTrEvent#,'N',null,null,null ,sysdate   
     ) 
 </insert>
	
	<insert id="whfsqlinserttoppalette" parameterClass="cargo.cms.uld.bo.ULDEICBO" >
				INSERT INTO ULD_INVENTORY(ULD_KEY,ULD_TYPE,
									  ULD_NO,ULD_CARR,
                                      BASE_PLT, 
									 LOC_CODE, 
									  EIC_FLG, EMPTY_FLG, 
									  BASE_PAL_FLG, DAM_IND, 
									  OWNER_ID, PARENT_OWNER, STRG_DATE,  
									  LM_USER_ID, LM_DATE, CFM_STATUS,

										REF_TR_NO, 
										REF_TR_TYPE, 
										REF_TR_DATE, 
										REF_IN_CARR, 
										REF_OUT_CARR, 
										REF_DOC_LINE_NO, 
										REF_LOC_FROM, 
										REF_TR_EVENT, 
										REF_RMK,OWNED_INV,ULD_FLOW,TR_TYPE,FINAL_WEIGHT,
		    DOUBLE_WGT_RSLT,X_RAY_RES,X_RAY_REQ ,ENTRY_TIME 
 
				)
			VALUES(
						#uldKey#, #uldType#, 
						#uldNo#, 	#uldCarr#, 
						#basePlt#,
						 #locCode#,
						'Y', 'Y',
						'N','SER',
						#ownerId#, #ownerId#, sysdate,
						#userId#, sysdate,
						'CONFIRMED',
		
						ULD_TR_SEQ.NEXTVAL,
						'EI',
						SYSDATE,
						#carrCode#,
						null,
						1,
						#locCode#,
						#refTrEvent#,
						#genRem#,
						'Y','E',#refTrEvent#,'N',null,null,null ,sysdate  
				 )	
	</insert>
	<!--<insert id="sqlinsertuldmovement" parameterClass="cargo.cms.uld.bo.ULDMovementBO" >
		  INSERT INTO ULD_MOV(TR_TYPE,TR_NO, TR_DATE,DOC_LINE_NO,ULD_NO,ULD_TYPE,    
								   ULD_CARR, ULD_KEY,RTRV_DATE, STRG_DATE,MOV_FROM,    
							  MOV_TO, MOV_LOC_FROM, MOV_LOC_TO, FLT_CARR,       
							  FLT_NO, FLT_TYPE, FLT_KEY,FLT_DATE,       
							  BRD_POINT,OFF_POINT,COND_CODE,     
								EIC_ISS, EMPTY_ISS, CONTR_CCODE, OWNER_ID,
							  TRANS_CARR, RECV_CARR, RMK, CR_USER_ID,
							  CR_DATE, LM_USER_ID, LM_DATE, ISS_RECV, ULD_STATUS)
		
		 VALUES (#trType#,#trNo#,sysdate,#docLineNo#,#uldNo#,#uldType#,
				 #uldCarr#,#uldKey#,sysdate,sysdate,#strOriginWarehouse#,
				#strDestinationWarehouse#,#strOriginLocn#,#strDestinationLocn#, #fltCarr#,
				#fltNo#,#fltType#,#fltKey#,#fltDate#,
				#brdPoint#,#offPoint#,#condCode#,
				#eicIss#,#emptyIss#,#contrCode#,#ownerId#,
				#transCarr#,#recCarr#,#rmk#,#crUsedId#,					   											   
				sysdate,#lmUserid#, sysdate,#issRecv#,#uldStatus#
				)  
	</insert>


	<insert id="sqlinsertuldrem" parameterClass="cargo.cms.uld.bo.ULDREMBO" >
			INSERT INTO ULD_RMK(ULD_TYPE, ULD_NO, ULD_CARR, 
								  TR_NO, TR_TYPE, DOC_LINE_NO, 
							 ULD_RMK, ULD_KEY, CR_USER_ID, 
							 CR_DATE, LM_USER_ID, LM_DATE)
			VALUES (#uldType#,#uldNo#,#uldcarr#,
			   #trNo#,#trType#,#docLineNo#,
			   #uldRmk#, #uldKey#, #crUserId#,
			   sysdate,#lmUserID#,sysdate
			)	
	</insert>-->
	
	
	<update id="sqlupdatebasepalette" parameterClass="cargo.cms.uld.bo.ULDEICBO">
   UPDATE ULD_INVENTORY
     SET  
      TARE_WEIGHT = NVL(#tareWeight#,0), 
      GROSS_WEIGHT =  NVL(#grossWeight#,0), 
      GEN_RMK = #genRem#,
      IMP_FLT_CARR = #uldCarr#,
      IMP_FLT_NO = #fltNo#, 
      IMP_Flt_Date = to_date(#fltDate#,'DDMONYY'),
      IMP_Flt_Key = #fltKey#,
      LM_USER_ID = #lmUserId#,
      LM_DATE = sysdate,
      TR_TYPE = #trtype#,
      REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
      REF_TR_TYPE = 'EI',
      REF_DOC_LINE_NO = 1,
      REF_TR_DATE = SYSDATE, 
      REF_OUT_CARR = #uldCarr#, 
      REF_TR_EVENT = #refTrEvent#, 
      REF_RMK = #genRem#,
      EIC_TYPE='EIC',
      ULD_FLOW='I',
      PPK_IND = 'N', 
      MIX_PPK_IND = 'N', 
      DAM_IND =  NVL(DAM_IND,'N'), 
      SER_IND = 'Y', 
      ASV_INV = 'N', 
      OFLD_FLG = 'N', 
      BB_IND = 'N', 
      TRANSIT_FLG = 'N', 
      LOCKED = 'N', 
      LOCK_RQS = 'N', 
      DG_IND = 'N', 
      Agent_inv = 'N',
      DAM_RMK = null,
      spl_code1=null,
      spl_code2=null,
      spl_code3=null,
      target = null, 
      TRANSIT_TYPE = null,
      agent_id = null  ,
      FINAL_WEIGHT = 'N',
      RESV_FLG = 'N',
	  DOUBLE_WGT_RSLT  = null,
	  X_RAY_RES = null,X_RAY_REQ = null          

   WHERE ULD_KEY = #uldKey#
 </update>

<update id="sqlupdatebasepalettewhf" parameterClass="cargo.cms.uld.bo.ULDEICBO">
   UPDATE ULD_INVENTORY
     SET  
      TARE_WEIGHT = NVL(#tareWeight#,0), 
      GROSS_WEIGHT = NVL(#grossWeight#,0), 
      GEN_RMK = #genRem#,
      CONTR_CODE = #contrCode#,
    <!-- handles non eic to eic -->
      EIC_FLG  = 'Y',
      BASE_PAL_FLG = 'Y',
      LM_USER_ID = #lmUserId#,
      LM_DATE = sysdate,
     LOC_CODE=#locCode#,
  
      REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
      REF_TR_TYPE = 'EI',
      REF_DOC_LINE_NO = 1,
      REF_TR_DATE = SYSDATE, 
      REF_OUT_CARR = #uldCarr#, 
      REF_TR_EVENT = #moveType#,
      REF_RMK = #genRem#,  
      TR_TYPE = #moveType#,
      FLT_TYPE = null,
      FLT_NO = null, 
      Flt_Date = null,
      Flt_Key = null,
      CARR_CODE=null,
      ULD_FLOW= nvl(#uldFlow#,ULD_FLOW),
      EIC_TYPE=#eicType# ,
      PPK_IND = 'N', 
      MIX_PPK_IND = 'N', 
      DAM_IND =  NVL(DAM_IND,'N'), 
      ASV_INV = 'N', 
      OFLD_FLG = 'N', 
      BB_IND = 'N', 
      TRANSIT_FLG = 'N', 
      LOCKED = 'N', 
      LOCK_RQS = 'N', 
      DG_IND = 'N', 
      Agent_inv = 'N',
      DAM_RMK = null,
      spl_code1=null,
      spl_code2=null,
      spl_code3=null,
      target = null, 
      TRANSIT_TYPE = null,
      agent_id = null  ,
      FINAL_WEIGHT = 'N',
	  DOUBLE_WGT_RSLT  = null,
	  X_RAY_RES = null,X_RAY_REQ = null   
	  WHERE ULD_KEY = #uldKey#
 </update>
	
		
	
	
	<!-- Offshore changes by Murugan on 15 May 06 Newly added starts -->

		<update id="sqlupdatebasepaletteexportforimport" parameterClass="cargo.cms.uld.bo.ULDEICBO">
			UPDATE ULD_INVENTORY
			  SET  
				  TARE_WEIGHT = NVL(#tareWeight#,0), 
				  GROSS_WEIGHT = NVL(#grossWeight#,0), 
				  GEN_RMK = #genRem#,
				  CONTR_CODE = #contrCode#,
				<!-- handles non eic to eic -->
				  EIC_FLG  = 'Y',
				  BASE_PAL_FLG = 'Y',
				  LM_USER_ID = #lmUserId#,
				  LM_DATE = sysdate,
				  EIC_UNLDG_PT = #eicUnloadingPt#,

				  REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
				  REF_TR_TYPE = 'EI',
				  REF_DOC_LINE_NO = 1,
				  REF_TR_DATE = SYSDATE, 
				  REF_OUT_CARR = #uldCarr#, 
				  REF_TR_EVENT = #trEvent#, 
				  REF_RMK = #genRem# ,
				  EIC_TYPE=#eicType# ,
				  LOC_CODE=#locCode# ,
				  ULD_FLOW='E' ,
				  FLT_NO = #fltNo#,
				  FLT_DATE = #fltDate#,
				  FLT_KEY = #fltKey#,
				  CARR_CODE = #carrCode#,
PARENT_OWNER = #carrCode#,
				  FLT_TYPE = 'E' ,
				  PPK_IND = 'N', 
			      MIX_PPK_IND = 'N', 
			      DAM_IND =  NVL(DAM_IND,'N'), 
			      SER_IND = 'Y', 
			      ASV_INV = 'N', 
			      OFLD_FLG = 'N', 
			      BB_IND = 'N', 
			      TRANSIT_FLG = 'N', 
			      LOCKED = 'N', 
			      LOCK_RQS = 'N', 
			      DG_IND = 'N', 
			      Agent_inv = 'N',
			      DAM_RMK = null,
			      spl_code1=null,
			      spl_code2=null,
			      spl_code3=null,
			      target = null, 
			      TRANSIT_TYPE = null,
			      agent_id = null,
			      TR_TYPE = #trEvent#,
      FINAL_WEIGHT = 'N',
	  DOUBLE_WGT_RSLT  = null,
	  X_RAY_RES = null,X_RAY_REQ = null             

			WHERE ULD_KEY = #uldKey#
	</update>
	
	<update id="sqlupdatebasepaletteexport" parameterClass="cargo.cms.uld.bo.ULDEICBO">
			UPDATE ULD_INVENTORY
			  SET  
				  TARE_WEIGHT = NVL(#tareWeight#,0), 
				  GROSS_WEIGHT = NVL(#grossWeight#,0),
				  GEN_RMK = #genRem#,
				  CONTR_CODE = #contrCode#,
				<!-- handles non eic to eic -->
				  EIC_FLG  = 'Y',
				  BASE_PAL_FLG = 'Y',
				  LM_USER_ID = #lmUserId#,
				  LM_DATE = sysdate,
				  FLT_NO = #fltNo#,
				  FLT_DATE = #fltDate#,
				  FLT_KEY = #fltKey#,
				  CARR_CODE = #carrCode#,
				  PARENT_OWNER = #carrCode#,
				  FLT_TYPE = 'E',
				  EIC_UNLDG_PT = #eicUnloadingPt#,
				  TR_TYPE = #trEvent#,
				  REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
				  REF_TR_TYPE = 'EI',
				  REF_DOC_LINE_NO = 1,
				  REF_TR_DATE = SYSDATE, 
				  REF_OUT_CARR = #uldCarr#, 
				  REF_TR_EVENT = #trEvent#, 
				  REF_RMK = #genRem#,
				  EIC_TYPE=#eicType#,
				  LOC_CODE=#locCode# ,
				  ULD_FLOW='E' ,
				  PPK_IND = 'N', 
			      MIX_PPK_IND = 'N', 
			      DAM_IND =  NVL(DAM_IND,'N'), 
			      SER_IND = 'Y', 
			      ASV_INV = 'N', 
			      OFLD_FLG = 'N', 
			      BB_IND = 'N', 
			      TRANSIT_FLG = 'N', 
			      LOCKED = 'N', 
			      LOCK_RQS = 'N', 
			      DG_IND = 'N', 
			      Agent_inv = 'N',
			      DAM_RMK = null,
			      spl_code1=null,
			      spl_code2=null,
			      spl_code3=null,
			      target = null, 
			      TRANSIT_TYPE = null,
			      agent_id = null ,
      				FINAL_WEIGHT = 'N',
	  				DOUBLE_WGT_RSLT  = null,
	  				X_RAY_RES = null, X_RAY_REQ = null           
				  <isEqual property="buildUpCmplt" compareValue="Y">
				  	,first_wt = NVL(#grossWeight#,0),
				  	READY_WH = 'Y' 
				  </isEqual>
				  <isNotEqual property="buildUpCmplt" compareValue="Y">
				  	,first_wt = 0,
				  	READY_WH = 'N' 
				  </isNotEqual>
			WHERE ULD_KEY = #uldKey#
	</update>
	<!-- Offshore changes by Murugan on 15 May 06 Newly added ends -->
<update id="sqlupdatetoppalette" parameterClass="cargo.cms.uld.bo.ULDEICBO">
   UPDATE ULD_INVENTORY
     SET  
      BASE_PLT = #basePlt#, 
      EIC_FLG  = 'Y',
      BASE_PAL_FLG = 'N',
      CARR_CODE = #carrCode#,
      FLT_NO = #fltNo#, 
      FLT_TYPE = #fltType#,
      Flt_Date = to_date(#fltDate#,'DDMONYY'),
      Flt_Key = #fltKey#,
      IMP_FLT_CARR = #uldCarr#,
      IMP_FLT_NO = #fltNo#, 
      IMP_Flt_Date = to_date(#fltDate#,'DDMONYY'),
      IMP_Flt_Key = #fltKey#,
      LOC_CODE = #locCode#,
      EMPTY_FLG = 'Y', 
      OWNER_ID = NVL(#ownerId#,OWNER_ID),
	  PARENT_OWNER = #ownerId#,
      CFM_STATUS = 'CONFIRMED', 
      LM_USER_ID = #lmUserId#,
      LM_DATE = sysdate,
	  TR_TYPE = #trtype#,
      REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
      REF_TR_TYPE = 'EI',
      REF_DOC_LINE_NO = 1,
      REF_TR_DATE = SYSDATE, 
      REF_OUT_CARR = #uldCarr#, 
      REF_TR_EVENT = #refTrEvent#, 
      CONTR_CODE = #contrCode#,
      REF_RMK = #genRem#,     
      OWNED_INV = 'Y',
      dam_rmk = null,
      RESV_RMK = null,
      RMV_RMK = null,
      handling_mode=null,
      EIC_TYPE='EIC',
      RESV_DATE='', 
      TARGET='',   
      FIRST_WT='', 
      SECOND_WT='', 
      THIRD_WT='', 
      REF_WT='', 
      TARE_WEIGHT = NVL(#tareWeight#,0), 
	  GROSS_WEIGHT = NVL(#grossWeight#,0), 
      ULD_FLOW='I',
      PPK_IND = 'N', 
      MIX_PPK_IND = 'N', 
      DAM_IND =  'N', 
      SER_IND = 'Y', 
      ASV_INV = 'N', 
      OFLD_FLG = 'N', 
      BB_IND = 'N', 
      TRANSIT_FLG = 'N', 
      LOCKED = 'N', 
      LOCK_RQS = 'N', 
      DG_IND = 'N', 
      Agent_inv = 'N',
      spl_code1=null,
      spl_code2=null,
      spl_code3=null, 
      TRANSIT_TYPE = null,
      agent_id = null ,
      FINAL_WEIGHT = 'N',
      RESV_FLG = 'N',
	  DOUBLE_WGT_RSLT  = null,
	  X_RAY_RES = null, X_RAY_REQ = null, ENTRY_TIME = sysdate,GEN_RMK='',MAN_WT_IND  = 'N',
		man_wt_ind2 = 'N',
		man_wt_ind3 = 'N'        
    WHERE ULD_KEY = #uldKey#    

 </update>
 
 
 

	<update id="whfsqlupdatetoppalette" parameterClass="cargo.cms.uld.bo.ULDEICBO">
   UPDATE ULD_INVENTORY
     SET  
      BASE_PLT = #basePlt#, 
      EIC_FLG  = 'Y',
      BASE_PAL_FLG = 'N',
      LOC_CODE = #locCode#,
      EMPTY_FLG = 'Y', 
      OWNER_ID = NVL(OWNER_ID,#ownerId#),
	  PARENT_OWNER = #ownerId#,
      CFM_STATUS = 'CONFIRMED', 
      LM_USER_ID = #lmUserId#,
      LM_DATE = sysdate,

      REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
      REF_TR_TYPE = 'EI',
      REF_DOC_LINE_NO = 1,
      REF_TR_DATE = SYSDATE, 
      REF_OUT_CARR = #uldCarr#, 
      REF_TR_EVENT = #refTrEvent#, 
      CONTR_CODE = #contrCode#,
      REF_RMK = #genRem# ,  
      
      FLT_TYPE = null,
      FLT_NO = null, 
      Flt_Date = null,
      Flt_Key = null,
      CARR_CODE=null,
      EIC_TYPE=#eicType#,
      OWNED_INV = 'Y',
      RESV_RMK = null,
      RMV_RMK = null,
      handling_mode=null,
      RESV_DATE='', 
      TARGET='',   
      FIRST_WT='', 
      SECOND_WT='', 
      THIRD_WT='', 
      REF_WT='' ,
      ULD_FLOW= #uldFlow#,
      PPK_IND = 'N', 
      MIX_PPK_IND = 'N', 
      DAM_IND = NVL(DAM_IND,'N'),      
      ASV_INV = 'N', 
      OFLD_FLG = 'N', 
      BB_IND = 'N', 
      TRANSIT_FLG = 'N', 
      LOCKED = 'N', 
      LOCK_RQS = 'N', 
      DG_IND = 'N', 
      Agent_inv = 'N',
      DAM_RMK = null,
      spl_code1=null,
      spl_code2=null,
      spl_code3=null,
      TRANSIT_TYPE = null,
      agent_id = null,
      TR_TYPE = #refTrEvent#,
      FINAL_WEIGHT = 'N',
	  DOUBLE_WGT_RSLT  = null,
	  X_RAY_RES = null, X_RAY_REQ = null, ENTRY_TIME = sysdate     
    WHERE ULD_KEY = #uldKey#    
 </update>


<update id="updatetoppalettewfforDismantle" parameterClass="cargo.cms.uld.bo.ULDEICBO">
   UPDATE ULD_INVENTORY
     SET  
      BASE_PLT = #basePlt#, 
      EIC_FLG  = 'Y',
      BASE_PAL_FLG = 'N',
      LOC_CODE = #locCode#,
      EMPTY_FLG = 'Y', 
      OWNER_ID = NVL(OWNER_ID,#ownerId#),
	  PARENT_OWNER = #ownerId#,
      CFM_STATUS = 'CONFIRMED', 
      LM_USER_ID = #lmUserId#,
      LM_DATE = sysdate,

      REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
      REF_TR_TYPE = 'EI',
      REF_DOC_LINE_NO = 1,
      REF_TR_DATE = SYSDATE, 
      REF_OUT_CARR = #uldCarr#, 
      REF_TR_EVENT = #trEvent#, 
      CONTR_CODE = #contrCode#,
      REF_RMK = #genRem# ,  
      
      FLT_TYPE = null,
      FLT_NO = null, 
      Flt_Date = null,
      Flt_Key = null,
      EIC_TYPE=#eicType#,
      ULD_FLOW='E' ,
      OWNED_INV = 'Y',
      handling_mode=null,
      RESV_RMK = null,
      RMV_RMK = null,
      RESV_DATE='', 
      TARGET='',   
      FIRST_WT='', 
      SECOND_WT='', 
      THIRD_WT='', 
      REF_WT=''  ,
      PPK_IND = 'N', 
      MIX_PPK_IND = 'N', 
      DAM_IND =  NVL(DAM_IND,'N'), 
      SER_IND = 'Y', 
      ASV_INV = 'N', 
      OFLD_FLG = 'N', 
      BB_IND = 'N', 
      TRANSIT_FLG = 'N', 
      LOCKED = 'N', 
      LOCK_RQS = 'N', 
      DG_IND = 'N', 
      Agent_inv = 'N',
      DAM_RMK = null,
      spl_code1=null,
      spl_code2=null,
      spl_code3=null,
      TRANSIT_TYPE = null,
      agent_id = null,
      TR_TYPE = #trEvent#,
      FINAL_WEIGHT = 'N',
	  DOUBLE_WGT_RSLT  = null,
	  X_RAY_RES = null, X_RAY_REQ = null, ENTRY_TIME = sysdate              
    WHERE ULD_KEY = #uldKey#    

 </update>



	<!-- Offshore change by Muurgan on 13 May 2006 Starts -->
	<update id="sqlupdatetoppaletteexport" parameterClass="cargo.cms.uld.bo.ULDEICBO">
			UPDATE ULD_INVENTORY
			  SET  
				  BASE_PLT = #basePlt#, 
				  EIC_FLG  = 'Y',
				  BASE_PAL_FLG = 'N',
				  FLT_NO = #fltNo#, 
				  FLT_TYPE = 'E',
				  Flt_Date = to_date(#fltDate#,'DDMONYY'),
				  Flt_Key = #fltKey#,
				  LOC_CODE = #locCode#,
				  OWNER_ID = NVL(OWNER_ID,#ownerId#),
				  PARENT_OWNER = #ownerId#,
				  CFM_STATUS = 'CONFIRMED',
				  LM_USER_ID = #lmUserId#,
				  LM_DATE = sysdate,
				  CARR_CODE = #carrCode#,
				  EIC_UNLDG_PT = #eicUnloadingPt#,
				  REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
				  REF_TR_TYPE = 'EI',
				  REF_DOC_LINE_NO = 1,
				  REF_TR_DATE = SYSDATE, 
				  REF_OUT_CARR = #uldCarr#, 
				  REF_TR_EVENT = #trEvent#, 
				  CONTR_CODE = #contrCode#,
				  handling_mode=null,
				  REF_RMK = #genRem#,
				  EIC_TYPE=#eicType#  ,
      			  PPK_IND = 'N', 
			      MIX_PPK_IND = 'N', 
			      DAM_IND =  NVL(DAM_IND,'N'), 
			      SER_IND = 'Y', 
			      ASV_INV = 'N', 
			      OFLD_FLG = 'N', 
			      BB_IND = 'N', 
			      TRANSIT_FLG = 'N', 
			      LOCKED = 'N', 
			      LOCK_RQS = 'N', 
			      DG_IND = 'N', 
			      Agent_inv = 'N',
			      DAM_RMK = null,
			      spl_code1=null,
			      spl_code2=null,
			      spl_code3=null,
			      target = null, 
			      TRANSIT_TYPE = null,
			      agent_id = null,
			      TR_TYPE = #trEvent#,
      			  FINAL_WEIGHT = 'N',
	  			  DOUBLE_WGT_RSLT  = null,
	  			  X_RAY_RES = null,X_RAY_REQ=null         
			 WHERE ULD_KEY = #uldKey#	   
	</update>
	<!-- Offshore change by Muurgan on 13 May 2006 Ends -->
	

<update id="sqldismantlesave" parameterClass="cargo.cms.uld.bo.ULDEICBO">
   UPDATE ULD_INVENTORY   
     SET  
      BASE_PLT = '', 
      EIC_FLG  = 'N',
      BASE_PAL_FLG = 'N',
      EMPTY_FLG = #emptyFLG#,
      LOC_CODE = #locCode#,
      GEN_RMK = #genRem#,
      DAM_RMK = #damRem#,
      DAM_IND = #condnCode#,
      SER_IND = DECODE (NVL(#condnCode#,'N'),'N','Y','Y','N'),
      OWNER_ID = NVL(OWNER_ID,#ownerId#),
	  PARENT_OWNER = #ownerId#,
      FLT_NO = '', 
      FLT_TYPE = '', 
      FLT_KEY = '',
      Flt_Date = '',
      CARR_CODE = '',  
      CFM_STATUS = #cfmStatus#,
      LM_USER_ID = #lmUserId#,
      LM_DATE = sysdate,
      EIC_UNLDG_PT = '',     
      REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
      REF_TR_TYPE = 'EI',
      REF_DOC_LINE_NO = 1,
      REF_TR_DATE = SYSDATE, 
      REF_OUT_CARR = #uldCarr#, 
      REF_TR_EVENT = #trEvent#, 
      CONTR_CODE = '',
      REF_RMK = #genRem# , 
      EIC_TYPE = #eicType#,
      OWNED_INV = #ownedInvFlg#,
      TR_TYPE = #trEvent# 
      <isEqual property="ownedInvFlg" compareValue="Y">		
 		,ENTRY_TIME = sysdate
	  </isEqual>
      WHERE ULD_KEY = #uldKey#    
 </update>


<update id="sqldismantlesaveforwfandexportfortypeimport" parameterClass="cargo.cms.uld.bo.ULDEICBO">
   UPDATE ULD_INVENTORY

      SET  
      BASE_PLT = '', 
      EIC_FLG  = 'N',
      BASE_PAL_FLG = 'N',
      EMPTY_FLG = #emptyFLG#,
      LOC_CODE = #locCode#,
      GEN_RMK = #genRem#,
      DAM_RMK = #damRem#,
      DAM_IND = #condnCode#,
      OWNER_ID = NVL(OWNER_ID,#ownerId#),
	  PARENT_OWNER = #ownerId#,
      CFM_STATUS = #cfmStatus#,
      LM_USER_ID = #lmUserId#,
      LM_DATE = sysdate,
      EIC_UNLDG_PT = '',
      handling_mode=null,
      REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
      REF_TR_TYPE = 'EI',
      REF_DOC_LINE_NO = 1,
      REF_TR_DATE = SYSDATE, 
      REF_OUT_CARR = #uldCarr#, 
      REF_TR_EVENT = #trEvent#, 
      CONTR_CODE = '',
      REF_RMK = #genRem# ,
      EIC_TYPE = #eicType#,
      OWNED_INV = #ownedInvFlg# ,
      AGENT_ID = null,
      Agent_inv = 'N'  
      <isEqual property="ownedInvFlg" compareValue="Y">		
 		,ENTRY_TIME = sysdate
	  </isEqual>
      WHERE ULD_KEY = #uldKey#    
 </update>



	



	
	<update id="sqldismantlebasesave" parameterClass="cargo.cms.uld.bo.ULDEICBO">
			UPDATE ULD_INVENTORY
			   SET  
				  BASE_PLT = '', 
				  EIC_FLG  = 'N',
				  EIC_TYPE=null,
				  BASE_PAL_FLG = 'N',
	 		 	  CONTR_CODE = '',
				  LM_USER_ID = #lmUserId#,
				  LM_DATE = sysdate,
			 	  EIC_UNLDG_PT = '',
				  REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
				  REF_TR_TYPE = 'EI',
				  REF_DOC_LINE_NO = 1,
				  REF_TR_DATE = SYSDATE, 
				  REF_OUT_CARR = #uldCarr#, 
				  REF_TR_EVENT = #trEvent#, 
				  REF_RMK = #genRem#,
				  GROSS_WEIGHT = NVL(TARE_WEIGHT,0) 
			   WHERE ULD_KEY = #uldKey#	   
	</update>
	
	<!-- AFTER ADDING TOP PALLET IN EXPORT EIC -->
	<update id="updateExportBasePaletteForFltType" parameterClass="cargo.cms.uld.bo.ULDEICBO">
		update uld_inventory u 
		set CARR_CODE = #carrCode#,
			PARENT_OWNER = #carrCode#,
			 EIC_FLG  = DECODE((select count(*) from uld_inventory where base_plt=#uldKey#),0,'Y','N'),
				  FLT_NO = #fltNo#, 
				  Flt_Date = to_DATE(#fltDate#,'DDMONYY'),
				  Flt_Key = #fltKey#,
				  FLT_TYPE = 'E'
				   <isEqual property="buildUpCmplt" compareValue="Y">
					  ,first_wt = NVL(#grossWeight#,0),
					  READY_WH = 'Y' 
				  </isEqual>
				  <isNotEqual property="buildUpCmplt" compareValue="Y">
					  ,first_wt = 0,
					  READY_WH = 'N' 
				  </isNotEqual>
		WHERE ULD_KEY = #uldKey# AND FLT_TYPE = 'I'
	</update>		
	<!-- AND EXISTS (SELECT ULD_KEY FROM uld_inventory WHERE BASE_PLT = u.ULD_KEY and FLT_TYPE = 'E') -->
	<!-- AFTER DISMANTLE FROM EXPORT EIC -->
	<update id="updateExportDismantleBasePaletteForFltType" parameterClass="cargo.cms.uld.bo.ULDEICBO">
		update uld_inventory u 
			set CARR_CODE = IMP_FLT_CARR,
PARENT_OWNER = IMP_FLT_CARR,
					  FLT_NO = IMP_FLT_NO, 
					  Flt_Date = IMP_Flt_Date,
					  Flt_Key = IMP_Flt_Key,
					  FLT_TYPE = 'I'
			WHERE ULD_KEY = #uldKey# AND FLT_TYPE = 'E' AND IMP_Flt_Key IS NOT NULL
			AND NOT EXISTS (SELECT ULD_KEY FROM uld_inventory WHERE BASE_PLT = u.ULD_KEY and FLT_TYPE = 'E')
	</update>	

	<update id="sqldismantlebasesavecomp" parameterClass="cargo.cms.uld.bo.ULDEICBO">
			UPDATE ULD_INVENTORY
			   SET  
				  BASE_PLT = '', 
				  EIC_FLG  = DECODE((select count(*) from uld_inventory where base_plt=#uldKey#),0,'N','Y'),
				  CARR_CODE='',
				  FLT_KEY ='',
				  FLT_NO ='',
				  FLT_TYPE='',
				  FLT_DATE='',		
				  BASE_PAL_FLG = 'N',
	 		 	  CONTR_CODE = '',
				  LM_DATE = sysdate,
			 	  EIC_UNLDG_PT = '',
				  REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
				  REF_TR_TYPE = 'EI',
				  REF_DOC_LINE_NO = 1,
				  REF_TR_DATE = SYSDATE, 
				  REF_OUT_CARR = #uldCarr#, 
				  REF_TR_EVENT = #trEvent#, 
				  REF_RMK = #genRem#,
				  GROSS_WEIGHT = NVL(TARE_WEIGHT,0),
				  EIC_TYPE=DECODE((select count(*) from uld_inventory where base_plt=#uldKey#),0,null,EIC_TYPE)       
			   WHERE ULD_KEY = #uldKey#	   
	</update>
	
	<update id="sqldismantlebasesavecompimp" parameterClass="cargo.cms.uld.bo.ULDEICBO">
			UPDATE ULD_INVENTORY
			   SET  
				  BASE_PLT = '', 				 
	 		 	  CONTR_CODE = '',
				  LM_DATE = sysdate,
			 	  EIC_UNLDG_PT = '',
				  REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
				  REF_TR_TYPE = 'EI',
				  REF_DOC_LINE_NO = 1,
				  REF_TR_DATE = SYSDATE, 
				  REF_OUT_CARR = #uldCarr#, 
				  REF_TR_EVENT = #trEvent#, 
				  REF_RMK = #genRem# ,
				  GROSS_WEIGHT = NVL(TARE_WEIGHT,0) ,
				  EMPTY_FLG = DECODE((select count(*) from uld_inventory where base_plt=#uldKey#),0,'Y','N')  ,
				  EIC_TYPE=DECODE((select count(*) from uld_inventory where base_plt=#uldKey#),0,null,EIC_TYPE)
			   WHERE ULD_KEY = #uldKey#	   
	</update>
	

	<select id="get_count_to_update_hht" parameterClass="cargo.cms.uld.bo.ULDEICBO" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM EXP_FLT_ULD WHERE 
			ULD_KEY = #uldKey# AND 
			FLT_KEY = #fltKey# AND 
			FLT_DATE = to_date(#fltDate#,'ddmonyy') and 
			(source != 'EIC' or PMAN_YN = 'Y')
	</select>	
	<update id="sqlserviceerrorlogsave"  parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO">
			UPDATE SERVICE_ERR_LOG	
				SET 
				  RMK1 = #rmk1#, 
				  LM_USER_ID = #lmUserId#,
				  LM_DATE = sysdate,
				  SVC_USER_ID = #svcUserId#,
				  SVC_DATE = sysdate
				  
			WHERE TR_NO = #trNo# AND TR_TYPE = #trType# AND DOC_LINE_NO = #docLineNo# AND to_char(LM_DATE, 'DDMMYY HH24:MI:SS') = #lastModifiedDate#
	</update>

	<!--  WHEN TOP PALLET ADDED IN IMPORT EIC -->
	<insert id="sqlinsertimporteic" parameterClass="cargo.cms.uld.bo.ULDEICBO">
		INSERT INTO IMP_EIC (FLT_KEY, FLT_DATE, BASE_PLT, ULD_KEY, CR_USER_ID, CR_DATE,TR_TYPE)
		VALUES (#fltKey#, to_date(#fltDate#,'DDMONYY'),#basePlt#,#uldKey#,#userId#, sysdate,'EICCR')
	</insert>

	<!--  WHEN TOP PALLET DISMANTLE IN IMPORT EIC -->
	<delete id="sqldeleteimporteic" parameterClass="cargo.cms.uld.bo.ULDEICBO">
		DELETE FROM IMP_EIC WHERE FLT_KEY||FLT_DATE||BASE_PLT = (select FLT_KEY||FLT_DATE||BASE_PLT from uld_inventory where ULD_KEY = #uldKey#) AND ULD_KEY = #uldKey#
	</delete>

<!-- Offshore changes by Murugan on 17 May 06 EIC enquiry added to fix bugs in ULD Enquiry starts-->
<select id="sqlgetbasepalletnoforeicview" parameterClass="cargo.cms.uld.bo.ULDEICBO" resultClass="java.lang.String">
	SELECT NVL((SELECT Base_Plt FROM ULD_INVENTORY 
         WHERE ULD_Key = #uldKey# AND Base_Pal_Flg = 'N'), #uldKey#) BasePlt 
	FROM dual
</select>
<!-- Offshore changes by Murugan on 17 May 06 EIC enquiry added to fix bugs in ULD Enquiry ends-->	

<!-- EIC murugan -->

<!-- sql for pro enq starts -->
<!--  ULD Profile -->

<select id="fetchMastULDTypes" parameterClass="cargo.cms.uld.bo.SearchULDProfileBO" resultClass="java.lang.Integer">
	SELECT count(1) FROM  MAST_ULD_TYPE WHERE CODE NOT IN (SELECT ULD_TYPE FROM ULD_GROUP_CARR 
	WHERE CARR_CODE = #carrierId#)	ORDER BY CODE_DESC
</select>

<select id="fetchULDGroup" parameterClass="java.lang.String" resultClass="java.lang.Integer">
  SELECT count(1) FROM  uld_group_type WHERE uld_type= #PARAM#
</select>

<select id="sqlfetchuldprofileParent" parameterClass="cargo.cms.uld.bo.SearchULDProfileBO" resultClass="cargo.cms.uld.bo.ULDProfileBO">
  select DISTINCT grp.CARR_CODE strCarrierCode, grp.MAX_WEIGHT strMaxWeight, grp.BASE_PAL_FLG strBasePalleteType, grp.ULD_TYPE strULDType, grp.ULD_TYPE oldStrULDType,  a.ULD_GROUP uldGroup, TO_CHAR(grp.LM_DATE , 'DDMONYY HH24:MI:SS') lastModDate
  from ULD_Group_Carr grp, ULD_TYPE_CARR_TARE_WT type  join  ULD_Group_Type a on  a.ULD_TYPE =type.ULD_TYPE where grp.carr_code = type.uld_carr and grp.ULD_TYPE = type.ULD_TYPE
  
	<isNotEmpty property="carrierCopyFrom" prepend="AND" >
		grp.CARR_CODE = #carrierCopyFrom#
	</isNotEmpty>
	<isEmpty property="carrierCopyFrom" prepend="AND" >
		grp.CARR_CODE = #carrierId#
	</isEmpty>
	<isNotEmpty property="strULDType" prepend="AND" >
		grp.ULD_TYPE = #strULDType#
	</isNotEmpty>	
	
 		<isNotEmpty property="uldFrom">
			<isNotEmpty property="uldTo">
				AND (((#uldFrom# BETWEEN TRUNC(type.ULD_NO_FROM) AND TRUNC(type.ULD_NO_TO ))
		   			 or (#uldTo# BETWEEN TRUNC(type.ULD_NO_FROM) AND TRUNC(type.ULD_NO_TO )))
		   			 or (#uldTo#&gt;=TRUNC(type.ULD_NO_FROM)
		    		 And #uldFrom#&lt;=TRUNC(type.ULD_NO_TO )))
			</isNotEmpty>
		</isNotEmpty> 
	 order by grp.ULD_TYPE

</select>
<select id="copyULDProfileParent" parameterClass="cargo.cms.uld.bo.SearchULDProfileBO" resultClass="cargo.cms.uld.bo.ULDProfileBO">
  select DISTINCT grp.CARR_CODE strCarrierCode, grp.MAX_WEIGHT strMaxWeight, grp.BASE_PAL_FLG strBasePalleteType, grp.ULD_TYPE strULDType, 'Y' newRowFlag
  from ULD_Group_Carr grp, ULD_TYPE_CARR_TARE_WT type where grp.carr_code = type.uld_carr and grp.ULD_TYPE = type.ULD_TYPE
  
	<isNotEmpty property="carrierCopyFrom" prepend="AND" >
		grp.CARR_CODE = #carrierCopyFrom#
	</isNotEmpty>
	 order by grp.ULD_TYPE
</select>
<select id="sqlfetchuldprofileChild" parameterClass="cargo.cms.uld.bo.SearchULDProfileBO" resultClass="cargo.cms.uld.bo.ULDProfileBO">
 select type.ULD_CARR strCarrierCode, type.ULD_TYPE strULDType, type.ULD_NO_FROM strULDFrom,
  type.ULD_NO_TO strULDTo, type.TARE_WEIGHT strTareWeight, type.SPECIFICATION specification  
  from ULD_TYPE_CARR_TARE_WT type
  <dynamic prepend="WHERE"> 
	<isNotEmpty property="carrierCopyFrom" prepend="AND" >
		type.ULD_CARR = #carrierCopyFrom#
	</isNotEmpty>
	<isEmpty property="carrierCopyFrom" prepend="AND" >
		type.ULD_CARR = #carrierId#
	</isEmpty>
	<isNotEmpty property="strULDType" prepend="AND" >
		type.ULD_TYPE = #strULDType#
	</isNotEmpty>
		<isNotEmpty property="uldFrom">
			<isNotEmpty property="uldTo">
				AND (((#uldFrom# BETWEEN TRUNC(type.ULD_NO_FROM) AND TRUNC(type.ULD_NO_TO ))
		   			 or (#uldTo# BETWEEN TRUNC(type.ULD_NO_FROM) AND TRUNC(type.ULD_NO_TO )))
		   			 or (#uldTo#&gt;=TRUNC(type.ULD_NO_FROM)
		    		 And #uldFrom#&lt;=TRUNC(type.ULD_NO_TO )))
			</isNotEmpty>
		</isNotEmpty>
	</dynamic>	
	 order by type.ULD_TYPE,type.ULD_NO_FROM
</select>

<select id="sqlfetchuldprofile" parameterClass="cargo.cms.uld.bo.SearchULDProfileBO" resultClass="cargo.cms.uld.bo.ULDProfileBO">
  select grp.CARR_CODE strCarrierCode, grp.MAX_WEIGHT strMaxWeight, grp.BASE_PAL_FLG strBasePalleteType, grp.ULD_TYPE strULDType, type.ULD_NO_FROM strULDFrom,
  type.ULD_NO_TO strULDTo, type.TARE_WEIGHT strTareWeight, type.SPECIFICATION specification,TO_CHAR(grp.LM_DATE , 'DDMONYY HH24:MI:SS') lastModDate  
  from ULD_Group_Carr grp, ULD_TYPE_CARR_TARE_WT type
  where grp.carr_code = type.uld_carr and grp.ULD_TYPE = type.ULD_TYPE
	<isNotEmpty property="carrierCopyFrom" prepend="AND" >
		grp.CARR_CODE = #carrierCopyFrom#
	</isNotEmpty>
	<isEmpty property="carrierCopyFrom" prepend="AND" >
		grp.CARR_CODE = #carrierId#
	</isEmpty>
	<isNotEmpty property="strULDType" prepend="AND" >
		grp.ULD_TYPE = #strULDType#
	</isNotEmpty>	
		<isNotEmpty property="uldFrom">
			<isNotEmpty property="uldTo">
				AND (((#uldFrom# BETWEEN TRUNC(type.ULD_NO_FROM) AND TRUNC(type.ULD_NO_TO ))
		   			 or (#uldTo# BETWEEN TRUNC(type.ULD_NO_FROM) AND TRUNC(type.ULD_NO_TO )))
		   			 or (#uldTo#&gt;=TRUNC(type.ULD_NO_FROM)
		    		 And #uldFrom#&lt;=TRUNC(type.ULD_NO_TO )))
			</isNotEmpty>
		</isNotEmpty>

	 order by grp.ULD_TYPE
</select>
<delete id="sqluldprofiledelete" parameterClass="cargo.cms.uld.bo.ULDProfileBO" >
		delete from ULD_Group_Carr where CARR_CODE = #strCarrierCode# and ULD_TYPE = #strULDType#					
</delete>
<delete id="sqlchilduldprofiledelete" parameterClass="cargo.cms.uld.bo.ULDProfileBO" >
		delete from ULD_TYPE_CARR_TARE_WT where ULD_CARR = #strCarrierCode# and ULD_TYPE = #strULDType#
</delete>
<delete id="deletePopupChildULDProfile" parameterClass="cargo.cms.uld.bo.ULDProfileBO" >
		delete from ULD_TYPE_CARR_TARE_WT where ULD_CARR = #strCarrierCode# and ULD_TYPE = #strULDType# and ULD_NO_FROM=#oldstrULDFrom# and ULD_NO_TO=#oldstrULDTo# and TARE_WEIGHT=#oldstrTareWeight#
</delete>
<select id="duplicateULDNumberAddFromValidation" parameterClass="cargo.cms.uld.bo.ULDProfileBO" resultClass="java.lang.Integer">
SELECT count(1) FROM ULD_TYPE_CARR_TARE_WT WHERE ULD_CARR=#strCarrierCode# AND ULD_TYPE=#strULDType# AND #strULDFrom# BETWEEN ULD_NO_FROM AND ULD_NO_TO
</select>
<select id="duplicateULDNumberAddToValidation" parameterClass="cargo.cms.uld.bo.ULDProfileBO" resultClass="java.lang.Integer">
SELECT count(1) FROM ULD_TYPE_CARR_TARE_WT WHERE ULD_CARR=#strCarrierCode# AND ULD_TYPE=#strULDType# AND #strULDTo# BETWEEN ULD_NO_FROM AND ULD_NO_TO
</select>
<select id="duplicateULDNumberUpdateFromValidation" parameterClass="cargo.cms.uld.bo.ULDProfileBO" resultClass="java.lang.Integer">	
	SELECT COUNT(1) FROM ULD_TYPE_CARR_TARE_WT WHERE ULD_CARR=#strCarrierCode# AND ULD_TYPE=#strULDType# AND (
  		(ULD_NO_FROM between #strULDFrom# and #strULDTo#) OR (ULD_NO_TO between #strULDFrom# and #strULDTo#) OR
  		(#strULDFrom# between ULD_NO_FROM and ULD_NO_TO) OR (#strULDTo# between ULD_NO_FROM and ULD_NO_TO))
	<isNotEmpty prepend = "AND" property="oldstrULDFrom">
		ULD_NO_FROM != NVL(#oldstrULDFrom#, ULD_NO_FROM)
	</isNotEmpty>
	<isNotEmpty prepend = "AND" property="oldstrULDTo">
		ULD_NO_TO != #oldstrULDTo#
	</isNotEmpty>	
</select>
<select id="duplicateULDNumberUpdateToValidation" parameterClass="cargo.cms.uld.bo.ULDProfileBO" resultClass="java.lang.Integer">	
	SELECT COUNT(1) FROM ULD_TYPE_CARR_TARE_WT WHERE ULD_CARR=#strCarrierCode# AND ULD_TYPE=#strULDType# AND (
  		(ULD_NO_FROM between #strULDFrom# and #strULDTo#) OR (ULD_NO_TO between #strULDFrom# and #strULDTo#) OR
  		(#strULDFrom# between ULD_NO_FROM and ULD_NO_TO) OR (#strULDTo# between ULD_NO_FROM and ULD_NO_TO))
	<isNotEmpty prepend = "AND" property="oldstrULDFrom">
		ULD_NO_FROM != NVL(#oldstrULDFrom#, ULD_NO_FROM)
	</isNotEmpty>
	<isNotEmpty prepend = "AND" property="oldstrULDTo">
		ULD_NO_TO != #oldstrULDTo#
	</isNotEmpty>		
</select>

<select id="checkuldtype" parameterClass="map" resultClass="java.lang.Integer">
select count(1) from ULD_Group_Type where  ULD_TYPE=#uldType# 
</select>

<update id="sqlupdateuldprofile" parameterClass="cargo.cms.uld.bo.ULDProfileBO" >
		update ULD_Group_Carr
				set MAX_WEIGHT    = #strMaxWeight#,
					BASE_PAL_FLG  = #strBasePalleteType#,
					LM_USER_ID    = #userId#,
					LM_DATE		  = SYSDATE
				where ULD_TYPE  = #strULDType#
				and CARR_CODE   = #strCarrierCode#
				and ULD_GROUP =  #uldGroup#
</update>
<insert id="sqlinsertuldprofile" parameterClass="cargo.cms.uld.bo.ULDProfileBO">
    		insert into  ULD_Group_Carr (CARR_CODE, ULD_GROUP, ULD_TYPE, MAX_WEIGHT, 
	 	Cr_User_Id, Cr_Date, LM_User_Id, LM_Date,BASE_PAL_FLG)
		Select #strCarrierCode#,  ULD_GROUP , #strULDType#,  NVL(#strMaxWeight#,0), #userId#, sysdate, #userId#, sysdate, #strBasePalleteType#
		from ULD_Group_Type where ULD_TYPE = #strULDType#
</insert>
<insert id="sqlinsertchilduldprofile" parameterClass="cargo.cms.uld.bo.ULDProfileBO">
    		insert into ULD_TYPE_CARR_TARE_WT 
		(ULD_CARR,ULD_TYPE,ULD_NO_FROM,ULD_NO_TO,TARE_WEIGHT,SPECIFICATION,CR_USER_ID,CR_DATE,LM_USER_ID,LM_DATE) 
		values ( #strCarrierCode#,#strULDType#,#strULDFrom#,#strULDTo#,#strTareWeight#,#specification#,
    #userId#,TO_DATE(SYSDATE,'DD/MM/YYYY HH24MISS'),#userId#,TO_DATE(SYSDATE,'DD/MM/YYYY HH24MISS'))
</insert>

<select id="getuldprofileCount"  parameterClass="cargo.cms.uld.bo.ULDProfileBO" resultClass="java.lang.Integer">
		select count(1)
	    from ULD_Group_Carr	    
	    where
	    ULD_TYPE  = #strULDType#
		and CARR_CODE = #strCarrierCode#
		and ULD_GROUP = (Select ULD_GROUP from ULD_Group_Type where ULD_TYPE = #strULDType#)
</select>

<select id="sqlfetchCopyCarrierCodes" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.ULDCodeBO">
   select distinct grp.CARR_CODE codeVal from ULD_Group_Carr grp, ULD_TYPE_CARR_TARE_WT type
  where grp.CARR_CODE = type.uld_carr and grp.CARR_CODE &lt;&gt; #PARAM#
</select>
<select id="sqlCountCarrierIdOwnedULDProfile" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	select count(CODE) from MAST_CARRIER where OWNED_CARR = 'Y' AND CODE = #PARAM#
</select>
<select id="sqlCountCarrierIdULDProfile" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	select count(CODE) from MAST_CARRIER where CODE = #PARAM#
</select>
<select id="sqlCountULDTypeForULDProfile" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	select count(CODE) from MAST_ULD_TYPE where CODE= #PARAM#
</select>
<!--  ULD Profile -->
<!--  ULD Prohibit -->
<select id="sqlfetchuldprohibitbyaircraft" parameterClass="cargo.cms.uld.bo.ULDProhibitBO" resultClass="cargo.cms.uld.bo.ULDProhibitBO">
	select ULD_TYPE strULDType ,CONTR_CODE strContourType, ACFT_TYPE strProhibitAircraftType 
	from ULD_TYPE_PROH_ACFT where ACFT_TYPE = #strProhibitAircraftType#
	<isNotEmpty property="strCarrierId">
		 and CARR_CODE = #strCarrierId#  
	</isNotEmpty>
</select>
<select id="sqlfetchuldprohibitbycontour" parameterClass="cargo.cms.uld.bo.ULDProhibitBO" resultClass="cargo.cms.uld.bo.ULDProhibitBO">
		select a.ULD_TYPE strULDType,a.CONTR_CODE strContourType, a.ACFT_TYPE strProhibitAircraftType , 
		b.CODE_DESC strProhibitAircraftTypeDesc,a.CARR_CODE strCarrierId, b.CODE_DESC strProhibitAircraftTypeDesc,
		TO_CHAR(a.LM_DATE , 'DDMONYY HH24:MI:SS')AS lastModDate
		from ULD_TYPE_PROH_ACFT a, MAST_ACFT_TYPE b	where 
		ULD_TYPE = #strULDType# 
		and CONTR_CODE = #strContourType#
		and b.CODE = a.ACFT_TYPE
		order by a.ACFT_TYPE, a.CARR_CODE
</select>

	<select id="isValidCarrierId"  parameterClass="cargo.cms.uld.bo.ULDProhibitBO" resultClass="java.lang.Integer">
      <![CDATA[
                  SELECT COUNT(*) as count FROM MAST_CARRIER WHERE OWNED_CARR = 'Y' and CODE = #strCarrierId# 
            ]]>
      </select>
<delete id="sqluldprohibitdelete" parameterClass="cargo.cms.uld.bo.ULDProhibitBO" >
		delete ULD_TYPE_PROH_ACFT where ACFT_TYPE = #strProhibitAircraftType# 
		and ULD_TYPE = #strULDType# and CONTR_CODE = #strContourType# 
		and TO_CHAR(LM_DATE,'DDMONYY HH24:MI:SS') = #lastModDate#
		<isNotEmpty property="strCarrierId">
		 and CARR_CODE = #strCarrierId#  
		</isNotEmpty>
</delete>
<update id="sqlupdateuldprohibit" parameterClass="cargo.cms.uld.bo.ULDProhibitBO" >
		
</update>
<insert id="sqlinsertuldprohibit" parameterClass="cargo.cms.uld.bo.ULDProhibitBO">
		insert into ULD_TYPE_PROH_ACFT 
		(ACFT_TYPE,ULD_TYPE,CONTR_CODE,CR_USER_ID,CR_DATE,LM_USER_ID,LM_DATE,CARR_CODE) 
		values ( #strProhibitAircraftType#,#strULDType#,#strContourType#,#userId#,TO_DATE(SYSDATE,'DD/MM/YYYY HH24MISS'),#userId#,TO_DATE(SYSDATE,'DD/MM/YYYY HH24MISS'),#strCarrierId#)
</insert>
<select id="sqlfetchcontoursbyuldtype" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.ULDContourCodeBO">
	select a.CONTR_CODE prohibitCode , b.CODE_DESC prohibitCodeDesc
	from ULD_TYPE_CONTR a,MAST_CONTR_IND b 
		where ULD_TYPE = #PARAM#
		and a.CONTR_CODE = b.CODE
</select>
<select id="sqlfetchAircraftTypeByCarrierCode" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.ULDContourCodeBO">
select a.ACFT_TYPE prohibitCode, b.CODE_DESC prohibitCodeDesc from MAST_CARR_ACFT a,MAST_ACFT_TYPE b
	where CARR_CODE = #PARAM#
	and b.CODE = a.CARR_CODE
</select>
<select id="isValidULDType"  parameterClass="cargo.cms.uld.bo.ULDProhibitBO" resultClass="java.lang.Integer" >
	select count(1) from MAST_ULD_TYPE where CODE = #strULDType#
</select>
<select id="isValidULDTypeForULDProfile"  parameterClass="java.lang.String" resultClass="java.lang.Integer" >
	select count(1) from MAST_ULD_TYPE where CODE = #PARAM#  AND BT_IND = 'N'
</select>
<select id="isValidContrCode"  parameterClass="cargo.cms.uld.bo.ULDProhibitBO" resultClass="java.lang.Integer" >
	select count(1) from ULD_TYPE_CONTR where CONTR_CODE = #strContourType#
</select>

<select id="sqlCountULDTypeVsContourCodeMapping"  parameterClass="cargo.cms.uld.bo.ULDProhibitBO" resultClass="java.lang.Integer" >
	select count(1) from ULD_TYPE_CONTR where ULD_TYPE = #strULDType# and CONTR_CODE = #strContourType#
</select>
<select id="sqlCountAirCraftType"  parameterClass="cargo.cms.uld.bo.ULDProhibitBO" resultClass="cargo.cms.uld.bo.ULDProhibitBO" >
	select CODE strProhibitAircraftType, CODE_DESC strProhibitAircraftTypeDesc from MAST_ACFT_TYPE where CODE = #strProhibitAircraftType#
</select> 
<select id="isValidAircraftTypeById"  parameterClass="cargo.cms.uld.bo.ULDProhibitBO" resultClass="cargo.cms.uld.bo.ULDProhibitBO" >
	select CODE strProhibitAircraftType, CODE_DESC strProhibitAircraftTypeDesc from MAST_ACFT_TYPE where CODE = #strProhibitAircraftType#
</select> 

<select id="sqlCountAircraftTypeVsCarrierCodeMapping"  parameterClass="map" resultClass="java.lang.Integer" >
	select count(1) from MAST_CARR_ACFT where ACFT_TYPE = #strProhibitAircraftType# and CARR_CODE = #strCarrierId#
</select>

<select id="isDestAValidCity" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT COUNT(1) FROM MAST_ARPT A, MAST_CITY B WHERE B.CODE=A.CITY_CODE AND A.CODE=#dest# 
</select>

<!--  ULD Prohibit -->
<!--  LSP By Location -->
<select id="sqlLSPInventoryByLOCQuery" parameterClass="cargo.cms.uld.bo.LSPBO" resultClass="cargo.cms.uld.bo.LSPBO">
  select lsp.LSP_NO lspNo,
  lsp.LOC_CODE locationCode,
  lsp.EMPTY_FLG emptyFlag, 
  lsp.HGT_CLASS heightClass, 
  TO_CHAR(lsp.STRG_DATE,'DDMONYY HH24:MI') storageDate, 
  TO_CHAR(lsp.RTRV_DATE,'DDMONYY HH24:MI') retrieveDate,
  TO_CHAR(lsp.STRG_DATE,'DDMONYY') strg,
  loc.wh_group groupId,
  area.wh_area_desc warehousedescription,
  area.wh_area warehouseDestination
  from LSP_INVENTORY lsp,MAST_WH_LOC loc, MAST_WH_GROUP grp left outer join
         MAST_WH_AREA area on grp.wh_area = area.wh_area
	         WHERE loc.wh_group = grp.wh_group and lsp.LOC_CODE=loc.code  	
			<isNotEmpty property="locationCode" prepend="AND" > LOC_CODE  = #locationCode# </isNotEmpty>
			<isNotEmpty property="emptyFlag">   
				<isNotEqual property="emptyFlag" compareValue="all" prepend="AND" >
				<isEqual property="emptyFlag" compareValue="Y">
					EMPTY_FLG = 'Y' AND NOT EXISTS (SELECT 'Y' FROM AWB_INVENTORY WHERE LSP_NO=lsp.LSP_NO)
				</isEqual>
				<isEqual property="emptyFlag" compareValue="N">
					EMPTY_FLG = 'N' 
				</isEqual>
				</isNotEqual>
				<isEqual property="emptyFlag" compareValue="all"  prepend="AND">
					 ((EMPTY_FLG = 'Y' AND NOT EXISTS (SELECT 'Y' FROM AWB_INVENTORY WHERE LSP_NO=lsp.LSP_NO)) or EMPTY_FLG = 'N')
				</isEqual>
			</isNotEmpty>
			  <isNotEmpty property="warehouseDestination" prepend="AND">
               area.wh_area like UPPER(#warehouseDestination#) 
           </isNotEmpty>
           <isNotEmpty property="groupId" prepend="AND">
               grp.wh_group like UPPER(#groupId#) 
           </isNotEmpty>
             <isNotEmpty property="inactiveDays" prepend="AND">
               (SYSDATE - lsp.STRG_DATE)&gt;= #inactiveDays#
           </isNotEmpty>
             <dynamic prepend="ORDER BY ">
		           <isNotEmpty property="sortOrder.sortField">
		             $sortOrder.sortField$
		           </isNotEmpty>
		 </dynamic>
</select>

<select id="sqlLSPInventoryByLOCQueryCOUNT" parameterClass="cargo.cms.uld.bo.LSPBO" resultClass="cargo.cms.uld.bo.LSPBO">
  select lsp.LSP_NO lspNo,
  lsp.LOC_CODE locationCode,
  lsp.EMPTY_FLG emptyFlag, 
  lsp.HGT_CLASS heightClass, 
  TO_CHAR(lsp.STRG_DATE,'DDMONYY HH24:MI') storageDate, 
  TO_CHAR(lsp.RTRV_DATE,'DDMONYY HH24:MI') retrieveDate,
  loc.wh_group groupId,
  area.wh_area_desc warehousedescription,
  area.wh_area warehouseDestination
  from LSP_INVENTORY lsp,MAST_WH_LOC loc, MAST_WH_GROUP grp left outer join
         MAST_WH_AREA area on grp.wh_area = area.wh_area
	         WHERE loc.wh_group = grp.wh_group and lsp.LOC_CODE=loc.code  	
			<isNotEmpty property="locationCode" prepend="AND" > LOC_CODE  = #locationCode# </isNotEmpty>
			<isNotEmpty property="emptyFlag">   
				<isNotEqual property="emptyFlag" compareValue="all" prepend="AND" >
				<isEqual property="emptyFlag" compareValue="Y">
					EMPTY_FLG = 'Y' AND NOT EXISTS (SELECT 'Y' FROM AWB_INVENTORY WHERE LSP_NO=lsp.LSP_NO)
				</isEqual>
				<isEqual property="emptyFlag" compareValue="N">
					EMPTY_FLG = 'N' 
				</isEqual>
				</isNotEqual>
				<isEqual property="emptyFlag" compareValue="all"  prepend="AND">
					 ((EMPTY_FLG = 'Y' AND NOT EXISTS (SELECT 'Y' FROM AWB_INVENTORY WHERE LSP_NO=lsp.LSP_NO)) or EMPTY_FLG = 'N')
				</isEqual>
			</isNotEmpty>
			  <isNotEmpty property="warehouseDestination" prepend="AND">
               area.wh_area like UPPER(#warehouseDestination#) 
           </isNotEmpty>
           <isNotEmpty property="groupId" prepend="AND">
               grp.wh_group like UPPER(#groupId#) 
           </isNotEmpty>
             <isNotEmpty property="inactiveDays" prepend="AND">
               (SYSDATE - lsp.STRG_DATE)&gt;= #inactiveDays#
           </isNotEmpty>
</select>
<!--  LSP By Location -->
<!--  LSP By Movement -->
<!-- Onsite Changed on 26 May 2006 by mayank Starts here (Add Event_ID)  -->
<select id="sqlLSPInventoryByMOVQuery" parameterClass="cargo.cms.uld.bo.SearchLSPMovementBO"  resultClass="cargo.cms.uld.bo.LSPBO">
   select TO_CHAR(MOV_DATE,'DDMONYY HH24:MI') movementDate ,
     b.EVENT_DESC event,
	 ORG_LOC_CODE originalLocationCode ,
	 DEST_LOC_CODE locationCode,LM_USER_ID staffId 
	 from LSP_MOV a
   LEFT JOIN REGISTER_TR_NO_EVENTS b ON A.TR_TYPE = B.TR_TYPE AND A.EVENT_ID = B.EVENT_ID 
	WHERE
	A.MOV_DATE &gt;= TO_DATE(#strMovementFrom#,'DD/MM/YY HH24MI')
	and A.MOV_DATE &lt;= TO_DATE(#strMovementTo#,'DD/MM/YY HH24MI')
	and LSP_NO = #strLSPNo#
	and nvl(ORG_LOC_CODE, '*') != nvl(DEST_LOC_CODE,'*')
	  <dynamic prepend="ORDER BY ">
		           <isNotEmpty property="sortOrder.sortField">
		             $sortOrder.sortField$
		           </isNotEmpty>
		           
		           <isEmpty property="sortOrder.sortField">
		             a.MOV_DATE desc
		           </isEmpty>
		 </dynamic>
</select>

<select id="sqlLSPInventoryByMOVQueryCOUNT" parameterClass="cargo.cms.uld.bo.SearchLSPMovementBO"  resultClass="cargo.cms.uld.bo.LSPBO">
	select COUNT(1) FROM
	LSP_MOV a
   	LEFT JOIN REGISTER_TR_NO_EVENTS b ON A.TR_TYPE = B.TR_TYPE AND A.EVENT_ID = B.EVENT_ID 
	WHERE
	A.MOV_DATE &gt;= TO_DATE(#strMovementFrom#,'DD/MM/YY HH24MI')
	and A.MOV_DATE &lt;= TO_DATE(#strMovementTo#,'DD/MM/YY HH24MI')
	and LSP_NO = #strLSPNo#
	and nvl(ORG_LOC_CODE, '*') != nvl(DEST_LOC_CODE,'*')
</select>

<!-- Onsite Changed on 26 May 2006 by mayank Ends here (Add Event_ID)  -->
<!--  LSP By Movement -->
<!--  LSP  -->
<select id="sqlLSPByLSPNoQuery" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.LSPBO">
	select LSP_NO lspNo, TARGET target , LOCKED status, LOC_CODE locationCode, EMPTY_FLG emptyFlag, HGT_CLASS heightClass, 
	TO_CHAR(STRG_DATE,'DDMONYY HH24:MI') storageDate, TO_CHAR(RTRV_DATE,'DDMONYY HH24:MI') retrieveDate,
	REF_NET_WT as refNetWt
	from LSP_INVENTORY
	where LSP_NO =#PARAM# 
</select>
	<select id="sqlSRFByLSPNoQuery" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.LSPBO">
	select T.*,decode((select CONSTRAINT from MAST_CONSTRAINT_CODE  ac where ac.code = T.ruleValue and rownum=1),'Y','Y','N') ccExist from 
  	(select I.SRF_NO srf , I.COLL_NAME collPerson,I.TRUCK_NO truckNo,
	I.PRINT_IND prinyInd, A.flt_type fltType,
	(SELECT V.CC_CODE FROM V_CST_IMP_CC_CODE_AWB V
	WHERE V.FLT_KEY = D.FLT_KEY AND V.FLT_DATE = D.FLT_DATE AND V.AWB_NO = D.AWB_NO 
	AND NVL(V.HAWB_NO, '000000000000000000') =  '000000000000000000' AND ROWNUM = 1) as ruleValue,
	FUN_GET_TRUCK_DOCK(I.TRUCK_NO) truckDock
	from AWB_INVENTORY A
	join IMP_SRF I ON A.SRF_NO = I.SRF_NO
	join IMP_SRF_FLT D ON I.SRF_NO = D.SRF_NO
	WHERE I.SRF_EXPY_DATE &gt; SYSDATE
	AND I.STATUS='ISSUED'
	AND A.LSP_NO=#PARAM# and rownum=1) T
</select>

<!--<select id="sqlTruckByLSPNoQuery" parameterClass="java.lang.String"  resultClass="java.lang.String">
	Select truckDock From (select  TRUCK_DOCK truckDock FROM TRUCK_TRIP 
	WHERE TRUCK_NO=#PARAM# and CLOSE_TIME is null order by cr_date desc) where rownum=1
</select> -->
<select id="sqlFltByLSPNoQuery" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.LSPBO">
	select  T.CNTG_FLT_KEY fltKey, TO_CHAR(T.CNTG_FLT_DATE,'DDMONYY') fltDate FROM AWB_INVENTORY A
  	JOIN DDT_SHP S	ON S.AWB_NO = A.AWB_NO AND S.AWB_DATE = A.AWB_DATE 
	JOIN DDT_SHP_TRF_DTL T ON T.TR_NO=S.TR_NO AND T.SDOC_LINE_NO=S.DOC_LINE_NO
	WHERE T.TRF_TYPE='QT' AND A.LSP_NO=#PARAM# and rownum=1
</select>

	<!-- Onsite Changed on 7 Nov 2006 by Prabhakar Starts here -->
	<select id="sqlAWBInvyByLSPNo" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.AWBInventoryBO">
	select AWB_NO strAWBNo ,strg_date as strStorageDate
	from AWB_INVENTORY
	where LSP_NO = #PARAM#  and
	strg_date in (select max(strg_date) from AWB_INVENTORY  where lsp_no = #PARAM#)
	</select>
	
	<!-- Onsite Changed on 23 May 2006 by mayank Starts here -->
<select id="sqlAWBInventoryByLSPNoQuery" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.AWBInventoryBO">
	<!-- select I.AWB_NO strAWBNo, I.WH_DEST strwarehouseDest,I.SEQ_NO AS seqNo, I.LOC_CODE strLocation, I.LOCN_PCS strLocationPieces, trim(to_char(I.LOCN_WT, '9999999.99')) strLocationWeight,
    I.FLT_TYPE strFltType, I.FLT_KEY strFltNo, TO_CHAR(I.FLT_DATE,'DDMONYY') strFltDate, 
    TO_CHAR(I.STRG_DATE,'DDMONYY HH24:MI') strStorageDate,
    I.CATALOG as strCatalogue
    from AWB_INVENTORY I
    LEFT JOIN AWB A ON A.AWB_NO = I.AWB_NO AND A.AWB_DATE = I.AWB_DATE
    where I.LSP_NO = #PARAM# 
    order by I.STRG_DATE DESC -->
	select row_number() over (order by I.AWB_NO) serialNo, I.AWB_NO strAWBNo,I.SEQ_NO AS seqNo, I.LOC_CODE strLocation, I.LOCN_PCS strLocationPieces, trim(to_char(I.LOCN_WT, '9999999.99')) strLocationWeight,
    I.FLT_TYPE strFltType, I.FLT_KEY strFltNo, TO_CHAR(I.FLT_DATE,'DDMONYY') strFltDate, 
    TO_CHAR(I.STRG_DATE,'DDMONYY HH24:MI') strStorageDate,LOCN_PCS strLocationPieces ,
	trim(to_char(LOCN_WT, '9999999.99'))  strLocationWeight,
    decode(A.CATALOG,'',CA.CATALOG,A.CATALOG) as strCatalogue
    from AWB_INVENTORY I
    LEFT JOIN AWB A ON A.AWB_NO = I.AWB_NO AND A.AWB_DATE = I.AWB_DATE
    LEFt JOIN IMP_CAR_AWB CA ON CA.AWB_NO = A.AWB_NO AND CA.AWB_DATE = A.AWB_DATE
    where I.LSP_NO = #PARAM# 
   


</select>
	
	<select id="sqlHAWBInventoryByLSPNoQuery" parameterClass="cargo.cms.uld.bo.AWBInventoryBO"  resultClass="cargo.cms.uld.bo.AWBInventoryBO">
	select HAWB_NO hawbNumber, STRG_PCS strLocationPieces ,
	trim(to_char(STRG_WT, '9999999.99'))  strLocationWeight
   	FROM  HAWB_INVENTORY
    where  SEQ_NO =#seqNo#
</select>

<select id="sqlAgentInventoryByLSPNoQuery" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.AgentInventoryBO">
	select HAWB_NO hawbNumber , AWB_NO strAWBNo, AGENT_CODE agentName, LOCN_PCS strLocationPieces,trim(to_char(LOCN_WT, '9999999.99')) strLocationWeight
    from ASV_INVENTORY 
    where LSP_NO =#PARAM# 
</select>
	
	

<!-- Onsite Changed on 23 May 2006 by mayank Ends here -->
<select id="sqlAWBMovByLSPNoQuery" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.AWBMovementBO">
	select AWB_NO strAWBNo,LOC_CODE strLocation,LOC_PCS strLocationPieces,trim(to_char(LOC_WT, '9999990.9')) strLocationWeight,
	FLT_TYPE strFltType,FLT_KEY strFltNo,TO_CHAR(FLT_DATE,'DDMONYY') strFltDate, 
	TO_CHAR(STRG_DATE,'DDMONYY HH24:MI') strStorageDate,
	NVL(CATALOG,(SELECT CATALOG FROM AWB WHERE AWB_NO = AWB_MOV.AWB_NO AND AWB_DATE = AWB_MOV.AWB_DATE AND ROWNUM = 1)) as strCatalogue  
	from AWB_MOV
	where LSP_NO = #PARAM# AND AWB_NO||AWB_DATE NOT IN (SELECT AWB_NO||AWB_DATE FROM AWB_INVENTORY WHERE LSP_NO = #PARAM#)
	order by STRG_DATE DESC
</select>
<select id="sqlRetrieveLSPHeaderQuery" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.LSPBO">
	select a.LSP_NO lspNo,a.LOC_CODE originalWarehouseDestination, a.LOC_CODE originalLocationCode, a.EMPTY_FLG emptyFlag, 
	a.HGT_CLASS heightClass, TO_CHAR(a.STRG_DATE,'DDMONYY HH24:MI') storageDate, TO_CHAR(a.RTRV_DATE,'DDMONYY HH24:MI') retrieveDate, 
	b.TML_CODE terminalName, a.STATUS status
	from LSP_INVENTORY a,MAST_WH_LOC b
	where a.LSP_NO = #PARAM#
	and a.LOC_CODE = b.CODE
</select>
<select id="sqlWarehouseLocationsQuery" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.ULDCodeBO">
	<![CDATA[
	select t1.CODE codeVal, t1.CODE_DESC codeDesc from MAST_WH_LOC t1, mast_wh_group t2
	where t1.wh_group = t2.WH_GROUP 
    and t2.wh_type <> 'MHS'	order by code
	]]>
</select>
<update id="sqlUpdateLSPInventoryQuery" parameterClass="cargo.cms.uld.bo.LSPBO" >
	update LSP_INVENTORY set 	
	LOC_CODE = null,
	LM_USER_ID=#userId#,

	REF_TR_NO        = #lspNo#,
	REF_TR_TYPE      = 'RL',
	REF_TR_EVENT     = 'RL',
	REF_TR_DATE      =  SYSDATE, 
	REF_DOC_LINE_NO  = 1,
	REF_MOV_FROM     = #warehouseDestination#,
	REF_LOC_FROM     = null
 
	
	where 
	
	LSP_NO = #lspNo#
</update>

<select id="funcByULD" parameterClass="cargo.cms.uld.bo.ULDBO"  resultClass="java.lang.String">
	select AWB_NO FROM AWB_INVENTORY where ULD_KEY=#suldNumber#
</select>

<select id="awbByLSP" parameterClass="cargo.cms.uld.bo.LSPBO"  resultClass="java.lang.String">
	select AWB_NO FROM AWB_INVENTORY where LSP_NO = #lspNo# and rownum=1
</select>

<select id="pcByLSP" parameterClass="cargo.cms.uld.bo.LSPBO"  resultClass="java.lang.String">
	select LOCN_PCS FROM AWB_INVENTORY where LSP_NO = #lspNo# and rownum=1
</select>
<select id="wtByLSP" parameterClass="cargo.cms.uld.bo.LSPBO"  resultClass="java.lang.String">
	select LOCN_WT FROM AWB_INVENTORY where LSP_NO = #lspNo# and rownum=1
</select>


<insert id="retrievelspmhs" parameterClass="cargo.cms.uld.bo.LSPBO" >
	INSERT INTO LSP_MOV
		(SEQ_NO, TR_TYPE, MOV_DATE, DOC_LINE_NO,
		LSP_NO,ORG_LOC_CODE,DEST_LOC_CODE,
		STRG_DATE, STATUS, CR_USER_ID, CR_DATE,
		LM_USER_ID, LM_DATE,EVENT_ID)
	select LSP_MOV_SEQ.NEXTVAL, 'RL', SYSDATE, 1,
		LSP_NO,#originalWarehouseDestination#,#warehouseDestination#, 
		SYSDATE, STATUS, #userId#, SYSDATE,
		#userId#, SYSDATE, 'RL'
	from LSP_inventory
	where LSP_NO = #lspNo#
</insert>


<update id="sqlRtrvMoveOrderStatus" parameterClass="java.lang.String" >
<![CDATA[
		UPDATE rtrv_move_order
		SET status='CANCELLED'
		where UPPER(LSP) = UPPER(#lspNo#)
		AND (status IS NULL OR(status <> 'E' AND status <>'CANCELLED' AND status <>'COMPLETED'))
]]>
</update>

<insert id="retrievemovorder" parameterClass="java.util.HashMap" >

		Insert into RTRV_MOVE_ORDER 
		(FUNC,REF_NO,AWB_NO,CURR_LOCN,LSP,ULD,
		PC,WT,TARGET,STATUS,CR_USER_ID,
		CR_DATE,LM_USER_ID,LM_DATE,TYPE,INV_TYPE) 
		values (#FUNC#,#REF_NO#,#AWB_NO#,#CURR_LOCN#,#LSP#,#ULD#,
		#PC#,#WT#,#TARGET#,#STATUS#,#CR_USER_ID#,
		SYSDATE,#LM_USER_ID#,SYSDATE,'M',#INV_TYPE#)
	
</insert>


<update id="sqlRtrtMHSLspUpdate" parameterClass="cargo.cms.uld.bo.LSPBO" >
		Update Lsp_inventory 
		set Target = #warehouseDestination#,
			lm_date = sysdate,
			lm_user_id = #userId#
		where Lsp_no = #lspNo#
		
</update>

<select id="sqlDOCLineNoForLSPMovQuery" parameterClass="java.lang.String"  resultClass="java.lang.Integer">
	select decode(max(DOC_LINE_NO),null,1,max(DOC_LINE_NO)) from LSP_MOV where LSP_NO = #PARAM#
</select>
<insert id="sqlInsertLSPMovementQuery" parameterClass="cargo.cms.uld.bo.LSPBO">
	insert into LSP_MOV (TR_TYPE, DOC_LINE_NO, LSP_NO ,TR_DATE ,ORG_WH_LOC,
		DEST_WH_LOC ,MOV_DATE ,MOV_MM ,CR_USER_ID ,CR_DATE ,LM_USER_ID ,LM_DATE ,RTRV_DATE,ORG_LOC_CODE,DEST_LOC_CODE)	
	values ('LR',#docLineNumber#,#lspNo#,sysdate,#originalWarehouseDestination#,#warehouseDestination#,sysdate,
	#movmm#,#userId#,sysdate,#userId#,sysdate,sysdate,#originalLocationCode#,null)
</insert>
<!--  LSP -->


<!-- ULD Enq -->
	<!-- Onsite Changed on 26 May 2006 by mayank Starts here (Add Event_ID)  -->
<select id="sqlULDMovementByULDNoQuery" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.ULDMovementBO">
		SELECT 
     		TO_CHAR( A.CR_DATE, 'DDMONYY HH24:MI:SS' ) AS crDate,
     		A.CR_USER_ID as crUserId,
     		( select des_tag from his_mst_itm where cod_his_seq_num=b.cod_his_seq_num) AS eventId,
     		decode(b.cod_his_seq_num,'628',decode(B.cod_act,'A','ADD','U','UPD','D','UPD'),DECODE(B.cod_act,'A','ADD','U','UPD','D','DEL'))  as event,
     		B.DES_HIS_DTS as eventDesc
  		FROM HIS_ULD_EVNT A,HIS_ULD_EVNT_DTL B
  		WHERE B.ULD_KEY= A.ULD_KEY
  			AND A.COD_TRA_SEQ_NUM  = B.COD_TRA_SEQ_NUM
        	AND A.ULD_KEY = #PARAM#
  		    AND A.MODULE = 'W'
        	AND A.COD_HIS_TYP = 'E'
    	group by a.ULD_KEY,A.CR_DATE,A.CR_USER_ID,A.COD_FUNC,B.cod_act,B.DES_HIS_DTS,b.cod_his_seq_num
		order by A.CR_DATE
</select>
	<!-- Onsite Changed on 26 May 2006 by mayank Ends here (Add Event_ID)  -->
<!-- Onsite Changed on 26 May 2006 by mayank Starts here -->	
<select id="sqlCSDMovementByULDNoQuery" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.AWBMovementBO">
		SELECT 
     		TO_CHAR( A.CR_DATE, 'DDMONYY HH24:MI:SS' ) AS crDate,
     		A.CR_USER_ID as crUserId,
     		( select des_tag from his_mst_itm where cod_his_seq_num=b.cod_his_seq_num) AS eventId,
     		decode(b.cod_his_seq_num,'628',decode(B.cod_act,'A','ADD','U','UPD','D','UPD'),DECODE(B.cod_act,'A','ADD','U','UPD','D','DEL'))  as event,
     		B.DES_HIS_DTS as eventDesc
  		FROM HIS_CSD_EVNT A,HIS_CSD_EVNT_DTL B
  		WHERE B.CSD_NO= A.CSD_NO
  			AND A.COD_TRA_SEQ_NUM  = B.COD_TRA_SEQ_NUM
        	AND A.CSD_NO = #PARAM#
  		    AND A.MODULE = 'W'
        	AND A.COD_HIS_TYP = 'E'
		order by A.CR_DATE
</select>
	
<!-- Updated onsite Lokesh 11May06 For BUG:TF1005006 Starts -->

<select id="sqlDollyIdULDNoQuery" parameterClass="java.lang.String"  resultClass="java.lang.String">
SELECT MAX(DOLLY_ID) FROM IMP_RAMP_DOLLY_DTL WHERE ULD_KEY=#PARAM#  AND CR_DATE  = (SELECT MAX(CR_DATE) FROM IMP_RAMP_DOLLY_DTL WHERE ULD_KEY=#PARAM#)
</select>

<select id="sqlULDInventoryByULDNoQuery" parameterClass="cargo.cms.uld.bo.EnquireULDBO"  resultClass="cargo.cms.uld.bo.EnquireULDBO">
WITH ULD_SHC AS (
	SELECT STRAGG(STRINGDELIM(CODE,',')) SHCS FROM(SELECT M.CODE FROM V_EXP_ULD_SHC U,  MAST_SPL_HAND_CODE M WHERE M.CODE = U.CODE AND U.ULD_KEY  = #strULDKey# ORDER BY PRIORITY DESC) WHERE ROWNUM &lt;=9
)
SELECT (select to_char(ob_handover_date,'DDMONYY HH24:MI') FROM EXP_CHKOUT_DTL    WHERE flt_key = A.FLT_KEY
  AND flt_date  = A.FLT_DATE
  AND ULD_KEY   = A.ULD_KEY)as obTime,
   (SELECT TO_CHAR(k.cr_date,'DDMONYY HH24:MI')
  FROM imp_ramp_dolly_dtl k
  WHERE k.flt_key = (select FLT_KEY  from IMP_RAMP_DOLLY_HD where dolly_id=#dollyId# AND ROWNUM=1)
  AND k.flt_date  = (select TO_CHAR(FLT_DATE,'DDMONYY') from IMP_RAMP_DOLLY_HD where dolly_id=#dollyId# AND ROWNUM=1) 
   AND k.ULD_KEY   = A.ULD_KEY)
  AS unloadingTime ,
 (SELECT TO_CHAR(k.hover_date,'DDMONYY HH24:MI')
  FROM imp_ramp_dolly_hd k ,
    imp_ramp_dolly_dtl d
  WHERE d.flt_key=k.flt_key
  AND d.flt_date =k.flt_date
  AND k.dolly_id =d.dolly_id
  AND d.uld_key  =A.ULD_KEY
  AND k.flt_key  = (select FLT_KEY from IMP_RAMP_DOLLY_HD where dolly_id=#dollyId# AND ROWNUM=1)
  AND k.flt_date = (select TO_CHAR(FLT_DATE,'DDMONYY') from IMP_RAMP_DOLLY_HD where dolly_id=#dollyId# AND ROWNUM=1) 
  AND rownum     =1
  )                                               AS inboundHOTime ,
 to_char(A.LST_MHCS_EXIT_TIME,'DDMONYY HH24:MI') as mhcsexitTime,
 to_char(A.LST_MHCS_ETRY_TIME,'DDMONYY HH24:MI') as mhcsentryTime,
     (SELECT TO_CHAR(k.chkin_date,'DDMONYY HH24:MI')
  FROM imp_ramp_chk_dtl k
  WHERE k.flt_key = A.IMP_FLT_KEY
  AND k.flt_date  = TO_CHAR(A.IMP_FLT_DATE,'DDMONYY')
  AND k.ULD_KEY   = A.ULD_KEY
  ) AS chkinTime ,
(select to_char(EXPHOVER.PRINT_HANDOVER_DATE,'DDMONYY HH24:MI') from ULD_REL_DTL CHK,ULD_ISS_HD ISS,EXP_ULD_HOVER_DTL EXPHOVER
where ISS.EIR_NO = CHK.EIR_NO AND CHK.STATUS = 'RELEASED' AND (ISS.STATUS = 'PARTRELEASED' OR ISS.STATUS = 'RELEASED') AND 
EXPHOVER.HO_FORM_NO = CHK.HO_FORM_NO AND EXPHOVER.ULD_KEY = CHK.ULD_KEY AND CHK.ULD_KEY = A.ULD_KEY
AND NOT EXISTS (select NULL from EXP_CHKOUT_DTL CHK
LEFT JOIN EXP_ULD_HOVER_DTL EXPHOVER ON EXPHOVER.HO_FORM_NO = CHK.HO_FORM_NO AND EXPHOVER.ULD_KEY = CHK.ULD_KEY 
where CHK.flt_key = A.FLT_KEY and CHK.flt_date = A.FLT_DATE and CHK.ULD_KEY = A.ULD_KEY)
UNION
select to_char(EXPHOVER.PRINT_HANDOVER_DATE,'DDMONYY HH24:MI') from EXP_CHKOUT_DTL CHK
LEFT JOIN EXP_ULD_HOVER_DTL EXPHOVER ON EXPHOVER.HO_FORM_NO = CHK.HO_FORM_NO AND EXPHOVER.ULD_KEY = CHK.ULD_KEY 
where CHK.flt_key = A.FLT_KEY and CHK.flt_date = A.FLT_DATE and CHK.ULD_KEY = A.ULD_KEY) hoTime,
case when B.ULD_BT_NO is null then  case when A.TRANSIT_TYPE='IF' then DECODE(A.OFLD_FLG, 'N',NVL(E.READY_DISP,'N'),'N') else DECODE(A.OFLD_FLG, 'Y','N','Y') end else  NVL(B.READY_WH,'N') end as ready,  
  A.ULD_KEY STRULDKEY, 
  CASE WHEN A.FLT_TYPE = 'E' THEN FUN_GET_ULD_UPLIFT_PRIORITY(A.FLT_KEY, TO_CHAR(A.FLT_DATE, 'DDMONYY'), A.ULD_KEY) 
  		ELSE FUN_GET_ULD_UPLIFT_PRIORITY('', '', A.ULD_KEY) END as upliftPriority,
  CASE WHEN FUN_GET_ULD_STATE(A.ULD_KEY) = 'OnEty' THEN 'N' ELSE 'Y' END displayPriority,
  A.OWNED_INV STRAATINV           , 
  A.LOC_CODE STRLOCATION          , 
  (select curr_location from mast_wh_loc where code=A.LOC_CODE and MOVABLE='Y') as CURRLOCATION,
  A.EIC_FLG strEicStack           , 
  A.eic_type strStackType         , 
  A.BASE_PLT strEicBasePallet,
  A.empty_flg strEmptyFlag           , 
  nvl(B.UNLDG_PT,E.UNLDG_PT) strUnldngPt      ,
  A.RESV_FLG strReserveInd        ,
  A.handling_mode strHandlingMode ,
  Decode((SELECT count(1) from  MAST_ULD_TYPE where CODE = SUBSTR(A.ULD_KEY,1,3) and (H_CONT_IND = 'Y' OR BT_IND = 'Y')),0,A.OWNER_ID,'') strOwnerCode ,
  A.DAM_IND strDamInd             , 
  A.ser_ind strSerInd             , 
  A.CONTR_CODE STRCONTOURCODE     , 
  DECODE(A.PPK_IND,'Y','Y',DECODE(A.MIX_PPK_IND,'Y','Y','N')) strPPKInd             ,
  A.GEN_RMK STRREMARKS            ,
  A.REBUILD_YN strRebuildInd      ,
  A.TOPUP_YN strTopupInd          ,
  A.locked strLockStatus          ,
  decode(ULD_FLOW,'E',
 (CASE when (select count(1) from cust_airl_spl_code where carr_code=A.ULD_CARR AND UPPER(spl_type)=UPPER('SPL_DANG') and spl_code in (
  select code from V_EXP_ULD_AWB_SHC where uld_key = A.ULD_KEY))>0 then 'Y'
  ELSE 
  'N' end ) , 
 (CASE when (select count(1) from cust_airl_spl_code where  carr_code=A.ULD_CARR AND UPPER(spl_type)='SPL_DANG' and spl_code in (
  select shc from V_IMP_FLT_ULD_SHC where flt_key=A.FLT_KEY and flt_date = A.FLT_DATE and uld_key = A.ULD_KEY AND A.flt_type='I'))>0 then 'Y'
  ELSE 
  'N' end )) strDgInd               ,
  (CASE WHEN FUN_GET_TEMP_CAT4_CLASS(A.ULD_KEY,'') IS NOT NULL THEN 
   FUN_GET_TEMP_CAT4_CLASS(A.ULD_KEY,'') ELSE
   '' END) AS strTempClass,
  A.tare_weight strTareWt,
  A.MAN_WT_IND strManWtInd,
  A.MAN_WT_IND2 strManWtInd2,
  A.MAN_WT_IND3 strManWtInd3,
  A.first_wt strFirstWt           ,
  A.second_wt strSecondWt         ,
  A.third_wt strThirdWt           ,
  A.ref_wt strRefWt               ,
  A.REF_NET_WT refNetWt			  ,
  DECODE(A.final_weight, 'Y', A.gross_weight, null) as grossWt,
  A.double_wgt_rslt  as doubleWeightResult,
  A.target strTarget,
  A.TRANSIT_TYPE strTransitType   ,
  B.vol_ind strVolInd             ,
  C.ht_ind strHtInd               ,
  C.ht strHt,
  D.AIRL_RMK strAirlineRemarks    ,
  E1.EIR_NO strEIRNo               ,
  F.CODE_DESC agentName,
  nvl(B.BLDUP_COMPLETE,E.BLDUP_COMPLETE) bldComplete    ,
  case when B.ULD_BT_NO is null then  case when A.TRANSIT_TYPE='IF' then DECODE(A.OFLD_FLG, 'N',NVL(E.READY_DISP,'N'),'N') else DECODE(A.OFLD_FLG, 'Y','N','Y') end else  NVL(B.READY_DISP,'N') end as rdyForDsptch,
  (select code_desc from mast_code_dtl where code_type = 'ULD_STATE' and code = FUN_GET_ULD_STATE(A.ULD_KEY) )  strULDState,
  PKG_COMMON.get_flt_ata(A.FLT_KEY, A.FLT_DATE, 'A') strATA , 
  D.WH_RMK strWhRemarks,
  A.DAM_RMK damRmk,
  DECODE(A.PPK_IND,'Y','Y',DECODE(A.MIX_PPK_IND,'Y','Y','N')) AS prepackInd             ,
  G.ULD_IMAGE_NAME transactionId,
  A.x_ray_req strxrayreq,
  A.X_RAY_RES strxrayres,
  A.FLT_TYPE cargofltType,
  A.flt_key fltKey,
  to_char(A.flt_date,'DDMONYY') fltDate,
  FUN_GET_CARGO_TYPE(A.uld_key,'') AS mhcsCargoType,
  (SELECT NVL(ULD_CLOSE,'N') FROM EXP_PMANIFEST_ULD B WHERE B.FLT_KEY = A.FLT_KEY AND B.FLT_DATE = A.FLT_DATE AND B.ULD_BT_NO = A.ULD_KEY AND ROWNUM=1) uldClose,
  (SELECT SHCS FROM ULD_SHC) uldSHCs,
   (SELECT CASE WHEN (SELECT count(1) FROM XT_IMP_CAR_SHP_DTL xt where xt.ULD_KEY =  #strULDKey# ) > 0 then 'Y' else 'N' end  from dual) as xtShpFlg,
   (select lastOrder FROM
		  (select target || '(' || NVL(STATUS,'STARTED') || ')' as lastOrder from rtrv_move_order where uld = #strULDKey# order by cr_date desc) where rownum = 1) as lastOrder,
   (SELECT rt.nesting_id FROM EDI_RESDIT_TAG_DTL rt WHERE rt.container_no = #strULDKey# AND ROWNUM = 1) as nestingID,
   A.CFM_STATUS AS cfmStatus,
   (SELECT NVL(UIT_PRINT,'N') FROM EXP_FLT_ULD FLTULD WHERE FLTULD.FLT_KEY=A.FLT_KEY AND FLTULD.FLT_DATE=A.FLT_DATE AND FLTULD.ULD_KEY=A.ULD_KEY) AS uitPrint 
  FROM uld_inventory A
LEFT JOIN
 (SELECT flt_key, flt_date, uld_bt_no , vol_ind,BLDUP_COMPLETE,READY_DISP,READY_WH,UNLDG_PT FROM EXP_Pmanifest_ULD
  ) B
     ON B.uld_bt_no= A.uld_key and a.flt_key = b.flt_key and a.flt_date = b.flt_date and a.flt_type = 'E' 
LEFT JOIN
  (SELECT flt_key, flt_date, uld_bt_no ,  READY_DISP,  decode(READY_DISP,null,'N',READY_DISP) READY_WH,  decode(uld_bt_no,null,null,'Y') BLDUP_COMPLETE,UNLDG_PT FROM EXP_PMAN_TARMAC_ULD
  ) E
     ON E.uld_bt_no= A.uld_key and a.flt_key = E.flt_key and a.flt_date = E.flt_date and a.flt_type = 'E'      
LEFT JOIN
  (SELECT  flt_key,flt_date, ULD_KEY, ht_ind,ht FROM imp_ramp_chk_dtl
  )C
     ON C.ULD_KEY=A.ULD_KEY  and c.flt_key = a.flt_key and a.flt_date = c.flt_date
LEFT JOIN
  (SELECT flt_key,flt_date, ULD_KEY , AIRL_RMK , WH_RMK FROM IMP_ULD_LIST
  )D
     ON D.ULD_KEY=A.ULD_KEY  and d.flt_key = a.imp_flt_key and a.imp_flt_date = d.flt_date
LEFT JOIN (SELECT distinct ULD_KEY, EIR_NO FROM ULD_REL_DTL 
	  WHERE TR_NO = (SELECT MAX(TO_NUMBER(TR_NO)) FROM ULD_REL_DTL WHERE ULD_KEY = #strULDKey# AND UPPER(STATUS) = 'RELEASED')) E1 
ON A.ULD_KEY = E1.ULD_KEY  AND A.AGENT_ID IS NOT NULL
LEFT JOIN  CUST_COMPANY F ON A.AGENT_ID = F.CODE
LEFT JOIN (SELECT max(ULD_IMAGE_NAME) ULD_IMAGE_NAME, ULD_KEY FROM ULD_IMAGE group by uld_key) G
ON A.ULD_KEY = G.ULD_KEY
		WHERE A.ULD_KEY = #strULDKey# AND rownum=1
		
</select>


<select id="inBoundManifestDtls" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.EnquireULDBO">
	SELECT 
	ffm.flt_key as inbFltKey,
	to_char(ffm.flt_date,'DDMONYY') as inbFltDate,
	ffm.awb_no as awbNum,
	ffm.pcs as loadPcs,
	ffm.wt as loadWt,
	awb.orig as origin,
	awb.dest as dest,
	decode(awb.spl_code1, null, '', awb.spl_code1 || decode(awb.spl_code2, null, '', '/'))
			|| decode(awb.spl_code2, null, '', awb.spl_code2 || decode(awb.spl_code3, null, '', '/'))
			|| decode(awb.spl_code3, null, '', awb.spl_code3 || decode(awb.spl_code4, null, '', '/'))
			|| decode(awb.spl_code4, null, '', awb.spl_code4 || decode(awb.spl_code5, null, '', '/'))
			|| decode(awb.spl_code5, null, '', awb.spl_code5 || decode(awb.spl_code6, null, '', '/'))
			|| decode(awb.spl_code6, null, '', awb.spl_code6 || decode(awb.spl_code7, null, '', '/'))
			|| decode(awb.spl_code7, null, '', awb.spl_code7 || decode(awb.spl_code8, null, '', '/'))
			  || decode(awb.spl_code8, null, '', awb.spl_code8 || decode(awb.spl_code9, null, '', '/'))
			|| decode(awb.spl_code9, null, '', awb.spl_code9) as awbSHC,
	awb.content as awbContent,
	CASE WHEN (select count(*) from edi_fhl where awb_no = awb.awb_no and awb_date = awb.awb_date) > 0 THEN 'Y'  
	WHEN (select count(*) from mast_code_dtl where code_type = 'CONSOLIDATION' and instr(awb.content,code) > 0 ) > 0 THEN 'Y' 
	else 'N' END as consol
	FROM v_ffm_dtl ffm
	JOIN uld_inventory uld ON ffm.flt_key = uld.imp_flt_key and ffm.flt_date = uld.imp_flt_date and ffm.uld_key = uld.uld_key
	JOIN AWB awb ON awb.awb_no = ffm.AWB_NO AND awb.AWB_DATE = ffm.AWB_DATE
	LEFT JOIN imp_ramp_chk_dtl chk ON chk.flt_key = uld.imp_flt_key and chk.flt_date = uld.imp_flt_date and chk.uld_key = uld.uld_key
	where uld.uld_key = #uldKey# AND NVL(chk.chkin_yn,'N') = 'N'
</select>


<select id="outBoundManifestDtls" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.EnquireULDBO">
	SELECT 
	pawb.flt_key as outFltKey,
	to_char(pawb.flt_date,'DDMONYY') as outFltDate,
	pawb.awb_no as awbNum,
	pawb.assigned_pcs as loadPcs,
	pawb.assigned_wt as loadWt,
	awb.orig as origin,
	awb.dest as dest,
	decode(awb.spl_code1, null, '', awb.spl_code1 || decode(awb.spl_code2, null, '', '/'))
			|| decode(awb.spl_code2, null, '', awb.spl_code2 || decode(awb.spl_code3, null, '', '/'))
			|| decode(awb.spl_code3, null, '', awb.spl_code3 || decode(awb.spl_code4, null, '', '/'))
			|| decode(awb.spl_code4, null, '', awb.spl_code4 || decode(awb.spl_code5, null, '', '/'))
			|| decode(awb.spl_code5, null, '', awb.spl_code5 || decode(awb.spl_code6, null, '', '/'))
			|| decode(awb.spl_code6, null, '', awb.spl_code6 || decode(awb.spl_code7, null, '', '/'))
			|| decode(awb.spl_code7, null, '', awb.spl_code7 || decode(awb.spl_code8, null, '', '/'))
			  || decode(awb.spl_code8, null, '', awb.spl_code8 || decode(awb.spl_code9, null, '', '/'))
			|| decode(awb.spl_code9, null, '', awb.spl_code9) as awbSHC,
	awb.content as awbContent,
	(select bb_ind from exp_pmanifest_uld where flt_key = pawb.flt_key and flt_date = pawb.flt_date and uld_bt_no = pawb.uld_bt_no) as breakBulk,
	CASE WHEN (select count(*) from edi_fhl where awb_no = awb.awb_no and awb_date = awb.awb_date) > 0 THEN 'Y'  
	WHEN (select count(*) from mast_code_dtl where code_type = 'CONSOLIDATION' and instr(awb.content,code) > 0 ) > 0 THEN 'Y' 
	else 'N' END as consol
	FROM exp_pmanifest_uld_awb pawb
	JOIN uld_inventory uld ON pawb.flt_key = uld.flt_key and pawb.flt_date = uld.flt_date and pawb.uld_bt_no = uld.uld_key
	JOIN AWB awb ON awb.awb_no = pawb.AWB_NO AND awb.AWB_DATE = pawb.AWB_DATE
	where uld.uld_key = #uldKey# and uld.flt_type = 'E'
	UNION ALL
	SELECT 
	pawb.flt_key as outFltKey,
	to_char(pawb.flt_date,'DDMONYY') as outFltDate,
	pawb.awb_no as awbNum,
	pawb.assigned_pcs as loadPcs,
	pawb.assigned_wt as loadWt,
	awb.orig as origin,
	awb.dest as dest,
	decode(awb.spl_code1, null, '', awb.spl_code1 || decode(awb.spl_code2, null, '', '/'))
			|| decode(awb.spl_code2, null, '', awb.spl_code2 || decode(awb.spl_code3, null, '', '/'))
			|| decode(awb.spl_code3, null, '', awb.spl_code3 || decode(awb.spl_code4, null, '', '/'))
			|| decode(awb.spl_code4, null, '', awb.spl_code4 || decode(awb.spl_code5, null, '', '/'))
			|| decode(awb.spl_code5, null, '', awb.spl_code5 || decode(awb.spl_code6, null, '', '/'))
			|| decode(awb.spl_code6, null, '', awb.spl_code6 || decode(awb.spl_code7, null, '', '/'))
			|| decode(awb.spl_code7, null, '', awb.spl_code7 || decode(awb.spl_code8, null, '', '/'))
			  || decode(awb.spl_code8, null, '', awb.spl_code8 || decode(awb.spl_code9, null, '', '/'))
			|| decode(awb.spl_code9, null, '', awb.spl_code9) as awbSHC,
	awb.content as awbContent,
	uld.bb_ind as breakBulk,
	CASE WHEN (select count(*) from edi_fhl where awb_no = awb.awb_no and awb_date = awb.awb_date) > 0 THEN 'Y'  
	WHEN (select count(*) from mast_code_dtl where code_type = 'CONSOLIDATION' and instr(awb.content,code) > 0 ) > 0 THEN 'Y' 
	else 'N' END as consol
	FROM exp_pman_tarmac_uld_awb pawb
	JOIN uld_inventory uld ON pawb.flt_key = uld.flt_key and pawb.flt_date = uld.flt_date and pawb.uld_bt_no = uld.uld_key
	JOIN AWB awb ON awb.awb_no = pawb.AWB_NO AND awb.AWB_DATE = pawb.AWB_DATE
	where uld.uld_key = #uldKey# and uld.flt_type = 'E'
</select>

<!-- Updated By Kamakhya 2 Aug 10  -->
<select id="sqlAWBCpctInvByNoQuery" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.AWBOnULDBO" >

select  row_number() over (order by inv.AWB_NO) serialNo, inv.SEQ_NO strSeqNo, inv.AWB_NO strAWBNo ,
 inv.flt_type strFltType, 
 inv.FLT_KEY strFLTNo, TO_CHAR(inv.FLT_DATE,'DDMONYY') strFLTDate, 
                SUBSTR(inv.AWB_NO,1,3)||'-'||SUBSTR(inv.AWB_NO,4) as strShowAWBNo ,          
                TO_CHAR(inv.STRG_DATE,'DDMONYY HH24:MI') strStrgDate,
                inv.LOCN_PCS strPieces, trim(to_char(inv.LOCN_WT, '9999999.99')) strWeight,
                awb.AWB_TYPE strAwbType
                from AWB_INVENTORY inv 
                join AWB awb
                on awb.AWB_no = inv.AWB_NO and awb.AWB_DATE = inv.AWB_DATE
                where inv.ULD_KEY = #PARAM#
                order by inv.AWB_NO

</select>
<select id="sqlAWBCpctInv" parameterClass="cargo.cms.uld.bo.AWBOnULDBO"   resultClass="cargo.cms.uld.bo.AWBOnULDBO" >
  select SEQ_NO strSeqNo, HAWB_NO strHAWBNo, 
   STRG_PCS strPieces, trim(to_char(STRG_WT, '9999999.99')) strWeight
   from HAWB_inventory  where SEQ_NO =#strSeqNo# 
</select>
<select id="sqlAWBAgentInvByNoQuery" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.AWBOnULDBO" >
	select a.HAWB_NO strHAWBNo,	
   (select code_desc from cust_company c where c.code=a.Agent_code) as strAgentName  ,
	 SUBSTR(AWB_NO,1,3)||'-'||SUBSTR(AWB_NO,4) as strAWBNo ,
	a.LOCN_PCS strPieces, trim(to_char(a.LOCN_WT, '9999999.99')) strWeight
	from ASV_INVENTORY a
	where a.ULD_KEY = #PARAM#
	order by a.AWB_NO
</select>

<!-- Updated onsite Lokesh 11May06 For BUG:TF1005006 Ends -->
<!-- Onsite Changed on 26 May 2006 by mayank Starts here -->	
<!-- Updated offshore Lokesh 15May06 Internal Bug Starts -->
<select id="sqlFlightDetByULDNoQuery" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.FlightDetailsBO">
	SELECT a.FLT_TYPE flightType, A.FLT_KEY flightKey, TO_CHAR(A.SCH_DATE,'DDMONYY') scheduledDate, 
	   DECODE(a.FLT_TYPE, 'A', A.FLT_KEY||'/'||TO_CHAR(A.SCH_DATE,'DDMONYY'), '') chkInFlt,
	   DECODE(O.FLT_KEY, NULL, '', O.FLT_KEY||'/'||TO_CHAR(O.FLT_DATE,'DDMONYY')) chkOutFlt,
       PKG_COMMON.get_flt_ata(A.FLT_KEY, A.SCH_DATE, 'A') strATA, FE.EST_TIME strEstimatedTime, c.LUC_NO strLUCNo,c.RECPT_NO strCtrlReptNo,
       b.BASE_PLT strEICBasePallete, c.IN_CARR_CODE strRecvCarr, c.OUT_CARR_CODE strIssueCarr
	FROM ULD_INVENTORY B 
	LEFT JOIN FLT_OPR a ON a.FLT_KEY = b.IMP_FLT_KEY  AND  A.SCH_DATE= B.IMP_FLT_DATE 
		 AND a.FLT_TYPE = 'A'  
	LEFT JOIN (SELECT i1.ULD_KEY, i2.LUC_NO, RECPT_NO, IN_CARR_CODE, OUT_CARR_CODE 
			FROM LUC_DTL i1, LUC_HD i2 
			WHERE i1.LUC_NO = i2.LUC_NO AND ULD_KEY = UPPER(#PARAM#)
				   AND i2.LUC_Date = (SELECT MAX(LUC_Date) FROM   LUC_DTL i1, LUC_HD i2 
						 WHERE i1.LUC_NO = i2.LUC_NO AND  ULD_KEY = UPPER(#PARAM#))) c 
	 		ON c.ULD_KEY = b.ULD_KEY
	LEFT JOIN ULD_INVENTORY E ON E.ULD_KEY = B.BASE_PLT AND E.FLT_TYPE = 'E'
	LEFT JOIN (SELECT ULD_KEY, FLT_KEY, FLT_DATE FROM EXP_CHKOUT_DTL WHERE CHKOUT_DATE IS NOT NULL) O
		 ON O.ULD_KEY = NVL(E.ULD_KEY, B.ULD_KEY) AND O.FLT_KEY = NVL(E.FLT_KEY, B.FLT_KEY) AND O.FLT_DATE = NVL(E.FLT_DATE, B.FLT_DATE)
	LEFT JOIN FLT_OPR FE ON FE.FLT_KEY = O.FLT_KEY AND FE.SCH_DATE = O.FLT_DATE AND FE.FLT_TYPE = 'D' 
	WHERE b.ULD_KEY = UPPER(#PARAM#)
</select>

<!-- Updated offshore Lokesh 15May06 Internal Bug Ends -->
<select id="sqlAWBInvByULDNoQuery" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.AWBOnULDBO" >
	select a.AWB_NO strAWBNo,
	SUBSTR(a.AWB_NO,1,3)  awbNoPrefix , 
	SUBSTR(a.AWB_NO,4)  awbNoSuffix , 
	SUBSTR(a.AWB_NO,1,3)||'-'||SUBSTR(A.AWB_NO,4) as strShowAWBNo ,
	TO_CHAR(A.AWB_DATE, 'DDMONYY') awbDate,
	a.LOCN_PCS strPieces, trim(to_char(a.LOCN_WT, '9999990.9'))  strWeight,awb.AWB_TYPE strFLTType,
	a.FLT_KEY strFLTNo,TO_CHAR(a.FLT_DATE,'DDMONYY') strFLTDate, TO_CHAR(a.STRG_DATE,'DDMONYY HH24:MI') strStrgDate, a.CATALOG catalog
	from AWB_INVENTORY a
    JOIN AWB awb ON UPPER(awb.AWB_NO) = UPPER(a.AWB_NO) 
    AND UPPER (awb.awb_date) = UPPER (a.awb_date)
	where a.ULD_KEY = #PARAM#
	order by a.AWB_NO
</select>

<select id="sqlSRFByULDRelease" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.EnquireULDBO">
select I.SRF_NO strSrfNo , I.COLL_NAME strCollPerson,I.TRUCK_NO strTruckNo, 
    I.PRINT_IND strPrintIndYn, I.PRINT_IND strPPKInd,  D.CC_CODE,
    decode((SELECT IMP_SRF_POST_YN FROM MAST_CONSTRAINT_CODE WHERE CODE = D.CC_CODE),'N','Y','N') ccExist,
    decode((SELECT IMP_SRF_POST_YN FROM MAST_CONSTRAINT_CODE WHERE CODE = D.CC_CODE),'N','Y','N') strCcExist,
    A.cr_date strCarrierDate,
    A.carr_code strCarrierCode, FUN_GET_TRUCK_DOCK(I.TRUCK_NO) strTruckDock
    from AWB_INVENTORY A 
    join IMP_SRF I ON A.SRF_NO = I.SRF_NO
    join IMP_SRF_FLT D ON I.SRF_NO = D.SRF_NO
  WHERE I.SRF_EXPY_DATE > SYSDATE
	AND I.STATUS='ISSUED'
	AND A.ULD_KEY=#PARAM# AND rownum=1
</select>
<!-- ULD Enq -->
<!-- ULD Enq by Flight -->
	

<select id="sqlULDByFlightQuery" parameterClass="cargo.cms.uld.bo.FlightDetailsBO"  resultClass="cargo.cms.uld.bo.EnquireULDBO">
<![CDATA[	
      select a.ULD_KEY strULDKey, A.loc_code strLocation,a.OWNER_ID strOwnerCode,
            a.GEN_RMK strRemarks,a.GEN_RMK strRemarks,a.AGENT_ID strAgentName,a.DAM_IND strDmgInd,a.CONTR_CODE strContourCode,
            TO_CHAR(a.FLT_DATE,'DDMONYY') flightDate,
            TO_CHAR(a.STRG_DATE,'DDMONYY HH24:MI') strStorageDate, 
            CASE WHEN A.CFM_STATUS LIKE 'RCL%' THEN 'N' 
                         WHEN A.CFM_STATUS LIKE 'UNCONFIRMED%' THEN '' 
                         ELSE A.EMPTY_FLG END strEmptyFlag,
            a.EIC_FLG strEICFlag,         
             (select count(*) from uld_inventory where BASE_PLT = a.ULD_KEY) as topPltExist
      from ULD_INVENTORY A
      where 
            a.FLT_KEY = concat(#carrierCode#, #flightNo#)
            and a.FLT_DATE = TO_DATE(#scheduledDate#,'DDMONYY')
            and a.FLT_TYPE = DECODE(#flightType#,'A','I','E')
    and BASE_PLT is null
            ]]>
      <isNotEmpty prepend="AND" property="dmgInd" >
            a.DAM_IND = #dmgInd#
      </isNotEmpty>     
      <isEqual prepend="AND" property="eicFlag" compareValue="Y">
			a.EIC_FLG = 'Y'
	  </isEqual>
	  <isNotEmpty property="loginCarrier">
			AND	(a.CARR_CODE = #loginCarrier#
			OR a.CARR_CODE IN (SELECT CARR_CODE FROM MAST_CARR_GRP 
			WHERE GRP_CARR_CODE	= #loginCarrier#))							
	 </isNotEmpty>  
      order by   a.ULD_KEY
</select>


<select id="sqlCountEICByULDNoQuery" parameterClass="cargo.cms.uld.bo.FlightDetailsBO"  resultClass="java.lang.Integer">
	select count(1)  from ULD_INVENTORY 
	where 
		CARR_CODE = #carrierCode#
		and FLT_NO = #flightNo#
		and FLT_DATE = TO_DATE(#scheduledDate#,'DDMONYY')
		and FLT_TYPE = DECODE(#flightType#,'A','I','E')
		and EIC_FLG='Y' AND BASE_PAL_FLG='Y' 
</select>

<select id="sqlCountEmptyByULDNoQuery" parameterClass="cargo.cms.uld.bo.FlightDetailsBO"  resultClass="java.lang.Integer">
	select count(1)  from ULD_INVENTORY 
	where 
		CARR_CODE = #carrierCode#
		and FLT_NO = #flightNo#
		and FLT_DATE = TO_DATE(#scheduledDate#,'DDMONYY')
		and FLT_TYPE = DECODE(#flightType#,'A','I','E')
		and EMPTY_FLG='Y' AND (EIC_FLG='N' OR (EIC_FLG='Y' AND BASE_PAL_FLG='Y'))
</select>

<select id="impULDByFlightQuery" parameterClass="cargo.cms.uld.bo.FlightDetailsBO"  resultClass="cargo.cms.uld.bo.EnquireULDBO">
<![CDATA[
      select a.ULD_KEY strULDKey,  a.loc_code strLocation, 
                   a.ULD_OWNER_ID strOwnerCode, a.RMK strRemarks, a.DAM_IND strDmgInd, a.CONTR strContourCode,
            TO_CHAR(a.LM_DATE,'DDMONYY HH24:MI') strStorageDate, a.EMPTY_IND strEmptyFlag, a.EIC_IND strEICFlag,
            'I' fltType , TO_CHAR(a.FLT_DATE,'DDMONYY') flightDate,
             a.FLT_KEY flightKey, 
             (select count(*) from uld_inventory where BASE_PLT = a.ULD_KEY) as topPltExist
      from IMP_RAMP_CHK_DTL a
      where a.CHKIN_YN = 'Y' 
            and a.CARR_CODE = #carrierCode#
            and a.FLT_NO = #flightNo#
            and a.FLT_DATE = TO_DATE(#scheduledDate#,'DDMONYY')
            ]]>
      <isNotEmpty prepend="AND" property="dmgInd" >
            a.DAM_IND = #dmgInd#
      </isNotEmpty>    
      	<isEqual prepend="AND" property="eicFlag" compareValue="Y">
			a.EIC_IND = 'Y'
		</isEqual>  
      order by  a.ULD_KEY
</select>



<select id="impCountEICByULDNoQuery" parameterClass="cargo.cms.uld.bo.FlightDetailsBO"  resultClass="java.lang.Integer">
	select count(1)  from IMP_RAMP_CHK_DTL
	where 
		CARR_CODE = #carrierCode#
		and FLT_NO = #flightNo#
		and FLT_DATE = TO_DATE(#scheduledDate#,'DDMONYY')
		and EIC_IND='Y'
</select>

<select id="impCountEmptyByULDNoQuery" parameterClass="cargo.cms.uld.bo.FlightDetailsBO"  resultClass="java.lang.Integer">
	select count(1)  from IMP_RAMP_CHK_DTL
	where 
		CARR_CODE = #carrierCode#
		and FLT_NO = #flightNo#
		and FLT_DATE = TO_DATE(#scheduledDate#,'DDMONYY')
		and EMPTY_IND='Y'
</select>

		<select id="sqlULDMovQuery" parameterClass="cargo.cms.uld.bo.ULDEnquireByMovementSearchBO"  resultClass="cargo.cms.uld.bo.ULDMovementBO">
		select TO_CHAR(TR_DATE,'DDMONYY HH24:MI') strTRDate, TO_CHAR(TR_DATE,'DDMONYY') flightDate, MOV_FROM strOriginWarehouse,MOV_TO strDestinationWarehouse,
		LM_USER_ID strUserId, b.EVENT_DESC strEvent, a.TR_TYPE  strEventCode, a.ULD_KEY as uldKey,a.TR_NO as trNo
		 from ULD_MOV  a left join REGISTER_TR_NO_EVENTS b on a.EVENT_ID = b.EVENT_ID 
		where  ULD_KEY = #strULDNo#
		and nvl(MOV_FROM, '*') != nvl(MOV_TO,'*')
		and TR_DATE &gt;= TO_DATE(#strFromDate#,'DDMONYY')
		and TR_DATE &lt; TO_DATE(#strToDate#,'DDMONYY')+1 
			<isNotEmpty property="loginCarrier" prepend="AND" >
				(a.OWNER_ID = #loginCarrier#
				OR a.OWNER_ID IN (SELECT CARR_CODE FROM MAST_CARR_GRP WHERE GRP_CARR_CODE= #loginCarrier#))
			</isNotEmpty>
			<isEmpty property="sortOrder.sortField">
	             ORDER BY CR_DATE DESC
	        </isEmpty>			
			<dynamic prepend="ORDER BY ">
	           <isNotEmpty property="sortOrder.sortField">
	             $sortOrder.sortField$
	           </isNotEmpty>	           	           
	        </dynamic>
		</select>

		<select id="sqlULDMovQueryCOUNT" parameterClass="cargo.cms.uld.bo.ULDEnquireByMovementSearchBO"  resultClass="java.lang.Integer">
		select COUNT(*) as totalRowCount
		 from ULD_MOV  a left join REGISTER_TR_NO_EVENTS b on a.EVENT_ID = b.EVENT_ID 
		where  ULD_KEY = #strULDNo#
		and TR_DATE &gt;= TO_DATE(#strFromDate#,'DDMONYY')
		and TR_DATE &lt; TO_DATE(#strToDate#,'DDMONYY')+1 
			<isNotEmpty property="loginCarrier" prepend="AND" >
				(a.OWNER_ID = #loginCarrier#
				OR a.OWNER_ID IN (SELECT CARR_CODE FROM MAST_CARR_GRP WHERE GRP_CARR_CODE= #loginCarrier#))
			</isNotEmpty>		
		</select>

<!-- END ULD Enq by Flight -->

<select id="getULDState" resultClass="cargo.cms.uld.bo.ULDCodeBO">
	select CODE codeVal, CODE_DESC codeDesc from mast_code_dtl where code_type = 'ULD_STATE' order by CODE 
</select>
<select id="getSpecification" resultClass="cargo.cms.uld.bo.ULDCodeBO">
	select CODE codeVal, CODE_DESC codeDesc from mast_code_dtl where code_type = 'ULD_SPCES' order by CODE
</select>

<select id="sqlMAST_ULD_TYPEQuery" resultClass="cargo.cms.uld.bo.ULDCodeBO">
	select CODE codeVal, CODE_DESC codeDesc from MAST_ULD_TYPE order by CODE
</select>
<select id="sqlMAST_ULD_GROUPQuery" resultClass="cargo.cms.uld.bo.ULDCodeBO">
	select ULD_GROUP codeVal, ULD_GROUP codeDesc from MAST_ULD_GROUP order by ULD_GROUP
</select>
<select id="sqlMAST_ULD_WH_LOCQuery" resultClass="cargo.cms.uld.bo.ULDCodeBO">
	select CODE codeVal, CODE_DESC codeDesc from MAST_WH_LOC order by CODE
</select>
<select id="sqlMAST_CONTR_CODEQuery" resultClass="cargo.cms.uld.bo.ULDCodeBO">
	select CODE codeVal, CODE_DESC codeDesc from MAST_CONTR_IND  order by CODE
</select>
<select id="sqlCountLocationCodeByWarehouseIdQuery" resultClass="java.lang.Integer"  parameterClass="cargo.cms.uld.bo.ULDEnquiryByLocationSearchBO"  >
	select count(1) from MAST_WH_LOC_CODE where WH_LOC = #strWarehouseDest# and CODE = #strLocation#
</select>
<select id="sqlCountULDTypeByULDGroupQuery" resultClass="java.lang.Integer"  parameterClass="cargo.cms.uld.bo.ULDEnquiryByLocationSearchBO"  >
	select count(1) from ULD_GROUP_TYPE where 
	<isNotEmpty property="strULDGroup">
		ULD_GROUP = #strULDGroup# and 
	</isNotEmpty>
	ULD_TYPE = #strULDType#
</select>
<select id="sqlCountContourCodesByULDTypeQuery" resultClass="java.lang.Integer"  parameterClass="cargo.cms.uld.bo.ULDEnquiryByLocationSearchBO"  >
	select count(1) from ULD_TYPE_CONTR where 
	<isNotEmpty property="strULDType">
		ULD_TYPE = #strULDType# and 
	</isNotEmpty>
	CONTR_CODE = #strContourCode# 
</select>
<select id="sqlULDLocQuery" resultClass="cargo.cms.uld.bo.EnquireULDBO"  parameterClass="cargo.cms.uld.bo.ULDEnquiryByLocationSearchBO"  >
      
            select flightDate,strPPKInd,flightKey,strULDKey,strULDNo,strDmgInd,strContourCode,strLocation,uldGroup,strFltType,emptyFlag,strULDFlow,
			strStorageDate,strSpec,strEmptyFlag,strReserveInd,strEICFlag,strRemarks,strStatus,strCarrierId,strOwnerCode,strULDkeyContr,strULDState,
			awb_no,awb_type,empWtDiff,tempEntryDate,tempIdleDays
			from (select TO_CHAR(A.Flt_date,'DDMONYY') flightDate,decode(A.PPK_IND,'Y','Y',decode(A.MIX_PPK_IND,'Y','Y',DECODE(A.HANDLING_MODE,'PPK','Y','N'))) strPPKInd,A.FLT_KEY flightKey,A.ULD_KEY strULDKey, A.ULD_NO strULDNo,A.DAM_IND strDmgInd, A.CONTR_CODE strContourCode,B.CODE strLocation, type.ULD_GROUP uldGroup,A.flt_type strFltType, A.empty_flg emptyFlag,
               decode(A.uld_flow, 'I', 'Imp') || decode(A.uld_flow, 'E', 'Exp') || decode(A.uld_flow, 'T', 'Trf')AS  strULDFlow,
                     TO_CHAR(A.STRG_DATE,'DDMONYY HH24:MI') strStorageDate, mastSpec.code strSpec,
                    A.EMPTY_IND strEmptyFlag,
                    NVL(A.RESV_FLG,'N')  strReserveInd,
                     A.EIC_FLG strEICFlag,A.GEN_RMK strRemarks,   
                     A.CFM_STATUS strStatus,A.ULD_CARR strCarrierId, A.OWNER_ID strOwnerCode,
					decode(A.ULD_KEY,null,decode(A.CONTR_CODE,null,' ','/'||A.CONTR_CODE),A.ULD_KEY || decode(A.CONTR_CODE,null,' ','/'||A.CONTR_CODE))  AS strULDkeyContr,
					codedtl.CODE_DESC as strULDState,					
					DECODE(A.state,'AL',(SELECT CODE_DESC FROM MAST_CODE_DTL WHERE CODE_TYPE='LOAD_TYPE' AND TRIM(code)=TRIM(a.load_type) AND GROUP_CODE='38' AND ROWNUM=1),awb_inventory.AWB_NO||DECODE(nvl(awbcount,1),1,'','+'))  awb_no,
				   CASE WHEN nvl(awbcount,0)>0 THEN
			              CASE WHEN (SELECT COUNT(1) FROM AWB Z,AWB_INVENTORY Y
			              WHERE Z.AWB_NO=Y.AWB_NO
			              AND Z.AWB_DATE=Y.AWB_DATE
			              AND Y.ULD_KEY=A.ULD_KEY
			              AND Z.CATALOG IN ('EG', 'ES', 'EO'))=nvl(awbcount,0) THEN
			              'Export'
			              WHEN (SELECT COUNT(1) FROM AWB Z,AWB_INVENTORY Y
			              WHERE Z.AWB_NO=Y.AWB_NO
			              AND Z.AWB_DATE=Y.AWB_DATE
			              AND Y.ULD_KEY=A.ULD_KEY
			              AND Z.CATALOG IN ('TG'))=nvl(awbcount,0) then
			              'T/S'
			              WHEN (SELECT COUNT(1) FROM AWB Z,AWB_INVENTORY Y
			              WHERE Z.AWB_NO=Y.AWB_NO
			              AND Z.AWB_DATE=Y.AWB_DATE
			              AND Y.ULD_KEY=A.ULD_KEY
			              AND Z.CATALOG IN ('IG', 'IS', 'IU'))=nvl(awbcount,0) then
			              'Import'
			              WHEN (SELECT COUNT(1) FROM AWB Z,AWB_INVENTORY Y
			              WHERE Z.AWB_NO=Y.AWB_NO
			              AND Z.AWB_DATE=Y.AWB_DATE
			              AND Y.ULD_KEY=A.ULD_KEY
			              AND Z.CATALOG IN ('TM'))=nvl(awbcount,0) then
			              'TSM'
			              else
			              'MIX'
			              end
			          ELSE ''
			          END AWB_TYPE,
				   CASE WHEN (A.EMPTY_FLG='Y' AND NVL(A.REF_WT,0) !=0) THEN
				    TRIM(TO_CHAR(A.REF_WT - A.TARE_WEIGHT))
				    ELSE
				    ''
				    END empWtDiff,
				    TO_CHAR(ENTRY_TIME,'DDMONYY HH24:MI') as tempEntryDate,
				    FLOOR((SYSDATE-ENTRY_TIME)) as tempIdleDays,
				   dense_rank() over (partition BY a.uld_key order by awb_inventory.cr_date,awb_inventory.awb_no) rank
            from
                  (SELECT 
                        decode(CFM_STATUS,'RCLBULK','N','RCLMIXPREPACK','N','RCLPREPACK','N','UNCONFIRMED','',A.EMPTY_FLG ) EMPTY_IND,
                        (select FUN_GET_ULD_STATE(A.ULD_KEY) from DUAL) state, 
                        A.*  FROM ULD_INVENTORY A) A 
                        
                        LEFT OUTER JOIN (select uld_key,count(1) awbcount from awb_inventory group by uld_key) AI
						ON AI.ULD_KEY = A.uld_key
						LEFT OUTER JOIN awb_inventory awb_inventory
						ON awb_inventory.ULD_KEY = A.uld_key
						LEFT OUTER JOIN awb AB
						ON AB.awb_no    = awb_inventory.awb_no
						AND awb_inventory.awb_date = AB.awb_date                        
                        Left Outer Join Mast_Uld_Type muldtype on muldtype.code = A.uld_type
                        LEFT OUTER JOIN mast_code_dtl codedtl ON codedtl.CODE = A.STATE AND codedtl.code_TYPE = 'ULD_STATE' 
                        left outer join ULD_TYPE_CARR_TARE_WT wt
                        on A.uld_type = wt.uld_type and A.uld_carr = wt.uld_carr and a.uld_no BETWEEN wt.uld_no_from
                        and wt.uld_no_to left outer join mast_code_dtl mastSpec on wt.specification = mastSpec.code
                        and mastSpec.code_type = 'ULD_SPCES',                        
                        MAST_WH_LOC B, MAST_WH_GROUP grp, ULD_GROUP_TYPE type
            where A.LOC_CODE is not null AND A.LOC_CODE = B.CODE and B.wh_group = grp.wh_group AND A.ULD_TYPE = type.ULD_TYPE            
            and NVL(A.AGENT_INV, 'N') = 'N'
            <isNotEmpty property="strStatusEmpty">
            and Empty_Flg = #strStatusEmpty#
            </isNotEmpty>
            <isNotEmpty property="strStatusLoaded">
            and Empty_Flg != #strStatusLoaded#
            </isNotEmpty>
            <isNotEmpty property="strStatusReserved">
            and Resv_flg = #strStatusReserved#
            </isNotEmpty>
            <isNotEmpty property="strStatusBt">
            and bt_ind = #strStatusBt#
            </isNotEmpty>
            <isNotEmpty property="unservicable">
            and SER_IND = DECODE (NVL(#unservicable#,'N'),'N','Y','Y','N')
            </isNotEmpty>
            <!-- Bug Fix for 551 --> 
            <!--and A.AGENT_ID is null--> 
            <isNotEmpty property="strULDGroup">
                  and type.ULD_GROUP = #strULDGroup#
            </isNotEmpty>
            <isNotEmpty property="strULDType">
                  and A.ULD_TYPE = #strULDType#
            </isNotEmpty>
            <isNotEmpty property="strContourCode">
                  and A.CONTR_CODE = #strContourCode#
            </isNotEmpty>
            <isNotEmpty property="strULDState">
                  and A.state = #strULDState#
            </isNotEmpty>           
            <isNotEmpty property="strDmgInd">
                  and A.DAM_IND = #strDmgInd#
            </isNotEmpty>
            <isNotEmpty property="strInActiveDays">
                  and (Sysdate - A.Strg_Date) >= #strInActiveDays#  
                  and not exists (select uld_key from uld_mov where uld_key = A.uld_key and (sysdate - tr_date) &lt;= decode(#strInActiveDays#,null, 0,#strInActiveDays#) )
            </isNotEmpty>           
            <isEqual prepend="AND" property="strWtDiff" compareValue="Y">
                  A.EMPTY_FLG = 'Y' AND A.TARE_WEIGHT != A.REF_WT
            </isEqual>
            <iterate prepend="AND" property="arlStatus"
            open="(" close=")" conjunction="OR" >
                  $arlStatus[]$
            </iterate>              
            <isNotEmpty property="strLocn">
                  and A.LOC_CODE = #strLocn#
            </isNotEmpty>
            <isNotEmpty property="strGroup">
                  and B.WH_GROUP = #strGroup#
            </isNotEmpty>
            <isNotEmpty property="strArea">
                  and grp.WH_AREA = #strArea#
            </isNotEmpty>
            <isNotEmpty property="strCarrierId" prepend="AND" >
                  A.ULD_CARR = #strCarrierId#
            </isNotEmpty>
            <isNotEmpty property="strOwner" prepend="AND" >
                  A.OWNER_ID = #strOwner#
            </isNotEmpty>
            <isEmpty property="strOwner">
               <isNotEmpty property="loginCarrier">
                 AND   (A.OWNER_ID = #loginCarrier#
                 OR A.OWNER_ID IN (SELECT CARR_CODE FROM MAST_CARR_GRP 
                 WHERE GRP_CARR_CODE     = #loginCarrier#))                                          
               </isNotEmpty>
            </isEmpty>
            <isNotEmpty property="strSpec" prepend="AND" >
                  mastSpec.code = #strSpec#
            </isNotEmpty>
            <!-- Added for CR14091102. Sanket 13OCT14  -->
              <isNotEmpty property="strIdleDays">
                and (Sysdate - A.ENTRY_TIME) >= #strIdleDays#  
              </isNotEmpty>  
              
             <isEqual prepend="AND" property="lddImp" compareValue="Y">
                  AB.catalog in ('IG', 'IS', 'IU')
             </isEqual>
             <isEqual prepend="AND" property="lddTsm" compareValue="Y">
                 AB.catalog in ('TM')
             </isEqual>
             <isEqual prepend="AND" property="lddTs" compareValue="Y">
                  AB.catalog in ('TG')
             </isEqual>
             <isEqual prepend="AND" property="lddExp" compareValue="Y">
                  AB.catalog in ('EG', 'ES', 'EO')
             </isEqual>
             <isEqual prepend="AND" property="lddOther" compareValue="Y">
                 AB.catalog not in  ('TG', 'TM', 'EG','ES','EO','IG','IS','IU')
             </isEqual>
                        
              <dynamic prepend="ORDER BY ">
                 <isNotEmpty property="sortOrder.sortField">
                   $sortOrder.sortField$
                 </isNotEmpty>
              </dynamic>)
              where rank=1
</select>

<select id="sqlULDLocQueryCOUNT" resultClass="java.lang.Integer" parameterClass="cargo.cms.uld.bo.ULDEnquiryByLocationSearchBO">	
	select COUNT(*) as totalRowCount    
             from
               (                  
               select flightDate,strPPKInd,flightKey,strULDKey,strULDNo,strDmgInd,strContourCode,strLocation,uldGroup,strFltType,emptyFlag,strULDFlow,
			strStorageDate,strSpec,strEmptyFlag,strReserveInd,strEICFlag,strRemarks,strStatus,strCarrierId,strOwnerCode,strULDkeyContr,strULDState,
			awb_no,awb_type,empWtDiff
			from (select TO_CHAR(A.Flt_date,'DDMONYY') flightDate,decode(A.PPK_IND,'Y','Y',decode(A.MIX_PPK_IND,'Y','Y',DECODE(A.HANDLING_MODE,'PPK','Y','N'))) strPPKInd,A.FLT_KEY flightKey,A.ULD_KEY strULDKey, A.ULD_NO strULDNo,A.DAM_IND strDmgInd, A.CONTR_CODE strContourCode,B.CODE strLocation, type.ULD_GROUP uldGroup,A.flt_type strFltType, A.empty_flg emptyFlag,
               decode(A.uld_flow, 'I', 'Imp') || decode(A.uld_flow, 'E', 'Exp') || decode(A.uld_flow, 'T', 'Trf')AS  strULDFlow,
                     TO_CHAR(A.STRG_DATE,'DDMONYY HH24:MI') strStorageDate, mastSpec.code strSpec,
                    A.EMPTY_IND strEmptyFlag,
                    (case when (UPPER(A.CFM_STATUS)  = UPPER('RESERVED') and Resv_flg='Y' ) then 
					    'Y'
					    else
					    'N'
					    end) strReserveInd,
                     A.EIC_FLG strEICFlag,A.GEN_RMK strRemarks,   
                     A.CFM_STATUS strStatus,A.ULD_CARR strCarrierId, A.OWNER_ID strOwnerCode,
					decode(A.ULD_KEY,null,decode(A.CONTR_CODE,null,' ','/'||A.CONTR_CODE),A.ULD_KEY || decode(A.CONTR_CODE,null,' ','/'||A.CONTR_CODE))  AS strULDkeyContr,
					codedtl.CODE_DESC as strULDState,
					awb_inventory.AWB_NO||DECODE(nvl(awbcount,1),1,'','+')  awb_no,
				   CASE WHEN nvl(awbcount,0)>0 THEN
		              CASE WHEN (SELECT COUNT(1) FROM AWB Z,AWB_INVENTORY Y
		              WHERE Z.AWB_NO=Y.AWB_NO
		              AND Z.AWB_DATE=Y.AWB_DATE
		              AND Y.ULD_KEY=A.ULD_KEY
		              AND Z.CATALOG IN ('EG', 'ES', 'EO'))=nvl(awbcount,0) THEN
		              'Export'
		              WHEN (SELECT COUNT(1) FROM AWB Z,AWB_INVENTORY Y
		              WHERE Z.AWB_NO=Y.AWB_NO
		              AND Z.AWB_DATE=Y.AWB_DATE
		              AND Y.ULD_KEY=A.ULD_KEY
		              AND Z.CATALOG IN ('TG'))=nvl(awbcount,0) then
		              'T/S'
		              WHEN (SELECT COUNT(1) FROM AWB Z,AWB_INVENTORY Y
		              WHERE Z.AWB_NO=Y.AWB_NO
		              AND Z.AWB_DATE=Y.AWB_DATE
		              AND Y.ULD_KEY=A.ULD_KEY
		              AND Z.CATALOG IN ('IG', 'IS', 'IU'))=nvl(awbcount,0) then
		              'Import'
		              WHEN (SELECT COUNT(1) FROM AWB Z,AWB_INVENTORY Y
		              WHERE Z.AWB_NO=Y.AWB_NO
		              AND Z.AWB_DATE=Y.AWB_DATE
		              AND Y.ULD_KEY=A.ULD_KEY
		              AND Z.CATALOG IN ('TM'))=nvl(awbcount,0) then
		              'TSM'
		              else
		              'MIX'
		              end
		          ELSE ''
		          END AWB_TYPE,
				  CASE WHEN (A.EMPTY_FLG='Y' AND NVL(A.REF_WT,0) !=0) THEN
				    TRIM(TO_CHAR(A.REF_WT - A.TARE_WEIGHT))
				    ELSE
				    ''
				    END empWtDiff,
				   dense_rank() over (partition BY a.uld_key order by awb_inventory.cr_date,awb_inventory.awb_no) rank
            from
                  (SELECT 
                        decode(CFM_STATUS,'RCLBULK','N','RCLMIXPREPACK','N','RCLPREPACK','N','UNCONFIRMED','',A.EMPTY_FLG ) EMPTY_IND,
                        (select FUN_GET_ULD_STATE(A.ULD_KEY) from DUAL) state, 
                        A.*  FROM ULD_INVENTORY A) A 
                        
                        LEFT OUTER JOIN (select uld_key,count(1) awbcount from awb_inventory group by uld_key) AI
						ON AI.ULD_KEY = A.uld_key
						LEFT OUTER JOIN awb_inventory awb_inventory
						ON awb_inventory.ULD_KEY = A.uld_key
						LEFT OUTER JOIN awb AB
						ON AB.awb_no    = awb_inventory.awb_no
						AND awb_inventory.awb_date = AB.awb_date                        
                        Left Outer Join Mast_Uld_Type muldtype on muldtype.code = A.uld_type
                        LEFT OUTER JOIN mast_code_dtl codedtl ON codedtl.CODE = A.STATE AND codedtl.code_TYPE = 'ULD_STATE' 
                        left outer join ULD_TYPE_CARR_TARE_WT wt
                        on A.uld_type = wt.uld_type and A.uld_carr = wt.uld_carr and a.uld_no BETWEEN wt.uld_no_from
                        and wt.uld_no_to left outer join mast_code_dtl mastSpec on wt.specification = mastSpec.code
                        and mastSpec.code_type = 'ULD_SPCES',                        
                        MAST_WH_LOC B, MAST_WH_GROUP grp, ULD_GROUP_TYPE type
            where A.LOC_CODE is not null AND A.LOC_CODE = B.CODE and B.wh_group = grp.wh_group AND A.ULD_TYPE = type.ULD_TYPE            
            and NVL(A.AGENT_INV, 'N') = 'N'
            <isNotEmpty property="strStatusEmpty">
            and Empty_Flg = #strStatusEmpty#
            </isNotEmpty>
            <isNotEmpty property="strStatusLoaded">
            and Empty_Flg != #strStatusLoaded#
            </isNotEmpty>
            <isNotEmpty property="strStatusReserved">
            and Resv_flg = #strStatusReserved#
            </isNotEmpty>
            <isNotEmpty property="strStatusBt">
            and bt_ind = #strStatusBt#
            </isNotEmpty>
            <isNotEmpty property="unservicable">
            and SER_IND = DECODE (NVL(#unservicable#,'N'),'N','Y','Y','N')
            </isNotEmpty>
            <!-- Bug Fix for 551 --> 
            <!--and A.AGENT_ID is null--> 
            <isNotEmpty property="strULDGroup">
                  and type.ULD_GROUP = #strULDGroup#
            </isNotEmpty>
            <isNotEmpty property="strULDType">
                  and A.ULD_TYPE = #strULDType#
            </isNotEmpty>
            <isNotEmpty property="strContourCode">
                  and A.CONTR_CODE = #strContourCode#
            </isNotEmpty>
            <isNotEmpty property="strULDState">
                  and A.state = #strULDState#
            </isNotEmpty>           
            <isNotEmpty property="strDmgInd">
                  and A.DAM_IND = #strDmgInd#
            </isNotEmpty>
            <isNotEmpty property="strInActiveDays">
                  and (Sysdate - A.Strg_Date) >= #strInActiveDays#  
                  and not exists (select uld_key from uld_mov where uld_key = A.uld_key and (sysdate - tr_date) &lt;= decode(#strInActiveDays#,null, 0,#strInActiveDays#) )
            </isNotEmpty>           
            <isEqual prepend="AND" property="strWtDiff" compareValue="Y">
                  A.EMPTY_FLG = 'Y' AND A.TARE_WEIGHT != A.REF_WT
            </isEqual>
            <iterate prepend="AND" property="arlStatus"
            open="(" close=")" conjunction="OR" >
                  $arlStatus[]$
            </iterate>              
            <isNotEmpty property="strLocn">
                  and A.LOC_CODE = #strLocn#
            </isNotEmpty>
            <isNotEmpty property="strGroup">
                  and B.WH_GROUP = #strGroup#
            </isNotEmpty>
            <isNotEmpty property="strArea">
                  and grp.WH_AREA = #strArea#
            </isNotEmpty>
            <isNotEmpty property="strCarrierId" prepend="AND" >
                  A.ULD_CARR = #strCarrierId#
            </isNotEmpty>
            <isNotEmpty property="strOwner" prepend="AND" >
                  A.OWNER_ID = #strOwner#
            </isNotEmpty>
            <isEmpty property="strOwner">
               <isNotEmpty property="loginCarrier">
                 AND   (A.OWNER_ID = #loginCarrier#
                 OR A.OWNER_ID IN (SELECT CARR_CODE FROM MAST_CARR_GRP 
                 WHERE GRP_CARR_CODE     = #loginCarrier#))                                          
               </isNotEmpty>
            </isEmpty>
            <isNotEmpty property="strSpec" prepend="AND" >
                  mastSpec.code = #strSpec#
            </isNotEmpty>
            <!-- Added for CR14091102. Sanket 13OCT14  -->
              <isNotEmpty property="strIdleDays">
                and (Sysdate - A.ENTRY_TIME) >= #strIdleDays#  
              </isNotEmpty>  
              
             <isEqual prepend="AND" property="lddImp" compareValue="Y">
                  AB.catalog in ('IG', 'IS', 'IU')
             </isEqual>
             <isEqual prepend="AND" property="lddTsm" compareValue="Y">
                 AB.catalog in ('TM')
             </isEqual>
             <isEqual prepend="AND" property="lddTs" compareValue="Y">
                  AB.catalog in ('TG')
             </isEqual>
             <isEqual prepend="AND" property="lddExp" compareValue="Y">
                  AB.catalog in ('EG', 'ES', 'EO')
             </isEqual>
             <isEqual prepend="AND" property="lddOther" compareValue="Y">
                 AB.catalog not in  ('TG', 'TM', 'EG','ES','EO','IG','IS','IU')
             </isEqual>
             )
              where rank=1
             
         )  	
</select>
	<select id="fetchStrArea"  parameterClass="cargo.cms.uld.bo.ULDEnquiryByLocationSearchBO" resultClass="java.lang.Integer">
	<![CDATA[
		select count(1) from MAST_WH_AREA where wh_area like #strArea#
	]]>
	</select>
	<select id="fetchStrGroup"  parameterClass="cargo.cms.uld.bo.ULDEnquiryByLocationSearchBO" resultClass="java.lang.Integer">
	<![CDATA[
		select count(1) from MAST_WH_GROUP where wh_group like #strGroup#
	]]>
	</select>
	<select id="fetchStrLocn"  parameterClass="cargo.cms.uld.bo.ULDEnquiryByLocationSearchBO" resultClass="java.lang.Integer">
	<![CDATA[
		select count(1) from MAST_WH_LOC where code like #strLocn#
	]]>
	</select>
	<select id="checkValidStrCarrierCode"  parameterClass="cargo.cms.uld.bo.ULDEnquiryByLocationSearchBO" resultClass="java.lang.Integer">
      <![CDATA[
                  SELECT COUNT(*) as count FROM MAST_CARRIER WHERE OWNED_CARR = 'Y' and CODE = #strCarrierId# 
            ]]>
      </select>
      <select id="checkValidOwner"  parameterClass="cargo.cms.uld.bo.ULDEnquiryByLocationSearchBO" resultClass="java.lang.Integer">
      <![CDATA[
                  SELECT COUNT(*) as count FROM MAST_CARRIER WHERE OWNED_CARR = 'Y' and CODE = #strOwner# 
            ]]>
      </select>	
      <select id="getNestingIDDetails"  parameterClass="java.lang.String" resultClass="java.lang.String">
      <![CDATA[
                  SELECT rt.container_no FROM EDI_RESDIT_TAG_DTL rt WHERE rt.NESTING_ID = #PARAM# AND ROWNUM = 1 
            ]]>
      </select>	
<!-- SQL FOR ULD Allotment Starts-->

<select id="sqlULDAllotmentMasterQuery"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.ULDMasterBO">
	select ULD_ALLOT codeValue,PLT_CNT pltCnt,PLT_CNT oldPltCnt,
	'R' crudStatus,TO_CHAR(LM_DATE , 'DDMMYY HH24:MI:SS') AS lastModifiedDate  
	from MAST_ULD_ALLOT 
</select>
<select id="sqlULDGroupMasterQuery"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.ULDMasterBO">
	select a.ULD_GROUP codeValue, b.PLT_CNT_SIZE accessorySize,b.PLT_CNT_SIZE oldAccessorySize, 			
			NVL(c.cntValue,0) cntSubTypes,'R' crudStatus,TO_CHAR(a.LM_DATE , 'DDMMYY HH24:MI:SS')AS lastModifiedDate,TO_CHAR(b.LM_DATE , 'DDMMYY HH24:MI:SS')AS lastModDateUpdate 
                  from MAST_ULD_ALLOT_GROUP a 
					join MAST_ULD_GROUP b on a.ULD_GROUP = b.ULD_GROUP 
					left join (Select ULD_GROUP, count(1) cntValue from ULD_GROUP_TYPE group by ULD_GROUP) c on a.ULD_GROUP = c.ULD_GROUP
		            where ULD_ALLOT=#PARAM#
		            order by a.ULD_GROUP
</select>

<select id="sqlULDTypeMasterQuery"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.ULDMasterBO">
	select a.ULD_TYPE codeValue,count(b.CONTR_CODE) cntSubTypes,'R' crudStatus,TO_CHAR(a.LM_DATE , 'DDMMYY HH24:MI:SS') AS lastModifiedDate  
		from ULD_GROUP_TYPE a left join ULD_TYPE_CONTR b on a.ULD_TYPE=b.ULD_TYPE
	where ULD_GROUP=#PARAM#
		GROUP By a.ULD_TYPE,a.LM_DATE order by a.ULD_TYPE
</select>
<select id="sqlULDContourMasterQuery"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.ULDMasterBO">
	select CONTR_CODE codeValue,DECK deck, 'R' crudStatus,TO_CHAR(LM_DATE , 'DDMMYY HH24:MI:SS') AS lastModifiedDate from ULD_TYPE_CONTR where ULD_TYPE=#PARAM#
</select>
<select id="sqlULDTypesMasterAdditionCodesQuery"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.ULDMasterBO">
	select CODE codeValue, 'R' crudStatus from MAST_ULD_TYPE
		where CODE not in (select ULD_TYPE codeValue  from ULD_GROUP_TYPE)
</select>
<select id="sqlULDGroupsMasterAdditionCodesQuery"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.ULDMasterBO">
	select ULD_GROUP codeValue, 'R' crudStatus from MAST_ULD_GROUP
		where ULD_GROUP not in (select ULD_GROUP codeValue  from MAST_ULD_ALLOT_GROUP )
</select>
<select id="sqlULDContoursMasterAdditionCodesQuery"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.ULDMasterBO">
	select CODE codeValue, 'R' crudStatus from MAST_CONTR_IND
		where CODE not in (select CONTR_CODE codeValue  from ULD_TYPE_CONTR where ULD_TYPE=#PARAM#)
</select>
<insert id="sqlInsertULDTypeMasterQuery"  parameterClass="map" >
	insert into ULD_GROUP_TYPE 
	(ULD_GROUP,ULD_TYPE,CR_USER_ID,CR_DATE,LM_USER_ID,LM_DATE)
	values(#uldgroup#,#uldtype#,#userId#,sysdate,#userId#,sysdate)
</insert>


<insert id="sqlInsertULDGroupMasterQuery"  parameterClass="map" >
	insert into MAST_ULD_ALLOT_GROUP 
	(ULD_GROUP,ULD_ALLOT,CR_USER_ID,CR_DATE,LM_USER_ID,LM_DATE)
	values(#uldgroup#,#uldallot#,#userId#,sysdate,#userId#,sysdate)
</insert>
<!--added by Surendra GOllapalli on 1st June 2010 START -->
<!--  This is Query for display the Code Desc for Pallet or Container START -->
<select id="sqlULDGroupsPltCntCodeDescQuery"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.ULDMasterBO">
	select ULD_ALLOT codeValue,PLT_CNT pltCnt, t2.Code_desc pltCntDesc, 'R' crudStatus  from MAST_ULD_ALLOT t1
left join mast_code_dtl t2 on t2.code_type = 'PLT_CNT' and t1.PLT_CNT = t2.Code
</select>
<!--   This is Query for display the Code Desc for Pallet or Container END -->
<update id="sqlUpdateULDAllotement"  parameterClass="cargo.cms.uld.bo.ULDMasterBO" >
	update MAST_ULD_ALLOT set PLT_CNT = #pltCnt# , LM_DATE=SYSDATE
	where ULD_ALLOT = #codeValue# and to_char(LM_DATE, 'ddMMYY hh24:mi:ss') = #lastModifiedDate# 	
</update>

<update id="sqlUpdateULDAllotementGroup"  parameterClass="cargo.cms.uld.bo.ULDMasterBO" >
	update MAST_ULD_GROUP set PLT_CNT_SIZE = #accessorySize#, 	LM_DATE=SYSDATE
	where ULD_GROUP = #codeValue# and to_char(LM_DATE, 'ddMMYY hh24:mi:ss') = #lastModDateUpdate#	
</update>



<update id="sqlUpdateULDAllotementGroupSize"  parameterClass="cargo.cms.uld.bo.ULDMasterBO" >
	update MAST_ULD_GROUP set PLT_CNT_SIZE = #accessorySize#
	where ULD_GROUP = #codeValue# 	
</update>



<!-- <update id="sqlDeleteULDGroupMasterQueryMaster"  parameterClass="cargo.cms.uld.bo.ULDMasterBO" >
	update MAST_ULD_GROUP set INCL_INV_EST_YN= nvl(#inclInvEstYN#,'N')
	where ULD_GROUP = #codeDesc# 
</update>
 --><update id="sqlUpdateULDContourCode"  parameterClass="cargo.cms.uld.bo.ULDMasterBO" >
	update ULD_TYPE_CONTR set DECK = #deck#,LM_DATE=SYSDATE
	where CONTR_CODE = #codeValue# and to_char(LM_DATE, 'ddMMYY hh24:mi:ss') = #lastModifiedDate# 	
</update>
<!--added by Surendra GOllapalli on 1st June 2010 END -->

<insert id="sqlInsertULDContourCodesMasterQuery"  parameterClass="map" >
	insert into ULD_TYPE_CONTR  
	(ULD_TYPE,DECK,CONTR_CODE,CR_USER_ID,CR_DATE,LM_USER_ID,LM_DATE)
	values(#uldtype#,#deck#,#uldcontor#,#userId#,sysdate,#userId#,sysdate)
</insert>


	<delete id="sqlDeleteULDTypeMasterQuery"  parameterClass="cargo.cms.uld.bo.ULDMasterBO" >
		delete ULD_GROUP_TYPE where ULD_GROUP = #codeValue# and ULD_TYPE = #codeDesc# and to_char(LM_DATE, 'ddMMYY hh24:mi:ss') = #lastModifiedDate# 
	</delete>
	<delete id="sqlDeleteULDGroupMasterQuery"  parameterClass="cargo.cms.uld.bo.ULDMasterBO" >
		delete  MAST_ULD_ALLOT_GROUP where ULD_ALLOT = #codeValue# and ULD_GROUP = #codeDesc# and to_char(LM_DATE, 'ddMMYY hh24:mi:ss') = #lastModifiedDate#
	</delete>
	<delete id="sqlDeleteULDContoursMasterQuery"  parameterClass="cargo.cms.uld.bo.ULDMasterBO" >
		delete ULD_TYPE_CONTR  where ULD_TYPE = #codeValue# and CONTR_CODE = #codeDesc# and to_char(LM_DATE, 'ddMMYY hh24:mi:ss') = #lastModifiedDate#
	</delete>




<!-- SQL FOR ULD Allotment Ends -->

<!-- VALIDATOR FOR THE ULDKEY-->
<parameterMap id="hmULDValidator" class="map" >
		<parameter property="RESULT" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
		<parameter property="ULDKEY" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="IN"/>
		<parameter property="ULDTYPE" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
		<parameter property="ULDNO" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
		<parameter property="CARRIERID" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
	</parameterMap>
	<procedure id="validateuldtest" parameterMap="hmULDValidator" >
		{? = call PKG_VALIDATE.VALIDATE_ULD(?,?,?,?) }
	</procedure>
	
	<select id="getULDKey"  parameterClass="cargo.cms.uld.bo.ULDEnquireByMovementSearchBO" resultClass="java.lang.Integer">
		<![CDATA[
			select count(1) from ULD_INVENTORY where ULD_KEY =#strULDNo#
		]]>
	</select>
	
<!-- VALIDATOR FOR THE ULDKEY-->
<!-- VALIDATOR FOR THE WH LOC -->
<parameterMap id="whlocmap" class="map" >
		<parameter property="RESULT" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
		<parameter property="WHLOC" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="IN"/>
		<parameter property="SPLCOD" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="IN"/>
	</parameterMap>
	<procedure id="validatewhloc" parameterMap="whlocmap" >
		{? = call FUN_VALIDATE_WHLOC(?,?) }
	</procedure>
<!-- VALIDATOR FOR THE WH LOC -->
<!-- VALIDATOR FOR THE WH && LOC -->
<parameterMap id="whlocmap" class="map" >
		<parameter property="RESULT" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
		<parameter property="WHCOD" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="IN"/>
		<parameter property="LOCCOD" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="IN"/>
	</parameterMap>
	<procedure id="validatewhloccode" parameterMap="whlocmap" >
		{? = call PKG_VALIDATE.VALIDATE_WH_LOCCODE(?,?) }
	</procedure>
<!-- VALIDATOR FOR THE WH && LOC -->
<!-- ULD Image insertion -->
	<insert id="sqlinsertuldtmpimage" parameterClass="cargo.cms.uld.bo.ULDImageBO" >
			INSERT INTO ULD_IMAGE_TMP(ULD_IMAGE_NAME,ULD_TYPE,
								  ULD_NO, ULD_CARR, ULD_KEY, 
							  ULD_IMAGE)
			VALUES (#fileName#,#uldType#,#uldNo#,
			   #uldCarr#,#uldKey#,#fileData#)	
	</insert>
	
	<insert id="sqlinsertuldupdimage" parameterClass="cargo.cms.uld.bo.ULDImageBO" >
			INSERT INTO ULD_IMAGE(ULD_IMAGE_NAME,ULD_TYPE,
								  ULD_NO, ULD_CARR, ULD_KEY, 
							  ULD_IMAGE)
			VALUES (#fileName#,#uldType#,#uldNo#,
			   #uldCarr#,#uldKey#,#fileData#)	
	</insert>
	
	<resultMap id="uldimgmap" class="cargo.cms.uld.bo.ULDImageBO">
		<result property="uldType" column="ULD_TYPE"/>
		<result property="uldNo" column="ULD_NO"/>
		<result property="uldCarr" column="ULD_CARR"/>
		<result property="uldKey" column="ULD_KEY"/>
		<result property="fileName" column="ULD_IMAGE_NAME"/>
		<result property="fileData" column="ULD_IMAGE"/>
	</resultMap>

	<select id="sqlgetuldimage"  parameterClass="cargo.cms.uld.bo.ULDImageBO" resultMap="uldimgmap">
		SELECT  ULD_TYPE,
				ULD_NO,
				ULD_CARR,
				ULD_KEY,
				ULD_IMAGE_NAME,
				ULD_IMAGE
		FROM ULD_IMAGE WHERE ULD_KEY =#uldKey#
	</select>
	
	<select id="sqlimagelistinvokeupload"  parameterClass="cargo.cms.uld.bo.ULDImageBO" resultMap="uldimgmap">
		SELECT  ULD_TYPE,
				ULD_NO,
				ULD_CARR,
				ULD_KEY,
				ULD_IMAGE_NAME,
				ULD_IMAGE
		FROM ULD_IMAGE_TMP WHERE ULD_KEY =#uldKey#
	</select>
	
	<select id="checkImageNametmp" resultClass="java.lang.Integer" parameterClass="cargo.cms.uld.bo.ULDImageBO">
	SELECT count(1) 
		FROM ULD_IMAGE_TMP WHERE ULD_KEY =#uldKey# AND ULD_IMAGE_NAME = #fileName#	
	</select>
	<select id="checkImageNameupd" resultClass="java.lang.Integer" parameterClass="cargo.cms.uld.bo.ULDImageBO">
	SELECT count(1) 
		FROM ULD_IMAGE WHERE ULD_KEY =#uldKey# AND ULD_IMAGE_NAME = #fileName#	
	</select>
	
	<select id="checkUldKey"  resultClass="java.lang.Integer" parameterClass="cargo.cms.uld.bo.ULDImageBO">
	SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY =#uldKey# 	
	</select>
	
	<delete id="sqluldtmpimagedel" parameterClass="cargo.cms.uld.bo.ULDImageBO" >
		DELETE ULD_IMAGE_TMP WHERE ULD_KEY =#uldKey# AND ULD_IMAGE_NAME = #fileName#
	</delete>
	
	<delete id="sqluldimagedelete" parameterClass="cargo.cms.uld.bo.ULDImageBO" >
		DELETE ULD_IMAGE WHERE ULD_KEY =#uldKey# AND ULD_IMAGE_NAME = #fileName#
	</delete>
	
	<insert id="sqlinsertuldimage" parameterClass="map" >
			insert into ULD_IMAGE (ULD_TYPE,
				ULD_NO,
				ULD_CARR,
				ULD_KEY,
				ULD_IMAGE_NAME,ULD_IMAGE)			
				values(
				#uld_type#,
				#uld_key#,
				#uld_carr#,
				#uld_key#,
				#transactionId#,
				null)		   
	</insert>


	<!--<resultMap id="uldimgmap" class="cargo.cms.uld.bo.ULDImageBO">
		<result property="uldType" column="ULD_TYPE"/>
		<result property="uldNo" column="ULD_NO"/>
		<result property="uldCarr" column="ULD_CARR"/>
		<result property="uldKey" column="ULD_KEY"/>
		<result property="fileName" column="ULD_IMAGE_NAME"/>
		<result property="fileData" column="ULD_IMAGE"/>
	</resultMap>

		<select id="sqlgetuldimage"  parameterClass="cargo.cms.uld.bo.ULDImageBO"  
						resultMap="uldimgmap">
		SELECT  ULD_TYPE AS ,
				ULD_NO AS ,
				ULD_CARR ,
				ULD_KEY ,
				ULD_IMAGE_NAME,
				ULD_IMAGE
		FROM ULD_IMAGE WHERE ULD_KEY =#uldKey#
	</select>-->
	<delete id="sqluldimagedel" parameterClass="map" >
		DELETE ULD_IMAGE_TMP WHERE ULD_KEY =#uld_key# 
	</delete>
<!-- ULD image insertion -->
	<!-- ULD Rem Log Starts -->
	<!-- Onsite Changed on 26 May 2006 by mayank Starts here -->
	<select id="sqlRemarksListQuery" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.UldRemarkBO">
		select TO_CHAR(a.CR_DATE,'DDMONYY HH24:MI') remDate,a.CR_USER_ID userId,a.ULD_RMK remark,b.EVENT_DESC strTRType
			from ULD_RMK a left join Register_Tr_No_Events b on a.EVENT_ID = b.EVENT_ID 
		where ULD_KEY = #PARAM#
	</select>
	<!-- ULD Rem Log Ends -->
	<!-- Enquire Event Starts -->
	<select id="sqlEventDetailEU" resultClass="cargo.cms.uld.bo.EventDetailBO" parameterClass="cargo.cms.uld.bo.SearchEventBO" >
		select 
			a.MOV_TO strWarehouseDest,'' strLocation ,a.EIC_ISS strEIC ,a.EMPTY_ISS strEmpty,
			TO_CHAR(a.RTRV_DATE,'DDMONYY HH24:MI') strRetrieveDate,TO_CHAR(a.STRG_DATE,'DDMONYY HH24:MI') strStorageDate,
			a.FLT_TYPE strFlightType , a.FLT_KEY strFlightKey, a.FLT_NO strFlightNo,TO_CHAR(a.FLT_DATE,'DDMONYY') strFlightDate ,a.CONTR_CCODE strContrCode,
			PKG_COMMON.GET_FLT_ATA(a.FLT_KEY,TO_CHAR(a.FLT_DATE,'DDMONYY'),DECODE(a.FLT_TYPE,'I','A','E','D'),'DD') as strATA,
			'' strCondInd,
			a.OWNER_ID strOwnerCode,a.MOV_FROM strSource,a.MOV_TO strDestination,a.TRANS_CARR strIssueCarr,a.RECV_CARR strRecieveCarr,
			DECODE(a.EVENT_ID,'RC',a.TR_NO,'') strRCLNo,
			DECODE(a.EVENT_ID,'UR',a.TR_NO,'') strEIRNo,
			DECODE(a.EVENT_ID,'LU',a.TR_NO,'ALU',a.TR_NO,'DLUC',a.TR_NO,'PLUC',a.TR_NO,'VLUC',a.TR_NO,'') strLUCNo,
			DECODE(a.EVENT_ID,'ALU',a.TR_NO,'') strALUCNo, 
			DECODE(a.EVENT_ID,'VLUC',a.TR_NO,'') strVLUCNo, 
			DECODE(a.EVENT_ID,'DLUC',a.TR_NO,'') strDLUCNo,
			DECODE(a.EVENT_ID,'PLUC',a.TR_NO,'') strPLUCNo, 
			d.CODE_DESC strEIRAgentName,a.DAM_RMK strDamageRem,a.RMK strGenRem,
			a.RMV_RMK strRemoveRem, a.RESV_RMK strReserveRem,		
			DECODE(a.EVENT_ID,'PLUC',a.RMK,'') strPostLUCRem,
			TO_CHAR(a.CR_DATE,'DDMONYY HH24:MI') strMovementDate
		from ULD_MOV a 
		left join ULD_ISS_HD c on a.TR_NO = c.EIR_NO 
		left join CUST_COMPANY d on d.code = c.AGENT_CUST_NO
		join Register_Tr_No_Events b on a.EVENT_ID = b.EVENT_ID 
		join ULD_INVENTORY e on e.ULD_KEY = a.ULD_KEY
		where 
		a.ULD_KEY = #strULDKey#
		and (a.EVENT_ID = #strEventType# or a.TR_TYPE = #strEventType#)
		and TO_CHAR(a.TR_DATE,'DDMONYY') = #strEventDate# 
		and TO_CHAR(a.CR_DATE,'DDMONYY HH24:MI') = #strTRDate#
		and a.tr_no = #trNo#
	</select>
	
	<!-- Onsite Changed on 26 May 2006 by mayank Starts here -->
	<!-- Enquire Event Ends -->
	<!-- AWB validations Starts -->
	<select  id="getCarrierForAwb" parameterClass="map" resultClass="java.lang.String">
		SELECT CARR_CODE 
		FROM MAST_AWB_PREFIX
		WHERE CODE = #awbPrefix# and def_yn = 'Y'
	</select>
	<parameterMap id="hmAWBValidator" class="map" >
		<parameter property="RESULT" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
		<parameter property="AWBNO" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="IN"/>
		<parameter property="CARRCODE" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="IN"/>
		<parameter property="DUMMYIND" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="IN"/>
		</parameterMap>
	<procedure id="validateawbno" parameterMap="hmAWBValidator" >
		{? = call FUN_VALIDATE_AWB(?,?,?) }
	</procedure>
	<!-- AWB validations Ends -->
	<!-- CITY CODE VALIDATION STARTS -->
	<select id="importValidator_cityCode_validation" parameterClass="map"
		resultClass="java.lang.Integer">
		SELECT count(1)
		FROM MAST_CITY
		WHERE CODE = #cityCode#
	</select>	
	<!-- CITY CODE VALIDATION ENDS -->
	
	<!-- SPL CODE VALIDATION STARTS -->
	<select id="importValidator_splCode_validation" parameterClass="map"
		resultClass="java.lang.Integer">
		SELECT count(1)
		FROM MAST_SPL_HAND_CODE
		WHERE CODE = #code#
	</select>	
	<!-- SPL CODE VALIDATION ENDS -->
	
	<!-- if count = 0 then error msg = No record Found For Entered {0} SRF No. -->
	<select id="srfcount" parameterClass="java.lang.String"	resultClass="java.lang.Integer">
		<![CDATA[
		select count(1) from IMP_SRF where srf_no = #srfNo#
		]]>
	</select>	
	<!-- if count = 0 then error msg = No record Found For Entered {0} SRF No. -->
	
	<!-- if count = 0 then error msg = SRF Already Posted. -->
	<select id="postsrfcount" parameterClass="java.lang.String"	resultClass="java.lang.Integer">
		<![CDATA[
		select count(1) from IMP_SRF where post_date is null and post_time is null and post_user is null and srf_no = #srfNo#
		]]>
	</select>	
	<!-- if count = 0 then error msg = SRF Already Posted. -->
	
	<!-- if count = 0 then error msg = SRF Already Void. -->
	<select id="voidsrfcount" parameterClass="java.lang.String"	resultClass="java.lang.Integer">
		<![CDATA[
		select count(1) from IMP_SRF where void_date is null and void_user is null and srf_no = #srfNo#
		]]>
	</select>	
	<!-- if count = 0 then error msg = SRF Already Void. -->
	
	<!-- if count grater 0 then erro msg = SRF is Expired. -->
	<select id="expiredsrfcount" parameterClass="java.lang.String"	resultClass="java.lang.Integer">
		<![CDATA[
		select count(1) from IMP_SRF where SRF_EXPY_DATE <= sysdate  and srf_no = #srfNo# AND STATUS = 'ISSUED'
		]]>
	</select>	
		
	<select id="expiredsrfcountCDP" parameterClass="java.lang.String"	resultClass="java.lang.Integer">
		<![CDATA[
			select count(1) from IMP_SRF srf where  srf_no = #srfNo# 
			 AND ( (STATUS ='ISSUED' and sysdate < srf_expy_date) OR 
					EXISTS (SELECT NULL FROM imp_srf_awb_inventory where srf_no = srf.srf_no and dlv_pcs > 0) )
		]]>
	</select>
	
	<!-- if count = 0 then erro msg = SRF is Expired. -->
	
	<!-- if count = 0 then erro msg = Cargo Delivery is not Complete. -->
	<select id="cargodeliverysrfcount" parameterClass="java.lang.String"	resultClass="java.lang.Integer">
		<![CDATA[
		select count(1) from IMP_SRF_AWB_INVENTORY where DLV_IND='Y' and srf_no = #srfNo#
		]]>
	</select>	
	<!-- if count = 0 then erro msg = Cargo Delivery is not Complete. -->
	
	<!-- if count != 0 then erro msg = Outstanding charges exist.  -->
	<select id="outstandingsrfcount" parameterClass="java.lang.String"	resultClass="java.lang.Integer">
		<![CDATA[
		SELECT COUNT(1) 
		FROM BILL_CHARGE_DTL b 
		JOIN IMP_SRF s ON 
			(UPPER(B.STATUS) = 'PENDING' AND b.NET_AMT>0) AND 
			b.AWB_NO = s.AWB_NO AND 
			B.SRF_NO = S.SRF_NO AND 
			B.SRF_NO = #PARAM#
		]]>
	</select>	
	<!-- if count != 0 then erro msg = Outstanding charges exist.  -->
	
	<!-- if count = 0, CC Code has been changed -->
	 <select id="isCCCodeChangedForSrf" parameterClass="java.lang.String"    resultClass="java.lang.Integer">
	        SELECT  COUNT(1)
	        FROM IMP_SRF_FLT A
	        LEFT JOIN V_CST_IMP_CC_CODE_AWB B ON  B.FLT_KEY=A.ORIG_FLT_KEY AND B.FLT_DATE=A.ORIG_FLT_DATE AND B.AWB_NO=A.AWB_NO 
	        WHERE A.SRF_NO=#srfNo# AND (nvl(B.CC_CODE,'*') = nvl(A.CC_CODE,'*') or nvl(B.CC_CODE,'NC') = 'NC')
	</select>
	<!-- if count = 0, CC Code has been changed -->
	
	<!-- if count != 0 then erro msg = Cannot Void As CDIF is Created.  -->
	<select id="existcdifsrfcount" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		<![CDATA[
		select count(1) from IMP_CDIF where srf_no = #srfNo#
		]]>
	</select>	
	<!-- if count != 0 then erro msg = Cannot Void As CDIF is Created. -->

	<!-- if count != 0 then erro msg = SRF Already Captured. or Cargo Office Arrival Time is Capture.  -->
	<select id="alreadycapsrfcount" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		<![CDATA[
		select count(1) from IMP_SRF where OFF_ARR_DATE is not null  and srf_no = #srfNo# 
		]]>
	</select>	
	<!-- if count != 0 then erro msg = SRF Already Captured. -->
	
	
	<!-- if count != 0 then erro msg = SRF first cargo release time Already Captured.  -->
	<select id="firstcargoarrdatecount" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		<![CDATA[
		select count(1) from IMP_SRF where FIRST_CG_ARR_DATE is not null  and srf_no = #srfNo# 
		]]>
	</select>	
	<!-- if count != 0 then erro msg = SRF  first cargo release time  Already Captured. -->
	
	
	<!-- if count != 0 then erro msg = SRF last cargo release time Already Captured.  -->
	<select id="lastcargoarrdatecount" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		<![CDATA[
		select count(1) from IMP_SRF where LAST_CG_ARR_DATE is not null  and srf_no = #srfNo# 
		]]>
	</select>	
	<!-- if count != 0 then erro msg = SRF  last cargo release time  Already Captured. -->	
	
	
	
	
	

	<!-- if count > 0 then error msg: Constraint Code is changed.  -->
	<select id="constraintcodechanged" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		<![CDATA[
		select NVL(count(1) , 0) 
		from Imp_SRF_Flt s 
		join Imp_SRF srf on srf.SRF_No = s.SRF_No
		join Imp_CAR_AWB c on s.AWB_No = c.AWB_No 
		where s.CC_Code != c.CC_Code and srf.Status = 'ISSUED' and SRF_EXPY_DATE >= sysdate
		and s.SRF_No = #srfNo#
		]]>
	</select>	
	<!-- if count > 0 then error msg: Constraint Code is changed. -->
	
	<!-- ULD common rules standard validation starts -->	
			
	<select id="getuldforcommonuldrulevalidations" parameterClass="java.lang.String"	
			 resultClass="cargo.cms.common.bo.StdUldBO">
		SELECT 
			ULD_KEY as uldKey, 
			NVL(AGENT_INV,'N') as agentInv,
			CFM_STATUS as cfmStatus,
			NVL(RESV_FLG,'N') as resvFLG,
			NVL(EIC_FLG,'N') as eicFLG,
			NVL(EMPTY_FLG,'Y') as emptyFLG,
			NVL(BASE_PAL_FLG,'N') as basePalFLG,
			BASE_PLT as basePlt,
			to_char(FLT_DATE,'DDMONYY') as fltDate,
			FLT_KEY as fltKey,
			DAM_IND as condnCode,
			OWNED_INV as ownedInv,
			LOC_CODe as locCode,
			ASV_INV as asvInv,
			EIC_TYPE as eicType,
			ULD_FLOW as uldFlow,
			SER_IND as serInd,
			FLt_TYPE fltType 
		FROM ULD_INVENTORY
		WHERE UPPER(ULD_KEY) = UPPER(#uldKey#) 	
	</select>	
	<!-- ULD common rules standard validation ends -->	

	<select id="sqlcheckownercodecommon"  parameterClass="java.lang.String"  resultClass="java.lang.String">
			SELECT count(1) FROM MAST_CARRIER where CODE = #code# and OWNED_CARR = 'Y' 	   
	</select>

	<select id="sqlcheckownercodeaatowned"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
			SELECT count(1) FROM MAST_CARRIER where CODE = #code#  AND OWNED_CARR = 'Y' 	   
	 </select>

	<!-- Validate LSP is exist and whdest and loc along with lsp in lsp inventory starts -->
	<select id="getwhdestandloccodewithlspno" parameterClass="java.lang.String"	
			 resultClass="cargo.cms.common.bo.StdUldBO">
		SELECT 
			 LOC_CODE as locCode 
		FROM LSP_INVENTORY 
		
		WHERE LSP_NO = #lspNo#
	</select>	

	<select id="getwhdestandloccodewithuldno" parameterClass="java.lang.String"	
			 resultClass="cargo.cms.common.bo.StdUldBO">
		SELECT 
		 LOC_CODE as locCode 
		FROM ULD_INVENTORY 
		
		WHERE ULD_KEY = #uldKey#
	</select>	

	<!-- Validate LSP is exist and whdest and loc along with lsp in lsp inventory ends -->	

	<!-- AWB Image starts -->
	<insert id="sqlinsertawbimage" parameterClass="cargo.cms.uld.bo.AwbImageBO" >
			insert into IMP_CAR_AWB_DMG_IMG 
					(AWB_NO, AWB_DATE, FLT_KEY,
					 FLT_DATE, IMG_NAME, IMG,
					 CR_USER_ID, CR_DATE, LM_USER_ID, LM_DATE)
			values(#awbNo#, to_date(#awbDate#, 'DDMONYY'), #fltKey#,
					to_date(#fltDate#,'DDMONYY'), #fileName# , #fileData#,	
					#userId#, SYSDATE, #userId#, SYSDATE)
	</insert>

	<select id="sqlgetawbimage"  parameterClass="cargo.cms.uld.bo.AwbImageBO" 
		resultClass="cargo.cms.uld.bo.AwbImageBO">

		SELECT  
				AWB_NO as awbNo,
				to_char(AWB_DATE,'DDMONYY') as awbDate,
				FLT_KEY as fltKey,
				to_char(FLT_DATE, 'DDMONYY') as fltDate, 
				IMG_NAME as fileName, 
				IMG	as fileData	
		FROM IMP_CAR_AWB_DMG_IMG 
		WHERE 
			AWB_NO = #awbNo# AND
			AWB_DATE = to_date(#awbDate#, 'DDMONYY') AND
			FLT_KEY = #fltKey# AND
			FLT_DATE = to_date(#fltDate#, 'DDMONYY')
	</select>

	<delete id="sqlawbimagedelete" parameterClass="cargo.cms.uld.bo.AwbImageBO" >
		DELETE IMP_CAR_AWB_DMG_IMG WHERE 
			AWB_NO = #awbNo# AND
			AWB_DATE = to_date(#awbDate#, 'DDMONYY') AND
			FLT_KEY = #fltKey# AND
			FLT_DATE = to_date(#fltDate#, 'DDMONYY') AND
			IMG_NAME = #fileName#
	</delete>

	<!-- AWB Image ends -->
	<!-- awb standard validation starts -->
<select id="getAwbStatus" parameterClass="cargo.cms.common.bo.StdAwbBO"	
			 resultClass="cargo.cms.common.bo.StdAwbBO">
	SELECT NVL(LOCKED_YN,'N') AS lockIndicator, NVL(MISSING_YN,'N') AS missingIndicator FROM AWB WHERE AWB_NO=#awbNo# AND AWB_CLOSED_YN='N' AND ROWNUM ='1'
</select>
<!-- added by kishore on 10AUG06 for getting aatprinterlist -->
<select id="aatPrinterList"  parameterClass="map" resultClass="cargo.cms.afw.bo.MasterBO">
   SELECT CODE AS codeId, CODE_DESC AS codeDesc FROM MAST_PRT_DTL WHERE PRT_TYPE=#PRTTYPE#
 </select>
<!-- aatprinterlist query end --> 
<!-- awb standard validation ends -->	
<select id="getTerminalNo" parameterClass="java.lang.String" resultClass="java.lang.String">	
	select TML_CODE  from MAST_WH_LOC where CODE = #whdestcode#
</select>
<!-- <select id="getGovtYN" parameterClass="java.lang.String" resultClass="java.lang.String">	
	SELECT GOVT_YN FROM SEC_USER where CODE = #userId#
</select> -->
<select id="sqlDateComparison" parameterClass="java.lang.String" resultClass="java.lang.Double">
		SELECT TO_DATE(#passDate#,'DDMONYY HH24:MI') - TO_DATE(TO_CHAR(SYSDATE,'DDMONYY HH24:MI'),'DDMONYY HH24:MI') FROM DUAL
</select>
<select id="sqlTimeComparison" parameterClass="java.lang.String" resultClass="java.lang.Double">
		SELECT TO_DATE(#passTime#,'HH24:MI') - TO_DATE(TO_CHAR(SYSDATE,'HH24:MI'),'HH24:MI') FROM DUAL
</select>

<!-- if count greater than 0 then erro msg = EIR is Expired. -->
<select id="expiredeircount" parameterClass="java.lang.String"	resultClass="java.lang.Integer">
	<![CDATA[
	select count(1) from ULD_ISS_HD where EIR_EXPIRY_DATE <= sysdate  and EIR_NO = #eirNo# 
	]]>
</select>

<select id="eirExpiryDate" parameterClass="map" resultClass="java.lang.String">
	select TO_CHAR(EIR_EXPIRY_DATE,'DDMONYY HH24:MI') expiryDate from ULD_ISS_HD 
	<dynamic prepend="WHERE" >
			<isNotEmpty property="eirNo" prepend="AND" >
				EIR_NO = #eirNo#
			</isNotEmpty>
			<isNotEmpty property="issNo" prepend="AND" >
				ISS_NO = #issNo#
			</isNotEmpty>
	</dynamic>	
</select>

<select id="Imp_Eir_ruleCode"  parameterClass="java.lang.String"  resultClass="java.lang.String">	
	select RULE_VALUE FROM CMSRULES WHERE RULE_CODE =  #ruleCode#
</select>

<select id="spliteirlist" parameterClass="cargo.cms.uld.bo.ULDRequestBO" resultClass="cargo.cms.uld.bo.ULDRequestBO">	 	
<![CDATA[
	SELECT a.TR_NO AS trNo, a.ISS_NO AS issNo, a.EIR_NO AS eirNo, 
	to_char(a.EIR_DATE,'DDMONYY HH24:MI') AS eirDate, 
	a.CARR_CODE AS carrCode , b.ULD_GROUP AS uldGroup ,    b.ULD_TYPE AS uldType ,
	b.ULD_REQ_QTY AS iuldQty ,  b.EQUIP_TYPE as accessoryType, b.EQUIP_REQ_QTY AS iaccQty ,    
	a.EIR_NO AS eirNo, a.CR_USER_ID AS crUserId , to_char(a.CR_DATE, 'DDMONYY hh24:mi') AS crDate, 
	to_char(a.LM_DATE, 'ddMMYY hh24:mi') AS lmDate, a.ISS_RMK AS reqRem, a.TR_STATUS as trStatus ,     
	b.DOC_LINE_NO AS docLineNo,	a.status as status , c.CODE_DESC AS agentIdName, c.CODE as agentName,
	a.EXTENDED_YN AS extendEirFlag    
	FROM ULD_ISS_HD a LEFT JOIN CUST_COMPANY c ON a.AGENT_CUST_NO = c.CODE  , ULD_ISS_DTL b     
	where a.TR_NO = b.TR_NO AND a.ISS_NO = b.ISS_NO 
	and EIR_EXPIRY_DATE >= sysdate and Upper(a.STATUS) = 'PROCESSED'	
	]]>
	
	<isNotEmpty property="carrCode"> AND a.CARR_CODE = Upper(#carrCode#) </isNotEmpty>		 
	<isNotEmpty property="agentName"> AND c.CODE = #agentName#</isNotEmpty>
	<isNotEmpty property="coIataCode"> AND c.CO_IATA_CODE = #coIataCode#</isNotEmpty>
	<isNotEmpty property="agentIdName"> AND UPPER(c.CODE_DESC) = UPPER(#agentIdName#)</isNotEmpty>	 
	Order By a.EIR_DATE
	
</select>

<update id="sqlupdateuldrequestprocess" parameterClass="cargo.cms.uld.bo.ULDRequestBO" >
	UPDATE ULD_ISS_HD SET CARR_CODE = #carrCode# , REQ_BY_CARR = #requestByFlag#, FLT_NO = #fltNo# , FLT_DATE = #fltDate# ,   EIR_NO = #eirNo# , AGENT_CUST_NO = #agentName# ,STP_EFAX = #emailFaxStop# , LM_DATE = SYSDATE , LM_USER_ID = #lmUserId#,
	STATUS = UPPER(#status#), TR_STATUS = #trStatus# , EIR_EXPIRY_DATE = SYSDATE + #extendEirHrs#/24 , 	EIR_DATE = SYSDATE , EIR_TIME = TO_CHAR(SYSDATE,'HH24MISS') , ISS_RMK = #reqRem#
	WHERE TR_NO = #trNo# AND ISS_NO = #issNo# 
</update>

<select id="postandtransferdatecomparison" parameterClass="map" resultClass="java.lang.Double">
		SELECT TO_DATE(#postDateTime#,'DDMONYY HH24:MI')  - TO_DATE(#transferDateTime#,'DDMONYY HH24:MI')  FROM DUAL		
</select>		

<select id="eir_uld_req_qty" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		Select  NVL(SUM(ULD_REQ_QTY),0) from uld_iss_dtl 
		where (ULD_EQUIP is not null or ULD_GROUP is not null) and  eir_no = #eirNo# 
</select>

<select id="eir_equip_req_qty" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		Select  NVL(SUM(EQUIP_REQ_QTY),0) from uld_iss_dtl where EQUIP_TYPE is not null   and  eir_no = #eirNo# 
</select>

<select id="release_eir_uld_req_qty" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from uld_rel_dtl where ULD_KEY is not null and eir_no = #eirNo#
</select>

<select id="release_eir_equip_req_qty" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select  NVL(SUM(EQUIP_QTY),0) from uld_rel_dtl where EQUIP_TYPE is not null and eir_no = #eirNo#
</select>

<select id="aatcheckuldcarrier" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT count(1) FROM MAST_CARRIER WHERE CODE=#PARAM# AND OWNED_CARR = 'Y'
</select>
	
<select id="sqlcheckvalidfileextension" parameterClass="java.lang.String" resultClass="java.lang.String">
	SELECT count(1) FROM MAST_CODE_DTL WHERE CODE_TYPE = 'FILE_EXT' AND upper(CODE) = upper(#param#)
</select>

<select id="uldKeyExist" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT count(1) FROM ULD_INVENTORY WHERE ULD_KEY = #PARAM# 
</select>

<select id="uld_accept_Emt_OtherValues" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.ULDBO">
	select u.uld_key as suldNumber ,c.code_desc as sAgentId , iss.eir_no  as sEIRNumber, 
	TO_CHAR(iss.eir_date,'DDMONYY HH24:MI') as sEIRDate, u.LM_USER_ID as sStaffId
	from uld_inventory u
	join (select uld_key, max(tr_no) tr_no from uld_rel_dtl where status = 'RELEASED' group by uld_key) r on r.uld_key = u.uld_key
	join uld_rel_hd rel on rel.tr_no = r.tr_no
	join uld_iss_hd iss on iss.eir_no = rel.eir_no
	join cust_company c on c.code = iss.agent_cust_no
	where u.CFM_STATUS = 'RELEASED' and u.agent_inv = 'Y'
	and u.uld_key = #suldNumber#
</select>

<!-- VALIDATOR FOR THE LSP KEY-->
<parameterMap id="hmLSPValidator" class="map" >
		<parameter property="RESULT" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
		<parameter property="LSPNO" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="IN"/>
		<parameter property="LOCCODE" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="IN"/>
	</parameterMap>
	<procedure id="validatelsp" parameterMap="hmLSPValidator" >
		{? = call PKG_VALIDATE.VALIDATE_LSP(?,?) }
	</procedure>
<!-- VALIDATOR FOR THE LSP KEY-->

<select id="uld_check_truck_ban" parameterClass="java.lang.String" resultClass="java.lang.Integer">			
	<![CDATA[
	select count(1) 
	from int_truck_ban_log 
	where TRUCK_NO = #truckNo# 
	and PERIOD_FROM <= to_char(sysdate, 'DDMONYY') 
	and PERIOD_TO >= to_char(sysdate, 'DDMONYY') 
	]]>
</select>

<select id="release_eir_muld_list" parameterClass="cargo.cms.uld.bo.ULDRequestBO" 
			resultClass="cargo.cms.uld.bo.ULDTypeBO">
SELECT  A.AGENT_CUST_NO as custNo ,B.ISS_NO as issNo , NVL(B.ULD_GROUP,B.ULD_TYPE) as uldGroupType, 
SUM(B.ULD_REQ_QTY) as iqty FROM ULD_ISS_DTL B, ULD_ISS_HD A 
WHERE B.ULD_EQUIP  IN ('G','T') AND A.ISS_NO = B.ISS_NO 
AND A.EIR_NO = #eirNo#
GROUP BY A.AGENT_CUST_NO , B.ISS_NO, NVL(ULD_GROUP,ULD_TYPE)

</select>

<select id="release_eir_email_list" parameterClass="java.lang.String" 
			resultClass="cargo.cms.uld.bo.GenerateScmBO">
SELECT 
		EMAIL1 AS emailAddress1 ,EMAIL2 AS emailAddress2 , 
		EMAIL3 AS emailAddress3 , EMAIL4 AS emailAddress4 , 
		EMAIL5 AS emailAddress5 ,
		FAX1 AS faxNumber1 ,FAX2 AS faxNumber2 ,
		FAX3 AS faxNumber3 , FAX4 AS faxNumber4 , FAX5 AS faxNumber5 
		FROM CUST_CONTACT WHERE CONTACT_TYPE = 'EIR' AND CUST_NO = #PARAM#

</select>

<parameterMap id="ACCMAP" class="map" >	
	<parameter property="CARRCODE" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="OUT"/>
	<parameter property="ULDKEY" jdbcType="VARCHAR"	javaType="java.lang.String"	mode="IN"/>
</parameterMap>

<procedure id="getCarrierCodeForULD" parameterMap="ACCMAP" >
	{ ? = call FUN_GET_ULD_OWNER(?)}
</procedure>

 <select id="dls_finalise"  parameterClass="map"  resultClass="java.lang.Integer">
	SELECT NVL(count(1),0)FROM FLT_OPR_EVENTS WHERE FLT_KEY  = upper(#flightKey#) AND 
	SCH_DATE =  TO_DATE( #flightDate#, 'DDMONYY') AND FLT_TYPE = 'D' AND DLS_FINAL_DATE is not null
</select>

<select id="uld_checkULDImportShipment"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
	select count(1) from awb_inventory where uld_key = #uldKey#
</select>  
<!-- Updated for fixing 12529. Sanket 12SEP14 -->
<select id="getOnloadCarrierForULD"  parameterClass="map"  resultClass="java.lang.Integer">
	select count(1) from uld_inventory where uld_key = UPPER(#uldKey#) 
<isNotEmpty prepend="AND" property="loginCarrier">
	(OWNER_ID = #loginCarrier#
	OR
	ULD_CARR = #loginCarrier#
	OR 
	ULD_CARR IN (SELECT CARR_CODE FROM MAST_CARR_GRP 
	WHERE GRP_CARR_CODE	= #loginCarrier#))
</isNotEmpty>
</select>  
<select id="getOnloadCarrierForEIR"  parameterClass="map"  resultClass="java.lang.Integer">
	select count(1) from uld_iss_hd where eir_no = #eirNo# and CARR_CODE = #loginCarrier#
</select>  

<select id="getOnloadCustomerForEIR"  parameterClass="map"  resultClass="java.lang.Integer">
	select count(1) from uld_iss_hd where eir_no = #eirNo# and AGENT_CUST_NO = #loginCustNo#
</select>  
<!-- Updated by Arun on 23-6-10 -->
<select id="selectRecordList3" parameterClass="cargo.cms.uld.bo.LucBO" resultClass="cargo.cms.uld.bo.LucBO">
select A.LUC_NO AS lucNumber , A.OUT_CARR_CODE As isueCarr , A.IN_CARR_CODE As recCarr, decode(A.LUC_STAT,
	'I', 'Issued', 'V', 'Void', 'P', 'Posted') AS status,to_CHAR(A.TRANS_DATE, 'DDMONYY') AS transferDate ,
	TO_CHAR(A.TRANS_DATE, 'hh24:mi') AS transferTime,  A.TRANS_USER_ID AS transUser,to_CHAR(A.TR_POST_DATE, 'DDMONYY') AS postDate, 
	TO_CHAR(A.TR_POST_DATE, 'hh24:mi') AS postTime, A.TR_POST_USER_ID AS postUser, to_char(A.LM_DATE, 'ddMMYY hh24:mi') AS lmDate , 
	A.CR_USER_ID AS crUserId ,  to_char(A.TR_POST_DATE, 'ddMONyy hh24:mi') AS postDateTime ,
	A.TR_POST_USER_ID AS postUser, A.TR_POST_RMK AS postRemark 
	from luc_hd A, luc_dtl B WHERE A.LUC_NO = B.LUC_NO 
<isNotEmpty prepend="AND" property="uldNo">
			B.ULD_KEY = upper(#uldNo#) 
</isNotEmpty> 
<isNotEmpty prepend="AND" property="filterControlRecNumber">
			B.RECPT_NO = upper(#filterControlRecNumber#) 
</isNotEmpty> 
<isNotEmpty prepend="AND" property="filterUldType">
			B.ULD_TYPE = upper(#filterUldType#) 
</isNotEmpty> 
<isNotEmpty prepend="AND" property="filterOwner">
			A.OUT_CARR_CODE = upper(#filterOwner#) 
</isNotEmpty> 
<isNotEmpty prepend="AND" property="loginCarrier">
	(OUT_CARR_CODE = #loginCarrier#
	OR OUT_CARR_CODE IN (SELECT CARR_CODE FROM MAST_CARR_GRP 
	WHERE GRP_CARR_CODE	= #loginCarrier#))	 
</isNotEmpty> 
group by  A.LUC_NO  , A.OUT_CARR_CODE  , A.IN_CARR_CODE , decode(A.LUC_STAT,
      'I', 'Issued', 'V', 'Void', 'P', 'Posted') ,to_CHAR(A.TRANS_DATE, 'DDMONYY')  ,
      TO_CHAR(A.TRANS_DATE, 'hh24:mi') ,  A.TRANS_USER_ID ,to_CHAR(A.TR_POST_DATE, 'DDMONYY') , 
      TO_CHAR(A.TR_POST_DATE, 'hh24:mi') , A.TR_POST_USER_ID , to_char(A.LM_DATE, 'ddMMYY hh24:mi')  , 
      A.CR_USER_ID  ,  to_char(A.TR_POST_DATE, 'ddMONyy hh24:mi')  ,
      A.TR_POST_USER_ID , A.TR_POST_RMK  
order by 1 desc
</select>
<!-- Updated by Arun on 23-6-10 -->
<select id="selectRecordList1" parameterClass="cargo.cms.uld.bo.LucBO" resultClass="cargo.cms.uld.bo.LucBO">
	select LUC_NO AS lucNumber , OUT_CARR_CODE As isueCarr , IN_CARR_CODE As recCarr, decode(LUC_STAT,
	'I', 'Issued', 'V', 'Void', 'P', 'Posted') AS status,to_CHAR(TRANS_DATE, 'DDMONYY') AS transferDate ,
	TO_CHAR(TRANS_DATE, 'hh24:mi') AS transferTime,  TRANS_USER_ID AS transUser,to_CHAR(TR_POST_DATE, 'DDMONYY') AS postDate, 
	TO_CHAR(TR_POST_DATE, 'hh24:mi') AS postTime, TR_POST_USER_ID AS postUser, to_char(LM_DATE, 'ddMMYY hh24:mi') AS lmDate , 
	CR_USER_ID AS crUserId ,  to_char(TR_POST_DATE, 'ddMONyy hh24:mi') AS postDateTime ,
	TR_POST_USER_ID AS postUser, TR_POST_RMK AS postRemark 
	from luc_hd WHERE 1=1 AND 
	upper(LUC_NO) = #lucNumber#  
	<isNotEmpty prepend="AND" property="loginCarrier">
		upper(OUT_CARR_CODE) = #loginCarrier# 
	</isNotEmpty> 
	order by 1 desc
</select>

<select id="selectRecordList2" parameterClass="cargo.cms.uld.bo.LucBO"
		resultClass="cargo.cms.uld.bo.LucBO">
		select LUC_NO AS lucNumber , OUT_CARR_CODE As isueCarr , IN_CARR_CODE
		As recCarr,
		decode(LUC_STAT, 'I', 'Issued', 'V', 'Void', 'P', 'Posted') AS
		status,to_CHAR(TRANS_DATE, 'DDMONYY') AS transferDate ,
		TO_CHAR(TRANS_DATE, 'hh24:mi') AS transferTime, TRANS_USER_ID AS
		transUser, to_CHAR(TR_POST_DATE, 'DDMONYY') AS postDate,
		TO_CHAR(TR_POST_DATE, 'hh24:mi') AS postTime, TR_POST_USER_ID AS
		postUser, to_char(LM_DATE, 'ddMMYY hh24:mi') AS lmDate ,
		CR_USER_ID AS crUserId , to_char(TR_POST_DATE, 'ddMONyy hh24:mi') AS
		postDateTime ,TR_POST_USER_ID AS postUser,
		TR_POST_RMK AS postRemark from luc_hd
		WHERE 1=1

		<isNotEmpty prepend="AND" property="filterIssueDateFrom">
			<![CDATA[
			TRANS_DATE >= TO_DATE(#filterIssueDateFrom#, 'DDMONYY')
			]]>
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="filterIssuedDateTo">
			<![CDATA[
			TRANS_DATE < TO_DATE(#filterIssuedDateTo#, 'DDMONYY') + 1 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="isueCarr">
			OUT_CARR_CODE = #isueCarr#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="recCarr">
			IN_CARR_CODE = #recCarr#
		</isNotEmpty>
		order by 1 desc
	</select>
<select id="selectRecordList2_LoginCarr" parameterClass="cargo.cms.uld.bo.LucBO"
		resultClass="cargo.cms.uld.bo.LucBO">
		select LUC_NO AS lucNumber , OUT_CARR_CODE As isueCarr , IN_CARR_CODE
		As recCarr,
		decode(LUC_STAT, 'I', 'Issued', 'V', 'Void', 'P', 'Posted') AS
		status,to_CHAR(TRANS_DATE, 'DDMONYY') AS transferDate ,
		TO_CHAR(TRANS_DATE, 'hh24:mi') AS transferTime, TRANS_USER_ID AS
		transUser, to_CHAR(TR_POST_DATE, 'DDMONYY') AS postDate,
		TO_CHAR(TR_POST_DATE, 'hh24:mi') AS postTime, TR_POST_USER_ID AS
		postUser, to_char(LM_DATE, 'ddMMYY hh24:mi') AS lmDate ,
		CR_USER_ID AS crUserId , to_char(TR_POST_DATE, 'ddMONyy hh24:mi') AS
		postDateTime ,TR_POST_USER_ID AS postUser,
		TR_POST_RMK AS postRemark from luc_hd
		WHERE 1=1
		<isNotEmpty prepend="AND" property="filterIssueDateFrom">
			<![CDATA[
			TRANS_DATE >= TO_DATE(#filterIssueDateFrom#, 'DDMONYY')
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="filterIssuedDateTo">
			<![CDATA[
			TRANS_DATE < TO_DATE(#filterIssuedDateTo#, 'DDMONYY') + 1 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="loginCarrier">
			(IN_CARR_CODE = #loginCarrier#
					OR IN_CARR_CODE IN (SELECT CARR_CODE FROM MAST_CARR_GRP
					WHERE GRP_CARR_CODE =#loginCarrier#))
		</isNotEmpty>
		UNION
		select LUC_NO AS lucNumber , OUT_CARR_CODE As isueCarr , IN_CARR_CODE
		As recCarr,
		decode(LUC_STAT, 'I', 'Issued', 'V', 'Void', 'P', 'Posted') AS
		status,to_CHAR(TRANS_DATE, 'DDMONYY') AS transferDate ,
		TO_CHAR(TRANS_DATE, 'hh24:mi') AS transferTime, TRANS_USER_ID AS
		transUser, to_CHAR(TR_POST_DATE, 'DDMONYY') AS postDate,
		TO_CHAR(TR_POST_DATE, 'hh24:mi') AS postTime, TR_POST_USER_ID AS
		postUser, to_char(LM_DATE, 'ddMMYY hh24:mi') AS lmDate ,
		CR_USER_ID AS crUserId , to_char(TR_POST_DATE, 'ddMONyy hh24:mi') AS
		postDateTime ,TR_POST_USER_ID AS postUser,
		TR_POST_RMK AS postRemark from luc_hd
		WHERE 1=1
   		<isNotEmpty prepend="AND" property="filterIssueDateFrom">
			<![CDATA[
			TRANS_DATE >= TO_DATE(#filterIssueDateFrom#, 'DDMONYY')
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="filterIssuedDateTo">
			<![CDATA[
			TRANS_DATE < TO_DATE(#filterIssuedDateTo#, 'DDMONYY') + 1 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="loginCarrier">
			(OUT_CARR_CODE = #loginCarrier#
					OR OUT_CARR_CODE IN (SELECT CARR_CODE FROM MAST_CARR_GRP
					WHERE GRP_CARR_CODE =#loginCarrier#))
		</isNotEmpty>
		
		order by 1 desc
	</select>

<select id="ulddtlcount" parameterClass="map"	resultClass="java.lang.Integer">
	select count(1) from ULD_ISS_DTL 
	where (ULD_EQUIP = #ULDEQUIP1# OR ULD_EQUIP = #ULDEQUIP2# ) AND  Iss_NO = #ISSNO#  
	<isNotEmpty property="EIRNO">
		AND EIR_NO = #EIRNO# 
	</isNotEmpty>
</select>

<delete id="deleteulddtl" parameterClass="map" >
	DELETE ULD_ISS_DTL 
	where (ULD_EQUIP = #ULDEQUIP1# OR ULD_EQUIP = #ULDEQUIP2# ) AND  Iss_NO = #ISSNO#  
	<isNotEmpty property="EIRNO">
		AND EIR_NO = #EIRNO# 
	</isNotEmpty>
</delete>

<select id="getMaxUldDtlDocLineNo" parameterClass="cargo.cms.uld.bo.ULDRequestBO"	resultClass="java.lang.Integer">
	<![CDATA[
		 select max(doc_Line_no) from ULD_ISS_DTL 
		 WHERE TR_NO = #trNo# AND ISS_NO = #issNo# 
	]]>
</select> 

<update id="deleteULDGrpTypRequest" parameterClass="cargo.cms.uld.bo.ULDTypeBO">
	DELETE ULD_ISS_DTL 
	WHERE TR_NO = #trNo# AND ISS_NO = #issNo# AND DOC_LINE_NO = #docLineNo#
</update>


<update id="deleteACCRequest" parameterClass="cargo.cms.uld.bo.AccessoryBO" >
	DELETE ULD_ISS_DTL 
	WHERE TR_NO = #trNo# AND ISS_NO = #issNo# AND DOC_LINE_NO = #docLineNo#
</update>

<update id="exportBasePaletteForExpDlsDtl" parameterClass="cargo.cms.uld.bo.ULDEICBO">
	update exp_dls_dtl
	set eic_yn = #eicFLG#,
	contr_code = #contrCode#,
	gross_wt   = #grossWeight#, 
	tare_wt	   = #tareWeight# 
	where  flt_key = #fltKey#
	and    flt_date = to_date(#fltDate#,'DDMONYY')
	and    uld_key = #uldKey#
</update>
<update id="exportBasePaletteForExpFltUld" parameterClass="cargo.cms.uld.bo.ULDEICBO">
	update exp_flt_uld
	set eic_yn = #eicFLG#,
	contr_code = #contrCode#,
	gross_wt   = #grossWeight#,
	BUILDUP_YN  = #buildUpCmplt#, 
	<isEqual property="unloadingPtFlg" compareValue="Y">
	 UNLDG_PT = #eicUnloadingPt#,
	</isEqual> 
	tare_wt	   = #tareWeight# 
	where  flt_key = #fltKey#
	and    flt_date = to_date(#fltDate#,'DDMONYY')
	and    uld_key = #uldKey#
</update>
<insert id="exportBasePaletteForExpFltUldinsert" parameterClass="cargo.cms.uld.bo.ULDEICBO">
		insert into exp_flt_uld( 
			uld_key, 
			FLT_KEY,       
			FLT_DATE,       
			EIC_YN,
			BUILDUP_YN,        
			EMPTY_YN,
			UNLDG_PT,
			source,        
			CR_USER_ID,
			LM_USER_ID,
			CR_DATE,
			LM_DATE,
			BB_IND,
			FLT_TYPE,
			REMARKS,
			PMAN_YN,
			PPK_TYPE,
			DEL_YN,
			gross_wt,
			tare_wt,
			contr_code,
			net_wt) 
		values	
			(#uldKey#,
			#fltKey#,
			to_date(#fltDate#,'DDMONYY'),
			#eicFLG#,
			#buildUpCmplt#,
			#emptyYN#,			
			#eicUnloadingPt#,			
			'EIC',
			#lmUserId#,
			#lmUserId#,
			sysdate,
			sysdate,
			'N',
			'E',
			#remarks#,
			NVL(#pmanIndicator#,'N'),
			#ppkInd#,
			#deleteInd#,
			#grossWeight#,
			#tareWeight#,
			#contrCode#,
			(NVL(#grossWeight#,0)-NVL(#tareWeight#,0)))
	</insert>

<!-- <select id="checkLoginSubAccess" parameterClass="map"	resultClass="java.lang.String">
	select ENABLE_YN from SEC_ROLE_SUB_FUNCTION a,  SEC_USER_ROLE  b 
	where a.Role_CODE = b.Role_name and Function_code = #functionCode# and Sub_FUNCTION_CODE = #subFunctionCode#
	and b.User_ID = #userId# and ENABLE_YN = 'Y' and rownum = 1
</select> -->

<!-- for uld key  for AutoComplete -->	
 <select id="fetchUldKeysForAjax" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
 select ULD_KEY as strULDKey,CARR_CODE||FLT_NO as strFLTNO from ULD_INVENTORY where ULD_KEY like ('%'||#keySearchStr# ||'%') and ROWNUM &lt;= #maxRecFetch#      
</select>
<!-- for uld key  for AutoComplete -->	
<!-- for AWB No  for AutoComplete -->	
 <select id="fetchAWBNoForAjax" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
 select AWB_NO as awbNo from AWB where AWB_NO like ('%'||#keySearchStr# ||'%') and ROWNUM &lt;= #maxRecFetch#      
</select>
<!-- for AWB No  for AutoComplete -->		
 <select id="fetchUldKeysByFlightDateForAjax" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
 SELECT ULD_KEY AS lblCodeId FROM ULD_INVENTORY WHERE UPPER(CFM_STATUS) = 'CONFIRMED' AND ((EIC_FLG = 'Y' AND (FLT_KEY IS NULL OR FLT_TYPE = 'I')) or (FLT_TYPE = 'E' AND UPPER(CARR_CODE)=UPPER(#carrCode#) AND  UPPER(FLT_NO) = UPPER(#fltNo#) AND FLT_DATE = TO_DATE(#depDate#,'DDMONYY'))) 
 AND BASE_PLT IS NULL AND NVL(RESV_FLG, 'N') = 'N' AND ULD_KEY like ('%'||#keySearchStr# ||'%') AND ROWNUM &lt; #maxRecFetch#  ORDER BY ULD_KEY   
</select>

<select id="areaForValidate"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.LSPBO">
		SELECT WH_AREA as warehouseDestination
			FROM MAST_WH_AREA
		WHERE upper(WH_AREA) = upper(#warehouseDestination#)
</select>
<select id="groupForValidate"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.LSPBO">
		SELECT WH_GROUP as groupId
			FROM MAST_WH_GROUP
		WHERE upper(WH_GROUP) = upper(#groupId#)
</select>
<select id="locationForValidate"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.LSPBO">
		SELECT CODE as locationCode
			FROM MAST_WH_LOC
		WHERE upper(CODE) = upper(#locationCode#)
</select>

<select id="ValidateWHgroup"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		SELECT Count(1) FROM MAST_WH_GROUP WHERE upper(WH_GROUP) = upper(#groupId#)
</select>
<select id="ValidateWHlocation"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		SELECT Count(1) FROM MAST_WH_LOC WHERE upper(CODE) = upper(#locationCode#)
</select>
<select id="validatenewLocn"  parameterClass="java.util.HashMap"  resultClass="java.lang.Integer">
		SELECT Count(1) FROM MAST_WH_LOC WHERE upper(CODE) = upper(#LOC_CODE#) AND upper(WH_GROUP)=upper(#GRP_CODE#)
</select>
<select id="ValidateUldKey"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		SELECT Count(1) FROM ULD_INVENTORY WHERE upper(ULD_KEY) = upper(#uldKey#)
</select>

<select id="findGrpDescr"  parameterClass="java.util.HashMap"  resultClass="java.lang.Integer">
	select count(1) from ULD_INVENTORY where ULD_KEY=#ULD_KEY# and 
	loc_code in (select CODE from MAST_WH_LOC where WH_GROUP=#GRP_CODE#)
</select>

<select id="findLocDescr"  parameterClass="java.util.HashMap"  resultClass="java.lang.Integer">
	select count(1) from uld_inventory where ULD_KEY=#ULD_KEY# and LOC_CODE=#LOC_CODE#
</select>

<select id="findDamDescr"  parameterClass="java.util.HashMap"  resultClass="java.lang.Integer">
	select count(1) from uld_inventory where ULD_KEY=#ULD_KEY# and DAM_IND=#DAM_IND#
</select>


<select id="findEICDescr"  parameterClass="java.util.HashMap"  resultClass="java.lang.Integer">
	select count(1) from uld_inventory where ULD_KEY=#ULD_KEY# and EIC_FLG=#EIC_FLAG#
</select>

<select id="findBasePalletDescr"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
	select count(1) from uld_inventory where ULD_KEY=#ULD_KEY# and EIC_FLG='Y'and BASE_PAL_FLG='N'
</select>

<select id="findUldLoded"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
	select count(1) from uld_inventory where ULD_KEY=#ULD_KEY# and EMPTY_FLG = 'N'
</select>

<select id="findUldEmpty"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
	select count(1) from uld_inventory where ULD_KEY=#ULD_KEY# and EMPTY_FLG = 'Y'
</select>


<select id="findUldEmptyAndInInventory"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
	select count(1) from uld_inventory where ULD_KEY=#ULD_KEY# and EMPTY_FLG = 'Y' and loc_code is not null
</select>

<select id="findUldInCPCTInventory"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
	select count(1) from uld_inventory where ULD_KEY=#ULD_KEY# and loc_code is not null
</select>

 <select id="fetchULDnotFound" parameterClass="cargo.cms.uld.bo.WHDestBO" resultClass="java.util.HashMap">
		select ULD_KEY  from  uld_inventory
         WHERE  LOC_CODE=#locn#
         and empty_flg like #status# and base_plt is null 
         <iterate prepend="AND" property="arrList" open="(" close=")" conjunction="AND" >
                         uld_key != #arrList[]#
         </iterate> 
</select>

 <select id="fetchULDnotFound1" parameterClass="cargo.cms.uld.bo.WHDestBO" resultClass="java.util.HashMap">

 select ULD_KEY  from  uld_inventory
                WHERE  LOC_CODE in(select CODE from MAST_WH_LOC where WH_GROUP=#destination#) 
                and empty_flg like #status# and base_plt is null 
                <iterate prepend="AND" property="arrList" open="(" close=")" conjunction="AND" >
                                uld_key != #arrList[]#
                </iterate> 
</select>

 <select id="FetchTopPallet" parameterClass="cargo.cms.uld.bo.WHDestBO" resultClass="cargo.cms.uld.bo.WHDestBO">
			select uld_key as uldKey from uld_inventory where base_plt=#uldKey#
</select>

 <select id="checkbasepallet" parameterClass="java.lang.String" resultClass="java.lang.Integer">
			select count(1) from uld_inventory where uld_key=#uldKey# and BASE_PAL_FLG='Y'
</select>

<insert id="sqlinsertnotfound2" parameterClass="java.util.HashMap">
<![CDATA[
Insert into PHY_INV_CHECKING_HD 
(TR_NO,
GRP_CODE,
LOC_CODE,
CHK_OPT,
CR_USER_ID,
CR_DATE,
LM_USER_ID,
LM_DATE) 
values (INV_CHK_SEQ.NEXTVAL,
#GRP_CODE#,
#LOC_CODE#,
#STATUS#,
#USER_ID#,
SYSDATE,
#USER_ID#,
SYSDATE)
]]>
</insert>

<insert id="sqlinsertnotfound1" parameterClass="java.util.HashMap">
<![CDATA[
Insert into PHY_INV_CHECKING_DTL 
(TR_NO,
DOC_LINE_NO,
ULD_KEY,
DISC_CODE,
DISCR_YN,
EIC_YN,
DAM_YN,
REMARKS,
CR_USER_ID,
CR_DATE,
LM_USER_ID,
LM_DATE) values 
(INV_CHK_SEQ.CURRVAL,
#DOC_LINE_NO#,
#ULD_KEY#,
'INV_NF',
'Y',
'N',
'N',
(select CODE_DESC from mast_code_dtl where code_type = 'DISC_CODES' and Code='INV_NF'),
#USER_ID#,
SYSDATE,
#USER_ID#,
SYSDATE)
]]>
</insert>




<insert id="saveInventoryCheckhd" parameterClass="cargo.cms.uld.bo.WHDestBO">
<![CDATA[
Insert into PHY_INV_CHECKING_HD 
(TR_NO,
GRP_CODE,
LOC_CODE,
CHK_OPT,
CR_USER_ID,
CR_DATE,
LM_USER_ID,
LM_DATE) 
values (INV_CHK_SEQ.NEXTVAL,
#destination#,
#locn#,
#statusDesc#,
#userid#,
SYSDATE,
#userid#,
SYSDATE)
]]>
</insert> 

<insert id="saveInventoryCheck" parameterClass="cargo.cms.uld.bo.WHDestBO">
<![CDATA[
Insert into PHY_INV_CHECKING_DTL 
(TR_NO,
DOC_LINE_NO,
ULD_KEY,
DISC_CODE,
DISCR_YN,
EIC_YN,
DAM_YN,
REMARKS,
CR_USER_ID,
CR_DATE,
LM_USER_ID,
LM_DATE,
TR_TYPE) values 
(INV_CHK_SEQ.CURRVAL,
#doc_line_no#,
#uldKey#,
#descr_code#,
#descr_YN#,
#eicInd#,
#dmgInd#,
(select CODE_DESC from mast_code_dtl where code_type = 'DISC_CODES' and Code=#descr_code#),
#userid#,
SYSDATE,
#userid#,
SYSDATE,
#trtype#)
	]]>
</insert>



<update id="updateInventoryLoc" parameterClass="cargo.cms.uld.bo.WHDestBO">
 UPDATE ULD_INVENTORY
   SET  
	LOC_CODE = #locn#,
	 LM_USER_ID = #userid#,
     LM_DATE = sysdate
  WHERE ULD_KEY = #uldKey#  
</update>

<update id="updateTopPallet" parameterClass="cargo.cms.uld.bo.WHDestBO">
 UPDATE ULD_INVENTORY
   SET  
	LOC_CODE = #locn#,
	 LM_USER_ID = #userid#,
     LM_DATE = sysdate
  WHERE ULD_KEY in (select uld_key from uld_inventory where base_plt=#uldKey#)
</update>




<select id="sqlagentIdbyName" parameterClass="java.util.HashMap" resultClass="java.lang.String">
	<![CDATA[
			SELECT CODE FROM CUST_COMPANY WHERE upper(CODE_DESC) = upper(#agentName#)
		]]>
</select>

 <select id="fltDateTimeComparision"  parameterClass="map"  resultClass="java.lang.String">
  	 <![CDATA[		
 		SELECT TO_CHAR(TO_DATE(#endDate#,'DDMONYY') - TO_DATE(sysdate)) DAYDIFF FROM DUAL     
 	]]>
 </select>
 
 <select id="fromDateComparision"  parameterClass="java.lang.String"  resultClass="java.lang.String">
  	 <![CDATA[		
 		SELECT TO_CHAR(TO_DATE(#fromDate#,'DDMONYY') - trunc(sysdate)) DAYDIFF FROM DUAL     
 	]]>
 </select>
 
  <select id="dateTimeComparision"  parameterClass="java.lang.String"  resultClass="java.lang.String">
  	 <![CDATA[		
 		SELECT TO_CHAR(TO_DATE(#endDate#,'DDMONYY HH24') - TO_DATE(sysdate)) DAYDIFF FROM DUAL     
 	]]>
 </select>
 
 <select id="dateTimeAndSysdateComparision"  parameterClass="java.lang.String"  resultClass="java.lang.String">
  	 <![CDATA[		
 		SELECT TO_CHAR( TO_DATE(TO_CHAR(sysdate,'DDMONYY HH24:MI'),'DDMONYY HH24:MI') - TO_DATE(#endDate#,'DDMONYY HH24:MI')) DAYDIFF FROM DUAL     
 	]]>
 </select>
 
 <select id="lspForValidate"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.LSPBO">
		SELECT LSP_NO as strLSPNo
			FROM LSP_INVENTORY
		WHERE upper(LSP_NO) = upper(#strLSPNo#)
</select>


<update id="updateTopPalletwoflight" parameterClass="cargo.cms.uld.bo.ULDEICBO">
   UPDATE ULD_INVENTORY
     SET  
      BASE_PLT = #basePlt#, 
      EIC_FLG  = 'Y',
      BASE_PAL_FLG = 'N',
      LOC_CODE = #locCode#,
      EMPTY_FLG = 'Y', 
      OWNER_ID = NVL(OWNER_ID,#ownerId#),
      CFM_STATUS = 'CONFIRMED', 
      LM_USER_ID = #lmUserId#,
      LM_DATE = sysdate,

      REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
      REF_TR_TYPE = 'EI',
      REF_DOC_LINE_NO = 1,
      REF_TR_DATE = SYSDATE, 
      REF_OUT_CARR = #uldCarr#, 
      REF_TR_EVENT = #moveType#, 
      REF_RMK = #genRem#,  
      TR_TYPE = #moveType#,
      FLT_TYPE = null,
      FLT_NO = null, 
      Flt_Date = null,
      Flt_Key = null,
      CARR_CODE=null,
      EIC_TYPE=#eicType# ,
      IMP_FLT_CARR = #carrCode#,
      IMP_FLT_NO = #fltNo#, 
      IMP_Flt_Date = to_date(#fltDate#,'DDMONYY'),
      IMP_Flt_Key = #fltKey#,
      TARE_WEIGHT = NVL(#tareWeight#,0), 
	  GROSS_WEIGHT = NVL(#grossWeight#,0)     
 
    WHERE ULD_KEY = #uldKey#    

 </update>

	<select id="getTareWeightOFTOPPALEET"  parameterClass="java.lang.String" resultClass="java.lang.String">	
		SELECT TARE_WEIGHT as tareWeight from ULD_INVENTORY WHERE ULD_KEY = #uldKey# 
	</select>
		
	<select id="getGrossWeightOFTOPPALEET"  parameterClass="java.lang.String" resultClass="java.lang.String">	
		SELECT GROSS_WEIGHT as grossWeight from ULD_INVENTORY WHERE ULD_KEY = #uldKey# 
	</select>
	
<insert id="insertTopPalletwoflight" parameterClass="cargo.cms.uld.bo.ULDEICBO" >
    INSERT INTO ULD_INVENTORY(ULD_KEY,ULD_TYPE,
           ULD_NO,ULD_CARR,
           BASE_PLT, 
           LOC_CODE, 
           EIC_FLG, EMPTY_FLG, 
           BASE_PAL_FLG, DAM_IND, 
           OWNER_ID, STRG_DATE, 
           LM_USER_ID,
           LM_DATE, 
           CFM_STATUS,
          REF_TR_NO, 
          REF_TR_TYPE, 
          REF_TR_DATE, 
          REF_IN_CARR, 
          REF_OUT_CARR, 
          REF_DOC_LINE_NO, 
          REF_LOC_FROM, 
          REF_TR_EVENT, 
          REF_RMK,
          EIC_TYPE,
          ASV_INV ,
          tare_weight,
	      gross_weight,
	      TR_TYPE         
 
    )
   VALUES(
      #uldKey#, #uldType#, 
      #uldNo#,  #uldCarr#, 
      #basePlt#,
       #locCode#,
      'Y', 'Y',
      'N','SER',
      #ownerId#, sysdate,
      #userId#, sysdate,
      'CONFIRMED',
      ULD_TR_SEQ.NEXTVAL,
      'EI',
      SYSDATE,
      #carrCode#,
      null,
      1,
      #locCode#,
      #refTrEvent#,
      #genRem#,
      #eicType#,
      'N',
      #tareWeight#,
	  #grossWeight#,
	  #refTrEvent#
     ) 
 </insert>
 
 
 <!--  Added by Surendra Gollapalli on 21st June 2010 for Maintain Basic Accessory START -->
<insert id="sqlInsertULDMtnBasicAccessory" parameterClass="cargo.cms.uld.bo.MaintainBasicAccBO">
  Insert into ULD_BASIC_ACC (ULD_CARR, ULD_GROUP, ACC_TYPE, QTY, CR_USER_ID, CR_DATE, LM_USER_ID, LM_DATE) values(#carrCode#, #carrGroup#, #accessory#, #qty#, #lastUpdUser#, sysdate, #lastUpdUser#, sysdate)
</insert>
<select id="sqlULDMtnBasicAccessory" parameterClass="cargo.cms.uld.bo.MaintainBasicAccBO" resultClass="cargo.cms.uld.bo.MaintainBasicAccBO">
   select ULD_CARR as carrCode,ULD_GROUP as carrGroup,ACC_TYPE as accessory, QTY as qty, LM_USER_ID as lastUpdUser, LM_DATE as lastUpdDate,TO_CHAR(LM_DATE , 'DDMMYY HH24:MI:SS')AS lastModifiedDate from ULD_BASIC_ACC 
   WHERE ULD_CARR = #carrCode# AND ULD_GROUP = #carrGroup#
 </select>
 
 
 <select id="sqlULDMtnBasicAccessoryCopy" parameterClass="cargo.cms.uld.bo.MaintainBasicAccBO" resultClass="cargo.cms.uld.bo.MaintainBasicAccBO">
   select ULD_CARR as carrCode,ULD_GROUP as carrGroup,ACC_TYPE as accessory, QTY as qty, LM_USER_ID as lastUpdUser, LM_DATE as lastUpdDate,TO_CHAR(LM_DATE , 'DDMMYY HH24:MI:SS')AS lastModifiedDate,'copy' copyCarrier from ULD_BASIC_ACC 
   WHERE ULD_CARR = #carrierCopyFrom# AND ULD_GROUP = #carrGroup#
 </select>
 
 <delete id="sqlDeleteMtnBasicAccessory"  parameterClass="cargo.cms.uld.bo.MaintainBasicAccBO" >
  		delete  ULD_BASIC_ACC where ULD_CARR = #carrCode# and ULD_GROUP = #carrGroup# and ACC_TYPE= #accessory# and QTY = #qty# and to_char(LM_DATE, 'ddMMYY hh24:mi:ss') = #lastModifiedDate# 
 </delete>
 
 
 <select id="sqlCarrieQueryMtnBasicAccessory" parameterClass="cargo.cms.uld.bo.MaintainBasicAccBO" resultClass="cargo.cms.uld.bo.MaintainBasicAccBO">
   select distinct ULD_CARR carrCode from ULD_BASIC_ACC
  where ULD_CARR &lt;&gt; #carrCode# and ULD_GROUP = #carrGroup# 
</select>

<select id="checkAccessoryExist"  parameterClass="cargo.cms.uld.bo.MaintainBasicAccBO" resultClass="java.lang.Integer">
   <![CDATA[
    select count(1) from ULD_BASIC_ACC where ULD_CARR = #carrCode# and ULD_GROUP = #carrGroup# and ACC_TYPE = #accessory# 
   ]]>
 </select>
 
  <select id="BasicValidCarrierCodeCheck"  parameterClass="java.lang.String" resultClass="java.lang.Integer">
   <![CDATA[
    select count(1) from MAST_CARRIER where CODE = #dest#
   ]]>
 </select>
 
 <select id="BasicValidULDGrpCheck"  parameterClass="java.lang.String" resultClass="java.lang.Integer">
   <![CDATA[
    select count(1) from MAST_ULD_GROUP where ULD_GROUP = #dest#
   ]]>
 </select>
 
 <select id="checkCodeValueExist"   parameterClass="java.lang.String" resultClass="java.lang.Integer">
   <![CDATA[
    select count(1) from MAST_ULD_ALLOT_GROUP where ULD_GROUP = #dest#
   ]]>
 </select>
  <select id="checkULDTypeExist"   parameterClass="java.lang.String" resultClass="java.lang.Integer">
   <![CDATA[
    select count(1) from ULD_GROUP_TYPE where ULD_TYPE = #dest#
   ]]>
 </select>
 <select id="checkULDCONTRCodeExist"   parameterClass="java.lang.String" resultClass="java.lang.Integer">
   <![CDATA[
    select count(1) from ULD_TYPE_CONTR where CONTR_CODE = #dest#
   ]]>
 </select>
 
 
 
 
<!--  Added by Surendra Gollapalli on 21st June 2010 for Maintain Basic Accessory END -->
	<select id="awbcreatevalidatecarrier"  parameterClass="java.util.HashMap" resultClass="java.lang.String">
		SELECT count(1) FROM MAST_CARRIER WHERE UPPER(CODE) = UPPER(#CODE#)
	</select>
	<select id="validatecarrierandownedcarrieryes"  parameterClass="java.util.HashMap" resultClass="java.lang.String">
		SELECT count(1) FROM MAST_CARRIER WHERE UPPER(CODE) = UPPER(#CODE#) AND OWNED_CARR = 'Y'
	</select>
	<select id="Imp_AWB_FLT_checkFltNo"  parameterClass="map"  resultClass="java.lang.String">
	<![CDATA[
		SELECT FUN_VALIDATE_FLT_NO(#FLT_NO#) from DUAL
		]]>
   	</select>	
   		<select id="validateimportfligtwithdateandtype" parameterClass="java.util.HashMap" resultClass="java.lang.String">
		SELECT count(1) FROM FLT_OPR WHERE 
			UPPER(CARR_CODE) = UPPER(#carrCode#) AND 
			SCH_DATE = TO_DATE(#fltDate#,'DDMONYY') AND 
			UPPER(FLT_TYPE) = UPPER(#fltType#) AND UPPER(FLT_NO) = UPPER(#fltNo#)
	</select>

	<select id="checkCargoinAgtInv"  parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ASV_INVENTORY WHERE UPPER(ULD_KEY) = UPPER(#CODE#)
	</select>

	<select id="checkULDNoRange"  parameterClass="java.util.HashMap" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_TYPE_CARR_TARE_WT where UPPER(ULD_TYPE)=UPPER(#ULDTYPE#) and UPPER(ULD_CARR)=UPPER(#CARRIERID#) 
		 and UPPER(#ULDNO#) between ULD_NO_FROM and ULD_NO_TO
	</select>


<!-- ULDInventory Estimation Query Starts Here Mayank -->

	<parameterMap id="checmap" class="map" >
		<parameter property="RESULT" jdbcType="VARCHAR"	javaType="java.lang.String" mode="OUT"/>                  
		<parameter property="FLTKEY" jdbcType="VARCHAR"	javaType="java.lang.String" mode="IN"/>              
		<parameter property="FLTDATE" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>             
		<parameter property="ULDNO" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/> 
		<parameter property="AWBDATE" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
	</parameterMap>		

	<procedure id="callCheck"  parameterMap="checmap" >
		{? = call pkg_imp.fun_get_hdlg_area(?,?,?,?)}
	</procedure>

	<select id="inclInvEstAllotList" parameterClass="java.lang.String"
		resultClass="cargo.cms.uld.bo.ULDInvtryEstBO">
	<![CDATA[	
		select allotment from 
			(select distinct GROUP_LABEL as allotment from MAST_INV_EST_CARR_LABEL where carr_code = #carrCode#
      ) carrAllot where rownum <= 4
	]]>
	</select>

	<select id="getAllotGroupInvEstAllotList" parameterClass="java.lang.String"
			resultClass="cargo.cms.uld.bo.ULDInvtryEstBO">
		<![CDATA[
			select tab1.ULD_ALLOT, tab2.GROUP_LABEL
			from MAST_INV_EST_ELP_GROUP tab1,  
			(    select t1.ULD_GROUP, t1.GROUP_LABEL 
			from MAST_INV_EST_CARR_LABEL t1,
			(select GROUP_LABEL From (select distinct GROUP_LABEL  from MAST_INV_EST_CARR_LABEL where carr_code =  #carrCode#) carrAllot where rownum <= 4) t2  
			where t1.GROUP_LABEL = t2.GROUP_LABEL ) tab2  where tab1.ULD_GROUP = tab2.ULD_GROUP 
			
		]]>
	</select>

	<select id="getSysdateHHMI" parameterClass="java.lang.String"
		resultClass="java.lang.String">
	<![CDATA[	
		select to_char(round(sysdate- 1/48, 'HH'),'HH24MI') from dual
	]]>
	</select>
	<select id="getinit8HH24MIN" parameterClass="java.lang.String"
		resultClass="java.lang.String">
	<![CDATA[	
		select to_char(sysdate + 8/24,'DDMONYY') from dual
	]]>
	</select>
	<select id="getinitSysdate8HH24" parameterClass="java.lang.String"
		resultClass="java.lang.String">
	<![CDATA[	
		select to_char(sysdate + 8/24,'HH24') from dual
	]]>
	</select>

	<select id="getinitSysdate8MIN" parameterClass="java.lang.String"
		resultClass="java.lang.String">
	<![CDATA[	
		select to_char(sysdate + 8/24,'MI') from dual
	]]>
	</select>

	<select id="getHours" parameterClass="java.lang.String"
		resultClass="java.lang.String">
	<![CDATA[	
		select trunc(((86400*(round(to_date(#paramDate# , 'DDMONYY HH24MI') + 1/48 , 'HH')-sysdate))/60)/60)-24*(trunc((((86400*(round(to_date(#paramDate# , 'DDMONYY HH24MI')+ 1/48 , 'HH')-sysdate))/60)/60)/24)) + 1 hrs from dual  
	]]>
	</select>

	<select id="AvlDateTimeFlightList" parameterClass="cargo.cms.uld.bo.ULDInvtryEstBO"
		resultClass="cargo.cms.uld.bo.ULDInvtryEstBO">
<![CDATA[	
			select fltKey, fltDate, fltTime,Carr_code, to_char(avlDateTime, 'HH24MI') avltime, 
					to_char(avlDateTime, 'DDMONYY HH24MI') avlDateTime, (avlDateTime - sysdate) outStanding
					from (    select	
						round( TO_DATE(TO_CHAR(nvl(t1.act_date, t1.sch_date), 'DDMONYY')
								||' '||TO_CHAR(nvl(t1.act_time, t1.sch_time), '0000'), 'DDMONYY HH24MI') + 1/48 , 'HH') 
								+
								(nvl((select rule_value from cmsrules where rule_Code
								= decode(t1.CGO_ACFT_TYPE,'PSR','BD_ULD_AVL_PSR','FRE','BD_ULD_AVL_FRE')),0) / 24) as avlDateTime,
								t1.flt_key fltKey, TO_CHAR(nvl(t1.act_date, t1.sch_date), 'DDMONYY') fltDate,
								TO_CHAR(nvl(t1.act_time, t1.sch_time), '0000') fltTime, t1.Carr_code
							from FLT_OPR t1 , FLT_OPR_EVENTS t2 
							where t1.flt_type='A' and t1.flt_key = t2.flt_key and t1.sch_date = t2.sch_date  and t1.FLT_TYPE = t2.FLT_TYPE and t2.BRKDN_COMPL_YN = 'N' 
								and t1.CGO_ACFT_TYPE in ('PSR','FRE'))  flt_list
				where	Carr_code = #carrCode# and 
				avlDateTime	<= round(to_date(#timeUptoDate#||' '||#timeUptoTime# , 'DDMONYY HH24MI')+ 1/48, 'HH')
	]]>
	</select>

	<select id="CPM_FFM_ULD_AllotList" parameterClass="cargo.cms.uld.bo.ULDInvtryEstBO"
		resultClass="cargo.cms.uld.bo.ULDInvtryEstBO">
<![CDATA[	
	select fltKey, fltDate, fltTime, uldAllot, to_char(avlDateTime, 'HH24MI') avltime, 
					to_char(avlDateTime, 'DDMONYY HH24MI') avlDateTime, (avlDateTime - sysdate) outStanding
					from ( select  t1.flt_key fltKey, TO_CHAR(nvl(t1.act_date, t1.sch_date), 'DDMONYY') fltDate,
                TO_CHAR(nvl(t1.act_time, t1.sch_time), '0000') fltTime, t3.uld_allot uldAllot,
                round( TO_DATE(TO_CHAR(nvl(t1.act_date, t1.sch_date), 'DDMONYY')
                        ||' '||TO_CHAR(nvl(t1.act_time, t1.sch_time), '0000'), 'DDMONYY HH24MI') + 1/48 , 'HH') 
                        +
                        (nvl((select rule_value from cmsrules where rule_Code
                        = decode(t1.CGO_ACFT_TYPE,'PSR','BD_ULD_AVL_PSR','FRE','BD_ULD_AVL_FRE')),0) / 24) as avlDateTime
            from FLT_OPR t1 , FLT_OPR_EVENTS t2 , 
           (select flt_key , flt_date, uld_key , 
                      (select GROUP_LABEL from MAST_INV_EST_CARR_LABEL TAB1 ,  ULD_GROUP_TYPE TAB2
                         where TAB1.ULD_GROUP =  TAB2.ULD_GROUP 
                         and TAB1.CARR_CODE=IMP_RAMP_INB_CHK_DTL.CARR_CODE 
                         and tab2.uld_type = IMP_RAMP_INB_CHK_DTL.uld_type) as uld_allot 
                          from IMP_RAMP_INB_CHK_DTL where CPM_IND = 'Y' or FFM_IND = 'Y' )   t3
          where t1.flt_type='A' and t1.flt_key = t2.flt_key and t1.sch_date = t2.sch_date and t1.FLT_TYPE = t2.FLT_TYPE
              and t1.flt_key = t3.flt_key and t1.sch_date = t3.flt_date and t2.BRKDN_COMPL_YN = 'N' 
              and t1.CGO_ACFT_TYPE in ('PSR','FRE')
              and t1.Carr_code = #carrCode#  and 
              TO_DATE(TO_CHAR(nvl(t1.act_date, t1.sch_date), 'DDMONYY')
              ||' '||TO_CHAR(nvl(t1.act_time, t1.sch_time), '0000'), 'DDMONYY HH24MI')
              +
              (nvl((select rule_value from cmsrules where rule_Code
                = decode(t1.CGO_ACFT_TYPE,'PSR','BD_ULD_AVL_PSR','FRE','BD_ULD_AVL_FRE')),0) / 24)
              <=
             round(to_date(#timeUptoDate#||' '||#timeUptoTime# , 'DDMONYY HH24MI')+ 1/48, 'HH') ) CPMFFMlist
	]]>
	</select>

	<select id="BD_ULD_AllotList" parameterClass="cargo.cms.uld.bo.ULDInvtryEstBO"
		resultClass="cargo.cms.uld.bo.ULDInvtryEstBO">
<![CDATA[	
	select fltKey, fltDate, fltTime, uldAllot, to_char(avlDateTime, 'HH24MI') avltime, 
					to_char(avlDateTime, 'DDMONYY HH24MI') avlDateTime, (avlDateTime - sysdate) outStanding
					from ( select  t1.flt_key fltKey, TO_CHAR(nvl(t1.act_date, t1.sch_date), 'DDMONYY') fltDate,
        TO_CHAR(nvl(t1.act_time, t1.sch_time), '0000') fltTime, t3.uld_allot uldAllot,
                round( TO_DATE(TO_CHAR(nvl(t1.act_date, t1.sch_date), 'DDMONYY')
                        ||' '||TO_CHAR(nvl(t1.act_time, t1.sch_time), '0000'), 'DDMONYY HH24MI') + 1/48 , 'HH') 
                        +
                        (nvl((select rule_value from cmsrules where rule_Code
                        = decode(t1.CGO_ACFT_TYPE,'PSR','BD_ULD_AVL_PSR','FRE','BD_ULD_AVL_FRE')),0) / 24) as avlDateTime       
	from FLT_OPR t1 , FLT_OPR_EVENTS t2 , 
      (select flt_key , flt_date, uld_key , 
                 (select GROUP_LABEL from MAST_INV_EST_CARR_LABEL TAB1 ,  ULD_GROUP_TYPE TAB2
                         where TAB1.ULD_GROUP =  TAB2.ULD_GROUP 
                         and TAB1.CARR_CODE=IMP_RAMP_CHK_DTL.CARR_CODE
                         and tab2.uld_type = (substr(IMP_RAMP_CHK_DTL.uld_key,1,3))) as uld_allot 
                  from IMP_RAMP_CHK_DTL   where BRKDN_COMPL_DATE is not null)   t3,
        IMP_RAMP_INB_CHK_DTL RAMPINBCHKDTL                  
	where (RAMPINBCHKDTL.CPM_IND = 'Y' or RAMPINBCHKDTL.FFM_IND = 'Y') and t3.uld_key = RAMPINBCHKDTL.ULD_KEY  and 
		 RAMPINBCHKDTL.flt_key = t2.flt_key and RAMPINBCHKDTL.FLT_date = t2.sch_date and
		t1.flt_type='A' and t1.flt_key = t2.flt_key and t1.sch_date = t2.sch_date and t1.FLT_TYPE = t2.FLT_TYPE
      and t1.flt_key = t3.flt_key and t1.sch_date = t3.flt_date and t2.BRKDN_COMPL_YN = 'N' 
      and t1.CGO_ACFT_TYPE in ('PSR','FRE')
      and t1.Carr_code = #carrCode# and 
      TO_DATE(TO_CHAR(nvl(t1.act_date, t1.sch_date), 'DDMONYY')
      ||' '||TO_CHAR(nvl(t1.act_time, t1.sch_time), '0000'), 'DDMONYY HH24MI')
      +
      (nvl((select rule_value from cmsrules where rule_Code
        = decode(t1.CGO_ACFT_TYPE,'PSR','BD_ULD_AVL_PSR','FRE','BD_ULD_AVL_FRE')),0) / 24)
      <=
      round(to_date(#timeUptoDate#||' '||#timeUptoTime# , 'DDMONYY HH24MI')+ 1/48, 'HH') ) BDlist
	]]>
	</select>

	<select id="URF_AllotList" parameterClass="cargo.cms.uld.bo.ULDInvtryEstBO"
                resultClass="cargo.cms.uld.bo.ULDInvtryEstBO">
<![CDATA[

select carr_Code, to_char(avlDateTime, 'HH24MI') avltime,
                        to_char(avlDateTime, 'DDMONYY HH24MI') avlDateTime, (avlDateTime - sysdate) outStanding,
                        uldAllot,  nvl(orignalQty, 0) orignalQty,  relsQty, (nvl(orignalQty, 0) - nvl(relsQty, 0)) outStandingQty
                        from (
                                        select t1.Carr_code carr_Code,
                                                         (select GROUP_LABEL from MAST_INV_EST_CARR_LABEL
                                                                        where CARR_CODE=T1.CARR_CODE AND uld_group in ( t2.uld_group,
                                                                                        (select uld_group from uld_group_type where ULD_TYPE = t2.uld_type))) as uldAllot,
                                                                                        nvl(ULD_ACK_QTY,ULD_APR_QTY) orignalQty, nvl(ULD_REL_QTY, 0) relsQty,
                                                                t1.purpose,
                                                                decode(t1.purpose,'Agt', decode(t3.TIME_SLOT_DATE ,null,
                                                                                                                round(t1.EST_TIME - 1/48 , 'HH') + (nvl((select rule_value from cmsrules where rule_Code = 'URF_ULD_REQ_AGT'),0) / 24),
                                                                                                                round(to_date(to_char(t3.TIME_SLOT_DATE, 'DDMONYY') || ' ' || to_char(t3.TIME_SLOT_FROM, '0000') , 'DDMONYY HH24MI') - 1/48 , 'HH') ),
                                                                                        round(t1.EST_TIME - 1/48 , 'HH') - (nvl((select rule_value from cmsrules where rule_Code = 'URF_ULD_REQ_OTH'),0) / 24)) as avlDateTime
                                        from uld_iss_hd t1
                                        left join EIR_SCH_COLL_DTL t4 on t1.EIR_NO = t4.EIR_NO
                                        left join EIR_SCH_COLL t3 on t3.SCH_COLL_NO = t4.SCH_COLL_NO
                                        ,  uld_iss_dtl t2
                                        where t1.EIR_NO = t2.EIR_NO and t2.ULD_EQUIP = 'U' 
                                        and t1.eir_expiry_date >= sysdate
                                        and t1.status in ('APPROVED','PARTRELEASED')
                                        )URF_LIST
        where   carr_Code = #carrCode# and 
        avlDateTime     <= round(to_date(#timeUptoDate#||' '||#timeUptoTime# , 'DDMONYY HH24MI')+ 1/48, 'HH')

  ]]>
        </select>

        <select id="EndorsedURF_AllotList" parameterClass="cargo.cms.uld.bo.ULDInvtryEstBO"
                resultClass="cargo.cms.uld.bo.ULDInvtryEstBO">
<![CDATA[

select carr_Code, to_char(avlDateTime, 'HH24MI') avltime,
                        to_char(avlDateTime, 'DDMONYY HH24MI') avlDateTime, (avlDateTime - sysdate) outStanding,
                        uldAllot,  nvl(orignalQty, 0) orignalQty,  relsQty, (nvl(orignalQty, 0) - nvl(relsQty, 0)) outStandingQty
                        from (
                                        select t1.Carr_code carr_Code,
                                                         (select GROUP_LABEL from MAST_INV_EST_CARR_LABEL
                                                                        where CARR_CODE=T1.CARR_CODE AND uld_group in ( t2.uld_group,
                                                                                        (select uld_group from uld_group_type where ULD_TYPE = t2.uld_type))) as uldAllot,
                                                                                        nvl(ULD_ENDR_QTY,0) orignalQty, nvl(ULD_REL_QTY, 0) relsQty,
                                                                t1.purpose,
                                                                decode(t1.purpose,'Agt', decode(t3.TIME_SLOT_DATE ,null,
                                                                                                                round(t1.EST_TIME - 1/48 , 'HH') + (nvl((select rule_value from cmsrules where rule_Code = 'URF_ULD_REQ_AGT'),0) / 24),
                                                                                                                round(to_date(to_char(t3.TIME_SLOT_DATE, 'DDMONYY') || ' ' || to_char(t3.TIME_SLOT_FROM, '0000') , 'DDMONYY HH24MI') - 1/48 , 'HH') ),
                                                                                        round(t1.EST_TIME - 1/48 , 'HH') - (nvl((select rule_value from cmsrules where rule_Code = 'URF_ULD_REQ_OTH'),0) / 24)) as avlDateTime
                                        from uld_iss_hd t1
                                        left join EIR_SCH_COLL_DTL t4 on t1.EIR_NO = t4.EIR_NO
                                        left join EIR_SCH_COLL t3 on t3.SCH_COLL_NO = t4.SCH_COLL_NO
                                        ,  uld_iss_dtl t2
                                        where t1.EIR_NO = t2.EIR_NO and t2.ULD_EQUIP = 'U' 
                                        and t1.eir_expiry_date >= sysdate
                                        and t1.status in ('ENDORSED')
                                        )URF_LIST
        where   carr_Code = #carrCode# and 
        avlDateTime     <= round(to_date(#timeUptoDate#||' '||#timeUptoTime# , 'DDMONYY HH24MI')+ 1/48, 'HH')        
  ]]>
        </select>

	<select id="Empty_ULD_AllotList" parameterClass="cargo.cms.uld.bo.ULDInvtryEstBO"
		resultClass="cargo.cms.uld.bo.ULDInvtryEstBO">
<![CDATA[         
	select  
		(select GROUP_LABEL from MAST_INV_EST_CARR_LABEL TAB1 ,  ULD_GROUP_TYPE TAB2
          where TAB1.ULD_GROUP =  TAB2.ULD_GROUP 
          and TAB1.CARR_CODE = ULD_INVENTORY.OWNER_ID
          and tab2.uld_type = ULD_INVENTORY .uld_type) as uldAllot 
	from ULD_INVENTORY 
	where empty_flg = 'Y' and owned_inv = 'Y' and nvl(eic_type,'*') <> 'EIC' and (flt_key is null or flt_type = 'I')
	and OWNER_ID = #carrCode#
]]>
	</select>
	<select id="AVAIL_LOADED_ULD_AllotList" parameterClass="cargo.cms.uld.bo.ULDInvtryEstBO"
		resultClass="cargo.cms.uld.bo.ULDInvtryEstBO">
<![CDATA[         
	select  
		 (select GROUP_LABEL from MAST_INV_EST_CARR_LABEL TAB1 ,  ULD_GROUP_TYPE TAB2
                         where TAB1.ULD_GROUP =  TAB2.ULD_GROUP 
                         and TAB1.CARR_CODE = ULD_INVENTORY.OWNER_ID
                         and tab2.uld_type = ULD_INVENTORY .uld_type)  as uldAllot 
	from ULD_INVENTORY 
	where empty_flg = 'N' and ULD_FLOW = #fltType# 
	and OWNER_ID = #carrCode#
]]>
	</select>

	<select id="ReqDateTimeFlightList" parameterClass="cargo.cms.uld.bo.ULDInvtryEstBO"
		resultClass="cargo.cms.uld.bo.ULDInvtryEstBO">
<![CDATA[	
	select fltKey, fltDate, fltTime,Carr_code, to_char(avlDateTime, 'HH24MI') avltime, 
			to_char(avlDateTime, 'DDMONYY HH24MI') avlDateTime, (avlDateTime - sysdate) outStanding
			from (    select	
				round( TO_DATE(TO_CHAR(nvl(t1.est_date, t1.sch_date), 'DDMONYY')
						||' '||TO_CHAR(nvl(t1.est_time, t1.sch_time), '0000'), 'DDMONYY HH24MI') - 1/48 , 'HH') 
						-
						(nvl((select rule_value from cmsrules where rule_Code
						= decode(t1.CGO_ACFT_TYPE,'PSR','BU_ULD_REQ_PRS','FRE','BU_ULD_REQ_FRE')),0) / 24) as avlDateTime,
						t1.flt_key fltKey, TO_CHAR(nvl(t1.est_date, t1.sch_date), 'DDMONYY') fltDate,
						TO_CHAR(nvl(t1.est_time, t1.sch_time), '0000') fltTime, t1.Carr_code
					from FLT_OPR t1 , FLT_OPR_EVENTS t2 
					where t1.flt_type='D' and t1.flt_key = t2.flt_key and t1.sch_date = t2.sch_date  and t1.FLT_TYPE = t2.FLT_TYPE and t2.BUILDUP_CDATE is null
						and t1.CGO_ACFT_TYPE in ('PSR','FRE'))  flt_list
		where	Carr_code = #carrCode# and 
		avlDateTime	<= round(to_date(#timeUptoDate#||' '||#timeUptoTime# , 'DDMONYY HH24MI') + 1/48, 'HH')
	]]>
	</select>

	<select id="EDI_ELP_ULD_AllotList" parameterClass="cargo.cms.uld.bo.ULDInvtryEstBO"
		resultClass="cargo.cms.uld.bo.ULDInvtryEstBO">
	<![CDATA[	
    select  fltKey, TO_CHAR(to_date(fltDate, 'DDMONYY'), 'DDMONYY') fltDate, TO_CHAR(fltTime, '0000') fltTime, trNumber , 
            nvl(QTY_Q7,'0') qtyQ7, nvl(QTY_Q6,'0') qtyQ6, '0' qtyP, '0' qtyA, 
            nvl(QTY_X8,'0') qtyX8 , nvl(QTY_PEB,'0') qtyPEB,  nvl(QTY_A2,'0') qtyA2, nvl(QTY_LDC,'0') qtyLDC, nvl(QTY_H2,'0') qtyH2,
            to_char(avlDateTime, 'HH24MI') avltime, 
			to_char(avlDateTime, 'DDMONYY HH24MI') avlDateTime, (avlDateTime - sysdate) outStanding, schDate
	from (select fltKey, fltDate, fltTime, Carr_code, avlDateTime, schDate,
						(select max(tr_No) from EDI_ELP_MSG where flt_key = flt_list.fltkey and flt_date = flt_list.schDate)  trNumber 
			from (    select round( TO_DATE(TO_CHAR(nvl(t1.est_date, t1.sch_date), 'DDMONYY')
						||' '||TO_CHAR(nvl(t1.est_time, t1.sch_time), '0000'), 'DDMONYY HH24MI') - 1/48 , 'HH') 
						-
						(nvl((select rule_value from cmsrules where rule_Code
						= decode(t1.CGO_ACFT_TYPE,'PSR','BU_ULD_REQ_PRS','FRE','BU_ULD_REQ_FRE')),0) / 24) as avlDateTime,
						t1.flt_key fltKey, TO_CHAR(nvl(t1.est_date, t1.sch_date), 'DDMONYY') fltDate,TO_CHAR(t1.sch_date, 'DDMONYY') schDate,
						TO_CHAR(nvl(t1.est_time, t1.sch_time), '0000') fltTime, t1.Carr_code
					from FLT_OPR t1 , FLT_OPR_EVENTS t2 
					where t1.flt_type='D' and t1.flt_key = t2.flt_key and t1.sch_date = t2.sch_date  and t1.FLT_TYPE = t2.FLT_TYPE and t2.BUILDUP_CDATE is null
						and t1.CGO_ACFT_TYPE in ('PSR','FRE'))  flt_list
					where	Carr_code = #carrCode# and 
				avlDateTime	<= round(to_date(#timeUptoDate#||' '||#timeUptoTime# , 'DDMONYY HH24MI') + 1/48, 'HH') ) flt_allot_list
    join edi_elp_allot on edi_elp_allot.tr_no = flt_allot_list.trNumber
	]]>
	</select>

	<select id="getAllotGroupInvEstList" parameterClass="cargo.cms.uld.bo.ULDInvtryEstBO"
			resultClass="cargo.cms.uld.bo.ULDInvtryEstBO">
		<![CDATA[
			select distinct tab1.ULD_ALLOT uldAllot, tab2.GROUP_LABEL label
			from MAST_INV_EST_ELP_GROUP tab1,  
			(    select t1.ULD_GROUP, t1.GROUP_LABEL 
			from MAST_INV_EST_CARR_LABEL t1,
			(select GROUP_LABEL From (select distinct GROUP_LABEL  from MAST_INV_EST_CARR_LABEL where carr_code =  #carrCode#) carrAllot where rownum <= 4) t2  
			where t1.GROUP_LABEL = t2.GROUP_LABEL ) tab2  where tab1.ULD_GROUP = tab2.ULD_GROUP 
		]]>
	</select>

	<select id="BU_ULD_AllotList" parameterClass="cargo.cms.uld.bo.ULDInvtryEstBO"
		resultClass="cargo.cms.uld.bo.ULDInvtryEstBO">
	<![CDATA[	
    
    select  fltKey, TO_CHAR(TO_DATE(fltDate,'DDMONYY'),'DDMONYY') fltDate, TO_CHAR(fltTime, '0000') fltTime, to_char(avlDateTime, 'HH24MI') avltime, 
			to_char(avlDateTime, 'DDMONYY HH24MI') avlDateTime, (avlDateTime - sysdate) outStanding,
			(select GROUP_LABEL from MAST_INV_EST_CARR_LABEL TAB1 ,  ULD_GROUP_TYPE TAB2
                   where TAB1.ULD_GROUP =  TAB2.ULD_GROUP 
                   and TAB1.CARR_CODE= T1.Carr_code
                   and TAB2.ULD_TYPE = (SUBSTR(expuld.ULD_BT_NO,1,3))) as uldAllot,schDate
	from ( select fltKey, fltDate, fltTime, Carr_code, avlDateTime,schDate
        from (  select round( TO_DATE(TO_CHAR(nvl(t1.est_date, t1.sch_date), 'DDMONYY')
						||' '||TO_CHAR(nvl(t1.est_time, t1.sch_time), '0000'), 'DDMONYY HH24MI') - 1/48 , 'HH') 
						-
						(nvl((select rule_value from cmsrules where rule_Code
						= decode(t1.CGO_ACFT_TYPE,'PSR','BU_ULD_REQ_PRS','FRE','BU_ULD_REQ_FRE')),0) / 24) as avlDateTime,
						t1.flt_key fltKey, TO_CHAR(nvl(t1.est_date, t1.sch_date), 'DDMONYY') fltDate,TO_CHAR(t1.sch_date, 'DDMONYY') schDate,
						TO_CHAR(nvl(t1.est_time, t1.sch_time), '0000') fltTime, t1.Carr_code
					from FLT_OPR t1 , FLT_OPR_EVENTS t2 
					where t1.flt_type='D' and t1.flt_key = t2.flt_key and t1.sch_date = t2.sch_date  and t1.FLT_TYPE = t2.FLT_TYPE and t2.BUILDUP_CDATE is null
						and t1.CGO_ACFT_TYPE in ('PSR','FRE'))  flt_list
				where	Carr_code = #carrCode#  and 
				avlDateTime	<= round(to_date(#timeUptoDate#||' '||#timeUptoTime# , 'DDMONYY HH24MI') + 1/48, 'HH') ) T1
     join EXP_PMANIFEST_ULD expuld on BLDUP_COMPLETE is not null and T1.fltKey = expuld.FLT_KEY and T1.schDate = expuld.FLT_DATE    
          
	]]>
	</select>

	<select id="sqlDateTime8Hours" parameterClass="java.lang.String"
		resultClass="java.lang.Double">
<![CDATA[	
			SELECT SYSDATE + 8/24 - TO_DATE(#param#,'DDMONYY HH24:MI') FROM DUAL
    ]]>
	</select>

	<!-- ULDInventory Estimation Query Ends Here Mayank -->

<select id="sqlretrieveretrieveawbinfo" parameterClass="java.lang.String" resultClass="java.util.HashMap">
		SELECT AWB_NO,LOCN_PCS,LOCN_WT FROM AWB_INVENTORY where ULD_KEY = #PARAM#
	</select>
	 <update id="updateULDInv" parameterClass="java.util.HashMap">
         update uld_inventory
     	  set base_plt = null,
       	eic_flg = 'N',
       	eic_type=null
         where base_plt = #ULD_KEY#
 </update>

 <select id="sqlvalidatelocnuldretrieve" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	 	select count(1) from 
	 	MAST_WH_LOC t1, mast_wh_group t2 where t1.wh_group = t2.WH_GROUP and t2.wh_type = 'MHS'
    	 AND t1.CODE = #PARAM#
	</select>
<update id="updateFlightDtls" parameterClass="cargo.cms.uld.bo.ULDEICBO">
	UPDATE ULD_INVENTORY
     SET  
      LM_USER_ID = #lmUserId#,
      LM_DATE = sysdate,
      REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
      FLT_TYPE = null,
      FLT_NO = null, 
      Flt_Date = null,
      Flt_Key = null 
     WHERE ULD_KEY = #uldKey#  
</update>

 <update id="uncheckinuld" parameterClass="cargo.cms.uld.bo.ULDEICBO">
	UPDATE ULD_INVENTORY
     SET  
      LM_USER_ID = #lmUserId#,
      LM_DATE = sysdate,
      REF_TR_NO = ULD_TR_SEQ.NEXTVAL,
      FLT_TYPE = null,
      FLT_NO = null, 
      Flt_Date = null,
      Flt_Key = null,
      EIC_TYPE=null,
      EIC_FLG='N',
      OWNED_INV='N',
      BASE_PLT=null,
      LOC_CODe=null,
      CFM_STATUS ='REMOVED',
      REF_TR_EVENT = 'IEIC',
      TR_TYPE ='IEIC'
     WHERE ULD_KEY = #uldKey#  
</update>
<select id="sqlGetULDTareWeight"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.uld.bo.ULDEICBO">
		SELECT TARE_WEIGHT as tareWeight
			 FROM ULD_TYPE_CARR_TARE_WT
			  where UPPER(ULD_TYPE)=UPPER(#uldType#) and UPPER(ULD_CARR)=UPPER(#carrCode#) 
		 and UPPER(#uldNo#) between ULD_NO_FROM and ULD_NO_TO
   	</select>
   	
   	<select id="checkULDTypeForHHTBT"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		SELECT count(1) from  MAST_ULD_TYPE where CODE = #param# and (H_CONT_IND = 'Y' OR BT_IND = 'Y')
   	</select>
   	
   	<select id="sqlGetExpDlsDtlCount"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="java.lang.Integer">
		SELECT count(1) from  exp_dls_dtl where  flt_key = #fltKey#
	and    flt_date = to_date(#fltDate#,'DDMONYY')
	and    uld_key = #uldKey#
   	</select>
   	<select id="sqlGetExpFltULDCount"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="java.lang.Integer">
		SELECT count(1) from  exp_flt_uld  where  flt_key = #fltKey#
	and    flt_date = to_date(#fltDate#,'DDMONYY')
	and    uld_key = #uldKey#
   	</select>
   	<select id="sqlAssgnExpFltULDCount"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="java.lang.String">
		SELECT flt_key||'_'|| to_char(flt_date,'DDMONYY') from  exp_flt_uld  where  flt_key is not null
	and    flt_date is not null
	and    uld_key = #uldKey# and flt_key = #fltKey#
	and    flt_date = to_date(#fltDate#,'DDMONYY')
   	</select>
   	<insert id="insertexportBasePaletteForExpDlsDtl" parameterClass="cargo.cms.uld.bo.ULDEICBO">
   	    insert into exp_dls_dtl 
   	    (eic_yn,
   	    contr_code,
		gross_wt,
		tare_wt,
		LM_USER_ID,
		FLT_KEY,
		BLDUP_COMPLETE,
		SNO,
		UNLDG_PT,
		FLT_DATE,
		LM_DATE,
		ULD_KEY) VALUES
		(
		#eicFLG#,
		#contrCode#,
		#grossWeight#, 
		#tareWeight#,
		#lmUserId#,
		#fltKey#,
		#buildUpCmplt#,
		1,
		#eicUnloadingPt#,
		#fltDate#,
		sysdate,
		#uldKey#)
	</insert>
	<insert id="insertexportBasePaletteForExpFltUld" parameterClass="cargo.cms.uld.bo.ULDEICBO">
		insert into  exp_flt_uld
		(eic_yn,
   	    contr_code,
		tare_wt,
		LM_USER_ID,
		FLT_KEY,
		BUILDUP_YN ,
		UNLDG_PT,
		FLT_DATE,
		LM_DATE,
		ULD_KEY,
		FLT_TYPE,
		CR_USER_ID,
		LOC_CODE,gross_wt) VALUES
		(
		#eicFLG#,
		#contrCode#,
		#tareWeight#,
		#lmUserId#,
		#fltKey#,
		#buildUpCmplt#,
		#eicUnloadingPt#,
		#fltDate#,
		sysdate,
		#uldKey#,'D',
		#lmUserId#,
		#locCode#,#grossWeight#)
	</insert>
	<select id="sqlGetExpPreManULDCount"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="java.lang.Integer">
		SELECT count(1) from  EXP_PMANIFEST_ULD 
		where  flt_key = #fltKey#
		and    flt_date = to_date(#fltDate#,'DDMONYY')
		and    ULD_BT_NO = #uldKey#
   	</select>

	
   	<select id="sqlCheckExpPreManULDUnldgPt"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="java.lang.Integer">
		SELECT count(1) from  EXP_PMANIFEST_ULD 
		where  flt_key = #fltKey#
		and    flt_date = to_date(#fltDate#,'DDMONYY')
		and    ULD_BT_NO = #uldKey#
		and    UNLDG_PT = #eicUnloadingPt#
   	</select>
   	

   	<insert id="insertExportBasePaletteForExpPreManUld" parameterClass="cargo.cms.uld.bo.ULDEICBO">
   	    insert into EXP_PMANIFEST_ULD 
   	    (eic_yn,
   	    gross_wt,
		tare_wt,
		LM_USER_ID,
		FLT_KEY,
		BLDUP_COMPLETE,
		GROUP_NO,
		UNLDG_PT,
		FLT_DATE,
		LM_DATE,
		ULD_BT_NO,CR_USER_ID,CR_DATE,PPK_TYPE,BLDUP_COMPLETE_DATE,BLDUP_COMPLETE_USER_ID,VOL_IND,FLT_TYPE,READY_WH,BLDUP_START,BLDUP_START_DATE,BLDUP_START_USER_ID,CONTR_CODE,
		TRANSIT_FLG,HDLG_MODE) VALUES
		(
		#eicFLG#,
		#grossWeight#, 
		#tareWeight#,
		#lmUserId#,
		#fltKey#,
		#buildUpCmplt#,
		1,
		#eicUnloadingPt#,
		#fltDate#,
		sysdate,
		#uldKey#,#lmUserId#,sysdate,'B',DECODE(#buildUpCmplt#,'Y',sysdate,null),DECODE(#buildUpCmplt#,'Y',#lmUserId#,null),#volInd#,'E',DECODE(#buildUpCmplt#,'Y','Y','N'),
		DECODE(#buildUpCmplt#,'Y','Y','N'),DECODE(#buildUpCmplt#,'Y',sysdate,null),DECODE(#buildUpCmplt#,'Y',#lmUserId#,null),#contrCode#,
		(SELECT TRANSIT_FLG FROM ULD_INVENTORY WHERE ULD_KEY=#uldKey#),
		(SELECT HANDLING_MODE FROM ULD_INVENTORY WHERE ULD_KEY=#uldKey#))
	</insert>
	<update id="updateExportBasePaletteForExpPreManUld" parameterClass="cargo.cms.uld.bo.ULDEICBO">
		update EXP_PMANIFEST_ULD
		set eic_yn = #eicFLG#,
		gross_wt   = #grossWeight#, 
		tare_wt	   = #tareWeight# ,
		BLDUP_COMPLETE = #buildUpCmplt#,
		<isEqual property="unloadingPtFlg" compareValue="Y">
			UNLDG_PT = #eicUnloadingPt#,
		</isEqual>
		LM_DATE = sysdate,
		LM_USER_ID =  #lmUserId#,
		VOL_IND = #volInd#,
		CONTR_CODE = #contrCode#
		<isEqual property="buildUpCmplt" compareValue="Y">
			,BLDUP_COMPLETE_DATE = sysdate
			,BLDUP_COMPLETE_USER_ID = #lmUserId#
			,READY_WH = 'Y'
			,BLDUP_START='Y'
			,BLDUP_START_DATE = sysdate
			,BLDUP_START_USER_ID = #lmUserId# 
		</isEqual>
		<isNotEqual property="buildUpCmplt" compareValue="Y">
			,BLDUP_COMPLETE_DATE = null
			,BLDUP_COMPLETE_USER_ID = null
			,READY_WH = 'N'
			,BLDUP_START='N'
			,BLDUP_START_DATE = null
			,BLDUP_START_USER_ID = null 
		</isNotEqual>
		where  flt_key = #fltKey#
		and    flt_date = to_date(#fltDate#,'DDMONYY')
		and    ULD_BT_NO = #uldKey#
	</update>
	<select id="getRCLNo"  parameterClass="java.lang.String"  resultClass="java.lang.String">
		SELECT RCL_NO from EXP_RCL_DTL WHERE ULD_KEY=#PARAM# and rownum=1 ORDER BY CR_DATE 
	</select> 
	<select id="getSRFButtonStatus"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		select 
			COUNT(*) 
		FROM 
			AWB_INVENTORY A,
			AWB B
		WHERE 
			B.AWB_TYPE='I' AND 
			B.AWB_NO=A.AWB_NO AND
			B.AWB_DATE=A.AWB_DATE AND
			ULD_KEY =#PARAM#
	</select>
	<select id="getAwbInvCount"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		select count(1) from awb_inventory where uld_key = #uldKey#
	</select> 
	<select id="getHHTAgtHdrDetails"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.EnquireULDBO">
		SELECT ULD_KEY as strULDKey,LOC_CODE as strLocation,LOCKED as strLockStatus,TARGET as strTarget from ULD_INVENTORY WHERE ULD_KEY=#uldKey#
	</select> 
	
	<select id="sqlFetchLUCNo" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.FlightDetailsBO">
		select luc_no as strLUCNo, recpt_no as strCtrlReptNo, in_carr_code as strRecvCarr, out_carr_code as strIssueCarr 
	    	from   (select t1.luc_no, recpt_no, in_carr_code, out_carr_code
						from   luc_hd t1, luc_dtl t2
						where  t1.luc_no = t2.luc_no
						and    t2.uld_key = #PARAM# and t1.luc_stat!='V'
						order by luc_date desc)
				where  rownum = 1
	</select>
	<select id="sqlgetFltDtlsEnq" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.FlightDetailsBO">
		select decode(FLT_TYPE,'E',decode(flt_key,null,'',flt_key||'/'||TO_CHAR(flt_date,'DDMONYY')),
		decode(imp_flt_key,null,'', imp_flt_key||'/'||TO_CHAR(imp_flt_date,'DDMONYY'))) as chkFltType,  
		TRANSIT_TYPE as transitType, flt_key as flightKey,TO_CHAR(flt_date,'DDMONYY') as flightDate,flt_type as fltType,imp_flt_key as impFlightKey,        
		TO_CHAR(imp_flt_date,'DDMONYY') as impFlightDate  from uld_inventory where  uld_key = #PARAM#
	</select>
	<select id="sqlgetJODtls" parameterClass="cargo.cms.uld.bo.FlightDetailsBO"  resultClass="java.lang.String">
		select JO_NO from exp_bu_jo where GP_NO in (select GP_NO from exp_bu_gp where flt_key = #flightKey# and  TO_CHAR(flt_date,'DDMONYY')= #flightDate#) and rownum=1 
	</select>
	<select id="sqlgetETD" parameterClass="cargo.cms.uld.bo.FlightDetailsBO"  resultClass="java.lang.String">
		select DECODE(PKG_COMMON.GET_FLT_ATA(#flightKey#,#flightDate#, 'D', 'DD'),NULL,NVL(PKG_COMMON.GET_FLT_ETA(#flightKey#,#flightDate#, 'D', 'DD'),PKG_COMMON.GET_FLT_STA(#flightKey#,#flightDate#, 'D', 'DD')),PKG_COMMON.GET_FLT_ATA(#flightKey#,#flightDate#, 'D', 'DD') || '*') as etd from DUAL
	</select>
	<select id="sqlgetATA" parameterClass="cargo.cms.uld.bo.FlightDetailsBO"  resultClass="java.lang.String">
		SELECT DECODE(PKG_COMMON.GET_FLT_ATA(#fltKey#,#fltDate#, 'A', 'DD'),NULL,NVL(PKG_COMMON.GET_FLT_ETA(#fltKey#,#fltDate#, 'A', 'DD'),PKG_COMMON.GET_FLT_STA(#fltKey#,#fltDate#, 'A', 'DD')),PKG_COMMON.GET_FLT_ATA(#fltKey#,#fltDate#, 'A', 'DD') || '*') AS ata from DUAL
	</select>
	<select id="sqlgetBrkDwn" parameterClass="cargo.cms.uld.bo.FlightDetailsBO"  resultClass="java.lang.String">
		SELECT brkdn_compl_yn from imp_ramp_chk_dtl where flt_key = #fltKey# and TO_CHAR(flt_date,'DDMONYY') = #fltDate# and uld_key = #strULDKey# and rownum=1
	</select>
		<select id="validInboundFlight" parameterClass="java.util.HashMap"  resultClass="java.lang.String">
		select FLT_TYPE from FLT_OPR where FLT_KEY=#flightCarrier# and SCH_DATE=TO_DATE(#flightArrDate#,'DDMONYY')  and FLT_TYPE='A'
	</select>
	<select id="validInboundFlightBetween" parameterClass="java.util.HashMap"  resultClass="java.lang.Integer">
		select count(*) from FLT_OPR where FLT_KEY=#flightCarrier# and SCH_DATE between to_date(#fromDate#,'DDMONYY HH24MI') and to_date(#toDate#,'DDMONYY HH24MI') and FLT_TYPE='A'
	</select>
	<select id="noOfFlight" parameterClass="java.util.HashMap"  resultClass="java.lang.Integer">
		select count(*) from FLT_OPR where FLT_KEY=#fltKey# and TO_DATE(SCH_DATE,'DDMONYY HH24MI') between #fromDate# and #toDate# and FLT_TYPE='A'
	</select>
	<select id="checkRampStatus" parameterClass="java.util.HashMap"  resultClass="java.lang.Integer">
		select count(*) from FLT_OPR_EVENTS where FLT_KEY=#fltKey# and SCH_DATE between to_date(#fromDate#,'DDMONYY HH24MI') and to_date(#toDate#,'DDMONYY HH24MI') and FLT_TYPE='A' and RAMP_COMPL_YN='N'
	</select>
	<select id="validateUldType" parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		select count(1) from MAST_ULD_TYPE where CODE=#uldType#
	</select>
	
	<!-- URF -->
	<insert id="sqlInsertURFRequestHeader" parameterClass="cargo.cms.uld.bo.URFRequestBO">
		INSERT
		INTO ULD_ISS_HD
		(
		EIR_NO, EIR_DATE, EIR_TIME, CARR_CODE, REQ_BY_CARR,
		FLT_NO, FLT_DATE, URF_FLT_KEY, URF_FLT_DATE, ISS_RMK,
		EIR_RMK,
		AGENT_CUST_NO, PRT_CODE, STATUS,
		EXTENDED_YN, REPT_VER, TR_TYPE,
		TR_STATUS, CR_USER_ID, CR_DATE,
		LM_USER_ID, LM_DATE, EIR_EXPIRY_DATE,
		ORIG_EIR_NO, PURPOSE,
		ENDR_BY, ENDR_DATE, ENDR_RMK, APR_BY,
		APR_DATE,
		APR_RMK, ACK_BY, ACK_DATE,
		ACK_RMK, EST_TIME, REQ_EST_TIME,
		ENDR_EST_TIME, APR_EST_TIME, ACK_EST_TIME, TIME_SLOT_DATE,
		TIME_SLOT_FROM, TIME_SLOT_TO, SCH_RLS, VOID_RMK, SRF_NO,AIRSIDE_REL,INBOUNDTOW_REL
		)
		VALUES
		(
		#eirNo#, #eirDate#, #eirTime#,#carrCode#,#reqByCarr#,
		#fltNo#, #fltDate#, #urfFltKey#, #urfFltDate#, #issRmk#,
		#eirRmk#,#agentCustNo#, #prtCode#,#status#,
		#extendedYN#,
		#reptVer#,#trType#, #trStatus#,
		NVL(#crUserId#,'AAHK'), SYSDATE, NVL(#lmUserId#,'AAHK'),
		SYSDATE,
		TO_DATE(#eirExpiryDate#, 'DDMONYY HH24:MI'), #origEirNo#,
		#purpose#,
		#endrBy#, TO_DATE(#endrDate#, 'DDMONYY HH24:MI'), #endrRmk#, #aprBy#,
		TO_DATE(#aprDate#, 'DDMONYY HH24:MI'), #aprRmk#,#ackBy#, TO_DATE(#ackDate#, 'DDMONYY HH24:MI'),
		#ackRmk#,TO_DATE(#estTime#, 'DDMONYY HH24:MI'), TO_DATE(#reqEstTime#,'DDMONYY HH24:MI'),
		TO_DATE(#endrEstTime#, 'DDMONYY HH24:MI'),TO_DATE(#aprEstTime#, 'DDMONYY HH24:MI'),
		TO_DATE(#ackEstTime#,'DDMONYY HH24:MI'), #timeSlotDate#, #timeSlotFrom#, #timeSlotTo#,
		#schRls#,
		#voidRmk#, #srfNo#,#airsiderelease#,#inbounddirect#
		)
	</insert>
	<insert id="sqlInsertURFRequestULD" parameterClass="cargo.cms.uld.bo.URFRequestULDBO">
		INSERT
		INTO
		ULD_ISS_DTL
		(
		EIR_NO, DOC_LINE_NO, ULD_EQUIP, ULD_GROUP,
		ULD_TYPE,
		ULD_REQ_QTY, ULD_APR_QTY, ULD_REL_QTY,
		TR_TYPE, TR_STATUS, CR_USER_ID,
		CR_DATE, LM_USER_ID,
		LM_DATE, ULD_ENDR_QTY,
		ULD_ACK_QTY
		)
		VALUES
		(
		#eirNo#, #docLineNo#, #uldEquip#, #uldGroup#,
		#uldType#, #uldReqQty#, #uldAprQty#, #uldRelQty#, #trType#,
		#trStatus#, NVL(#crUserId#,'AAHK'), SYSDATE, NVL(#lmUserId#,'AAHK'),
		SYSDATE, #uldEndrQty#,
		#uldAckQty#
		)
	</insert>
	<insert id="sqlInsertURFRequestBasicAccessory" parameterClass="cargo.cms.uld.bo.URFRequestAccessoryBO">
		INSERT
		INTO
		ULD_ISS_DTL
		(
		EIR_NO, DOC_LINE_NO, ULD_EQUIP, ULD_GROUP,
		ULD_TYPE, EQUIP_TYPE, EQUIP_REQ_QTY,
		EQUIP_APR_QTY, EQUIP_REL_QTY,
		TR_TYPE, TR_STATUS,
		CR_USER_ID, CR_DATE,
		LM_USER_ID,
		LM_DATE, EQUIP_ENDR_QTY, EQUIP_ACK_QTY
		)
		VALUES
		(
		#eirNo#, #docLineNo#, #uldEquip#, #uldGroup#,
		#uldType#, #equipType#, #equipReqQty#,
		#equipAprQty#,	#equipRelQty#, #trType#,
		#trStatus#, #crUserId#, SYSDATE,
		#lmUserId#,
		SYSDATE, #equipEndrQty#, #equipAckQty#
		)	
	</insert>
	<insert id="sqlInsertURFRequestAccessory" parameterClass="cargo.cms.uld.bo.URFRequestAccessoryBO">
		INSERT
		INTO
		ULD_ISS_DTL
		(
		EIR_NO, DOC_LINE_NO, ULD_EQUIP,
		EQUIP_TYPE,
		EQUIP_REQ_QTY,
		EQUIP_APR_QTY, EQUIP_REL_QTY,
		TR_TYPE, TR_STATUS,
		CR_USER_ID, CR_DATE,
		LM_USER_ID,
		LM_DATE, EQUIP_ENDR_QTY, EQUIP_ACK_QTY
		)
		VALUES
		(
		#eirNo#,
		#docLineNo#, #uldEquip#,
		#equipType#, #equipReqQty#,
		#equipAprQty#,
		#equipRelQty#, #trType#,
		#trStatus#, #crUserId#, SYSDATE,
		#lmUserId#,
		SYSDATE, #equipEndrQty#, #equipAckQty#
		)	
	</insert>	
	<update id="sqlUpdateURFRequestHeader" parameterClass="cargo.cms.uld.bo.URFRequestBO">
		UPDATE ULD_ISS_HD
		SET
		ENDR_BY = #endrBy#, APR_BY = #aprBy#, EIR_DATE = #eirDate#,	EIR_TIME = #eirTime#,
		ENDR_DATE = TO_DATE(#endrDate#, 'DDMONYY HH24:MI'), APR_DATE = TO_DATE(#aprDate#, 'DDMONYY HH24:MI'),
		EIR_EXPIRY_DATE = TO_DATE(#eirExpiryDate#, 'DDMONYY	HH24:MI'),
		REQ_EST_TIME = TO_DATE(#reqEstTime#, 'DDMONYY HH24:MI'),
		EST_TIME = TO_DATE(#estTime#, 'DDMONYY HH24:MI'),
		ENDR_EST_TIME =	TO_DATE(#endrEstTime#, 'DDMONYY HH24:MI'),
		APR_EST_TIME = TO_DATE(#aprEstTime#, 'DDMONYY HH24:MI'),
		STATUS =#status#, ENDR_RMK = #endrRmk#, APR_RMK = #aprRmk#,
		EIR_RMK = #eirRmk#,LM_USER_ID =	#lmUserId#, LM_DATE = SYSDATE
		WHERE EIR_NO = #eirNo#
	</update>
	<select id="checkreleasedatediff"  parameterClass="cargo.cms.uld.bo.URFReleaseULDBO"  resultClass="java.lang.Integer" >
			SELECT TO_DATE(#returnDate#,'DDMONYY') - TO_DATE((SELECT TO_CHAR(REL_DATE,'DDMONYY') FROM ULD_REL_HD WHERE EIR_NO=#eirNo# AND ROWNUM=1),'DDMONYY') DAYDIFF FROM DUAL
   	</select>
	<update id="sqlUpdateURFManualRtnDtls" parameterClass="cargo.cms.uld.bo.URFReleaseULDBO">
	UPDATE ULD_REL_DTL SET MANUAL_RET_DATE=#returnDate#,MANUAL_RET_RMK=#returnRemrk# WHERE EIR_NO=#eirNo# AND ULD_KEY=#uldKey#
	</update>
	<update id="sqlUpdateURFRequestULD" parameterClass="cargo.cms.uld.bo.URFRequestULDBO">
		UPDATE ULD_ISS_DTL
		SET
		ULD_REQ_QTY = #uldReqQty#,ULD_ENDR_QTY = #uldEndrQty#,ULD_APR_QTY = #uldAprQty#,
		LM_USER_ID = #lmUserId#,LM_DATE	= SYSDATE
		WHERE EIR_NO = #eirNo# AND DOC_LINE_NO = #docLineNo#
	</update>
	<delete id="sqlDeleteURFRequestBasicAccessories" parameterClass="cargo.cms.uld.bo.URFRequestBO">
		DELETE ULD_ISS_DTL WHERE EIR_NO = #eirNo# AND ULD_EQUIP = 'B'
	</delete>	
	<update id="sqlUpdateURFRequestAccessory" parameterClass="cargo.cms.uld.bo.URFRequestAccessoryBO">
		UPDATE ULD_ISS_DTL
		SET
		EQUIP_TYPE = #equipType#,EQUIP_REQ_QTY = #equipReqQty#,
		EQUIP_ENDR_QTY = #equipEndrQty#,
		EQUIP_APR_QTY =	#equipAprQty#,LM_USER_ID = #lmUserId#,LM_DATE = SYSDATE
		WHERE EIR_NO =	#eirNo# AND DOC_LINE_NO = #docLineNo#
	</update>
	<insert id="sqlInsertURFReleaseHeader" parameterClass="cargo.cms.uld.bo.URFReleaseBO">
		INSERT
		INTO ULD_REL_HD
		(
		TR_NO, EIR_NO, REL_DATE, REL_TIME,
		TRUCK_NO, CORR_REL_FLG, PRT_VER, PRT_CODE, RMK,
		AGENT_CUST_NO, TR_TYPE, TR_STATUS,
		CR_USER_ID, CR_DATE, LM_USER_ID, LM_DATE,
		REF_ISS_NO, CARR_CODE
		)
		VALUES
		(
		#trNo#, #eirNo#, #relDate#, #relTime#,
		#truckNo#, #corrRelFlg#, #prtVer#, #prtCode#, #rmk#,
		#agentCustNo#, #trType#, #trStatus#,
		#crUserId#, SYSDATE, #lmUserId#, SYSDATE,
		#refIssNo#, #carrCode#
		)
	</insert>
	<insert id="sqlInsertURFReleaseULD" parameterClass="cargo.cms.uld.bo.URFReleaseULDBO">
		INSERT INTO
		ULD_REL_DTL
		(
		TR_TYPE_EVT,TR_NO, DOC_LINE_NO, IDOC_LINE_NO, EIR_NO,
		ULD_EQUIP, ULD_TYPE, ULD_NO, ULD_CARR, ULD_KEY,
		EQUIP_TYPE, EQUIP_QTY,
		RET_DATE, RET_USER,
		STATUS, TR_TYPE, TR_STATUS,
		CR_USER_ID, CR_DATE, LM_USER_ID, LM_DATE
		)
		VALUES
		(
		'REURF',#trNo#, #docLineNo#, #idocLineNo#, #eirNo#,
		#uldEquip#, #uldType#, #uldNo#, #uldCarr#, #uldKey#,
		#equipType#, #equipQty#,
		#retDate#, #retUser#,
		#status#, #trType#, #trStatus#,
		#crUserId#, SYSDATE, #lmUserId#, SYSDATE
		)
	</insert>
	<insert id="sqlInsertURFReleaseAccessory" parameterClass="cargo.cms.uld.bo.URFReleaseAccessoryBO">
		INSERT
		INTO ULD_REL_DTL
		(
		TR_NO, DOC_LINE_NO, IDOC_LINE_NO, EIR_NO,
		ULD_EQUIP, ULD_TYPE, ULD_NO, ULD_CARR, ULD_KEY,
		EQUIP_TYPE, EQUIP_QTY,
		RET_DATE, RET_USER,
		STATUS, TR_TYPE, TR_STATUS,
		CR_USER_ID, CR_DATE, LM_USER_ID, LM_DATE
		)
		VALUES
		(
		#trNo#, #docLineNo#, #idocLineNo#, #eirNo#,
		#uldEquip#, #uldType#, #uldNo#, #uldCarr#, #uldKey#,
		#equipType#, #equipQty#,
		#retDate#, #retUser#,
		#status#, #trType#, #trStatus#,
		#crUserId#, SYSDATE, #lmUserId#, SYSDATE
		)
	</insert>
	<insert id="sqlInsertURFULDRmk" parameterClass="cargo.cms.uld.bo.URFReleaseULDBO">
        INSERT INTO ULD_RMK
        (ULD_TYPE,ULD_NO,ULD_CARR,TR_NO,
         TR_TYPE,DOC_LINE_NO,ULD_RMK,ULD_KEY,
         CR_USER_ID,CR_DATE,LM_USER_ID,LM_DATE,
         EVENT_ID)
        VALUES
         (#uldType#,#uldNo#,#uldCarr#,#trNo#,
          #trType#,#docLineNo#, #relRmk#, #uldKey#,
          #crUserId#, SYSDATE, #lmUserId#, SYSDATE,
         'UR');
	</insert>
	<update id="sqlUpdateRelURFULDToAgent" parameterClass="cargo.cms.uld.bo.URFReleaseULDBO">
		UPDATE ULD_INVENTORY 
		SET AGENT_INV = 'Y', OWNED_INV = 'N', AGENT_ID = #agentCode#, CFM_STATUS = 'RELEASED',
		LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE, GROSS_WEIGHT = 0, RESV_RMK = NULL,
		DAM_RMK = NULL, REF_TR_NO = #eirNo#, REF_TR_TYPE = 'UR', REF_TR_DATE = SYSDATE, REF_IN_CARR = NULL,
		REF_OUT_CARR = NULL, CONTR_CODE = NULL, REF_DOC_LINE_NO = #docLineNo#, 
		REF_LOC_FROM = LOC_CODE, LOC_CODE = NULL,
		GEN_RMK = #relRmk#, REF_TR_EVENT = 'INSERT',REF_RMK = #relRmk#,TR_TYPE='DUMMY',ULDENTRY_MSG_RCVD_YN='N'
		WHERE ULD_KEY = #uldKey#
	</update>
	<update id="sqlUpdateRelURFULDToNonAgent" parameterClass="cargo.cms.uld.bo.URFReleaseULDBO">
		UPDATE ULD_INVENTORY 
		SET RESV_FLG = 'Y', RESV_DATE = SYSDATE, RESV_USER_ID = #lmUserId#, URF_RESV = 'Y',
		FLT_TYPE = 'E' , FLT_KEY = (SELECT URF_FLT_KEY FROM ULD_ISS_HD WHERE EIR_NO = #eirNo#),
    	FLT_DATE = (SELECT URF_FLT_DATE FROM ULD_ISS_HD WHERE EIR_NO = #eirNo#),
		RESV_RMK = #reserveRmk#, CFM_STATUS = 'RESERVED',TR_TYPE='DUMMY'
		WHERE ULD_KEY = #uldKey#
	</update>
	<update id="sqlUpdateRelURFULDToInventory" parameterClass="cargo.cms.uld.bo.URFReleaseULDBO">
		UPDATE ULD_INVENTORY 
		SET RESV_FLG = 'N', RESV_DATE = NULL, RESV_USER_ID = NULL,
		FLT_TYPE = NULL, FLT_KEY = NULL, FLT_DATE = NULL,
		RESV_RMK = NULL, CFM_STATUS = 'CONFIRMED' 
		WHERE ULD_KEY = #oldUldKey#	
	</update>
	<update id="sqlUpdateURFStatus" parameterClass="cargo.cms.uld.bo.URFRequestBO">
		UPDATE ULD_ISS_HD
		SET	STATUS = #status#, LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE,AIRSIDE_REL=#airsiderelease#,INBOUNDTOW_REL=#inbounddirect#
		WHERE EIR_NO = #eirNo#
	</update>
	<update id="sqlUpdateURFResetAck" parameterClass="cargo.cms.uld.bo.URFRequestBO">
		UPDATE ULD_ISS_HD SET ACK_BY = NULL, ACK_DATE = NULL, ACK_EST_TIME = NULL, UCO_AMEND_YN = 'N'
		WHERE EIR_NO = #eirNo#
	</update>
	<update id="sqlUpdateURFResetAckQty" parameterClass="cargo.cms.uld.bo.URFRequestBO">
		UPDATE ULD_ISS_DTL SET ULD_ACK_QTY = NULL, EQUIP_ACK_QTY = NULL
		WHERE EIR_NO = #eirNo#
	</update>	
	<update id="sqlUpdateURFRequestULDRelQty" parameterClass="cargo.cms.uld.bo.URFReleaseULDBO">
		UPDATE ULD_ISS_DTL SET ULD_REL_QTY = NVL(ULD_REL_QTY, 0) + 1 WHERE EIR_NO =
		#eirNo# AND DOC_LINE_NO = #idocLineNo#
	</update>
	<update id="sqlReduceURFRequestULDRelQty" parameterClass="cargo.cms.uld.bo.URFReleaseULDBO">
		UPDATE ULD_ISS_DTL SET ULD_REL_QTY = NVL(ULD_REL_QTY, 0) - 1 WHERE EIR_NO =
		#eirNo# AND DOC_LINE_NO = #oldIdocLineNo#
	</update>
	<update id="sqlUpdateURFRequestAccRelQty" parameterClass="cargo.cms.uld.bo.URFReleaseAccessoryBO">
		UPDATE ULD_ISS_DTL SET EQUIP_REL_QTY = NVL(EQUIP_REL_QTY, 0) + #equipQty#
		WHERE EIR_NO = #eirNo# AND DOC_LINE_NO = #idocLineNo#
	</update>
	<update id="sqlUpdateURFExtended" parameterClass="cargo.cms.uld.bo.URFRequestBO">
		UPDATE	ULD_ISS_HD
		SET EXTENDED_YN = 'Y', LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE
		WHERE EIR_NO = #eirNo#
	</update>
	<update id="sqlUpdateURFExpiry" parameterClass="cargo.cms.uld.bo.URFRequestBO">
		UPDATE ULD_ISS_HD
		SET EIR_EXPIRY_DATE = TO_DATE(#eirExpiryDate#, 'DDMONYY HH24:MI'),
		LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE
		WHERE EIR_NO = #eirNo#
	</update>
	<update id="sqlUpdateURFVoid" parameterClass="cargo.cms.uld.bo.URFRequestBO">
		UPDATE ULD_ISS_HD
		SET	STATUS = #status#, LM_USER_ID = #lmUserId#,VOID_RMK = #voidRmk#,LM_DATE = SYSDATE
		WHERE EIR_NO = #eirNo#
	</update>
	<delete id="sqlDeleteURFReleaseULD" parameterClass="cargo.cms.uld.bo.URFReleaseULDBO">
		DELETE	ULD_REL_DTL WHERE TR_NO = #oldTrNo# AND ULD_KEY = #oldUldKey#
	</delete>
	<delete id="sqlDeleteAllURFRequestAccessory" parameterClass="cargo.cms.uld.bo.URFRequestAccessoryBO">
		DELETE ULD_ISS_DTL
		WHERE
		EIR_NO = #eirNo# AND DOC_LINE_NO = #docLineNo#
	</delete>
	<select id="sqlGetURFTimeSlotDate" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[	
			SELECT DAY_FRQ dayFreq, TO_CHAR(EFF_FROM, 'DDMONYY') || ' 00:00' effFrom, TO_CHAR(EFF_TO, 'DDMONYY') || ' 23:59' effTo
			FROM CUST_AGENT_SCH_COLL_TIME
			WHERE PURPOSE = 'ULD'
			AND CUST_NO   =
			  (SELECT CODE
			  FROM CUST_COMPANY
			  WHERE CODE_DESC = #agentName#
			  )
			AND 
		      (
		      (TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY')) >= TO_DATE(TO_CHAR(EFF_FROM, 'DDMONYY')) AND TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY')) <= TO_DATE(TO_CHAR(EFF_TO, 'DDMONYY'))) OR
		      (TO_DATE(TO_CHAR(SYSDATE + 1, 'DDMONYY')) >= TO_DATE(TO_CHAR(EFF_FROM, 'DDMONYY')) AND TO_DATE(TO_CHAR(SYSDATE + 1, 'DDMONYY')) <= TO_DATE(TO_CHAR(EFF_TO, 'DDMONYY'))) OR
		      (TO_DATE(TO_CHAR(SYSDATE + 2, 'DDMONYY')) >= TO_DATE(TO_CHAR(EFF_FROM, 'DDMONYY')) AND TO_DATE(TO_CHAR(SYSDATE + 2, 'DDMONYY')) <= TO_DATE(TO_CHAR(EFF_TO, 'DDMONYY'))) OR
		      (TO_DATE(TO_CHAR(SYSDATE + 3, 'DDMONYY')) >= TO_DATE(TO_CHAR(EFF_FROM, 'DDMONYY')) AND TO_DATE(TO_CHAR(SYSDATE + 3, 'DDMONYY')) <= TO_DATE(TO_CHAR(EFF_TO, 'DDMONYY')))
		      )
		]]>
	</select>
	<select id="sqlGetURFTimeSlotTime" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
			SELECT SUBSTR(TRIM(TO_CHAR(TIME_FROM,'0000')),1,2)
			  || NVL2(TIME_FROM, ':', '')
			  || SUBSTR(TRIM(TO_CHAR(TIME_FROM,'0000')),3,4)
			  || '-'
			  || SUBSTR(TRIM(TO_CHAR(TIME_TO,'0000')),1,2)
			  || NVL2(TIME_TO, ':', '')
			  || SUBSTR(TRIM(TO_CHAR(TIME_TO,'0000')),3,4) AS dayFreq,
			  TO_CHAR(EFF_FROM, 'DDMONYY') || ' 00:00' effFrom, TO_CHAR(EFF_TO, 'DDMONYY') || ' 23:59' effTo
			FROM CUST_AGENT_SCH_COLL_TIME
			WHERE PURPOSE = 'ULD'
			AND CUST_NO   =
			  (SELECT CODE
			  FROM CUST_COMPANY
			  WHERE CODE_DESC = #agentName#
			  )
			AND DAY_FRQ LIKE #like#
			<isEqual property="usage" compareValue="Y">
			AND TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY') || ' ' || SUBSTR(TRIM(TO_CHAR(TIME_TO,'0000')),1,2) || NVL2(TIME_TO, ':', '') || SUBSTR(TRIM(TO_CHAR(TIME_TO,'0000')),3,4), 'DDMONYY HH24:MI') &gt;= SYSDATE
			</isEqual>
			AND 
		      (
		      (TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY')) &gt;= TO_DATE(TO_CHAR(EFF_FROM, 'DDMONYY')) AND TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY')) &lt;= TO_DATE(TO_CHAR(EFF_TO, 'DDMONYY'))) OR
		      (TO_DATE(TO_CHAR(SYSDATE + 1, 'DDMONYY')) &gt;= TO_DATE(TO_CHAR(EFF_FROM, 'DDMONYY')) AND TO_DATE(TO_CHAR(SYSDATE + 1, 'DDMONYY')) &lt;= TO_DATE(TO_CHAR(EFF_TO, 'DDMONYY'))) OR
		      (TO_DATE(TO_CHAR(SYSDATE + 2, 'DDMONYY')) &gt;= TO_DATE(TO_CHAR(EFF_FROM, 'DDMONYY')) AND TO_DATE(TO_CHAR(SYSDATE + 2, 'DDMONYY')) &lt;= TO_DATE(TO_CHAR(EFF_TO, 'DDMONYY'))) OR
		      (TO_DATE(TO_CHAR(SYSDATE + 3, 'DDMONYY')) &gt;= TO_DATE(TO_CHAR(EFF_FROM, 'DDMONYY')) AND TO_DATE(TO_CHAR(SYSDATE + 3, 'DDMONYY')) &lt;= TO_DATE(TO_CHAR(EFF_TO, 'DDMONYY')))
		      )
			ORDER BY TIME_FROM ASC
	</select>
	<select id="sqlGetURFULDBasicAccessory" parameterClass="cargo.cms.uld.bo.URFRequestULDBO"
		resultClass="cargo.cms.uld.bo.URFNameValueBO">
		SELECT EQUIP_TYPE || '/' || EQUIP_REQ_QTY as value
		FROM ULD_ISS_DTL
		WHERE ULD_EQUIP = 'B' AND (ULD_GROUP = #uldGroup# OR ULD_TYPE = #uldType#) AND EIR_NO = #eirNo#
	</select>
	<select id="sqlGetURFUCOULDBasicAccessory" parameterClass="cargo.cms.uld.bo.URFRequestULDBO"
		resultClass="cargo.cms.uld.bo.URFNameValueBO">
		SELECT EQUIP_TYPE || '/' || NVL(NVL2(EQUIP_ACK_QTY, EQUIP_ACK_QTY, EQUIP_APR_QTY), 0) as value
		FROM ULD_ISS_DTL
		WHERE ULD_EQUIP = 'B' AND (ULD_GROUP = #uldGroup# OR ULD_TYPE = #uldType#) AND EIR_NO = #eirNo#
	</select>	
	<select id="sqlGetURFProcULDBasicAccessory" parameterClass="cargo.cms.uld.bo.URFRequestULDBO"
		resultClass="cargo.cms.uld.bo.URFNameValueBO">
		SELECT EQUIP_TYPE || '/' || DECODE(NVL(EQUIP_ENDR_QTY, 0), 0, EQUIP_REQ_QTY, EQUIP_ENDR_QTY) as value
		FROM ULD_ISS_DTL
		WHERE ULD_EQUIP = 'B' AND (ULD_GROUP = #uldGroup# OR ULD_TYPE = #uldType#) AND EIR_NO = #eirNo#
	</select>	
	<select id="sqlGetURFGroupBasicAccessory" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFNameValueBO">
		SELECT ACC_TYPE name, QTY * NVL(#total#, 0) value, QTY other
		FROM ULD_BASIC_ACC
		WHERE ULD_CARR = #carrCode#	AND ULD_GROUP = #uldGroup#
	</select>
	<select id="sqlGetURFTypeBasicAccessory" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFNameValueBO">
		SELECT ACC_TYPE name, QTY * NVL(#total#, 0) value, QTY other
		FROM ULD_BASIC_ACC
		WHERE ULD_CARR = #carrCode#
		AND ULD_GROUP =	(SELECT ULD_GROUP FROM ULD_GROUP_TYPE WHERE ULD_TYPE = #uldGroup#) 
	</select>
	<select id="sqlGetURFRequestHeader" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFMaintainRequestBO">
		<![CDATA[
		SELECT EIR_NO eirNo,a.airside_rel  airsiderelease,
a.inboundtow_rel inbounddirect, TO_CHAR(EIR_DATE, 'DDMONYY') eirDate, 
		SUBSTR(TRIM(TO_CHAR(EIR_TIME,'0000')),1,2) || NVL2(EIR_TIME, ':', '') || SUBSTR(TRIM(TO_CHAR(EIR_TIME,'0000')),3,4) eirTime,
		a.CARR_CODE carrCode, REQ_BY_CARR reqByCarr, a.FLT_NO
		fltNo, TO_CHAR(a.FLT_DATE, 'DDMONYY') fltDate,
	    a.STATUS status,
	    CASE WHEN NVL(a.EIR_EXPIRY_DATE,SYSDATE) >=  SYSDATE 
	    THEN d.CODE_DESC
	    ELSE
	      CASE WHEN (a.STATUS = 'APPROVED' OR a.STATUS = 'PARTRELEASED')
	      THEN 'Expired'
	      ELSE d.CODE_DESC
	      END
	    END statusName,
		ISS_RMK issRmk, EIR_RMK	eirRmk,
		a.AGENT_CUST_NO agentCustNo, b.CODE_DESC agentName,
		a.PRT_CODE prtCode,  EXTENDED_YN extendedYN, a.REPT_VER reptVer,
		a.TR_TYPE trType, a.TR_STATUS trStatus,
		a.CR_USER_ID crUserId, TO_CHAR(a.CR_DATE, 'DDMONYY HH24:MI') crDate,
		a.LM_USER_ID lmUserId, TO_CHAR(a.LM_DATE, 'DDMONYY HH24:MI') lmDate,
		TO_CHAR(a.LM_DATE, 'DDMONYY HH24:MI:SS') lmMultiUserTime,
		TO_CHAR(EIR_EXPIRY_DATE, 'DDMONYY HH24:MI') eirExpiryDate,
		ORIG_EIR_NO origEirNo, a.PURPOSE purpose, c.CODE_DESC purposeName,
		ENDR_BY endrBy, TO_CHAR(ENDR_DATE,'DDMONYY HH24:MI') endrDate, ENDR_RMK endrRmk,
		APR_BY aprBy, TO_CHAR(APR_DATE, 'DDMONYY HH24:MI') aprDate, APR_RMK aprRmk,
		ACK_BY ackBy, TO_CHAR(ACK_DATE, 'DDMONYY HH24:MI') ackDate, ACK_RMK ackRmk,
		TO_CHAR(EST_TIME, 'DDMONYY HH24:MI') estTime,
		TO_CHAR(REQ_EST_TIME,'DDMONYY HH24:MI') reqEstTime, TO_CHAR(ENDR_EST_TIME, 'DDMONYY HH24:MI') endrEstTime,
		TO_CHAR(APR_EST_TIME, 'DDMONYY HH24:MI') aprEstTime, TO_CHAR(ACK_EST_TIME, 'DDMONYY HH24:MI') ackEstTime,
		TO_CHAR(TIME_SLOT_DATE, 'DDMONYY') timeSlotDate, TIME_SLOT_FROM	timeSlotFrom, TIME_SLOT_TO timeSlotTo,
		SCH_RLS schRls,	TO_CHAR(URF_FLT_DATE, 'DDMONYY') urfFltDate, URF_FLT_KEY urfFltKey,
		VOID_RMK voidRmk, UCO_AMEND_YN ucoAmendYN, WH_ACTION whAction
		FROM
		ULD_ISS_HD a
		LEFT JOIN CUST_COMPANY b
		ON a.AGENT_CUST_NO = b.CODE
		LEFT JOIN MAST_CODE_DTL c
		ON a.PURPOSE = c.CODE AND c.CODE_TYPE = 'URF_PURPOSE'
		LEFT JOIN MAST_CODE_DTL d
		ON a.STATUS = d.CODE AND d.CODE_TYPE = 'URF_STATUS'
		WHERE a.EIR_NO = #eirNo#	
		]]>
	</select>
	<select id="sqlGetURFRequestULDs" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFRequestULDBO">
		SELECT DTL.EIR_NO eirNo,
		DTL.DOC_LINE_NO docLineNo,
		DTL.ULD_GROUP uldGroup,
		DTL.ULD_TYPE uldType,
		DTL.ULD_GROUP || ULD_TYPE as uldGroupType,
		DTL.ULD_REQ_QTY uldReqQty,
		DTL.ULD_APR_QTY uldAprQty,
		DTL.ULD_REL_QTY uldRelQty,
		DTL.TR_TYPE trType,
		DTL.TR_STATUS trStatus,
		DTL.CR_USER_ID crUserId,
		DTL.CR_DATE crDate,
		DTL.LM_USER_ID lmUserId,
		DTL.LM_DATE lmDate,
		DTL.ULD_ENDR_QTY uldEndrQty,
		DTL.ULD_ACK_QTY uldAckQty,
    	HD.ENDR_URF_MSG endrseURFMsg
		FROM ULD_ISS_DTL DTL,ULD_ISS_HD HD
		WHERE DTL.EIR_NO = HD.EIR_NO AND DTL.EIR_NO = #eirNo#
		AND ULD_EQUIP='U'
	</select>
	<select id="sqlGetURFRequestAccessories" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFRequestAccessoryBO">
		SELECT DTL.EIR_NO eirNo,
		DTL.DOC_LINE_NO docLineNo,
		DTL.EQUIP_TYPE equipType,
		NVL(DTL.EQUIP_REQ_QTY,0) equipReqQty,
		NVL(DTL.EQUIP_APR_QTY,0) equipAprQty,
		NVL(DTL.EQUIP_REL_QTY,0) equipRelQty,
		DTL.TR_TYPE trType,
		DTL.TR_STATUS trStatus,
		DTL.CR_USER_ID crUserId,
		DTL.CR_DATE crDate,
		DTL.LM_USER_ID lmUserId,
		DTL.LM_DATE lmDate,
		NVL(DTL.EQUIP_ENDR_QTY,0) equipEndrQty,
		NVL(DTL.EQUIP_ACK_QTY,0) equipAckQty,
    	HD.ENDR_URF_MSG endrseURFMsg
		FROM ULD_ISS_DTL DTL,ULD_ISS_HD HD
		WHERE DTL.EIR_NO = HD.EIR_NO AND DTL.EIR_NO = #eirNo#
		AND ULD_EQUIP='E'
	</select>
	<select id="sqlGetURFRequestBasicAccessories" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFRequestAccessoryBO">
	 	SELECT DTL.EIR_NO eirNo,
		DTL.DOC_LINE_NO docLineNo,
		DTL.ULD_GROUP uldGroup,
		DTL.ULD_TYPE uldType,		
		DTL.EQUIP_TYPE equipType,
		NVL(DTL.EQUIP_REQ_QTY,0) equipReqQty,
		NVL(DTL.EQUIP_APR_QTY,0) equipAprQty,
		NVL(DTL.EQUIP_REL_QTY,0) equipRelQty,
		DTL.TR_TYPE trType,
		DTL.TR_STATUS trStatus,
		DTL.CR_USER_ID crUserId,
		DTL.CR_DATE crDate,
		DTL.LM_USER_ID lmUserId,
		DTL.LM_DATE lmDate,
		NVL(DTL.EQUIP_ENDR_QTY,0) equipEndrQty,
		NVL(DTL.EQUIP_ACK_QTY,0) equipAckQty,
    	HD.ENDR_URF_MSG endrseURFMsg
		FROM ULD_ISS_DTL DTL,ULD_ISS_HD HD
		WHERE DTL.EIR_NO = HD.EIR_NO AND DTL.EIR_NO = #eirNo#
		AND ULD_EQUIP='B'
	</select>	
	<select id="sqlGetURFRequestEquipsView" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFRequestAccessoryBO">
		SELECT eirNo, NVL(CODE.CODE_DESC, '-') equipName, equipType, SUM(equipReqQty) equipReqQty, SUM(equipAprQty) equipAprQty,
		SUM(equipEndrQty) equipEndrQty, SUM(equipAckQty) equipAckQty, SUM(basicAccQty) basicAccQty
		FROM
		(
		SELECT EIR_NO eirNo, ULD_EQUIP uldEquip, EQUIP_TYPE equipType, EQUIP_REQ_QTY equipReqQty, 
		NVL(EQUIP_APR_QTY,0) equipAprQty, NVL(EQUIP_ENDR_QTY,0) equipEndrQty, NVL(EQUIP_ACK_QTY,0) equipAckQty, 0 basicAccQty
		FROM ULD_ISS_DTL
		WHERE EIR_NO = #eirNo# AND ULD_EQUIP ='E' 
		UNION ALL
		SELECT EIR_NO eirNo, ULD_EQUIP uldEquip, EQUIP_TYPE equipType, 0 equipReqQty, 
		NVL(EQUIP_APR_QTY,0) equipAprQty, NVL(EQUIP_ENDR_QTY,0) equipEndrQty, NVL(EQUIP_ACK_QTY,0) equipAckQty, NVL(EQUIP_REQ_QTY,0) basicAccQty
		FROM ULD_ISS_DTL
		WHERE EIR_NO = #eirNo# AND ULD_EQUIP = 'B'
		) EQUIP
	    LEFT OUTER JOIN MAST_CODE_DTL CODE
	    ON EQUIP.equipType = CODE.CODE AND CODE.CODE_TYPE = 'URF_EQUIP_TYPE'    
	    GROUP BY eirNo, NVL(CODE.CODE_DESC, '-'), equipType
	</select>
	<select id="sqlGetURFReleaseEquipsView" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFReleaseAccessoryBO">
		SELECT EQUIP_TYPE equipType, EQUIP_TYPE_NAME equipName,SUM(EQUIP_QTY) equipQty, TRUCK_NO truckNo,
		retDate, retUser, 
    	relDate, relTime, crUserId
		FROM
		(
		SELECT EQUIP_TYPE, NVL(CODE.CODE_DESC, '-') EQUIP_TYPE_NAME, EQUIP_QTY, TRUCK_NO, 
		TO_CHAR(DTL.RET_DATE, 'DDMONYY HH24:MI') retDate, DTL.RET_USER retUser,
		TO_CHAR(REL_DATE,'DDMONYY') relDate,
		SUBSTR(TRIM(TO_CHAR(REL_TIME,'0000')),1,2) || NVL2(REL_TIME, ':', '') || SUBSTR(TRIM(TO_CHAR(REL_TIME,'0000')),3,4)	relTime,
		DTL.CR_USER_ID crUserId
		FROM
		ULD_REL_HD HDR,
		ULD_REL_DTL DTL
	    LEFT OUTER JOIN MAST_CODE_DTL CODE
	    ON DTL.EQUIP_TYPE = CODE.CODE AND CODE.CODE_TYPE = 'URF_EQUIP_TYPE'		
		WHERE
		HDR.TR_NO = DTL.TR_NO AND HDR.EIR_NO = DTL.EIR_NO AND HDR.EIR_NO = #eirNo# AND ULD_EQUIP IN('E','B')
		) TBL
		GROUP BY EQUIP_TYPE, EQUIP_TYPE_NAME,TRUCK_NO, retDate, retUser, relDate, relTime, crUserId
		ORDER BY TBL.EQUIP_TYPE
	</select>	
	<select id="sqlGetURFRequestEquipsRelease" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFRequestAccessoryBO">
		SELECT eirNo, NVL(CODE.CODE_DESC, '-') equipName, equipType, SUM(equipReqQty) equipReqQty, SUM(equipAprQty) equipAprQty,
		SUM(equipEndrQty) equipEndrQty, SUM(equipAckQty) equipAckQty, SUM(basicAccQty) basicAccQty
		FROM
		(
		SELECT EIR_NO eirNo, ULD_EQUIP uldEquip, EQUIP_TYPE equipType, EQUIP_REQ_QTY equipReqQty, 
		NVL(EQUIP_APR_QTY,0) equipAprQty, NVL(EQUIP_ENDR_QTY,0) equipEndrQty, NVL(EQUIP_ACK_QTY,0) equipAckQty, 0 basicAccQty
		FROM ULD_ISS_DTL
		WHERE EIR_NO = #eirNo# AND ULD_EQUIP ='E' 
		UNION ALL
		SELECT EIR_NO eirNo, ULD_EQUIP uldEquip, EQUIP_TYPE equipType, EQUIP_REQ_QTY equipReqQty, 
		NVL(EQUIP_APR_QTY,0) equipAprQty, 0 equipEndrQty, NVL(EQUIP_ACK_QTY,0) equipAckQty, NVL(EQUIP_APR_QTY,0) basicAccQty
		FROM ULD_ISS_DTL
		WHERE EIR_NO = #eirNo# AND ULD_EQUIP = 'B'
		) EQUIP
	    LEFT OUTER JOIN MAST_CODE_DTL CODE
	    ON EQUIP.equipType = CODE.CODE AND CODE.CODE_TYPE = 'URF_EQUIP_TYPE'    
	    GROUP BY eirNo, NVL(CODE.CODE_DESC, '-'), equipType
	</select>
	<select id="sqlGetURFReleaseHeader" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFReleaseBO">
		SELECT TR_NO trNo,
		EIR_NO eirNo,
		TO_CHAR(REL_DATE, 'DDMONYY') relDate,
		SUBSTR(TRIM(TO_CHAR(REL_TIME,'0000')),1,2) || NVL2(REL_TIME, ':', '') || SUBSTR(TRIM(TO_CHAR(REL_TIME,'0000')),3,4) relTime,
		TRUCK_NO truckNo, CORR_REL_FLG corrRelFlg, PRT_VER prtVer, PRT_CODE prtCode,
		RMK	rmk, AGENT_CUST_NO agentCustNo, TR_TYPE trType, TR_STATUS trStatus,
		CR_USER_ID crUserId, CR_DATE crDate, LM_USER_ID lmUserId, LM_DATE lmDate,
		REF_ISS_NO refIssNo, CARR_CODE carrCode
		FROM ULD_REL_HD a
		WHERE EIR_NO =
		#eirNo#
		<isNotEmpty property="relDate"> AND TO_DATE(TO_CHAR(a.REL_DATE,	'DDMONYY'), 'DDMONYY') = TO_DATE(#relDate#, 'DDMONYY') </isNotEmpty>
		<isNotEmpty property="relTime"> AND TRIM(TO_CHAR(a.REL_TIME, '0000')) = #relTime# </isNotEmpty>
	</select>
	<select id="sqlGetURFReleaseULDs" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFReleaseULDBO">
		SELECT b.TR_NO trNo,DOC_LINE_NO docLineNo,IDOC_LINE_NO idocLineNo,b.EIR_NO eirNo,
		a.TRUCK_NO truckNo,	TO_CHAR(REL_DATE,'DDMONYY') relDate,
		SUBSTR(TRIM(TO_CHAR(REL_TIME,'0000')),1,2) || NVL2(REL_TIME, ':', '') || SUBSTR(TRIM(TO_CHAR(REL_TIME,'0000')),3,4)	relTime,
		ULD_TYPE uldType,ULD_NO uldNo,ULD_CARR uldCarr,ULD_KEY uldKey,
		to_char(RET_DATE,'DDMONYY HH24:MI') retDate,RET_USER retUser,b.STATUS status,b.TR_TYPE trType,b.TR_STATUS trStatus,
		b.CR_USER_ID crUserId,b.CR_DATE crDate,b.LM_USER_ID lmUserId,b.LM_DATE lmDate,TO_CHAR(b.manual_ret_date,'DDMONYY') AS returnDate,b.manual_ret_rmk AS returnRemrk,b.CHK_IN_FLT_KEY AS chkinFltKey,to_char(b.CHK_IN_FLT_DATE,'DDMONYY') AS chkinFltDate
		FROM ULD_REL_HD a, ULD_REL_DTL b
		WHERE a.TR_NO =
		b.TR_NO AND a.EIR_NO = #eirNo#
		AND ULD_EQUIP = 'U'
	</select>
	<select id="sqlGetURFReleaseAccessories" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFReleaseAccessoryBO">
		SELECT b.TR_NO trNo,DOC_LINE_NO docLineNo,IDOC_LINE_NO idocLineNo,
		a.TRUCK_NO truckNo,	TO_CHAR(REL_DATE, 'DDMONYY') relDate,
		SUBSTR(TRIM(TO_CHAR(REL_TIME,'0000')),1,2) || NVL2(REL_TIME, ':', '') || SUBSTR(TRIM(TO_CHAR(REL_TIME,'0000')),3,4) relTime,
		b.EIR_NO eirNo,	ULD_CARR uldCarr,EQUIP_TYPE equipType,EQUIP_QTY equipQty,RET_DATE retDate,RET_USER retUser,
		b.STATUS status,b.TR_TYPE trType,b.TR_STATUS trStatus,
		b.CR_USER_ID crUserId,b.CR_DATE crDate,b.LM_USER_ID lmUserId,b.LM_DATE lmDate
		FROM ULD_REL_HD a, ULD_REL_DTL b
		WHERE a.TR_NO = b.TR_NO AND a.EIR_NO = #eirNo#
		AND ULD_EQUIP = 'E'
	</select>
	<select id="sqlGetURFReleasePrintULD" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFReleaseULDBO">
		SELECT b.TR_NO trNo,DOC_LINE_NO docLineNo,IDOC_LINE_NO idocLineNo,b.EIR_NO eirNo,
		ULD_TYPE uldType,ULD_NO uldNo,ULD_CARR uldCarr,ULD_KEY uldKey,RET_DATE retDate,RET_USER retUser,
		b.STATUS status,b.TR_TYPE trType,b.TR_STATUS trStatus,
		b.CR_USER_ID crUserId,b.CR_DATE crDate,b.LM_USER_ID lmUserId,b.LM_DATE lmDate
		FROM ULD_REL_HD a, ULD_REL_DTL b
		WHERE a.TR_NO = b.TR_NO AND a.EIR_NO = #eirNo#
		AND ULD_EQUIP = 'U'
		<isNotEmpty property="relDate"> AND TO_DATE(TO_CHAR(a.REL_DATE,	'DDMONYY'), 'DDMONYY') = TO_DATE(#relDate#, 'DDMONYY') </isNotEmpty>
		<isNotEmpty property="relTime"> AND TRIM(TO_CHAR(a.REL_TIME, '0000')) = #relTime# </isNotEmpty>
	</select>
	<select id="sqlGetURFReleasePrintEquip" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFReleaseAccessoryBO">
		SELECT b.TR_NO trNo,DOC_LINE_NO docLineNo,IDOC_LINE_NO idocLineNo,b.EIR_NO eirNo,
		ULD_CARR uldCarr,EQUIP_TYPE equipType,EQUIP_QTY equipQty,
		RET_DATE retDate,RET_USER retUser,b.STATUS status,b.TR_TYPE trType,b.TR_STATUS trStatus,
		b.CR_USER_ID crUserId,b.CR_DATE crDate,b.LM_USER_ID lmUserId,b.LM_DATE lmDate
		FROM ULD_REL_HD a, ULD_REL_DTL b
		WHERE a.TR_NO = b.TR_NO AND a.EIR_NO = #eirNo#
		AND ULD_EQUIP = 'E'
		<isNotEmpty property="relDate"> AND TO_DATE(TO_CHAR(a.REL_DATE,	'DDMONYY'), 'DDMONYY') = TO_DATE(#relDate#, 'DDMONYY') </isNotEmpty>
		<isNotEmpty property="relTime"> AND TRIM(TO_CHAR(a.REL_TIME, '0000')) = #relTime# </isNotEmpty>
	</select>
	<select id="sqlGetURFReleaseEquipQty" parameterClass="cargo.cms.uld.bo.URFReleaseAccessoryBO"
		resultClass="java.lang.Integer">
		SELECT SUM(EQUIP_QTY) FROM ULD_REL_DTL WHERE EIR_NO = #eirNo# AND EQUIP_TYPE = #equipType#
	</select>	
	<select id="sqlGetMaintainURFs" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[
		SELECT DISTINCT ISS.EIR_NO urfNo, ISS.CARR_CODE carrCode ,  NVL(ISS.airside_rel,'N') airsiderelease,
  		NVL(ISS.inboundtow_rel,'N') inbounddirect, (
			SELECT COUNT(1)
			FROM uld_group_type gt,
			mast_uld_allot_group uag,
			mast_uld_allot ua,
			mast_uld_group ug,
	     	ULD_REL_DTL A
	   		WHERE gt.uld_group = uag.uld_group AND uag.uld_allot = ua.uld_allot AND ug.uld_group = uag.uld_group AND gt.uld_type = SUBSTR(a.uld_key, 0, 3)
        	AND A.eir_no = ISS.EIR_NO AND ua.plt_cnt = 'Pallet'
        ) as palletCount, (
        	SELECT COUNT(1)
			FROM uld_group_type gt,
  			mast_uld_allot_group uag,
  			mast_uld_allot ua,
  			mast_uld_group ug,
         	ULD_REL_DTL A
	   		WHERE gt.uld_group = uag.uld_group AND uag.uld_allot = ua.uld_allot AND ug.uld_group = uag.uld_group AND gt.uld_type    = SUBSTR(a.uld_key, 0, 3)
            AND A.eir_no = ISS.EIR_NO AND ua.plt_cnt != 'Pallet'
        ) as uldCount,
		ISS.FLT_NO || NVL2(ISS.FLT_NO, '/', '')|| TO_CHAR(ISS.FLT_DATE, 'DDMONYY') fltNoDate,
		AGT.CODE_DESC agentName, ORIG_EIR_NO parentUrfNo ,
		TO_CHAR(ISS.req_est_time, 'DDMONYY HH24:MI')
		reqEstTime,	TO_CHAR(ISS.CR_DATE, 'DDMONYY HH24:MI') createDate,
		PURP.CODE_DESC purpose,
	    CASE WHEN NVL(ISS.EIR_EXPIRY_DATE,SYSDATE) >=  SYSDATE 
	    THEN STAT.CODE_DESC
	    ELSE
	      CASE WHEN (ISS.STATUS = 'APPROVED' OR ISS.STATUS = 'PENDING')
	      THEN 'Expired'
	      ELSE STAT.CODE_DESC
	      END
	    END status,	(
	      SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_REQ_QTY, 0), ', ')) 
	      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND UPPER(ULD_EQUIP) = 'U' AND NVL(ULD_REQ_QTY, 0) > 0
	    ) reqUldQty, (
	      SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_ENDR_QTY, 0), ', ')) 
	      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND UPPER(ULD_EQUIP) = 'U' AND NVL(ULD_ENDR_QTY, 0) > 0
	    ) endrUldQty, (
	   	  SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_APR_QTY, 0), ', ')) 
	      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND UPPER(ULD_EQUIP) = 'U' AND NVL(ULD_APR_QTY, 0) > 0
	    ) aprUldQty, (
	      SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_REL_QTY, 0), ', ')) 
	      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND UPPER(ULD_EQUIP) = 'U' AND NVL(ULD_REL_QTY, 0) > 0
	    ) relUldQty ,
	    ISS.FLT_NO flightno,
        TO_CHAR(ISS.FLT_DATE, 'DDMONYY') flightdt, ( 
       	SELECT STRAGG(STRINGDELIM(ULD_KEY, ',')) FROM  uld_rel_dtl d WHERE d.eir_no = ISS.EIR_NO )as releaseduld,
       	nvl(ENDR_URF_MSG,'N') as endrseURFMsg    
		FROM
		ULD_ISS_HD ISS
		LEFT JOIN uld_rel_hd  hd 
		ON iss.eir_no=hd.eir_no
		LEFT JOIN CUST_COMPANY AGT
		ON ISS.AGENT_CUST_NO = AGT.CODE
		LEFT JOIN MAST_CODE_DTL PURP
		ON ISS.purpose = PURP.CODE AND PURP.CODE_TYPE = 'URF_PURPOSE'
		LEFT JOIN MAST_CODE_DTL STAT
		ON ISS.STATUS = STAT.CODE AND STAT.CODE_TYPE = 'URF_STATUS'
		WHERE 1 = 1
		]]>
		<isNotEmpty property="airsiderelease"> AND ISS.airside_rel = #airsiderelease# </isNotEmpty>
		<isNotEmpty property="inbounddirect"> AND ISS.inboundtow_rel = #inbounddirect# </isNotEmpty>
	 	<isNotEmpty property="truckNo"> AND hd.truck_no = #truckNo# </isNotEmpty>
		<isNotEmpty property="remarks"> AND  hd.rmk= #remarks# </isNotEmpty> 
		<isNotEmpty property="urfNo"> AND ISS.EIR_NO = #urfNo# </isNotEmpty>
		<isNotEqual property="carrCode" compareValue="ALL"> AND	ISS.CARR_CODE LIKE UPPER(#carrCode#)</isNotEqual>
		<isNotEmpty property="agentCode"> AND AGT.CODE = #agentCode# </isNotEmpty>
		<isNotEmpty property="agentName"> AND UPPER(AGT.CODE_DESC) = UPPER(#agentName#) </isNotEmpty>
		<isNotEmpty property="parentUrfNo"> AND ORIG_EIR_NO = #parentUrfNo#	</isNotEmpty>
		<isNotEmpty property="fltNoCarr"> 
			<isEmpty property="fltNoOnly"> AND UPPER(ISS.CARR_CODE) = UPPER(#fltNoCarr#)</isEmpty>
			<isNotEmpty property="fltNoOnly"> AND UPPER(ISS.FLT_NO) = TRIM(UPPER(#fltNoCarr#) || UPPER(#fltNoOnly#))</isNotEmpty>
		</isNotEmpty>
		<isNotEmpty property="fltNoOnly"> 
			<isEmpty property="fltNoCarr"> AND UPPER(ISS.FLT_NO) LIKE ('%' || UPPER(#fltNoOnly#))</isEmpty>
		</isNotEmpty>
		<isNotEmpty property="purpose"> AND ISS.PURPOSE = #purpose#</isNotEmpty>
		<isNotEmpty property="fltDate"> AND	TO_DATE(TO_CHAR(ISS.FLT_DATE,'DDMONYY')) = TO_DATE(#fltDate#,	'DDMONYY')</isNotEmpty>
		<isNotEmpty property="createFrom"><![CDATA[ AND TO_DATE(TO_CHAR(ISS.CR_DATE,'DDMONYY')) >= TO_DATE(#createFrom#,'DDMONYY') ]]></isNotEmpty>
		<isNotEmpty property="createTo"><![CDATA[ AND TO_DATE(TO_CHAR(ISS.CR_DATE,'DDMONYY')) <= TO_DATE(#createTo#,'DDMONYY') ]]></isNotEmpty>
		<isNotEqual property="status" compareValue="EXPIRED">
			<isNotEqual property="status" compareValue="ACKNOWLEDGED">
				<isNotEqual property="status" compareValue="ALL"> AND ISS.STATUS LIKE NVL(#status#, '%') </isNotEqual>
			</isNotEqual>
		</isNotEqual>
		<isEqual property="status" compareValue="EXPIRED"><![CDATA[ AND ISS.STATUS IN('APPROVED', 'PENDING') AND ISS.EIR_EXPIRY_DATE < SYSDATE ]]></isEqual>
		<isEqual property="status" compareValue="ACKNOWLEDGED"> AND ACK_BY IS NOT NULL</isEqual>
		<isEqual property="status" compareValue="PENDING"><![CDATA[ AND NVL(ISS.EIR_EXPIRY_DATE,SYSDATE) >= SYSDATE ]]></isEqual>
		<isEqual property="status" compareValue="ENDORSED"><![CDATA[ AND NVL(ISS.EIR_EXPIRY_DATE,SYSDATE) >= SYSDATE ]]></isEqual>
		<isEqual property="status" compareValue="APPROVED"><![CDATA[ AND NVL(ISS.EIR_EXPIRY_DATE,SYSDATE) >= SYSDATE ]]></isEqual>
		<isEqual property="carrCode" compareValue="ALL">
			<isEmpty property="fltNoCarr">	
				<isNotEmpty property="loginCarrier">				 
			       	AND   ( ISS.CARR_CODE = #loginCarrier# OR ISS.CARR_CODE IN (SELECT CARR_CODE FROM MAST_CARR_GRP WHERE GRP_CARR_CODE = #loginCarrier#))			     
				</isNotEmpty>
			</isEmpty>
		</isEqual>
		<dynamic prepend="ORDER BY ">
			<isNotEmpty property="sortOrder.sortField">
				$sortOrder.sortField$
			</isNotEmpty>
			<isEmpty property="sortOrder.sortField">
				ISS.EIR_NO ASC
			</isEmpty>           
		</dynamic>
	</select>
	<select id="sqlGetProcessURFs" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[
			SELECT DISTINCT ISS.EIR_NO urfNo,
			ISS.CARR_CODE carrCode ,
			ISS.FLT_NO ||	NVL2(ISS.FLT_NO, '/', '')|| TO_CHAR(ISS.FLT_DATE, 'DDMONYY') fltNoDate,
			TO_CHAR(ISS.FLT_DATE, 'DDMONYY') fltDate,
			SUBSTR(TRIM(TO_CHAR(NVL(FLT.EST_TIME, FLT.SCH_TIME),'0000')),0,2)|| NVL2(NVL(FLT.EST_TIME, FLT.SCH_TIME), ':', '')|| SUBSTR(TRIM(TO_CHAR(NVL(FLT.EST_TIME, FLT.SCH_TIME),'0000')),3,4) fltTime,
			TO_CHAR(ISS.EST_TIME, 'DDMONYY HH24:MI') finalEstTime,
			AGT.CODE_DESC	agentName, ISS.ENDR_RMK endrRmk, PURP.CODE_DESC purpose,
		    (
		    SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_REQ_QTY, 0), ', ')) 
		      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND UPPER(ULD_EQUIP) = 'U' AND NVL(ULD_REQ_QTY, 0) > 0
		    ) reqUldQty,
		    (
		    SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_ENDR_QTY, 0), ', ')) 
		      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND UPPER(ULD_EQUIP) = 'U' AND NVL(ULD_ENDR_QTY, 0) > 0
		    ) endrUldQty,
		    (
		    SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_APR_QTY, 0), ', ')) 
		      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND UPPER(ULD_EQUIP) = 'U' AND NVL(ULD_APR_QTY, 0) > 0
		    ) aprUldQty,
		    (
		    SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_REL_QTY, 0), ', ')) 
		      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND UPPER(ULD_EQUIP) = 'U' AND NVL(ULD_REL_QTY, 0) > 0
		    ) relUldQty,
		    ISS.EST_TIME, ISS.FLT_DATE, FLT.SCH_TIME
			FROM
			ULD_ISS_HD ISS
			LEFT JOIN CUST_COMPANY AGT
			ON ISS.AGENT_CUST_NO = AGT.CODE
			LEFT JOIN MAST_CODE_DTL PURP
			ON ISS.PURPOSE = PURP.CODE AND PURP.CODE_TYPE = 'URF_PURPOSE'
			LEFT JOIN FLT_OPR FLT
			ON ISS.FLT_NO = FLT.FLT_KEY AND ISS.FLT_DATE = FLT.SCH_DATE AND FLT_TYPE = 'D'
			WHERE (
				(SCH_RLS = 'N') OR 
				(TO_DATE(TO_CHAR(NVL(TIME_SLOT_DATE,'31AUG2000'), 'DDMONYY') || ' ' || TRIM(TO_CHAR(NVL(TIME_SLOT_TO,'0000'), '0000')), 'DDMONYY HH24MI') >= SYSDATE AND SCH_RLS = 'Y')
			)
		]]>
		<isNotEmpty property="carrCode">
		<isNotEqual property="carrCode" compareValue="ALL"> AND	ISS.CARR_CODE = UPPER(#carrCode#)</isNotEqual>
		<isEqual property="carrCode" compareValue="ALL"> 
			<isNotEmpty property="loginCarrier">
				AND (ISS.CARR_CODE = #loginCarrier#
				OR ISS.CARR_CODE IN (SELECT CARR_CODE FROM MAST_CARR_GRP 
				WHERE GRP_CARR_CODE	= #loginCarrier#)) 	
			</isNotEmpty>
		</isEqual>
		</isNotEmpty>
		<isNotEmpty property="agentCode"> AND AGT.CODE = #agentCode#</isNotEmpty>
		<isNotEmpty property="agentName"> AND UPPER(AGT.CODE_DESC) =	UPPER(#agentName#)</isNotEmpty>
		<isNotEmpty property="fltNoCarr"> 
			<isEmpty property="fltNoOnly"> AND UPPER(ISS.CARR_CODE) = UPPER(#fltNoCarr#)</isEmpty>
			<isNotEmpty property="fltNoOnly"> AND UPPER(ISS.FLT_NO) = TRIM(UPPER(#fltNoCarr#) || UPPER(#fltNoOnly#))</isNotEmpty>
		</isNotEmpty>
		<isNotEmpty property="fltNoOnly"> 
			<isEmpty property="fltNoCarr"> AND UPPER(ISS.FLT_NO) LIKE ('%' || UPPER(#fltNoOnly#))</isEmpty>
		</isNotEmpty>
		<isNotEmpty property="purpose"> AND ISS.PURPOSE = #purpose#</isNotEmpty>
		<isNotEmpty property="fltDate"> AND	TO_DATE(TO_CHAR(ISS.FLT_DATE,'DDMONYY')) = TO_DATE(#fltDate#,'DDMONYY')</isNotEmpty>
		<isNotEmpty property="endorsed">
			<isEqual property="endorsed" compareValue="Y"> AND ISS.STATUS = 'ENDORSED' </isEqual>
			<isEqual property="endorsed" compareValue="N"> AND ISS.STATUS = 'PENDING' </isEqual>
		</isNotEmpty>
		<isEmpty property="endorsed"> AND ISS.STATUS IN('PENDING', 'ENDORSED')</isEmpty>	
		<dynamic prepend="ORDER BY ">
			<isNotEmpty property="sortOrder.sortField">
				$sortOrder.sortField$
           </isNotEmpty>
			<isEmpty property="sortOrder.sortField">
				ISS.EST_TIME ASC, ISS.FLT_DATE ASC, FLT.SCH_TIME ASC
			</isEmpty>                      
		</dynamic>
	</select>
	<select id="sqlGetSplitURFs" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		SELECT DISTINCT
		AGT.CODE_DESC agentName,ISS.EIR_NO urfNo,ISS.CARR_CODE carrCode ,
		ISS.FLT_NO || NVL2(ISS.FLT_NO, '/', '') || TO_CHAR(ISS.FLT_DATE,'DDMONYY') fltNoDate,
		ISS.EIR_RMK aprRmk,TO_CHAR(ISS.APR_EST_TIME, 'DDMONYY HH24:MI')	aprEstTime,
		TO_CHAR(ISS.CR_DATE, 'DDMONYY HH24:MI') createDate,
	    (
	    SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_APR_QTY, 0), ', ')) 
	      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND ULD_EQUIP = 'U' AND NVL(ULD_APR_QTY, 0) > 0
	    ) aprUldQty,
	    (
	    SELECT STRAGG(STRINGDELIM(EQUIP_TYPE || '-' || NVL(EQUIP_APR_QTY, 0), ', ')) 
	      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND ULD_EQUIP = 'E' AND NVL(EQUIP_APR_QTY, 0) > 0
	    ) aprEquipQty  		
		FROM
		ULD_ISS_HD ISS
		LEFT JOIN CUST_COMPANY AGT
		ON ISS.AGENT_CUST_NO = AGT.CODE
		WHERE ISS.STATUS = 'APPROVED' AND ISS.PURPOSE = 'Agt' AND ISS.FLT_NO IS NOT NULL AND ISS.EIR_EXPIRY_DATE &gt;= SYSDATE
		<isNotEmpty property="urfNo"> AND ISS.EIR_NO = #urfNo# </isNotEmpty>
		<isNotEqual property="carrCode" compareValue="ALL"> AND	ISS.CARR_CODE = #carrCode#</isNotEqual>
		<isNotEmpty property="agentCode"> AND AGT.CODE = #agentCode#</isNotEmpty>
		<isNotEmpty property="agentName"> AND UPPER(AGT.CODE_DESC) = UPPER(#agentName#)</isNotEmpty>
		<isNotEmpty property="createFromDate"> AND ISS.CR_DATE &gt;= TO_DATE(#createFromDate#, 'DDMONYY HH24:MI')</isNotEmpty>
		<isNotEmpty property="createToDate"> AND ISS.CR_DATE &lt;= TO_DATE(#createToDate#, 'DDMONYY HH24:MI')</isNotEmpty>		
		<dynamic prepend="ORDER BY ">
			<isNotEmpty property="sortOrder.sortField">
				$sortOrder.sortField$
           </isNotEmpty>
			<isEmpty property="sortOrder.sortField">
				ISS.EIR_NO ASC
			</isEmpty>                    
		</dynamic>
	</select>
	<select id="sqlGetReleaseURFs" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		SELECT ISS.EIR_NO urfNo, ISS.FLT_NO || NVL2(ISS.FLT_NO, '/', '') || TO_CHAR(ISS.FLT_DATE, 'DDMONYY') fltNoDate,
		TO_CHAR(EST_TIME, 'DDMONYY HH24:MI') estTime,
		AGT.CODE_DESC agentName, PURP.CODE_DESC purpose, STAT.CODE_DESC status,
	    CASE
		    WHEN ISS.ACK_BY IS NOT NULL THEN (
		      SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_ACK_QTY, 0), ', ')) 
		      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND UPPER(ULD_EQUIP) = 'U' AND NVL(ULD_ACK_QTY, 0) > 0
		    )
		    ELSE (
		      SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_APR_QTY, 0), ', '))
		      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND UPPER(ULD_EQUIP) = 'U' AND NVL(ULD_APR_QTY, 0) > 0
		    )
	    END aprUldQty,
	    CASE 
		    WHEN ISS.ACK_BY IS NOT NULL THEN (
		      SELECT STRAGG(STRINGDELIM(EQUIP_TYPE || '-' || SUM(NVL(EQUIP_ACK_QTY, 0)), ', ')) 
		      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND UPPER(ULD_EQUIP) IN ('E', 'B') AND NVL(EQUIP_ACK_QTY, 0) > 0
		      GROUP BY EQUIP_TYPE
		    )
		    ELSE (
		      SELECT STRAGG(STRINGDELIM(EQUIP_TYPE || '-' || SUM(NVL(EQUIP_APR_QTY, 0)), ', ')) 
		      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND UPPER(ULD_EQUIP) IN ('E', 'B') AND NVL(EQUIP_APR_QTY, 0) > 0
		      GROUP BY EQUIP_TYPE
		    )
	    END aprEquipQty,
	    (
		   	SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || (NVL(ULD_APR_QTY, 0) - NVL(ULD_REL_QTY, 0)), ', '))
		  	FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND UPPER(ULD_EQUIP) = 'U' AND (NVL(ULD_APR_QTY, 0) - NVL(ULD_REL_QTY, 0)) > 0
      	) outstandULD,
      	(
		   	SELECT STRAGG(STRINGDELIM(EQUIP_TYPE || '-' || (SUM(NVL(EQUIP_APR_QTY, 0)) - SUM(NVL(EQUIP_REL_QTY, 0))), ', ')) 
		  	FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND UPPER(ULD_EQUIP) IN ('E', 'B') AND (EQUIP_APR_QTY - NVL(EQUIP_REL_QTY, 0)) > 0
		   	GROUP BY EQUIP_TYPE
      	) outstandAcc,
      	(
         	select STRAGG(STRINGDELIM(dtl.uld_key, ', ')) uldno from URF_COLLECTION_HD HD 
         	join URF_COLLECTION_DTL DTL on HD.TR_NO=DTL.TR_NO
         	join URF_TRUCK_REGD_HD trk_hd on trk_hd.TRK_REG_ID= HD.TRK_REG_ID
         	where HD.URF_NUM = ISS.EIR_NO AND UPPER(ULD_EQUIP) = 'U' AND trk_hd.TRK_REG_STATUS != 'Completed'
      	) collectedULD,
      	(
         	select STRAGG(STRINGDELIM(DTL.EQUIP_TYPE || '-' || NVL(DTL.EQUIP_QTY, 0), ', ')) accCode from URF_COLLECTION_HD HD 
         	join URF_COLLECTION_DTL DTL on HD.TR_NO=DTL.TR_NO
         	join URF_TRUCK_REGD_HD trk_hd on trk_hd.TRK_REG_ID= HD.TRK_REG_ID
          	where HD.URF_NUM = ISS.EIR_NO AND UPPER(ULD_EQUIP) IN ('E', 'B') AND trk_hd.TRK_REG_STATUS != 'Completed'
      	) collectedAcc
		FROM
		ULD_ISS_HD ISS
		LEFT OUTER JOIN CUST_COMPANY AGT
		ON ISS.AGENT_CUST_NO = AGT.CODE
		LEFT OUTER JOIN MAST_CODE_DTL PURP
		ON ISS.PURPOSE = PURP.CODE AND PURP.CODE_TYPE = 'URF_PURPOSE'
		LEFT OUTER JOIN MAST_CODE_DTL STAT
		ON ISS.STATUS = STAT.CODE AND STAT.CODE_TYPE = 'URF_STATUS'
		WHERE 1 = 1
		<isNotEmpty property="truckNo"> 
		AND ISS.PURPOSE = 'Agt' AND ISS.EIR_NO IN (
			SELECT EIR_NO
			FROM EIR_SCH_COLL HDR, EIR_SCH_COLL_DTL DTL
			WHERE
			HDR.SCH_COLL_NO = DTL.SCH_COLL_NO AND (
				TO_DATE(TO_CHAR(TIME_SLOT_DATE, 'DDMONYY')) = TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY')) AND TIME_SLOT_TO >= TO_NUMBER(TO_CHAR(SYSDATE, 'HH24MI')) OR 
				TO_DATE(TO_CHAR(TIME_SLOT_DATE, 'DDMONYY')) > TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY'))
			) AND (TRUCK1 = #truckNo# OR TRUCK2 = #truckNo# OR TRUCK3 = #truckNo#)
			UNION
			SELECT EIR_NO
			FROM ULD_TRUCK_EIR TRK
			WHERE
			TRIP_ID = (
				SELECT MAX(TRIP_ID) FROM TRUCK_TRIP WHERE EXIT_IND = 'N' AND CLOSED = 'N' AND TRUCK_NO = #truckNo#
			)		
		)
		</isNotEmpty>
		<isNotEmpty property="urfNo">
		AND ISS.EIR_NO = #urfNo#
		</isNotEmpty>
		ORDER BY ISS.EIR_EXPIRY_DATE ASC
	</select>
	<select id="sqlGetUldTypeCount" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM MAST_ULD_TYPE WHERE CODE = #PARAM#
	</select>

	<select id="sqlGetCarrFltNoAndDateCount" parameterClass="cargo.cms.uld.bo.URFMaintainRequestBO"
		resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM FLT_OPR WHERE
		FLT_KEY = UPPER(#fltNo#) AND CARR_CODE = #carrCode#	AND 
		TO_CHAR(SCH_DATE,'DDMONYY') = UPPER(#fltDate#) AND FLT_TYPE = 'D'
	</select>
	<select id="sqlGetFltNoAndDateDepCount" parameterClass="cargo.cms.uld.bo.URFMaintainRequestBO"
		resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM FLT_OPR WHERE
		FLT_KEY = UPPER(#fltNo#) AND TO_CHAR(SCH_DATE,'DDMONYY') = UPPER(#fltDate#)  AND FLT_TYPE = 'D'
	</select>
	<select id="sqlGetFltNoAndDateCount" parameterClass="cargo.cms.uld.bo.URFMaintainRequestBO"
		resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM FLT_OPR WHERE FLT_KEY = UPPER(#fltNo#) AND TO_CHAR(SCH_DATE,'DDMONYY') = UPPER(#fltDate#) 
	</select>
	<select id="sqlGetURFFltEstDate" parameterClass="cargo.cms.uld.bo.URFMaintainRequestBO"
		resultClass="java.lang.String">
		SELECT TO_CHAR(NVL(EST_DATE, SCH_DATE), 'DDMONYY') FROM FLT_OPR 
		WHERE FLT_KEY = UPPER(#fltNo#) AND TO_CHAR(SCH_DATE,'DDMONYY') = UPPER(#fltDate#) AND FLT_TYPE = 'D'
	</select>			
	<select id="sqlGetMaxURFDocLineNo" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT MAX(DOC_LINE_NO) maxDocLineNo FROM ULD_ISS_DTL WHERE EIR_NO = #PARAM#
	</select>
	<select id="sqlGetMaxRelURFDocLineNo" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT MAX(DOC_LINE_NO) maxDocLineNo FROM ULD_REL_DTL WHERE EIR_NO = #PARAM#
	</select>
	<select id="sqlGetMaxRelURFDate" parameterClass="java.lang.String"	resultClass="java.lang.String">
    	SELECT TO_CHAR(REL_DATE, 'DDMONYY')
		|| ' '
		|| SUBSTR(TRIM(TO_CHAR(REL_TIME,'0000')),1,2)
		|| NVL2(REL_TIME, ':', '')
		|| SUBSTR(TRIM(TO_CHAR(REL_TIME,'0000')),3,4) AS value
		FROM (SELECT MAX(REL_DATE) REL_DATE, MAX(REL_TIME) REL_TIME FROM ULD_REL_HD WHERE EIR_NO = #PARAM#)
	</select>	
	<select id="sqlGetURFExpireCount" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM ULD_ISS_HD 
		WHERE EIR_NO = #PARAM# AND EIR_EXPIRY_DATE &lt; SYSDATE AND STATUS IN('PENDING', 'APPROVED')
	</select>
	<select id="sqlGetURFStatusValue" parameterClass="java.lang.String"	resultClass="java.lang.String">
		SELECT b.CODE_DESC FROM ULD_ISS_HD a
		LEFT OUTER JOIN MAST_CODE_DTL b
		ON a.STATUS = b.CODE
		WHERE EIR_NO = #PARAM# AND B.CODE_TYPE = 'URF_STATUS'
	</select>
	<select id="sqlGetURFStatus" parameterClass="java.lang.String"	resultClass="java.lang.String">
		SELECT STATUS FROM ULD_ISS_HD a	WHERE EIR_NO = #PARAM#
	</select>	
	<select id="sqlGetValidURFCount" parameterClass="java.lang.String"	resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM ULD_ISS_HD a WHERE EIR_NO = #PARAM# AND STATUS &lt;&gt; 'DELETED'
	</select>
	<select id="sqlGetOwnULDAvailCount" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT COUNT(ULD_KEY) FROM ULD_INVENTORY WHERE OWNED_INV = 'Y' AND ULD_KEY = #PARAM#
	</select>
	<select id="sqlGetAgentSchCollCount" parameterClass="java.lang.String"	resultClass="java.lang.Integer">
		SELECT COUNT(*) value FROM CUST_AGENT_SCH_COLL_TIME WHERE CUST_NO = 
		(SELECT CODE FROM CUST_COMPANY WHERE CODE_DESC = UPPER(#PARAM#))
	</select>	
	<select id="sqlGetValidAgentURFCount" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM ULD_ISS_HD a WHERE EIR_NO = #eirNo# AND AGENT_CUST_NO = #agentCode# AND PURPOSE = 'Agt'
	</select>
	<select id="sqlGetURFPurpose" parameterClass="java.lang.String" resultClass="java.lang.String">
		SELECT PURPOSE FROM ULD_ISS_HD a WHERE EIR_NO = #eirNo#
	</select>	
	<select id="sqlGetAgentCode" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		SELECT CODE FROM CUST_COMPANY WHERE (Upper(CODE_DESC) = #PARAM# or CODE=#PARAM#) AND AGENT_YN = 'Y' AND ACTIVE = 'Y'
	</select>
	<select id="sqlGetAgentName" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		SELECT CODE_DESC FROM CUST_COMPANY WHERE CODE = #PARAM#	AND AGENT_YN = 'Y' AND ACTIVE = 'Y'
	</select>
	<select id="sqlGetURFNonAgentFltPrefix" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		SELECT NVL(MAX(RULE_VALUE), 'UR')FROM CMSRULES WHERE RULE_CODE = 'URF_FLT_PREFIX'
	</select>
	<select id="sqlGetMaxAllowedULDQty" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT NVL(MAX(RULE_VALUE), 40) FROM CMSRULES WHERE RULE_CODE = 'URF_ULD_MAX'
	</select>
	<select id="sqlGetMaxAllowedApproveEquipQty" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT NVL(MAX(RULE_VALUE), 99) FROM CMSRULES WHERE RULE_CODE = 'URF_APPROVE_EQUIP_MAX'
	</select>	
	<select id="sqlGetMaxAllowedAccessoryQty" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT NVL(MAX(RULE_VALUE), 999) FROM CMSRULES WHERE RULE_CODE = 'URF_ACCESSORY_MAX'
	</select>
	<select id="sqlGetURFExpireHour" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT NVL(MAX(RULE_VALUE), 8) FROM CMSRULES WHERE RULE_CODE = 'URF_EXPIRE_HOUR'
	</select>
	<select id="sqlGetURFExtendedExpireHour" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT NVL(MAX(RULE_VALUE), 20) FROM CMSRULES WHERE	RULE_CODE = 'URF_EXT_EXPIRE_HOUR'
	</select>
	<select id="sqlGetURFAccessories" resultClass="cargo.cms.uld.bo.URFNameValueBO">
		SELECT CODE value,
		CODE_DESC name FROM MAST_CODE_DTL WHERE CODE_TYPE = 'URF_EQUIP_TYPE'
		ORDER BY CODE_DESC ASC
	</select>	
	<select id="sqlGetURFReleaseDates" parameterClass="java.lang.String"
		resultClass="cargo.cms.uld.bo.URFNameValueBO">
		SELECT TO_CHAR(REL_DATE, 'DDMONYY')
		|| ' '
		|| SUBSTR(TRIM(TO_CHAR(REL_TIME,'0000')),1,2)
		|| NVL2(REL_TIME, ':', '')
		|| SUBSTR(TRIM(TO_CHAR(REL_TIME,'0000')),3,4) AS value
		FROM ULD_REL_HD
		WHERE
		EIR_NO = #PARAM#
		ORDER BY REL_DATE ASC, REL_TIME ASC
	</select>
	<select id="sqlGetURFPurposes" resultClass="cargo.cms.uld.bo.URFNameValueBO">
		SELECT CODE value,
		CODE_DESC name FROM MAST_CODE_DTL WHERE CODE_TYPE = 'URF_PURPOSE'
		ORDER BY CODE_DESC ASC
	</select>
	<select id="sqlGetURFStatuses" resultClass="cargo.cms.uld.bo.URFNameValueBO">
		SELECT CODE value,
		CODE_DESC name FROM MAST_CODE_DTL WHERE CODE_TYPE = 'URF_STATUS' ORDER
		BY CODE_DESC ASC
	</select>
	<select id="sqlGetULDGroup" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		SELECT ULD_GROUP uldGroup FROM ULD_GROUP_TYPE WHERE	ULD_TYPE = #PARAM#
	</select>
	<select id="sqlGetULDFromMHS" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT COUNT(WH_TYPE) FROM MAST_WH_GROUP WHERE WH_TYPE = 'MHS' AND WH_GROUP =  
  		(SELECT WH_GROUP FROM MAST_WH_LOC WHERE CODE = 
    	(SELECT LOC_CODE FROM ULD_INVENTORY WHERE OWNED_INV = 'Y' AND LOC_CODE IS NOT NULL AND ULD_KEY = #PARAM#))
	</select>	
	<select id="sqlGetURFTrNo" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		SELECT TR_NO FROM ULD_REL_HD WHERE EIR_NO = #PARAM#
	</select>
	<select id="sqlGetReleaseURFMaxDocNo" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT MAX(DOC_LINE_NO) FROM ULD_REL_DTL WHERE TR_NO = #PARAM#
	</select>
	<select id="sqlGetReleaseURFDateTime" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		SELECT TO_CHAR(REL_DATE, 'DDMONYY') || ' ' || 
		SUBSTR(TRIM(TO_CHAR(REL_TIME,'0000')),1,2) || NVL2(REL_TIME, ':', '') || SUBSTR(TRIM(TO_CHAR(REL_TIME,'0000')),3,4) value
		FROM ULD_REL_HD WHERE TR_NO = #PARAM#
	</select>	
	<!-- URF Truck Registration -->
	<insert id="sqlInsertURFTruckReg" parameterClass="cargo.cms.uld.bo.URFTruckRegisterBO">
		INSERT INTO	ULD_TRUCK_EIR
		(TRIP_ID, EIR_NO, RELEASED_YN, CR_USER_ID, CR_DATE, LM_USER_ID, LM_DATE)
		VALUES(#tripId#, #eirNo#, #releasedYN#, #crUserId#, SYSDATE, #lmUserId#, SYSDATE)
	</insert>
	<update id="sqlUpdateURFTruckRegAsReleased" parameterClass="cargo.cms.uld.bo.URFTruckRegisterBO">
		UPDATE ULD_TRUCK_EIR SET RELEASED_YN = 'Y', LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE WHERE EIR_NO = #eirNo#  AND TRIP_ID = 
		(SELECT MAX(TRIP_ID) FROM TRUCK_TRIP WHERE EXIT_IND = 'N' AND CLOSED = 'N' AND TRUCK_NO = #truckNo#)
	</update>
	<update id="sqlUpdateURFTruckRegExtraURFs" parameterClass="cargo.cms.uld.bo.URFTruckRegisterBO">
		UPDATE TRUCK_TRIP SET EXTRA_URF = #extraURFs#, LM_DATE = SYSDATE, LM_USER_ID = #lmUserId# WHERE TRIP_ID = #tripId#
	</update>	
	<delete id="sqlDeleteURFTruckRegURF" parameterClass="cargo.cms.uld.bo.URFTruckRegisterBO">
		DELETE FROM	ULD_TRUCK_EIR WHERE TRIP_ID = #tripId# AND EIR_NO = #oldEirNo#
	</delete>
	<delete id="sqlDeleteURFMobTruckRegURF" parameterClass="cargo.cms.uld.bo.URFTruckRegisterBO">
		 DELETE FROM URF_TRUCK_REGD_DTL WHERE urf_num=#oldEirNo#
      		AND tr_no IN (SELECT tr_no FROM URF_TRUCK_REGD_HD WHERE trk_num IN (SELECT truck_no FROM TRUCK_TRIP WHERE TRIP_ID=#tripId#) AND TRK_REG_STATUS != 'Completed')
	</delete>
	<select id="sqlGetURFTruckRegURFCount" parameterClass="cargo.cms.uld.bo.URFReleaseBO" resultClass="java.lang.Integer">
		SELECT COUNT(EIR_NO) FROM ULD_TRUCK_EIR a WHERE EIR_NO = #eirNo# AND a.TRIP_ID = 
		(SELECT MAX(TRIP_ID) FROM TRUCK_TRIP WHERE EXIT_IND = 'N' AND CLOSED = 'N' AND TRUCK_NO = #truckNo#)
	</select>	
	<select id="sqlGetURFTruckRegURFs" parameterClass="cargo.cms.uld.bo.URFTruckRegisterBO"
		resultClass="cargo.cms.uld.bo.URFTruckRegisterBO">
		SELECT	EIR_NO eirNo, EIR_NO oldEirNo, a.TRIP_ID tripId, RELEASED_YN releasedYN, 
		TO_CHAR(LM_DATE, 'DDMONYY HH24:MI:SS') lmMultiUserTime,'N' newFlag
		FROM ULD_TRUCK_EIR a WHERE a.TRIP_ID = #tripId#
		UNION
		SELECT	dtl.urf_num eirNo, '' oldEirNo, '' tripId, '' releasedYN, 
		'' lmMultiUserTime,'Y' newFlag
		FROM URF_TRUCK_REGD_HD hd 
		join URF_TRUCK_REGD_DTL dtl on hd.tr_no=dtl.tr_no WHERE hd.trk_num = #truckNo#
    	AND dtl.urf_num not in (SELECT	EIR_NO FROM ULD_TRUCK_EIR a WHERE a.TRIP_ID = #tripId#)
    	AND hd.TRK_REG_STATUS != 'Completed'
	</select>
	<select id="sqlGetURFTruckRegTripId" parameterClass="cargo.cms.uld.bo.URFTruckRegisterBO"
		resultClass="java.lang.String">
		SELECT MAX(a.TRIP_ID) FROM TRUCK_TRIP a	WHERE a.TRUCK_NO = #truckNo# AND a.CLOSED = 'N' AND a.EXIT_IND = 'N'
	</select>
	<select id="sqlGetTruckRegURFTruckNo" parameterClass="java.lang.String"	resultClass="java.lang.String">
		SELECT TRUCK_NO
	    FROM TRUCK_TRIP TRK,
	    ULD_TRUCK_EIR EIR
	    WHERE TRK.TRIP_ID = EIR.TRIP_ID AND EIR_NO = #PARAM# AND EXIT_IND = 'N' AND CLOSED = 'N'
	</select>	
	<select id="sqlGetURFTruckRegURFAllocCount" parameterClass="cargo.cms.uld.bo.URFTruckRegisterBO"
		resultClass="java.lang.Integer">
		SELECT COUNT(a.TRIP_ID) FROM
		ULD_TRUCK_EIR a, TRUCK_TRIP b
		WHERE
		a.TRIP_ID = b.TRIP_ID AND EIR_NO = #eirNo# AND RELEASED_YN = 'N'
		AND a.TRIP_ID &lt;&gt; #tripId# AND b.CLOSED = 'N' AND b.EXIT_IND = 'N'
	</select>
	<select id="sqlGetURFTruckRegInQueue" parameterClass="cargo.cms.uld.bo.URFTruckRegisterBO"
		resultClass="java.lang.Integer">
		SELECT COUNT(TRIP_ID) FROM
		TRUCK_TRIP
		WHERE TRIP_ID = #tripId# AND CLOSED = 'N' AND EXIT_IND = 'N' AND TRUCK_QUEUE_IND = 'Y'
	</select>
	<select id="sqlGetURFTruckRegExtraURF" parameterClass="cargo.cms.uld.bo.URFTruckRegisterBO"
		resultClass="java.lang.Integer">
		SELECT NVL(EXTRA_URF, 0) FROM TRUCK_TRIP WHERE TRIP_ID = #tripId#
	</select>		
	<select id="sqlGetURFSchCollURFAllocCount" parameterClass="cargo.cms.uld.bo.URFTruckRegisterBO"
		resultClass="java.lang.Integer">
		SELECT COUNT(a.SCH_COLL_NO) FROM
		EIR_SCH_COLL a,
		EIR_SCH_COLL_DTL b
		WHERE
		a.SCH_COLL_NO = b.SCH_COLL_NO AND
		EIR_NO = #eirNo# AND 
		(
		TO_DATE(TO_CHAR(TIME_SLOT_DATE, 'DDMONYY')) = TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY')) AND TIME_SLOT_TO >= TO_NUMBER(TO_CHAR(SYSDATE, 'HH24MI')) OR 
		TO_DATE(TO_CHAR(TIME_SLOT_DATE, 'DDMONYY')) > TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY'))
		)
	</select>	
	<select id="sqlGetURFTruckRegIsValidURF" parameterClass="cargo.cms.uld.bo.URFTruckRegisterBO"
		resultClass="java.lang.Integer">
		SELECT COUNT(EIR_NO) FROM ULD_ISS_HD
		WHERE STATUS IN('APPROVED', 'PARTRELEASED') AND EIR_NO = #eirNo# AND PURPOSE = 'Agt'
	</select>
	<select id="sqlGetURFTruckRegMaxAck" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT NVL(MAX(RULE_VALUE), 2) FROM CMSRULES WHERE RULE_CODE = 'URF_TRUCK_REG_EXTRA'
	</select>
	<!-- Schedule Collection -->
	<insert id="sqlInsertSchCollHdr" parameterClass="cargo.cms.uld.bo.URFTruckScheduleBO">
		INSERT INTO EIR_SCH_COLL(SCH_COLL_NO, AGENT_CUST_NO,TRUCK1, TRUCK2, TRUCK3,CR_USER_ID, 
		CR_DATE, LM_USER_ID, LM_DATE,TIME_SLOT_DATE,TIME_SLOT_FROM, TIME_SLOT_TO)
		VALUES
		(#schCollNo#,#agentCode#,#truckNo1#, #truckNo2#, #truckNo3#,#crUserId#, SYSDATE, #lmUserId#,
		SYSDATE,#timeSlotDate#,	#timeSlotFrom#, #timeSlotTo#
		)
	</insert>
	<insert id="sqlInsertSchCollDtl" parameterClass="cargo.cms.uld.bo.URFTruckScheduleBO">
		INSERT INTO	EIR_SCH_COLL_DTL(SCH_COLL_NO,EIR_NO,CR_USER_ID, CR_DATE, LM_USER_ID,LM_DATE)
		VALUES(#schCollNo#, #eirNo#, #crUserId#, SYSDATE, #lmUserId#, SYSDATE)
	</insert>
	<delete id="sqlDeleteSchCollURF" parameterClass="cargo.cms.uld.bo.URFTruckScheduleBO">
		DELETE FROM	EIR_SCH_COLL_DTL WHERE sch_coll_no = #schCollNo#
	</delete>
	<update id="sqlUpdateSchCollHeader" parameterClass="cargo.cms.uld.bo.URFTruckScheduleBO">
		UPDATE	EIR_SCH_COLL
		SET
		TRUCK1 = #truckNo1#, TRUCK2 = #truckNo2#,TRUCK3 = #truckNo3#,
		LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE
		WHERE
		SCH_COLL_NO	= #schCollNo#
	</update>
	<select id="sqlGetURFTruckRegSchCollTruckNo" parameterClass="java.lang.String"	resultClass="java.lang.String">
		SELECT MAX(TRUCK_NO)
	    FROM
	    TRUCK_TRIP TRK,
	    (
	    SELECT EIR_NO, TRUCK1, TRUCK2, TRUCK3 FROM
		EIR_SCH_COLL a,
		EIR_SCH_COLL_DTL b
		WHERE
		a.SCH_COLL_NO = b.SCH_COLL_NO AND EIR_NO = #PARAM#
	    ) SCH
	    WHERE TRK.TRUCK_NO = SCH.TRUCK1 OR TRK.TRUCK_NO = SCH.TRUCK2 OR TRK.TRUCK_NO = SCH.TRUCK3 AND EXIT_IND = 'N' AND CLOSED = 'N'
	</select>	
	<select id="sqlGetSchCollURFs" parameterClass="cargo.cms.uld.bo.URFTruckScheduleBO"
		resultClass="cargo.cms.uld.bo.URFTruckScheduleBO">
		SELECT a.SCH_COLL_NO schCollNo,	
		TRUCK1 truckNo1, TRUCK2	truckNo2, TRUCK3 truckNo3, EIR_NO eirNo, 
		TO_CHAR(a.LM_DATE, 'DDMONYY HH24:MI:SS') lmMultiUserTime
		FROM
		EIR_SCH_COLL a,	EIR_SCH_COLL_DTL b
		WHERE a.SCH_COLL_NO = b.SCH_COLL_NO
		AND AGENT_CUST_NO = #agentCode#
		AND TO_DATE(TO_CHAR(TIME_SLOT_DATE, 'DDMONYY')) = TO_DATE(#timeSlotDate#, 'DDMONYY')
		AND TIME_SLOT_FROM = #timeSlotFrom#
		AND TIME_SLOT_TO = #timeSlotTo#
	</select>
	<select id="sqlGetDefaultSchCollURFs" parameterClass="cargo.cms.uld.bo.URFTruckScheduleBO"
		resultClass="cargo.cms.uld.bo.URFTruckScheduleBO">
		SELECT EIR_NO eirNo FROM ULD_ISS_HD
		WHERE
		SCH_RLS = 'Y' AND STATUS = 'APPROVED' AND
		TO_DATE(TO_CHAR(TIME_SLOT_DATE, 'DDMONYY'))	= TO_DATE(#timeSlotDate#, 'DDMONYY') AND
		TIME_SLOT_FROM = #timeSlotFrom# AND	TIME_SLOT_TO = #timeSlotTo# AND
		AGENT_CUST_NO =	#agentCode# AND
		EIR_EXPIRY_DATE &gt;= SYSDATE
	</select>
	<select id="sqlGetSchCollTruckCount" parameterClass="cargo.cms.uld.bo.URFTruckScheduleBO"
		resultClass="java.lang.Integer">
		SELECT COUNT(SCH_COLL_NO) 
		FROM EIR_SCH_COLL
		WHERE
		TO_DATE(TO_CHAR(TIME_SLOT_DATE, 'DDMONYY')) = TO_DATE(#timeSlotDate#,'DDMONYY') 
		AND 
		(
		(TIME_SLOT_FROM &lt;= #timeSlotFrom# AND TIME_SLOT_TO &gt;= #timeSlotFrom#) OR 
		(TIME_SLOT_FROM &lt;= #timeSlotTo# AND TIME_SLOT_TO &gt;= #timeSlotTo#)
		)
		AND (TRUCK1 = #truckNo# OR TRUCK2 =	#truckNo# OR TRUCK3 = #truckNo#)
		<isNotEmpty property="schCollNo"> AND SCH_COLL_NO &lt;&gt; #schCollNo# </isNotEmpty>
	</select>
	<select id="sqlGetSchCollURFAllocCount" parameterClass="cargo.cms.uld.bo.URFTruckScheduleBO"
		resultClass="java.lang.Integer">
		SELECT COUNT(a.SCH_COLL_NO) FROM
		EIR_SCH_COLL a,
		EIR_SCH_COLL_DTL b
		WHERE
		a.SCH_COLL_NO = b.SCH_COLL_NO AND
		EIR_NO = #eirNo# AND
		(
		TO_DATE(TO_CHAR(TIME_SLOT_DATE, 'DDMONYY')) = TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY')) AND TIME_SLOT_TO >= TO_NUMBER(TO_CHAR(SYSDATE, 'HH24MI')) OR 
		TO_DATE(TO_CHAR(TIME_SLOT_DATE, 'DDMONYY')) > TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY'))
		)
		<isNotEmpty property="schCollNo"> AND a.SCH_COLL_NO &lt;&gt; #schCollNo# </isNotEmpty>
	</select>
	<select id="sqlGetSchCollIsValidURF" parameterClass="cargo.cms.uld.bo.URFTruckScheduleBO"
		resultClass="java.lang.Integer">
		SELECT COUNT(EIR_NO) FROM ULD_ISS_HD
		WHERE
		STATUS IN('APPROVED', 'PARTRELEASED') AND EIR_NO = #eirNo# AND PURPOSE = 'Agt'
	</select>
	<select id="sqlGetURFSchCollTruckGapHour" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT NVL(MAX(RULE_VALUE), 2) FROM CMSRULES WHERE RULE_CODE = 'URF_SCH_COLL_TRUCK_GAP'
	</select>
	<select id="sqlGetURFSchCollTruckInGap" parameterClass="cargo.cms.uld.bo.URFTruckScheduleBO"
		resultClass="java.lang.Integer">
		SELECT COUNT(SCH_COLL_NO)
		FROM EIR_SCH_COLL
		WHERE
		TIME_SLOT_DATE = #timeSlotDate# AND (TRUCK1 = #truckNo# OR TRUCK2 = #truckNo# OR TRUCK3 = #truckNo#) AND
		(
		(
		(TO_NUMBER(#timeSlotFrom#) - (SELECT NVL(MAX(RULE_VALUE), 2) * 100 FROM CMSRULES WHERE RULE_CODE = 'URF_SCH_COLL_TRUCK_GAP')) &lt;= TIME_SLOT_FROM
		 AND
		(TO_NUMBER(#timeSlotTo#) + (SELECT NVL(MAX(RULE_VALUE), 2) * 100 FROM CMSRULES WHERE RULE_CODE = 'URF_SCH_COLL_TRUCK_GAP')) &gt;= TIME_SLOT_FROM
		)
		OR
		(
		(TO_NUMBER(#timeSlotFrom#) - (SELECT NVL(MAX(RULE_VALUE), 2) * 100 FROM CMSRULES WHERE RULE_CODE = 'URF_SCH_COLL_TRUCK_GAP')) &lt;= TIME_SLOT_TO
		 AND
		(TO_NUMBER(#timeSlotTo#) + (SELECT NVL(MAX(RULE_VALUE), 2) * 100 FROM CMSRULES WHERE RULE_CODE = 'URF_SCH_COLL_TRUCK_GAP')) &gt;= TIME_SLOT_TO
		)
		)
		<isNotEmpty property="schCollNo"> AND SCH_COLL_NO &lt;&gt; #schCollNo# </isNotEmpty>
	</select>
	
	<select id="sqlGetURFAllocCount" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT COUNT(*) FROM
		ULD_TRUCK_EIR a, TRUCK_TRIP b
		WHERE
		a.TRIP_ID = b.TRIP_ID AND EIR_NO = #eirNo# AND RELEASED_YN = 'N'
		AND b.CLOSED = 'N' AND b.EXIT_IND = 'N' 
	</select>
	
	<update id="sqlUpdateURFSchCollTime" parameterClass="java.util.Map">
		UPDATE ULD_ISS_HD
		SET TIME_SLOT_DATE = TO_DATE(#DATE#, 'DDMONYY'), TIME_SLOT_FROM = #FROM#, TIME_SLOT_TO = #TO#,
		LM_USER_ID = #USER_ID#, LM_DATE = SYSDATE
		WHERE EIR_NO = #URF_NO#
	</update>		
	<!-- ULD Tow Order Out -->
	<select id="sqlGetTowOutOrderLoctns" resultClass="cargo.cms.uld.bo.URFNameValueBO">
		SELECT CODE	value, CODE_DESC name FROM MAST_WH_LOC ORDER BY CODE_DESC ASC
	</select>
	<select id="sqlGetTowOutOrderDests" resultClass="cargo.cms.uld.bo.URFNameValueBO">
		SELECT CODE value,
		CODE_DESC name FROM MAST_CODE_DTL WHERE CODE_TYPE = 'ULD_DESTINATION'
		ORDER BY CODE_DESC ASC
	</select>
	<select id="sqlGetTowOutMailFax" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.GenerateScmBO">
		SELECT EMAIL1 AS emailAddress1 ,EMAIL2 AS emailAddress2 , 
		EMAIL3 AS emailAddress3 , EMAIL4 AS emailAddress4 , 
		EMAIL5 AS emailAddress5 , 
		FAX1 AS faxNumber1 ,FAX2 AS faxNumber2 ,
		FAX3 AS faxNumber3
		FROM CUST_COMPANY WHERE CODE  = (SELECT MAX(RHO_ID) FROM TOW_ORDER_OUT WHERE TO_NO = #PARAM#)
	</select>	
	<select id="sqlGetTowOutOrderLoctn" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT COUNT(CODE) value FROM MAST_WH_LOC WHERE UPPER(CODE) = UPPER(#PARAM#) 
	</select>
	<select id="sqlGetRHOName" parameterClass="java.lang.String" resultClass="java.lang.String">
		SELECT CODE_DESC name FROM CUST_COMPANY	WHERE RHO_YN = 'Y' AND ACTIVE = 'Y' AND CODE = #PARAM#
	</select>		
	<select id="sqlGetTowOutRHOs" resultClass="cargo.cms.uld.bo.URFNameValueBO">
		SELECT CODE value, CODE_DESC name FROM CUST_COMPANY	WHERE RHO_YN = 'Y' AND ACTIVE = 'Y'
		ORDER BY 2 ASC
	</select>
	<select id="sqlGetTowOutOrders" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		SELECT TO_NO toNo, ULD_COUNT uldQty, TO_CHAR(EST_TIME, 'DDMONYY	HH24:MI') estTime,
		wh1.CODE_DESC pickUpLoctn,
		DEST_CODE destination
		FROM
		(
		SELECT a.TO_NO, COUNT(b.TO_NO) ULD_COUNT,
		EST_TIME, HO_AREA,
		DEST_CODE, RHO_ID
		FROM
		TOW_ORDER_OUT a
		LEFT OUTER JOIN TOW_ORDER_OUT_DTL
		b
		ON a.TO_NO = b.TO_NO
		WHERE 1 = 1 AND STATUS = 'ISSUED'  and a.type = 'Adhoc'
		<isNotEmpty property="rho"> AND RHO_ID = #rho# </isNotEmpty>
		<isNotEmpty property="destination"> AND DEST_CODE = #destination#</isNotEmpty>
		<isNotEmpty property="createFromDate"> AND	a.CR_DATE &gt;=	TO_DATE(#createFromDate#, 'DDMONYY HH24:MI')</isNotEmpty>
		<isNotEmpty property="createToDate"> AND a.CR_DATE &lt;= TO_DATE(#createToDate#, 'DDMONYY HH24:MI')</isNotEmpty>
		GROUP BY a.TO_NO, EST_TIME, HO_AREA, DEST_CODE, RHO_ID
		) tbl
		LEFT OUTER JOIN MAST_WH_LOC wh1
		ON tbl.HO_AREA = wh1.CODE
		LEFT OUTER JOIN	MAST_WH_LOC wh2
		ON tbl.DEST_CODE = wh2.CODE
		ORDER BY TO_NO DESC
	</select>
	<insert id="sqlInsertTowOutOrder" parameterClass="cargo.cms.uld.bo.URFTowOrderBO">
		INSERT INTO	TOW_ORDER_OUT
		(
		TO_NO, TYPE, RHO_ID, VER_NO,FLT_KEY, FLT_DATE,
		URF_NO,	DEST_CODE,EST_TIME, HO_AREA, STATUS,
		NOTF_SEND_DATE,	REM_1_DATE,	REM_2_DATE,VOID_USER_ID, VOID_DATE,
		CR_USER_ID, CR_DATE, LM_USER_ID,LM_DATE,FLT_TYPE
		)
		VALUES
		(
		#toNo#, #type#, #rhoId#, #verNo#,#fltKey#,
		TO_DATE(#fltDate#, 'DDMONYY HH24:MI'),#eirNo#, #destCode#,
		TO_DATE(#estTime#, 'DDMONYY HH24:MI'), #hoArea#, #status#,
		NVL2(#notfSendDate#,TO_DATE(#notfSendDate#,'DDMONYY HH24:MI'), SYSDATE),		
		TO_DATE(#rem1Date#,'DDMONYY HH24:MI'), TO_DATE(#rem2Date#, 'DDMONYY HH24:MI'),
		#voidUserId#, TO_DATE(#voidDate#, 'DDMONYY HH24:MI'),
		#crUserId#,	SYSDATE, #lmUserId#, SYSDATE,#fltType#
		)
	</insert>
	<insert id="sqlInsertTowOutOrderDtl" parameterClass="cargo.cms.uld.bo.URFTowOrderULDBO">
		INSERT INTO	TOW_ORDER_OUT_DTL
		(TO_NO, ULD_KEY,CR_USER_ID, CR_DATE, LM_USER_ID,LM_DATE)
		VALUES
		(#toNo#, #uldKey#,#crUserId#, SYSDATE, #lmUserId#,SYSDATE)
	</insert>
	<delete id="sqlDeleteTowOutOrderULD" parameterClass="cargo.cms.uld.bo.URFTowOrderBO">
		DELETE FROM	TOW_ORDER_OUT_DTL WHERE TO_NO = #toNo#
	</delete>
	<update id="sqlUpdateTowOutOrder" parameterClass="cargo.cms.uld.bo.URFTowOrderBO">
		UPDATE TOW_ORDER_OUT
		SET	RHO_ID = #rhoId#, VER_NO = VER_NO + 1, DEST_CODE = #destCode#, EST_TIME = TO_DATE(#estTime#, 'DDMONYY HH24:MI'),
		HO_AREA = #hoArea#, STATUS = #status#,LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE
		WHERE TO_NO = #toNo#
	</update>
	<update id="sqlUpdateVoidTowOutOrder" parameterClass="cargo.cms.uld.bo.URFTowOrderBO">
		UPDATE TOW_ORDER_OUT
		SET STATUS = 'VOID', LM_USER_ID = #lmUserId#, LM_DATE =	SYSDATE
		WHERE TO_NO = #toNo#
	</update>
	<select id="sqlGetTowOrderULDCount" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT COUNT(ULD_KEY) FROM ULD_INVENTORY WHERE ULD_KEY = #PARAM#
	</select>
	<select id="sqlGetTowOrderIssueCount" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT COUNT(TO_NO) FROM TOW_ORDER_OUT WHERE TO_NO = #PARAM# AND STATUS = 'ISSUED'
	</select>
	<select id="sqlGetTowOutOrderHdr" parameterClass="java.lang.String"
		resultClass="cargo.cms.uld.bo.URFTowOrderBO">
		SELECT
		TO_NO toNo, TYPE type, RHO_ID rhoId, VER_NO verNo,
		FLT_KEY fltKey, TO_CHAR(FLT_DATE, 'DDMONYY') fltDate, URF_NO urfNo,
		DEST_CODE destCode,
		LOC.CODE_DESC pickupLoctn,	TO_CHAR(EST_TIME, 'DDMONYY HH24:MI') estTime,
		HO_AREA hoArea, STATUS status,	TO_CHAR(NOTF_SEND_DATE, 'DDMONYY') notfSendDate,
		TO_CHAR(REM_1_DATE, 'DDMONYY') rem1Date, TO_CHAR(REM_2_DATE, 'DDMONYY') rem2Date,
		VOID_USER_ID voidUserId, TO_CHAR(VOID_DATE, 'DDMONYY') voidDate,
		OUT.CR_USER_ID	crUserId, TO_CHAR(OUT.CR_DATE, 'DDMONYY HH24:MI') crDate,
		OUT.LM_USER_ID lmUserId, TO_CHAR(OUT.LM_DATE, 'DDMONYY HH24:MI') lmDate,
		TO_CHAR(OUT.LM_DATE, 'DDMONYY HH24:MI:SS') lmMultiUserTime, FLT_TYPE fltType
		FROM
		TOW_ORDER_OUT OUT
    	LEFT OUTER JOIN MAST_WH_LOC LOC
    	ON OUT.HO_AREA = LOC.CODE
		WHERE TO_NO = #PARAM#
	</select>
	<select id="sqlGetTowOutOrderDtl" parameterClass="java.lang.String"
		resultClass="cargo.cms.uld.bo.URFTowOrderULDBO">
		SELECT TO_NO toNo, ULD_KEY uldKey,
		CR_USER_ID crUserId, TO_CHAR(CR_DATE, 'DDMONYY HH24:MI') crDate,
		LM_USER_ID lmUserId, TO_CHAR(LM_DATE, 'DDMONYY HH24:MI') lmDate
		FROM TOW_ORDER_OUT_DTL
		WHERE TO_NO = #PARAM#
	</select>
<select id="sqlGetAgentHoldingList" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[
		SELECT ULD.ULD_KEY uldNo, ULD.ULD_GROUP uldGroup, ULD.OWNER_ID carrCode,
		SPECIFICATION AS spec,
		ISS.EIR_NO urfNo, TO_CHAR(ISS.REL_DATE,'DDMONYY') issDate, TRUNC(SYSDATE) - TRUNC(ISS.REL_DATE)  elapsedDays,
		AGENT.CODE_DESC agentName, AGENT.CODE agentCustNo,
		(CASE WHEN (SELECT FREE_DAYS FROM MAST_DEMURAGE_FREE_DAYS WHERE CARR_CODE=ULD.OWNER_ID AND ULD_TYPE=ULD.ULD_TYPE AND ROWNUM=1) IS NOT NULL THEN
    	TO_CHAR(ISS.REL_DATE + NVL((SELECT FREE_DAYS FROM MAST_DEMURAGE_FREE_DAYS WHERE CARR_CODE=ULD.OWNER_ID AND ULD_TYPE=ULD.ULD_TYPE AND ROWNUM=1),0),'DDMONYY')
    	ELSE '' END) AS supposeRtnDate,
    	(SELECT (CASE WHEN ISSHD.SRF_NO IS NOT NULL THEN 'Import process' ELSE CASE WHEN (ISSHD.inboundtow_rel IS NOT NULL AND ISSHD.inboundtow_rel = 'Y') THEN 'Import process' ELSE 'Export process' END END) FROM ULD_ISS_HD ISSHD WHERE ISSHD.EIR_NO = ISS.EIR_NO AND ROWNUM         = 1) AS releaseType
		FROM
		(
		SELECT ULD_KEY, ULD.ULD_TYPE, GRP.ULD_GROUP, SPEC.SPECIFICATION , OWNER_ID
		FROM ULD_INVENTORY ULD
		LEFT OUTER JOIN ULD_GROUP_TYPE GRP
		ON ULD.ULD_TYPE = GRP.ULD_TYPE
		LEFT OUTER JOIN ULD_TYPE_CARR_TARE_WT SPEC
		ON ULD.ULD_CARR = SPEC.ULD_CARR AND ULD.ULD_TYPE = SPEC.ULD_TYPE AND 
		TO_NUMBER(ULD.ULD_NO) >= SPEC.ULD_NO_FROM AND TO_NUMBER(ULD.ULD_NO) <= SPEC.ULD_NO_TO		
		WHERE AGENT_INV = 'Y' AND AGENT_ID IS NOT NULL
		) ULD
		LEFT OUTER JOIN
		(
		SELECT MAX(TO_NUMBER(TR_NO)) TR_NO, ULD_KEY, ULD_CARR
		FROM ULD_REL_DTL
		WHERE ULD_EQUIP = 'U' AND ULD_KEY IN(SELECT ULD_KEY FROM ULD_INVENTORY ULD WHERE AGENT_INV = 'Y' AND AGENT_ID IS NOT NULL)
		GROUP BY ULD_KEY, ULD_CARR
		) REL
		ON ULD.ULD_KEY = REL.ULD_KEY
		LEFT OUTER JOIN ULD_REL_HD ISS
		ON REL.TR_NO = ISS.TR_NO
		LEFT OUTER JOIN CUST_COMPANY AGENT
		ON ISS.AGENT_CUST_NO = AGENT.CODE
		WHERE 1 = 1
		]]>
		<isNotEmpty property="carrCode">
			<isNotEqual property="carrCode" compareValue="ALL"> AND	ULD.OWNER_ID = #carrCode#</isNotEqual>
			<isNotEmpty property="loginCarrier">
				AND (ULD.OWNER_ID = #loginCarrier#
				OR ULD.OWNER_ID IN (SELECT CARR_CODE FROM MAST_CARR_GRP WHERE GRP_CARR_CODE	= #loginCarrier#)) 	
			</isNotEmpty> 
		</isNotEmpty>
		<isNotEmpty property="agentName"> AND AGENT.CODE = #agentCode#</isNotEmpty>
		<isNotEmpty property="uldType">	AND ULD.ULD_TYPE = #uldType#</isNotEmpty>
		<isNotEmpty property="uldGroup"> AND ULD.ULD_GROUP = #uldGroup#	</isNotEmpty>
		<dynamic prepend="ORDER BY ">
			<isNotEmpty property="sortOrder.sortField">
				$sortOrder.sortField$
           </isNotEmpty>
			<isEmpty property="sortOrder.sortField">
				ULD.ULD_GROUP ASC, ULD.ULD_TYPE ASC, AGENT.CODE_DESC ASC, ROUND(SYSDATE - ISS.REL_DATE) ASC
           </isEmpty>           
		</dynamic>		
	</select>
	<select id="sqlGetAgentHoldingListCOUNT" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM (
		<![CDATA[
		SELECT ULD.ULD_KEY uldNo, ULD.ULD_GROUP uldGroup, ULD.OWNER_ID carrCode,
		SPECIFICATION AS spec,
		ISS.EIR_NO urfNo, TO_CHAR(ISS.REL_DATE,'DDMONYY') issDate, ROUND(SYSDATE - ISS.REL_DATE) elapsedDays,
		AGENT.CODE_DESC agentName, AGENT.CODE agentCustNo, 
		(CASE WHEN (SELECT FREE_DAYS FROM MAST_DEMURAGE_FREE_DAYS WHERE CARR_CODE=ULD.OWNER_ID AND ULD_TYPE=ULD.ULD_TYPE AND ROWNUM=1) IS NOT NULL THEN
    	TO_CHAR(ISS.REL_DATE + NVL((SELECT FREE_DAYS FROM MAST_DEMURAGE_FREE_DAYS WHERE CARR_CODE=ULD.OWNER_ID AND ULD_TYPE=ULD.ULD_TYPE AND ROWNUM=1),0),'DDMONYY')
    	ELSE '' END) AS supposeRtnDate,
    	(SELECT (CASE WHEN ISSHD.SRF_NO IS NOT NULL THEN 'Import process' ELSE CASE WHEN (ISSHD.inboundtow_rel IS NOT NULL AND ISSHD.inboundtow_rel = 'Y') THEN 'Import process' ELSE 'Export process' END END) FROM ULD_ISS_HD ISSHD WHERE ISSHD.EIR_NO = ISS.EIR_NO AND ROWNUM         = 1) AS releaseType
		FROM
		(
		SELECT ULD_KEY, ULD.ULD_TYPE, GRP.ULD_GROUP, SPEC.SPECIFICATION, OWNER_ID
		FROM ULD_INVENTORY ULD
		LEFT OUTER JOIN ULD_GROUP_TYPE GRP
		ON ULD.ULD_TYPE = GRP.ULD_TYPE
		LEFT OUTER JOIN ULD_TYPE_CARR_TARE_WT SPEC
		ON ULD.ULD_CARR = SPEC.ULD_CARR AND ULD.ULD_TYPE = SPEC.ULD_TYPE AND 
		TO_NUMBER(ULD.ULD_NO) >= SPEC.ULD_NO_FROM AND TO_NUMBER(ULD.ULD_NO) <= SPEC.ULD_NO_TO		
		WHERE AGENT_INV = 'Y' AND AGENT_ID IS NOT NULL
		) ULD
		LEFT OUTER JOIN
		(
		SELECT MAX(TO_NUMBER(TR_NO)) TR_NO, ULD_KEY, ULD_CARR
		FROM ULD_REL_DTL
		WHERE ULD_EQUIP = 'U' AND ULD_KEY IN(SELECT ULD_KEY FROM ULD_INVENTORY ULD WHERE AGENT_INV = 'Y' AND AGENT_ID IS NOT NULL)
		GROUP BY ULD_KEY, ULD_CARR
		) REL
		ON ULD.ULD_KEY = REL.ULD_KEY
		LEFT OUTER JOIN ULD_REL_HD ISS
		ON REL.TR_NO = ISS.TR_NO
		LEFT OUTER JOIN CUST_COMPANY AGENT
		ON ISS.AGENT_CUST_NO = AGENT.CODE
		WHERE 1 = 1
		]]>
		<isNotEmpty property="carrCode">
			<isNotEqual property="carrCode" compareValue="ALL"> AND	ULD.OWNER_ID = #carrCode#</isNotEqual>
			<isNotEmpty property="loginCarrier">
				AND (ULD.OWNER_ID = #loginCarrier#
				OR ULD.OWNER_ID IN (SELECT CARR_CODE FROM MAST_CARR_GRP WHERE GRP_CARR_CODE	= #loginCarrier#)) 	
			</isNotEmpty> 
		</isNotEmpty>
		<isNotEmpty property="agentName"> AND AGENT.CODE_DESC = UPPER(#agentName#)</isNotEmpty>
		<isNotEmpty property="uldType">	AND ULD.ULD_TYPE = #uldType#</isNotEmpty>
		<isNotEmpty property="uldGroup"> AND ULD.ULD_GROUP = #uldGroup#	</isNotEmpty>
		<dynamic prepend="ORDER BY ">
			<isNotEmpty property="sortOrder.sortField">
				$sortOrder.sortField$
           </isNotEmpty>
			<isEmpty property="sortOrder.sortField">
				ULD.ULD_GROUP ASC, ULD.ULD_TYPE ASC, AGENT.CODE_DESC ASC, ROUND(SYSDATE - ISS.REL_DATE) ASC
           </isEmpty>           
		</dynamic>
		)
	</select>	
	<select id="sqlGetOutstandingURFs" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[ 
		SELECT ISS.EIR_NO urfNo, ISS.CARR_CODE carrCode, TO_CHAR(APR_DATE, 'DDMONYY') refDate, 
		FLT_NO || NVL2(FLT_NO, '/', '') || TO_CHAR(FLT_DATE, 'DDMONYY') fltDate, 
		AGENT.CODE_DESC agentName, COD.CODE_DESC purpose,
	    (
	    SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || (NVL(ULD_APR_QTY, 0) - NVL(ULD_REL_QTY, 0)), ', ')) 
	      FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND ULD_EQUIP = 'U' AND (NVL(ULD_APR_QTY, 0) - NVL(ULD_REL_QTY, 0)) > 0
	    ) outstandULD,
	    (
	    SELECT STRAGG(STRINGDELIM(EQUIP.EQUIP_TYPE || '-' || (SUM(NVL(EQUIP.EQUIP_APR_QTY, 0)) - SUM(NVL(EQUIP.EQUIP_REL_QTY, 0))), ', '))
      		FROM ULD_ISS_DTL EQUIP
      		WHERE EQUIP.ULD_EQUIP IN ('E', 'B')	AND EQUIP.EIR_NO = ISS.EIR_NO AND (EQUIP.EQUIP_APR_QTY - NVL(EQUIP.EQUIP_REL_QTY, 0)) > 0    
     		GROUP BY EQUIP.EQUIP_TYPE
	    ) outstandAcc		
		FROM
		ULD_ISS_HD ISS
		LEFT OUTER JOIN CUST_COMPANY AGENT
		ON ISS.AGENT_CUST_NO = AGENT.CODE
		LEFT OUTER JOIN MAST_CODE_DTL COD
		ON ISS.PURPOSE = COD.CODE AND COD.CODE_TYPE = 'URF_PURPOSE'
		WHERE
		ISS.STATUS IN('APPROVED', 'PARTRELEASED')
		AND ISS.EIR_NO IN (
		  SELECT ULD.EIR_NO
		  FROM ULD_ISS_HD HD, ULD_ISS_DTL ULD
		  WHERE HD.EIR_NO = ULD.EIR_NO AND HD.STATUS IN('APPROVED', 'PARTRELEASED') AND ULD_EQUIP = 'U' 
		  AND (ULD_APR_QTY - NVL(ULD_REL_QTY, 0)) > 0 AND HD.EIR_EXPIRY_DATE >= SYSDATE
		  UNION
		  SELECT EQUIP.EIR_NO
		  FROM ULD_ISS_HD HD, ULD_ISS_DTL EQUIP
		  WHERE HD.EIR_NO = EQUIP.EIR_NO AND HD.STATUS IN('APPROVED', 'PARTRELEASED') AND ULD_EQUIP IN ('E', 'B') 
		  AND (EQUIP_APR_QTY - NVL(EQUIP_REL_QTY, 0)) > 0 AND HD.EIR_EXPIRY_DATE >= SYSDATE
		)		
		]]>
		<isNotEmpty property="carrCode">
			<isNotEqual property="carrCode" compareValue="ALL"> AND	ISS.CARR_CODE = #carrCode#</isNotEqual>
			<isNotEmpty property="loginCarrier">
				AND (ISS.CARR_CODE = #loginCarrier#
				OR ISS.CARR_CODE IN (SELECT CARR_CODE FROM MAST_CARR_GRP 
				WHERE GRP_CARR_CODE	= #loginCarrier#)) 	
			</isNotEmpty> 
		</isNotEmpty>
		<isNotEmpty property="agentName"> AND AGENT.CODE_DESC = UPPER(#agentName#)</isNotEmpty>
		<isNotEmpty property="purpose">	AND ISS.PURPOSE = #purpose#	</isNotEmpty>
		<dynamic prepend="ORDER BY ">
			<isNotEmpty property="sortOrder.sortField">
				$sortOrder.sortField$
           </isNotEmpty>
			<isEmpty property="sortOrder.sortField">
				ISS.EIR_NO ASC
           </isEmpty>           
		</dynamic>
	</select>
	<select id="sqlGetOutstandingULDs" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[ 
		SELECT ULD_GROUP || ULD_TYPE || '-' || TO_CHAR(ULD_APR_QTY - NVL(ULD_REL_QTY, 0)) outstandULD
		FROM
		ULD_ISS_HD ISS, ULD_ISS_DTL ULD
		WHERE ISS.EIR_NO = ULD.EIR_NO AND ISS.STATUS IN('APPROVED', 'PARTRELEASED')
		AND ISS.EIR_EXPIRY_DATE >= SYSDATE 
		AND ULD.ULD_EQUIP = 'U' 
		AND ULD.EIR_NO = #urfNo# AND
		(ULD_APR_QTY - NVL(ULD_REL_QTY, 0)) > 0
		]]>
	</select>
	<select id="sqlGetOutstandingEquips" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[ 
			SELECT 2 ORD, DOC_LINE_NO,
			EQUIP_TYPE || '-' || TO_CHAR(EQUIP_APR_QTY - NVL(EQUIP_REL_QTY, 0)) outstandAcc
			FROM
			(
			  SELECT DISTINCT EQUIP_TYPE, STRAGG(STRINGDELIM(DOC_LINE_NO, '0')) DOC_LINE_NO,
			  (SELECT SUM(EQUIP_APR_QTY) FROM ULD_ISS_DTL WHERE EIR_NO = EQUIP.EIR_NO AND EQUIP_TYPE = EQUIP.EQUIP_TYPE) EQUIP_APR_QTY,
			  (SELECT SUM(NVL(EQUIP_REL_QTY, 0)) FROM ULD_ISS_DTL WHERE EIR_NO = EQUIP.EIR_NO AND EQUIP_TYPE = EQUIP.EQUIP_TYPE) EQUIP_REL_QTY
			  FROM (
			    SELECT * 
			    FROM ULD_ISS_DTL 
			    WHERE EIR_NO = #urfNo# AND ULD_EQUIP IN ('E', 'B')
			    ORDER BY DOC_LINE_NO
			  ) EQUIP
			  WHERE
			  (EQUIP_APR_QTY - NVL(EQUIP_REL_QTY, 0)) > 0 
			  GROUP BY EQUIP_TYPE, EIR_NO
			)
			ORDER BY 1, 2
		]]>
	</select>
	<!-- Exit Check Post -->
	<select id="sqlGetExitCheckpostURFs" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFHHTBO">
		SELECT DISTINCT HDR.TR_NO trNo, HDR.EIR_NO eirNo, HDR.TRUCK_NO truckNo
		FROM ULD_REL_HD HDR, ULD_TRUCK_EIR TRK
		WHERE
		HDR.EIR_NO = TRK.EIR_NO AND  TRK.RELEASED_YN = 'Y' 
    	AND TRK.TRIP_ID = #tripId#
   		AND HDR.CR_DATE BETWEEN  (SELECT CR_DATE from ULD_TRUCK_EIR WHERE TRIP_ID = #tripId# AND EIR_NO =  TRK.EIR_NO)  
    	AND NVL((SELECT MIN(CR_DATE) from ULD_TRUCK_EIR WHERE  EIR_NO =  TRK.EIR_NO  AND TRIP_ID > #tripId#),SYSDATE) 
	</select>
	
	<select id="sqlGetExitCheckPostTripId" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		SELECT MAX(TRIP_ID) FROM TRUCK_TRIP WHERE TRUCK_NO = #truckNo# AND EXIT_IND = 'N' AND CLOSED = 'N'
	</select>
	<select id="sqlGetExitCheckpostULDs" parameterClass="cargo.cms.uld.bo.URFHHTBO"
		resultClass="cargo.cms.uld.bo.URFHHTBO">
		SELECT ULD_KEY uldNo 
		FROM ULD_REL_HD HDR, 
		ULD_REL_DTL DTL WHERE HDR.TR_NO = DTL.TR_NO AND 
		ULD_EQUIP =	'U' AND HDR.TR_NO = #trNo# AND HDR.EIR_NO = #eirNo# AND TRUCK_NO = #truckNo#
	</select>
	<update id="sqlUpdateURFTruckExitMark" parameterClass="cargo.cms.uld.bo.URFHHTBO">
		UPDATE TRUCK_TRIP
		SET EXIT_IND = 'Y', LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE, REJ_RMK = #rmk# 
		WHERE TRIP_ID = (SELECT MAX(TRIP_ID) FROM TRUCK_TRIP WHERE TRUCK_NO = #truckNo# AND EXIT_IND = 'N' AND CLOSED = 'N') 
		AND TRUCK_NO = #truckNo#
	</update>
	<update id="sqlUpdateURFTruckExitRemark" parameterClass="cargo.cms.uld.bo.URFHHTBO">
		UPDATE TRUCK_TRIP
		SET EXIT_IND = 'N', REJ_RMK = #rmk#, LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE
		WHERE TRIP_ID = (SELECT MAX(TRIP_ID) FROM TRUCK_TRIP WHERE TRUCK_NO = #truckNo# AND EXIT_IND = 'N' AND CLOSED = 'N') 
		AND TRUCK_NO = #truckNo#
	</update>	
	<select id="sqlGetTermsConditionState" parameterClass="java.lang.String" resultClass="java.lang.String">
		SELECT MAX(TC_IND) FROM MAINTAIN_TC WHERE FUNCTION_CODE = #PARAM#
	</select>
	<!-- UCO Check List -->
	<select id="sqlGetUCOAgentHeaderList" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		SELECT type, id, truckNo, arrived, schCollTime, truckDockTarget, trucker, truckInQueueYN
		FROM
		(
		SELECT DISTINCT 'T' type, TRIP.TRIP_ID id, TRUCK_NO	truckNo, 'Y' arrived, '' schCollTime, TRIP.TRUCK_DOCK truckDockTarget, '' trucker, 
		TRUCK_QUEUE_IND truckInQueueYN
		FROM ULD_TRUCK_EIR EIR, TRUCK_TRIP TRIP
		WHERE
		TRIP.TRIP_ID = EIR.TRIP_ID AND TRIP.EXIT_IND = 'N' AND TRIP.CLOSED = 'N'
		UNION
		SELECT DISTINCT 'S'	type, HDR.SCH_COLL_NO id, 
		NVL2(TRIP.TRUCK_NO, TRIP.TRUCK_NO, NVL2(HDR.TRUCK1, HDR.TRUCK1, NVL2(HDR.TRUCK2, HDR.TRUCK2, HDR.TRUCK3))) truckNo, 
		NVL2(TRIP.TRIP_ID, 'Y', 'N') arrived,
		TO_CHAR(HDR.TIME_SLOT_DATE, 'DDMONYY')
		|| ' '
		|| SUBSTR(TRIM(TO_CHAR(HDR.TIME_SLOT_FROM,'0000')),1,2)
    	|| NVL2(HDR.TIME_SLOT_FROM, ':', '') 
    	|| SUBSTR(TRIM(TO_CHAR(HDR.TIME_SLOT_FROM,'0000')),3,4)
		|| '-'
		|| SUBSTR(TRIM(TO_CHAR(HDR.TIME_SLOT_TO,'0000')),1,2) 
    	|| NVL2(HDR.TIME_SLOT_TO,	':', '') 
    	|| SUBSTR(TRIM(TO_CHAR(HDR.TIME_SLOT_TO,'0000')),3,4) schCollTime,
		TRIP.TRUCK_DOCK truckDockTarget, '' trucker, NVL(TRUCK_QUEUE_IND, 'N') truckInQueueYN
		FROM EIR_SCH_COLL HDR
    	LEFT OUTER JOIN TRUCK_TRIP TRIP
    	ON (HDR.TRUCK1 = TRIP.TRUCK_NO OR HDR.TRUCK2 = TRIP.TRUCK_NO OR HDR.TRUCK3 = TRIP.TRUCK_NO) AND TRIP.EXIT_IND = 'N' AND TRIP.CLOSED = 'N'
		WHERE
		(
		TO_DATE(TO_CHAR(HDR.TIME_SLOT_DATE, 'DDMONYY')) = TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY')) AND HDR.TIME_SLOT_TO &gt;= TO_NUMBER(TO_CHAR(SYSDATE, 'HH24MI')) OR 
		TO_DATE(TO_CHAR(HDR.TIME_SLOT_DATE, 'DDMONYY')) &gt; TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY'))
		)
		)
		<!-- Sort by Truck Arrived -->
		ORDER BY arrived DESC, type DESC
	</select>
	<select id="sqlGetUCOAgentTruckURFList" parameterClass="cargo.cms.uld.bo.URFUCOCheckListBO"
		resultClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		SELECT EIR_NO urfNo, ISS.CARR_CODE carrCode, PURP.CODE_DESC purpose,
		CUST.CODE_DESC agentName, TO_CHAR(EST_TIME, 'DDMONYY HH24:MI') estTime,
		UCO_AMEND_YN amended, TO_CHAR(ACK_DATE, 'DDMONYY HH24:MI') ackTime,
		TO_CHAR(ISS.LM_DATE, 'DDMONYY HH24:MI') lmDate, TO_CHAR(ISS.LM_DATE, 'DDMONYY HH24:MI:SS') lmMultiUserTime, STAT.CODE_DESC status,
		NVL((SELECT RELEASED_YN FROM ULD_TRUCK_EIR TEIR, TRUCK_TRIP TRK 
			WHERE TEIR.TRIP_ID = TRK.TRIP_ID AND TEIR.EIR_NO = ISS.EIR_NO AND TEIR.TRIP_ID = #id#
		), 'N') releasedYN		
		FROM ULD_ISS_HD ISS
		LEFT OUTER JOIN MAST_CODE_DTL PURP
		ON ISS.PURPOSE = PURP.CODE
		LEFT OUTER JOIN MAST_CODE_DTL STAT
		ON ISS.STATUS = STAT.CODE,
		CUST_COMPANY CUST
		WHERE ISS.AGENT_CUST_NO = CUST.CODE AND	ISS.STATUS IN('APPROVED','PARTRELEASED') AND
		PURP.CODE_TYPE = 'URF_PURPOSE' AND STAT.CODE_TYPE = 'URF_STATUS' AND
		ISS.PURPOSE = 'Agt'	AND ISS.EIR_EXPIRY_DATE &gt;= SYSDATE
		AND ISS.EIR_NO IN(SELECT EIR_NO FROM ULD_TRUCK_EIR WHERE TRIP_ID =	#id#)
		<isNotEmpty property="agentCode"> AND ISS.AGENT_CUST_NO = #agentCode#</isNotEmpty>
	</select>
	<select id="sqlGetUCOAgentSchCollURFList" parameterClass="cargo.cms.uld.bo.URFUCOCheckListBO"
		resultClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		SELECT EIR_NO urfNo, ISS.CARR_CODE carrCode, PURP.CODE_DESC purpose,
          CUST.CODE_DESC agentName, TO_CHAR(EST_TIME, 'DDMONYY HH24:MI') estTime,
          UCO_AMEND_YN amended, TO_CHAR(ACK_DATE, 'DDMONYY HH24:MI') ackTime,
          TO_CHAR(ISS.LM_DATE, 'DDMONYY HH24:MI') lmDate, TO_CHAR(ISS.LM_DATE, 'DDMONYY HH24:MI:SS') lmMultiUserTime, STAT.CODE_DESC status
          FROM ULD_ISS_HD ISS
          LEFT OUTER JOIN MAST_CODE_DTL PURP
          ON ISS.PURPOSE = PURP.CODE
          LEFT OUTER JOIN MAST_CODE_DTL STAT
          ON ISS.STATUS = STAT.CODE,
          CUST_COMPANY CUST
          WHERE ISS.AGENT_CUST_NO = CUST.CODE AND ISS.STATUS IN('APPROVED', 'PARTRELEASED') AND
          PURP.CODE_TYPE = 'URF_PURPOSE' AND STAT.CODE_TYPE = 'URF_STATUS' AND
          ISS.PURPOSE = 'Agt' AND ISS.EIR_EXPIRY_DATE &gt;= SYSDATE
          AND  ISS.TIME_SLOT_DATE is not null and ISS.EIR_NO IN(SELECT EIR_NO FROM EIR_SCH_COLL_DTL WHERE SCH_COLL_NO = #id#)
          <isNotEmpty property="agentCode"> AND ISS.AGENT_CUST_NO = #agentCode#</isNotEmpty>
          <isNotEmpty property="truckNo">
              <isNotEmpty property="timeUpto">
              AND TO_DATE(TO_CHAR(ISS.TIME_SLOT_DATE, 'DDMONYY') || ' ' || TRIM(TO_CHAR(ISS.TIME_SLOT_FROM,'0000')), 'DDMONYY HH24MI') &lt; TO_DATE(#timeUpto#, 'DDMONYY HH24:MI')
              </isNotEmpty>
          </isNotEmpty>
          <isEmpty property="truckNo">
              <isNotEmpty property="timeUpto">
              AND TO_DATE(TO_CHAR(ISS.TIME_SLOT_DATE, 'DDMONYY') || ' ' || TRIM(TO_CHAR(ISS.TIME_SLOT_FROM,'0000')), 'DDMONYY HH24MI') &lt; TO_DATE(#timeUpto#, 'DDMONYY HH24:MI')
              AND (TO_DATE(TO_CHAR(ISS.TIME_SLOT_DATE, 'DDMONYY') || ' ' || TRIM(TO_CHAR(ISS.TIME_SLOT_TO,'0000')), 'DDMONYY HH24MI') + (#timeUptoExtMin#/60/24)) &gt; SYSDATE
			  </isNotEmpty>
		  </isEmpty>
	</select>
	<select id="sqlGetUCOAgentWithoutTruckURFList" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		SELECT EIR_NO urfNo, ISS.CARR_CODE carrCode, PURP.CODE_DESC purpose,
			CUST.CODE_DESC agentName, TO_CHAR(EST_TIME, 'DDMONYY HH24:MI') estTime,
			UCO_AMEND_YN amended, TO_CHAR(ACK_DATE, 'DDMONYY HH24:MI') ackTime,
			TO_CHAR(ISS.LM_DATE, 'DDMONYY HH24:MI') lmDate, TO_CHAR(ISS.LM_DATE, 'DDMONYY HH24:MI:SS') lmMultiUserTime, STAT.CODE_DESC status,
			ISS.SCH_RLS
			FROM ULD_ISS_HD ISS
			LEFT OUTER JOIN MAST_CODE_DTL PURP
			ON ISS.PURPOSE = PURP.CODE
			LEFT OUTER JOIN MAST_CODE_DTL STAT
			ON ISS.STATUS = STAT.CODE,
			CUST_COMPANY CUST
			WHERE ISS.AGENT_CUST_NO = CUST.CODE AND ISS.STATUS IN('APPROVED','PARTRELEASED') AND
			PURP.CODE_TYPE = 'URF_PURPOSE' AND STAT.CODE_TYPE = 'URF_STATUS' AND
			ISS.PURPOSE = 'Agt'	AND ISS.EIR_EXPIRY_DATE &gt;= SYSDATE AND
	    EIR_NO NOT IN
	    (
	      SELECT EIR.EIR_NO
	      FROM TRUCK_TRIP TRIP, ULD_TRUCK_EIR EIR
	      WHERE
	      TRIP.TRIP_ID = EIR.TRIP_ID AND TRIP.EXIT_IND = 'N' AND TRIP.CLOSED = 'N'
	      UNION
	      SELECT DTL.EIR_NO
	      FROM EIR_SCH_COLL HDR, EIR_SCH_COLL_DTL DTL
	      WHERE
	      HDR.SCH_COLL_NO = DTL.SCH_COLL_NO AND
	      (
	      TO_DATE(TO_CHAR(HDR.TIME_SLOT_DATE, 'DDMONYY')) = TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY')) AND HDR.TIME_SLOT_TO &gt;= TO_NUMBER(TO_CHAR(SYSDATE, 'HH24MI')) OR 
	      TO_DATE(TO_CHAR(HDR.TIME_SLOT_DATE, 'DDMONYY')) &gt; TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY'))
	      )
	      UNION
	      SELECT EIR_NO
	      FROM ULD_ISS_HD ISS
	      WHERE ISS.EIR_EXPIRY_DATE &gt;= SYSDATE AND SCH_RLS = 'Y'
	    )
		<isNotEmpty property="agentCode"> AND ISS.AGENT_CUST_NO = #agentCode#</isNotEmpty>
		<isNotEmpty property="timeUpto"> AND ISS.EST_TIME &lt; TO_DATE(#timeUpto#, 'DDMONYY HH24:MI')</isNotEmpty>
		<dynamic prepend="ORDER BY ">
			<isEmpty property="sortOrder.sortField">
				ISS.SCH_RLS DESC
			</isEmpty>
		</dynamic>
	</select>
	<select id="sqlGetUCOAgentSchCollWithoutTruckURFList" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		SELECT EIR_NO urfNo, ISS.CARR_CODE carrCode, PURP.CODE_DESC purpose,
			CUST.CODE_DESC agentName, TO_CHAR(EST_TIME, 'DDMONYY HH24:MI') estTime,
			UCO_AMEND_YN amended, TO_CHAR(ACK_DATE, 'DDMONYY HH24:MI') ackTime,
			TO_CHAR(ISS.LM_DATE, 'DDMONYY HH24:MI') lmDate, TO_CHAR(ISS.LM_DATE, 'DDMONYY HH24:MI:SS') lmMultiUserTime, STAT.CODE_DESC status,
			ISS.SCH_RLS
			FROM ULD_ISS_HD ISS
			LEFT OUTER JOIN MAST_CODE_DTL PURP
			ON ISS.PURPOSE = PURP.CODE
			LEFT OUTER JOIN MAST_CODE_DTL STAT
			ON ISS.STATUS = STAT.CODE,
			CUST_COMPANY CUST
			WHERE ISS.AGENT_CUST_NO = CUST.CODE AND ISS.STATUS IN('APPROVED','PARTRELEASED') AND
			PURP.CODE_TYPE = 'URF_PURPOSE' AND STAT.CODE_TYPE = 'URF_STATUS' AND
			ISS.PURPOSE = 'Agt'	AND ISS.EIR_EXPIRY_DATE &gt;= SYSDATE AND SCH_RLS = 'Y' AND
	    EIR_NO NOT IN
	    (
	      SELECT EIR.EIR_NO
	      FROM TRUCK_TRIP TRIP, ULD_TRUCK_EIR EIR
	      WHERE
	      TRIP.TRIP_ID = EIR.TRIP_ID AND TRIP.EXIT_IND = 'N' AND TRIP.CLOSED = 'N'
	      UNION
	      SELECT DTL.EIR_NO
	      FROM EIR_SCH_COLL HDR, EIR_SCH_COLL_DTL DTL
	      WHERE
	      HDR.SCH_COLL_NO = DTL.SCH_COLL_NO AND
	      (
	      TO_DATE(TO_CHAR(HDR.TIME_SLOT_DATE, 'DDMONYY')) = TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY')) AND HDR.TIME_SLOT_TO &gt;= TO_NUMBER(TO_CHAR(SYSDATE, 'HH24MI')) OR 
	      TO_DATE(TO_CHAR(HDR.TIME_SLOT_DATE, 'DDMONYY')) &gt; TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY'))
	      )
	    )
		<isNotEmpty property="agentCode"> AND ISS.AGENT_CUST_NO = #agentCode#</isNotEmpty>
		<isNotEmpty property="timeUpto"> AND ISS.EST_TIME &lt; TO_DATE(#timeUpto#, 'DDMONYY HH24:MI')</isNotEmpty>
		<dynamic prepend="ORDER BY ">
			<isEmpty property="sortOrder.sortField">
				ISS.EST_TIME
			</isEmpty>
		</dynamic>
	</select>	
	<select id="sqlGetUCONonAgentURFList" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		SELECT EIR_NO urfNo, CARR_CODE carrCode, PURP.CODE_DESC purpose,
		TO_CHAR(EST_TIME, 'DDMONYY HH24:MI') estTime,
		UCO_AMEND_YN amended, TO_CHAR(ACK_DATE, 'DDMONYY HH24:MI') ackTime,
		TO_CHAR(ISS.LM_DATE, 'DDMONYY HH24:MI') lmDate, TO_CHAR(ISS.LM_DATE, 'DDMONYY HH24:MI:SS') lmMultiUserTime, STAT.CODE_DESC status
		FROM ULD_ISS_HD ISS
		LEFT OUTER JOIN MAST_CODE_DTL PURP
		ON ISS.PURPOSE = PURP.CODE
		LEFT OUTER JOIN MAST_CODE_DTL STAT
		ON ISS.STATUS = STAT.CODE
		WHERE
		ISS.STATUS IN('APPROVED', 'PARTRELEASED') AND
		PURP.CODE_TYPE = 'URF_PURPOSE' AND STAT.CODE_TYPE = 'URF_STATUS' AND
		ISS.PURPOSE &lt;&gt; 'Agt' AND ISS.EIR_EXPIRY_DATE &gt;= SYSDATE
		<isNotEmpty property="purpose"> AND ISS.PURPOSE = #purpose#</isNotEmpty>
		<isNotEmpty property="timeUpto"> AND ISS.EST_TIME &lt; TO_DATE(#timeUpto#, 'DDMONYY HH24:MI')</isNotEmpty>
	</select>
	<select id="sqlGetUCOFlightHeaderList" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		SELECT trNo, fltNo, fltDate, fltNoDate, ucoRmk, std
	    FROM
	    (
	    	SELECT MSG.TR_NO trNo, MSG.FLT_KEY fltNo, TO_CHAR(MSG.FLT_DATE, 'DDMONYY') fltDate, 
			MSG.FLT_KEY || '/' || TO_CHAR(MSG.FLT_DATE, 'DDMONYY') fltNoDate, UCO_RMK ucoRmk,
			SUBSTR(TRIM(TO_CHAR(FLT.SCH_TIME,'0000')),1,2) || NVL2(FLT.SCH_TIME, ':', '') || SUBSTR(TRIM(TO_CHAR(FLT.SCH_TIME,'0000')),3,4) std,
	    	SUBSTR(TRIM(TO_CHAR(NVL(FLT.SCH_TIME, 0),'0000')),1,2)  FLTHOUR,
	    	SUBSTR(TRIM(TO_CHAR(NVL(FLT.SCH_TIME, 0),'0000')),3,4) FLTMIN
			FROM EDI_ELP_MSG MSG
		    JOIN FLT_OPR FLT
		    ON MSG.FLT_KEY = FLT.FLT_KEY AND MSG.FLT_DATE = FLT.SCH_DATE AND FLT.FLT_TYPE = 'D'
		    WHERE MSG.FLT_DATE &gt;= TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY')) AND
		    MSG.TR_NO = (SELECT MAX(TR_NO) FROM EDI_ELP_MSG WHERE FLT_KEY = FLT.FLT_KEY AND FLT_DATE = FLT.SCH_DATE AND FLT_TYPE = 'D')
	    )
	    WHERE 1 = 1
	    <isNotEmpty property="timeUpto"> 
	    AND TO_DATE((fltDate || ' ' || FLTHOUR || ':' || FLTMIN), 'DDMONYY HH24:MI') &lt; TO_DATE(#timeUpto#, 'DDMONYY HH24:MI')
	    </isNotEmpty>
	</select>
	<select id="sqlGetUCOFlightAllotList" parameterClass="cargo.cms.uld.bo.URFUCOCheckListBO"
		resultClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		<![CDATA[ 
		SELECT TR_NO trNo, DOC_LINE_NO docLineNo, INSTRUCTION instruction, 
		QTY_Q7 q7, QTY_Q6 q6, QTY_X8 x8, QTY_PEB peb, QTY_H2 h2, QTY_A2 a2, QTY_LDC ldc, QTY_H5 h5, RMK rmk
		FROM EDI_ELP_ALLOT ALLOT
		WHERE ALLOT.TR_NO = #trNo# AND CGO_TYPE = 'EIC'
		]]>
	</select>		
	<select id="sqlGetURFOutstandings" parameterClass="cargo.cms.uld.bo.URFUCOCheckListBO"
		resultClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		<![CDATA[
			SELECT 1 ORD, ('U' || DOC_LINE_NO) DOC_LINE_NO,
			ULD_GROUP || ULD_TYPE || '-' || TO_CHAR(ULD_APR_QTY - NVL(ULD_REL_QTY, 0)) outstandQty
			FROM
			ULD_ISS_DTL ULD
			WHERE
			ULD.ULD_EQUIP = 'U' 
			AND ULD.EIR_NO = #urfNo# AND
			(ULD_APR_QTY - NVL(ULD_REL_QTY, 0)) > 0
			UNION
			SELECT 2 ORD, DOC_LINE_NO,
			EQUIP_TYPE || '-' || TO_CHAR(EQUIP_APR_QTY - NVL(EQUIP_REL_QTY, 0)) outstandQty
			FROM
			(
			  SELECT DISTINCT EQUIP_TYPE, STRAGG(STRINGDELIM(DOC_LINE_NO, '0')) DOC_LINE_NO,
			  (SELECT SUM(EQUIP_APR_QTY) FROM ULD_ISS_DTL WHERE EIR_NO = EQUIP.EIR_NO AND EQUIP_TYPE = EQUIP.EQUIP_TYPE) EQUIP_APR_QTY,
			  (SELECT SUM(NVL(EQUIP_REL_QTY, 0)) FROM ULD_ISS_DTL WHERE EIR_NO = EQUIP.EIR_NO AND EQUIP_TYPE = EQUIP.EQUIP_TYPE) EQUIP_REL_QTY
			  FROM (
			    SELECT * 
			    FROM ULD_ISS_DTL 
			    WHERE EIR_NO = #urfNo# AND ULD_EQUIP IN ('E', 'B')
			    ORDER BY DOC_LINE_NO
			  ) EQUIP
			  WHERE
			  (EQUIP_APR_QTY - NVL(EQUIP_REL_QTY, 0)) > 0 
			  GROUP BY EQUIP_TYPE, EIR_NO
			)
			ORDER BY 1, 2
		]]>
	</select>
	<update id="sqlUpdateUCOEmptyAllotRmk" parameterClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		UPDATE EDI_ELP_MSG SET UCO_RMK = #ucoRmk# WHERE TR_NO = #trNo#
	</update>
	<update id="sqlUpdateUCOAckURF" parameterClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		UPDATE ULD_ISS_HD
		SET
		LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE,	ACK_BY = #lmUserId#, ACK_DATE = SYSDATE, UCO_AMEND_YN = 'N'
		WHERE EIR_NO = #urfNo#
	</update>
	<update id="sqlUpdateUCOAddToQueueTruck" parameterClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		UPDATE
		TRUCK_TRIP
		SET
		LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE, EXTRA_URF = 0
		WHERE TRIP_ID = (SELECT MAX(TRIP_ID) FROM TRUCK_TRIP WHERE TRUCK_NO =
		#truckNo# AND EXIT_IND = 'N' AND CLOSED = 'N')
	</update>	
	<update id="sqlUpdateUCOAckULD" parameterClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		UPDATE ULD_ISS_DTL
		SET
		ULD_ACK_QTY = DECODE(ULD_ACK_QTY, NULL, ULD_APR_QTY, ULD_ACK_QTY), LM_USER_ID = #lmUserId#, LM_DATE	= SYSDATE
		WHERE EIR_NO = #urfNo#
	</update>
	<update id="sqlUpdateUCOAckEquip" parameterClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		UPDATE ULD_ISS_DTL
		SET
		EQUIP_ACK_QTY =	DECODE(EQUIP_ACK_QTY, NULL, EQUIP_APR_QTY, EQUIP_ACK_QTY), LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE
		WHERE EIR_NO = #urfNo# AND ULD_EQUIP IN('E', 'B')
	</update>	
	<update id="sqlUpdateUCOAmendURF" parameterClass="cargo.cms.uld.bo.URFRequestBO">
		UPDATE ULD_ISS_HD
		SET
		UCO_AMEND_YN = 'Y',	ACK_EST_TIME = TO_DATE(#ackEstTime#, 'DDMONYY HH24:MI'),
		ACK_RMK = #ackRmk#, LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE
		WHERE EIR_NO = #eirNo#
	</update>	
	<update id="sqlUpdateUCOAmendULD" parameterClass="cargo.cms.uld.bo.URFRequestULDBO">
		UPDATE ULD_ISS_DTL
		SET
		ULD_ACK_QTY = #uldAckQty#, LM_USER_ID = #lmUserId#, LM_DATE	= SYSDATE
		WHERE EIR_NO = #eirNo# AND DOC_LINE_NO = #docLineNo# AND ULD_EQUIP = 'U'
	</update>	
	<update id="sqlUpdateUCOAmendAccessory" parameterClass="cargo.cms.uld.bo.URFRequestAccessoryBO">
		UPDATE ULD_ISS_DTL
		SET
		EQUIP_ACK_QTY =	#equipAckQty#, LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE
		WHERE EIR_NO =	#eirNo# AND DOC_LINE_NO = #docLineNo# AND ULD_EQUIP = 'E'
	</update>
	<update id="sqlUpdateUCOAmendBasicEquip" parameterClass="cargo.cms.uld.bo.URFRequestULDBO">
		UPDATE ULD_ISS_DTL
		SET
		EQUIP_ACK_QTY =	(EQUIP_APR_QTY / #uldAprQty#) * #uldAckQty#, LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE
		WHERE EIR_NO =	#eirNo# AND ULD_EQUIP = 'B' AND (ULD_GROUP = #uldGroup# OR ULD_TYPE = #uldType#)
	</update>	
	<select id="sqlGetUCOULDEstimateList" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		<![CDATA[ 
		SELECT SUM(OS_QTY) uldQty, ULD_GROUP type, MINUTES minutes, 
	    ROUNDED_TIME roundEstTime, IS_CURRENT currentEstYN, IS_OUTSTANDING osEstYN
	    FROM
	    (
	    SELECT OS_QTY, ULD_GROUP, MINUTES,TO_CHAR(EST_TIME, 'DDMONYY HH24:MI'),
	    ROUNDED_TIME, 
	    CASE WHEN tag = '2' THEN 'Y' ELSE 'N' END AS IS_CURRENT,
	    CASE WHEN FOR_OUTSTANDING < 0 THEN 'Y' ELSE 'N' END AS IS_OUTSTANDING
			FROM(
		SELECT  '1' tag, OS_QTY, ULD_GROUP, 
                EST_TIME,
	    	TO_CHAR(EST_TIME - (TO_CHAR(EST_TIME, 'MI') / 60)/24, 'HH24:MI') ROUNDED_TIME,
	    	TO_CHAR(EST_TIME - (TO_CHAR(EST_TIME, 'MI') / 60)/24, 'HH24') ROUNDED_HOUR,
			TRUNC((86400*(EST_TIME-SYSDATE))/60) AS MINUTES,
	    	TRUNC((86400*(EST_TIME-SYSDATE))/60) + TO_CHAR(SYSDATE, 'MI') FOR_OUTSTANDING,
	    	TO_CHAR(SYSDATE, 'HH24') SYSHOUR
		FROM (
		SELECT NVL2(DTL.ULD_GROUP, DTL.ULD_GROUP, TYPE.ULD_GROUP) AS ULD_GROUP, 
			NVL2(ACK_BY, NVL(ULD_ACK_QTY,0), ULD_APR_QTY - NVL(ULD_REL_QTY,0)) AS OS_QTY,
	    	TO_DATE(DECODE(PURPOSE, 'Agt', 
			DECODE(SCH_RLS , 'Y', 
		    (TO_CHAR(TIME_SLOT_DATE, 'DDMONYY') || ' ' || SUBSTR(TRIM(TO_CHAR(TIME_SLOT_FROM,'0000')),1,2) || NVL2(TIME_SLOT_FROM, ':', '') || SUBSTR(TRIM(TO_CHAR(TIME_SLOT_FROM,'0000')),3,4)),
		    TO_CHAR(EST_TIME + #agentExtHour#/24, 'DDMONYY HH24:MI')), TO_CHAR(EST_TIME - #nonAgentExtHour#/24, 'DDMONYY HH24:MI')), 'DDMONYY HH24:MI') AS EST_TIME
		FROM ULD_ISS_HD HDR, ULD_ISS_DTL DTL
		LEFT OUTER JOIN ULD_GROUP_TYPE TYPE
		ON DTL.ULD_TYPE = TYPE.ULD_TYPE
		WHERE
		HDR.EIR_NO = DTL.EIR_NO AND STATUS IN('APPROVED', 'PARTRELEASED') AND ULD_EQUIP = 'U' AND 
		CARR_CODE = #carrCode# AND EIR_EXPIRY_DATE >= SYSDATE
                )
		WHERE ULD_GROUP IN(SELECT ULD_GROUP FROM MAST_INV_EST_CARR_GROUP WHERE CARR_CODE = #carrCode# AND ROWNUM <= 6)
                
     union all
            select '2' tag,  1  AS OS_QTY, 
            	(select TAB1.ULD_GROUP  from MAST_INV_EST_CARR_GROUP TAB1 ,  ULD_GROUP_TYPE TAB2
	              where TAB1.ULD_GROUP =  TAB2.ULD_GROUP 
	              and TAB1.CARR_CODE = ULD_INVENTORY.OWNER_ID
	              and tab2.uld_type = ULD_INVENTORY.uld_type and TAB1.ULD_GROUP is not null and TAB2.ULD_GROUP is not null ) as ULD_GROUP, 
	            null EST_TIME,
		    	null ROUNDED_TIME,
		    	null ROUNDED_HOUR,
				TRUNC((86400*(sysdate - 100-SYSDATE))/60) AS MINUTES,
		    	null FOR_OUTSTANDING,
		    	null SYSHOUR
                from ULD_INVENTORY 
                where empty_flg = 'Y' and owned_inv = 'Y' and nvl(eic_type,'*') <> 'EIC' and (flt_key is null or flt_type = 'I')
                and OWNER_ID = #carrCode#  and ULD_INVENTORY.uld_type is not null
		)
		WHERE MINUTES <= (60 * #timeUptoHour#) and ULD_GROUP is not null
    	)
    	GROUP BY ULD_GROUP, MINUTES, ROUNDED_TIME, IS_CURRENT, IS_OUTSTANDING
		ORDER BY MINUTES
		
		]]>
	</select>
	<select id="sqlGetUCOULDGroupList" parameterClass="java.lang.String"
		resultClass="cargo.cms.uld.bo.URFUCOCheckListBO">
		<![CDATA[ 
		SELECT ULD_GROUP type FROM MAST_INV_EST_CARR_GROUP WHERE CARR_CODE = #carrCode# AND ROWNUM <= 6
		]]>
	</select>		
	<select id="sqlGetUCOAgentExtHour" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT NVL(MAX(RULE_VALUE), 1) FROM CMSRULES WHERE	RULE_CODE = 'URF_ULD_REQ_AGT'
	</select>
	<select id="sqlGetUCONonAgentExtHour" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT NVL(MAX(RULE_VALUE), 1) FROM CMSRULES WHERE	RULE_CODE = 'URF_ULD_REQ_OTH'
	</select>
	<select id="sqlGetUCOTimeUptoHour" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT NVL(MAX(RULE_VALUE), 8) FROM CMSRULES WHERE	RULE_CODE = 'URF_ULD_EST_UPTO'
	</select>
	<select id="sqlGetUCOTimeUptoExtMin" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT NVL(MAX(RULE_VALUE), 30) FROM CMSRULES WHERE	RULE_CODE = 'URF_TIME_UPTO_MIN'
	</select>
	<!-- Warehouse Action List -->
	<select id="sqlGetURFWHPurposes" resultClass="cargo.cms.uld.bo.URFNameValueBO">
		SELECT CODE value,
		CODE_DESC name FROM MAST_CODE_DTL WHERE CODE_TYPE = 'URF_PURPOSE'
		UNION
		SELECT CODE value, CODE_DESC name FROM MAST_CODE_DTL WHERE
		CODE_TYPE = 'URF_WH_PURPOSE'
		ORDER BY name ASC
	</select>
	<update id="sqlUpdateURFWHActionMark" parameterClass="cargo.cms.uld.bo.URFHHTBO">
		UPDATE	ULD_ISS_HD
		SET WH_ACTION = 'Y', LM_USER_ID = #lmUserId#, LM_DATE =	SYSDATE
		WHERE EIR_NO = #eirNo#
	</update>
	<select id="sqlGetWHTruckList" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFHHTBO">
		SELECT TRUCK_NO truckNo, TRUCK_DOCK truckDock
		FROM TRUCK_TRIP	WHERE EXIT_IND = 'N' AND CLOSED = 'N'
	</select>
	<select id="sqlGetWHTruckURFList" parameterClass="cargo.cms.uld.bo.URFHHTBO"
		resultClass="cargo.cms.uld.bo.URFHHTBO">
		SELECT EIR_NO urfNo, CARR_CODE carrCode, ACK_RMK rmk, SCH_RLS schRls,
		WH_ACTION whAction
		FROM ULD_ISS_HD HDR
		WHERE HDR.EIR_NO IN(
			SELECT EIR_NO
			FROM ULD_TRUCK_EIR EIR, TRUCK_TRIP TRIP
			WHERE EIR.TRIP_ID = TRIP.TRIP_ID AND EXIT_IND = 'N' AND CLOSED = 'N' AND TRUCK_NO = #truckNo#
			<isNotEmpty property="truckDock"> AND TRUCK_DOCK = #truckDock#</isNotEmpty>
			<isNotEmpty property="truckDockGrp"> AND (SELECT DECODE(COUNT(CODE), 0, 'N', 'Y') FROM MAST_WH_LOC WHERE WH_GROUP = #truckDockGrp# AND CODE = TRIP.TRUCK_DOCK) = 'Y' </isNotEmpty>
			UNION
			SELECT EIR_NO
			FROM EIR_SCH_COLL HDR, EIR_SCH_COLL_DTL DTL
			WHERE HDR.SCH_COLL_NO = DTL.SCH_COLL_NO AND
			(
				TO_DATE(TO_CHAR(TIME_SLOT_DATE, 'DDMONYY')) = TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY')) AND 
				TIME_SLOT_TO &gt;= TO_NUMBER(TO_CHAR(SYSDATE, 'HH24MI')) OR
				TO_DATE(TO_CHAR(TIME_SLOT_DATE, 'DDMONYY')) &gt; TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY'))
			) AND
			(TRUCK1 = #truckNo# OR TRUCK2 = #truckNo# OR TRUCK3 = #truckNo#)
		) AND HDR.EIR_EXPIRY_DATE &gt;= SYSDATE AND HDR.ACK_BY IS NOT NULL  and HDR.status != 'VOID'
		<isEqual property="notStarted" compareValue="Y"> AND HDR.WH_ACTION = 'N'</isEqual>
		and HDR.status != 'VOID'
	</select>
	<select id="sqlGetWHNonTruckURFList" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFHHTBO">
		SELECT EIR_NO urfNo, CARR_CODE carrCode, ACK_RMK rmk, SCH_RLS schRls,
		WH_ACTION whAction
		FROM ULD_ISS_HD HDR
		WHERE HDR.EIR_NO NOT IN(
			SELECT EIR_NO
			FROM ULD_TRUCK_EIR EIR, TRUCK_TRIP TRIP
			WHERE EIR.TRIP_ID = TRIP.TRIP_ID AND EXIT_IND = 'N' AND CLOSED = 'N'
			UNION
			SELECT EIR_NO
			FROM EIR_SCH_COLL HDR, EIR_SCH_COLL_DTL DTL
			WHERE HDR.SCH_COLL_NO = DTL.SCH_COLL_NO AND
			(
				TO_DATE(TO_CHAR(TIME_SLOT_DATE, 'DDMONYY')) = TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY')) AND 
				TIME_SLOT_TO &gt;= TO_NUMBER(TO_CHAR(SYSDATE, 'HH24MI')) OR
				TO_DATE(TO_CHAR(TIME_SLOT_DATE, 'DDMONYY')) &gt; TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY'))
			)
		) AND HDR.EIR_EXPIRY_DATE &gt;= SYSDATE AND HDR.ACK_BY IS NOT NULL
		<isEqual property="notStarted" compareValue="Y"> AND HDR.WH_ACTION = 'N'</isEqual>
		and HDR.status != 'VOID'
	</select>
	<select id="sqlGetWHNonAgentURFList" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFHHTBO">
		SELECT EIR_NO urfNo, CARR_CODE carrCode, ACK_RMK rmk, SCH_RLS schRls,
		WH_ACTION whAction
		FROM ULD_ISS_HD HDR
		WHERE HDR.PURPOSE &lt;&gt; 'Agt' AND HDR.PURPOSE = #usage# AND
		HDR.EIR_EXPIRY_DATE &gt;= SYSDATE AND HDR.ACK_BY IS NOT NULL
		<isEqual property="notStarted" compareValue="Y"> AND HDR.WH_ACTION = 'N'</isEqual>
		and HDR.status != 'VOID'
	</select>
	<select id="sqlGetWHEmptyAllotList" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFHHTBO">
		<![CDATA[ 
		SELECT  
		MSG.FLT_KEY || '/' || TO_CHAR(MSG.FLT_DATE, 'DDMONYY') fltNoDate, UCO_RMK ucoRmk,
		SUBSTR(TRIM(TO_CHAR(FLT.SCH_TIME,'0000')),1,2) || NVL2(FLT.SCH_TIME, ':', '') || SUBSTR(TRIM(TO_CHAR(FLT.SCH_TIME,'0000')),3,4) std
		FROM EDI_ELP_MSG MSG
	    LEFT OUTER JOIN FLT_OPR FLT
	    ON MSG.FLT_KEY = FLT.FLT_KEY AND MSG.FLT_DATE = FLT.SCH_DATE
	    WHERE FLT_DATE >= TO_DATE(TO_CHAR(SYSDATE, 'DDMONYY'))
		]]>
	</select>
	<select id="sqlGetWHULDEquipList" parameterClass="cargo.cms.uld.bo.URFHHTBO"
		resultClass="cargo.cms.uld.bo.URFHHTBO">
		<![CDATA[ 
		SELECT ULD_GROUP || ULD_TYPE AS type, NVL(ULD_ACK_QTY,0) AS uldQty
		FROM
		ULD_ISS_DTL ULD
		WHERE
		ULD.ULD_EQUIP = 'U' 
		AND ULD.EIR_NO = #urfNo#
		UNION
		SELECT EQUIP_TYPE type, EQUIP_ACK_QTY AS uldQty
	    FROM
	    (
	    	SELECT EQUIP_TYPE, SUM(NVL(EQUIP_ACK_QTY, 0)) EQUIP_ACK_QTY
			FROM
			ULD_ISS_DTL ULD
			WHERE
			ULD.ULD_EQUIP IN ('E', 'B')
			AND ULD.EIR_NO = #urfNo# AND NVL(EQUIP_ACK_QTY, 0) > 0
	    	GROUP BY EQUIP_TYPE
	    )
		]]>
	</select>
	<select id="sqlGetURFRequestMultiUserCheck" parameterClass="java.util.Map"
		resultClass="java.lang.Integer">
		SELECT COUNT(EIR_NO) FROM ULD_ISS_HD WHERE EIR_NO =
		#eirNo# AND TO_CHAR(LM_DATE, 'DDMONYY HH24:MI:SS') = #lmDate#
	</select>
	<select id="sqlGetURFSchCollMultiUserCheck" parameterClass="java.util.Map"
		resultClass="java.lang.Integer">
		SELECT COUNT(SCH_COLL_NO) FROM EIR_SCH_COLL WHERE
		SCH_COLL_NO = #schCollNo# AND TO_CHAR(LM_DATE, 'DDMONYY HH24:MI:SS') =
		#lmDate#
	</select>
	<select id="sqlGetURFTruckRegMultiUserCheck" parameterClass="java.util.Map"
		resultClass="java.lang.Integer">
		SELECT COUNT(TRIP_ID) FROM ULD_TRUCK_EIR WHERE TRIP_ID =#tripId# 
                AND EIR_NO = #eirNo# AND TO_CHAR(LM_DATE, 'DDMONYY HH24:MI:SS') = #lmDate#
	</select>
	<select id="sqlGetULDTowOutMultiUserCheck" parameterClass="java.util.Map"
		resultClass="java.lang.Integer">
		SELECT COUNT(TO_NO) FROM TOW_ORDER_OUT WHERE TO_NO =
		#toNo# AND TO_CHAR(LM_DATE, 'DDMONYY HH24:MI:SS') = #lmDate#
	</select>
	<insert id="sqlInsertURFServiceLog" parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO">
	<![CDATA[
		INSERT INTO SERVICE_ERR_LOG
		  (
		    TR_NO, TR_TYPE, DOC_LINE_NO, TR_DATE,
		    OWNER_ID, AGENT_NO, CARR_CODE,
		    RMK1, RMK2, ERR_REASON,
		    SVC_USER_ID, SVC_DATE,
		    ULD_TYPE, ULD_NO, ULD_CARR, ULD_KEY,
		    CR_USER_ID, CR_DATE, LM_USER_ID, LM_DATE,FLT_TYPE
		  )
		  VALUES
		  (
		    #trNo#, #trType#, SERVICE_ERR_LOG_DLN_SEQ.nextval, SYSDATE,
		    #carrCode#, #agentNo#, #carrCode#, 
		    #rmk1#, #rmk2#, #errorReason#,
		    #svcUserId#, TO_DATE(#svcDate#, 'DDMONYY HH24:MI'),
		    #uldType#, #uldNo#, #uldCarr#, #uldKey#,
		    #crUserId#, SYSDATE, #lmUserId#, SYSDATE,'E'
		  )	
	]]>
	</insert>
	<select id="sqlGetULDOwner" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		SELECT OWNER_ID FROM ULD_INVENTORY WHERE ULD_KEY = #PARAM#
	</select>
	<select id="sqlGetURFForSRFAddlEstHour" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT NVL(MAX(RULE_VALUE), 12) FROM CMSRULES WHERE
		RULE_CODE = 'URF_FOR_SRF_EST_HOUR'
	</select>
	<select id="sqlGetURFParkingCharge" parameterClass="java.util.Map"
		resultClass="java.lang.String">
		<![CDATA[
			SELECT SUM(NET_AMT) NET
			FROM BILL_CHARGE_DTL 
			WHERE ITM_CODE = 'PARKCHRG' AND TRUCK_NO = #TRUCK_NO# AND TRIP_ID = #TRIP_ID#
		]]>
	</select>
	<select id="sqlGetURFTruckEntryTime" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		<![CDATA[
			SELECT TO_CHAR(ARR_TIME, 'DDMONYY HH24:MI') FROM TRUCK_TRIP
			WHERE UPPER(TRUCK_NO) = UPPER(#PARAM#) AND CLOSED = 'N' AND EXIT_IND = 'N'
		]]>
	</select>
	<select id="sqlGetURFParkingDuration" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		<![CDATA[
			SELECT 
			FLOOR((SYSDATE - ARR_TIME) * 24) || ':' || 
			TRIM(TO_CHAR((FLOOR((SYSDATE - ARR_TIME) * 24 * 60) - (FLOOR((SYSDATE - ARR_TIME) * 24) * 60)), '00'))
			FROM TRUCK_TRIP
			WHERE UPPER(TRUCK_NO) = UPPER(#PARAM#) AND CLOSED = 'N' AND EXIT_IND = 'N' 
			AND (CURR_LOC IS NULL OR CURR_LOC = 'PARK')
		]]>
	</select>
	<update id="sqlUpdateURFTruckPurposeAsColl" parameterClass="cargo.cms.uld.bo.URFTruckRegisterBO">
		<![CDATA[
			UPDATE TRUCK_TRIP
			SET PURPOSE = 'ULD_COLL', DERIVED_PURPOSE = (SELECT DERIVED_PURPOSE FROM MAST_TCS_INCOMING_PURPOSE WHERE CODE = 'ULD_COLL'),
			LM_DATE = SYSDATE, LM_USER_ID = #lmUserId# 
			WHERE TRIP_ID = #tripId#
		]]>
	</update>
	<select id="sqlGetDefaultURFSchCollAllocDuration"
		parameterClass="java.lang.String" resultClass="java.lang.Integer">
		<![CDATA[
			SELECT NVL(ALLOCATION_DURATION, 0) FROM MAST_TCS_INCOMING_PURPOSE WHERE CODE = 'ULD_COLL'
		]]>
	</select>
	<select id="sqlGetURFIsValidWHDock" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		<![CDATA[
			SELECT MAX(CODE) FROM MAST_WH_LOC WHERE WH_GROUP IN(
  				SELECT WH_GROUP FROM MAST_WH_GROUP GRP WHERE GRP.WH_TYPE = 'TD'
			)
			AND CODE = #PARAM#
		]]>
	</select>
	<select id="sqlGetURFIsValidWHDockGroup" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		<![CDATA[
			SELECT DECODE(COUNT(WH_GROUP), 0, 'N', 'Y') FROM MAST_WH_GROUP GRP WHERE GRP.WH_TYPE = 'TD' AND WH_GROUP = #PARAM#
		]]>
	</select>
	<select id="sqlGetURFParentCarr" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		<![CDATA[
			SELECT FUN_GET_PARENT_CARR(#PARAM#) FROM DUAL
		]]>
	</select>
	<update id="sqlUpdateULDRemoveInTowOut" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE TOW_ORDER_OUT_DTL 
			SET REMOVE_DATE = SYSDATE, REMOVE_USER_ID = #USER_ID#, 
			LM_DATE = SYSDATE, LM_USER_ID = #USER_ID#
			WHERE
			ULD_KEY = #ULD_KEY# AND 
			TO_NO IN (SELECT TO_NO FROM TOW_ORDER_OUT WHERE STATUS = 'ISSUED')
		]]>
	</update>
	<update id="sqlUpdateULDRemoveInURF" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_REL_DTL
			SET REMOVE_DATE = SYSDATE, REMOVE_USER = #USER_ID#, 
			LM_DATE = SYSDATE, LM_USER_ID = #USER_ID#
			WHERE
			ULD_EQUIP = 'U' AND ULD_KEY = #ULD_KEY# AND 
			EIR_NO IN(
			  SELECT REL.EIR_NO
			  FROM ULD_REL_DTL REL
			  JOIN ULD_ISS_HD ISS
			  ON REL.EIR_NO = ISS.EIR_NO AND ISS.STATUS = 'RELEASED'
			  WHERE REL.ULD_EQUIP = 'U' AND REL.ULD_KEY = #ULD_KEY#
			)
		]]>
	</update>	
	<update id="sqlUpdateURFCloseWhenRemove" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_ISS_HD
			SET STATUS = 'CLOSED', LM_DATE = SYSDATE, LM_USER_ID = #USER_ID#
			WHERE STATUS = 'RELEASED' AND PURPOSE <> 'Agt' AND EIR_NO = (
			  SELECT DISTINCT REL.EIR_NO
			  FROM ULD_REL_DTL REL 
			  JOIN ULD_INVENTORY INV ON INV.ULD_KEY=REL.ULD_KEY 
			  JOIN ULD_ISS_HD ISS
			  ON REL.EIR_NO = ISS.EIR_NO AND ISS.STATUS = 'RELEASED'
			  WHERE REL.ULD_EQUIP = 'U' AND REL.ULD_KEY = #ULD_KEY# AND REL.REMOVE_DATE IS NOT NULL 
			  AND INV.FLT_KEY=ISS.URF_FLT_KEY AND INV.FLT_DATE=ISS.URF_FLT_DATE
			) AND (
			  SELECT COUNT(REL.EIR_NO)
			  FROM ULD_REL_DTL REL 
			  JOIN ULD_ISS_HD ISS
			  ON REL.EIR_NO = ISS.EIR_NO AND ISS.STATUS = 'RELEASED'
			  WHERE REL.ULD_EQUIP = 'U' AND REL.ULD_KEY = #ULD_KEY# AND REL.REMOVE_DATE IS NULL
			) = 0		
		]]>
	</update>
	<!-- Endorse URF -->
	<select id="sqlGetCarrierList" parameterClass="java.lang.Object"
		resultClass="cargo.cms.afw.bo.MasterBO">
		<![CDATA[
			SELECT CODE AS codeId, CODE_DESC AS codeDesc 
			FROM MAST_CARRIER
			WHERE OWNED_CARR = 'Y'
			ORDER BY CODE
		]]>
	</select>
	<!-- Carrier Name (English) -->
	<select id="sqlGetEnCarrierName" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		<![CDATA[
			SELECT INITCAP(CODE_DESC) FROM MAST_CARRIER WHERE CODE = #PARAM#
		]]>
	</select>
	<!-- Carrier Name (Chinese) -->
	<select id="sqlGetZhCarrierName" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		<![CDATA[
			SELECT NVL(CH_DESC, INITCAP(CODE_DESC)) FROM MAST_CARRIER WHERE CODE = #PARAM#		
		]]>
	</select>
	<!-- Flight Time -->
	<select id="sqlGetURFFltTime" parameterClass="cargo.cms.uld.bo.URFMaintainRequestBO"
		resultClass="java.lang.String">
		<![CDATA[
			SELECT SUBSTR(FLT_TIME, 1, 2) || ':' || SUBSTR(FLT_TIME, 3, 2) FLT_TIME
			FROM (
			  SELECT TRIM(TO_CHAR(SCH_TIME, '0000')) FLT_TIME 
			  FROM FLT_OPR		
			  WHERE FLT_KEY = UPPER(#fltNo#) AND TO_CHAR(SCH_DATE,'DDMONYY') = UPPER(#fltDate#) AND FLT_TYPE = 'D'
			)
		]]>
	</select>
	<!-- Endorse URF Header -->
	<insert id="sqlInsertURFEndorseHeader" parameterClass="cargo.cms.uld.bo.URFRequestBO">
		<![CDATA[
			INSERT INTO ULD_ENDR_HD (
			    ENDR_NO, ENDR_DATE,
			    CARR_CODE, FLT_NO, FLT_DATE,
			    ENDR_RMK, AGENT_CUST_NO, STATUS,
			    CR_USER_ID, CR_DATE, LM_USER_ID, LM_DATE,VER_NO
			) VALUES (
				#endorseNo#, SYSDATE,
				#carrCode#, #fltNo#, TO_DATE(#fltDate#, 'DDMONYY'),
				#eirRmk#, #agentCustNo#, #status#,
				#crUserId#, SYSDATE, #lmUserId#, SYSDATE,#versionNo#
			)
		]]>
	</insert>
	<!-- Endorse URF ULD Detail -->
	<insert id="sqlInsertURFEndorseULD" parameterClass="cargo.cms.uld.bo.URFRequestULDBO">
		<![CDATA[
			INSERT INTO ULD_ENDR_DTL (
			    ENDR_NO, DOC_LINE_NO,
			    ULD_EQUIP, ULD_GROUP, ULD_TYPE, ULD_QTY,
			    CR_USER_ID, CR_DATE, LM_USER_ID, LM_DATE
			) VALUES (
				#endorseNo#, #docLineNo#, 
				#uldEquip#, #uldGroup#, #uldType#, #uldEndrQty#, 
				#crUserId#, SYSDATE, #lmUserId#, SYSDATE
			)
		]]>
	</insert>
	<!-- Endorse URF Equipment Detail -->
	<insert id="sqlInsertURFEndorseAccessory" parameterClass="cargo.cms.uld.bo.URFRequestAccessoryBO">
		<![CDATA[
			INSERT INTO ULD_ENDR_DTL (
			    ENDR_NO, DOC_LINE_NO,
			    ULD_EQUIP, EQUIP_TYPE, EQUIP_QTY,
			    CR_USER_ID, CR_DATE, LM_USER_ID, LM_DATE
			) VALUES (
				#endorseNo#, #docLineNo#, 
				#uldEquip#, #equipType#, #equipEndrQty#,
				#crUserId#, SYSDATE, #lmUserId#, SYSDATE
			)
		]]>
	</insert>
	<!-- Endorse URF Summary - Add -->
	<insert id="sqlInsertURFEndorseULDSummary" parameterClass="java.util.Map">
		<![CDATA[
			INSERT INTO ULD_ENDR_SUM (
			  TR_NO,
			  AGENT_CUST_NO, FLT_NO, FLT_DATE,
			  ULD_EQUIP, ULD_GROUP, ULD_TYPE,
			  ENDR_QTY, APR_QTY, VOID_QTY,
			  CR_USER_ID, CR_DATE, LM_USER_ID, LM_DATE
			) VALUES (
			  URF_ENDR_SUM_SEQ.NEXTVAL,
			  #AGENT_NO#, #FLT_NO#, TO_DATE(#FLT_DATE#, 'DDMONYY'),
			  'U', #ULD_GROUP#, #ULD_TYPE#,
			  #ULD_ENDR_QTY#, 0, 0,
			  #USER_ID#, SYSDATE, #USER_ID#, SYSDATE
			)
		]]>
	</insert>
	<insert id="sqlInsertURFEndorseEquipSummary" parameterClass="java.util.Map">
		<![CDATA[
			INSERT INTO ULD_ENDR_SUM (
			  TR_NO,
			  AGENT_CUST_NO, FLT_NO, FLT_DATE,
			  ULD_EQUIP, EQUIP_TYPE,
			  ENDR_QTY, APR_QTY, VOID_QTY,
			  CR_USER_ID, CR_DATE, LM_USER_ID, LM_DATE
			) VALUES (
			  URF_ENDR_SUM_SEQ.NEXTVAL,
			  #AGENT_NO#, #FLT_NO#, TO_DATE(#FLT_DATE#, 'DDMONYY'),
			  'E', #EQUIP_TYPE#,
			  #EQUIP_ENDR_QTY#, 0, 0,
			  #USER_ID#, SYSDATE, #USER_ID#, SYSDATE
			)
		]]>
	</insert>	
	<!-- Endorse URF Summary - Update Endorse ULD Qty -->
	<update id="sqlUpdateURFEndorseSummaryEndorseULDQty"
		parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_ENDR_SUM SET
			ENDR_QTY = ENDR_QTY + NVL(#ULD_ENDR_QTY#, 0),
			LM_USER_ID = #USER_ID#, LM_DATE = SYSDATE
			WHERE AGENT_CUST_NO = #AGENT_NO# AND FLT_NO = #FLT_NO# AND FLT_DATE = TO_DATE(#FLT_DATE#, 'DDMONYY') AND
			ULD_EQUIP = 'U' AND (ULD_GROUP = #ULD_GROUP# OR ULD_TYPE = #ULD_TYPE#)
		]]>
	</update>
	<!-- Endorse URF Summary - Update Endorse Equipment Qty -->
	<update id="sqlUpdateURFEndorseSummaryEndorseEquipQty"
		parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_ENDR_SUM SET
			ENDR_QTY = ENDR_QTY + NVL(#EQUIP_ENDR_QTY#, 0),
			LM_USER_ID = #USER_ID#, LM_DATE = SYSDATE
			WHERE AGENT_CUST_NO = #AGENT_NO# AND FLT_NO = #FLT_NO# AND FLT_DATE = TO_DATE(#FLT_DATE#, 'DDMONYY') AND
			ULD_EQUIP = 'E' AND EQUIP_TYPE = #EQUIP_TYPE#
		]]>
	</update>
	<!-- Endorse URF Summary - Verify whether Record Exist for Agent, Flt/Date 
		and ULD Type/Group -->
	<select id="sqlGetIsEndorsedURFULDSummaryRecordExist"
		parameterClass="java.util.Map" resultClass="java.lang.String">
		<![CDATA[
			SELECT DECODE(COUNT(1), 0, 'N', 'Y')
			FROM ULD_ENDR_SUM
			WHERE AGENT_CUST_NO = #AGENT_NO# AND FLT_NO = #FLT_NO# AND FLT_DATE = TO_DATE(#FLT_DATE#, 'DDMONYY') AND
			ULD_EQUIP = 'U' AND (ULD_GROUP = #ULD_GROUP# OR ULD_TYPE = #ULD_TYPE#) 
		]]>
	</select>
	<!-- Endorse URF Summary - Verify whether Record Exist for Agent, Flt/Date 
		and Equipment Type -->
	<select id="sqlGetIsEndorsedURFEquipSummaryRecordExist"
		parameterClass="java.util.Map" resultClass="java.lang.String">
		<![CDATA[
			SELECT DECODE(COUNT(1), 0, 'N', 'Y')
			FROM ULD_ENDR_SUM
			WHERE AGENT_CUST_NO = #AGENT_NO# AND FLT_NO = #FLT_NO# AND FLT_DATE = TO_DATE(#FLT_DATE#, 'DDMONYY') AND
			ULD_EQUIP = 'E' AND EQUIP_TYPE = #EQUIP_TYPE#
		]]>
	</select>
	<!-- Endorse URF Summary - Search Result -->
	<select id="sqlGetEndorsedURFSummary" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[
			SELECT 
			AGENT_CUST_NO agentCustNo, CODE_DESC agentName, 
			SUMM.FLT_NO || '/' || TO_CHAR(SUMM.FLT_DATE, 'DDMONYY') fltNoDate, SUMM.FLT_NO fltNo, TO_CHAR(SUMM.FLT_DATE, 'DDMONYY') fltDate,
			SUBSTR(LPAD(NVL(FLT.EST_TIME, FLT.SCH_TIME), 4, '0'), 1, 2) || ':' || SUBSTR(LPAD(NVL(FLT.EST_TIME, FLT.SCH_TIME), 4, '0'), 3) fltTime,
			NVL(ULD_GROUP, ULD_TYPE) uldGroupType,
			SUM(ENDR_QTY) endrUldQty, SUM(APR_QTY) aprUldQty, SUM(VOID_QTY) voidQty, NVL(SUM((
			  SELECT SUM(NVL(ULD_REL_QTY, 0))
			  FROM ULD_ISS_HD HD
			  JOIN ULD_ISS_DTL DTL
			  ON HD.EIR_NO = DTL.EIR_NO
			  WHERE HD.PURPOSE = 'Agt' AND HD.ENDR_BY IS NOT NULL AND
			  HD.AGENT_CUST_NO = SUMM.AGENT_CUST_NO AND HD.FLT_NO = SUMM.FLT_NO AND HD.FLT_DATE = SUMM.FLT_DATE AND
			  (DTL.ULD_GROUP = SUMM.ULD_GROUP OR DTL.ULD_TYPE = SUMM.ULD_TYPE) AND DTL.ULD_EQUIP = 'U' AND NVL(DTL.ULD_REL_QTY, 0) > 0
			)), 0) relUldQty
			FROM ULD_ENDR_SUM SUMM
			JOIN FLT_OPR FLT
        	ON SUMM.FLT_DATE = FLT.SCH_DATE AND SUMM.FLT_NO = FLT.FLT_KEY AND FLT.FLT_TYPE = 'D'
			JOIN CUST_COMPANY AGT
			ON SUMM.AGENT_CUST_NO = AGT.CODE AND AGT.ACTIVE = 'Y' AND SUMM.ULD_EQUIP = 'U'
		]]>
		<isNotEmpty property="agentName"><![CDATA[AND UPPER(AGT.CODE_DESC) = UPPER(#agentName#)]]></isNotEmpty>
		<isNotEmpty property="fltNo"><![CDATA[AND UPPER(SUMM.FLT_NO) = UPPER(#fltNo#)]]></isNotEmpty>
		<isNotEmpty property="fromDate">
			<![CDATA[
				AND TO_DATE(TO_CHAR(FLT.SCH_DATE, 'DDMONYY') || ' ' || SUBSTR(LPAD(FLT.SCH_TIME, 4, '0'), 1, 2) || ':' || SUBSTR(LPAD(FLT.SCH_TIME, 4, '0'), 3), 'DDMONYY HH24:MI')
					>= TO_DATE(#fromDate#, 'DDMONYY HH24:MI')
			]]>
		</isNotEmpty>
		<isNotEmpty property="toDate">
			<![CDATA[
				AND TO_DATE(TO_CHAR(FLT.SCH_DATE, 'DDMONYY') || ' ' || SUBSTR(LPAD(FLT.SCH_TIME, 4, '0'), 1, 2) || ':' || SUBSTR(LPAD(FLT.SCH_TIME, 4, '0'), 3), 'DDMONYY HH24:MI')
					<= TO_DATE(#toDate#, 'DDMONYY HH24:MI')
			]]>
		</isNotEmpty>
		<isEmpty property="fltNo">	
			<isNotEmpty property="loginCarrier">
			 <![CDATA[
		       	AND ( 
		       		SUBSTR(SUMM.FLT_NO, 0, 2) = #loginCarrier#
					OR SUBSTR(SUMM.FLT_NO, 0, 2) IN (SELECT CARR_CODE FROM MAST_CARR_GRP WHERE GRP_CARR_CODE = #loginCarrier#)
				)
		      ]]>
			</isNotEmpty>
		</isEmpty>
		<dynamic>
			GROUP BY SUMM.FLT_DATE, NVL(FLT.EST_TIME, FLT.SCH_TIME), SUMM.FLT_NO, AGT.CODE_DESC, SUMM.ULD_GROUP, SUMM.ULD_TYPE, SUMM.AGENT_CUST_NO
			ORDER BY SUMM.FLT_DATE, NVL(FLT.EST_TIME, FLT.SCH_TIME), SUMM.FLT_NO, AGT.CODE_DESC, 6, SUMM.AGENT_CUST_NO          
		</dynamic>
	</select>
	<!-- Endorse URF Summary - Search Result -->
	<select id="sqlGetEndorsedURFULDSummary" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[
			SELECT
			NVL(ULD_GROUP, ULD_TYPE) uldGroupType,
			SUM(ENDR_QTY) endrUldQty, SUM(APR_QTY) aprUldQty, SUM(VOID_QTY) voidQty, NVL(SUM((
			  SELECT SUM(NVL(ULD_REL_QTY, 0))
			  FROM ULD_ISS_HD HD
			  JOIN ULD_ISS_DTL DTL
			  ON HD.EIR_NO = DTL.EIR_NO
			  WHERE HD.PURPOSE = 'Agt' AND HD.ENDR_BY IS NOT NULL AND
			  HD.AGENT_CUST_NO = SUMM.AGENT_CUST_NO AND HD.FLT_NO = SUMM.FLT_NO AND HD.FLT_DATE = SUMM.FLT_DATE AND
			  (DTL.ULD_GROUP = SUMM.ULD_GROUP OR DTL.ULD_TYPE = SUMM.ULD_TYPE) AND DTL.ULD_EQUIP = 'U' AND NVL(DTL.ULD_REL_QTY, 0) > 0
			)), 0) relUldQty
			FROM ULD_ENDR_SUM SUMM
			JOIN FLT_OPR FLT
        	ON SUMM.FLT_DATE = FLT.SCH_DATE AND SUMM.FLT_NO = FLT.FLT_KEY AND FLT.FLT_TYPE = 'D'
			JOIN CUST_COMPANY AGT
			ON SUMM.AGENT_CUST_NO = AGT.CODE AND AGT.ACTIVE = 'Y' AND SUMM.ULD_EQUIP = 'U'
		]]>
		<isNotEmpty property="agentName"><![CDATA[AND UPPER(AGT.CODE_DESC) = UPPER(#agentName#)]]></isNotEmpty>
		<isNotEmpty property="fltNo"><![CDATA[AND UPPER(SUMM.FLT_NO) = UPPER(#fltNo#)]]></isNotEmpty>
		<isNotEmpty property="fromDate">
			<![CDATA[
				AND TO_DATE(TO_CHAR(FLT.SCH_DATE, 'DDMONYY') || ' ' || SUBSTR(LPAD(FLT.SCH_TIME, 4, '0'), 1, 2) || ':' || SUBSTR(LPAD(FLT.SCH_TIME, 4, '0'), 3), 'DDMONYY HH24:MI')
					>= TO_DATE(#fromDate#, 'DDMONYY HH24:MI')
			]]>
		</isNotEmpty>
		<isNotEmpty property="toDate">
			<![CDATA[
				AND TO_DATE(TO_CHAR(FLT.SCH_DATE, 'DDMONYY') || ' ' || SUBSTR(LPAD(FLT.SCH_TIME, 4, '0'), 1, 2) || ':' || SUBSTR(LPAD(FLT.SCH_TIME, 4, '0'), 3), 'DDMONYY HH24:MI')
					<= TO_DATE(#toDate#, 'DDMONYY HH24:MI')
			]]>
		</isNotEmpty>
		<isEmpty property="fltNo">	
			<isNotEmpty property="loginCarrier">
			 <![CDATA[
		       	AND ( 
		       		SUBSTR(SUMM.FLT_NO,0,2) = #loginCarrier#
					OR SUBSTR(SUMM.FLT_NO, 0, 2) IN (SELECT CARR_CODE FROM MAST_CARR_GRP WHERE GRP_CARR_CODE = #loginCarrier#)
				)
		      ]]>
			</isNotEmpty>
		</isEmpty>
		<dynamic>
			GROUP BY SUMM.ULD_GROUP, SUMM.ULD_TYPE	
			ORDER BY 1          
		</dynamic>
	</select>
	<!-- Endorse URF Summary Detail by Agent and Flt/Date -->
	<select id="sqlGetEndorsedURFsForSummaryDetail" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[
			SELECT
			HD.ENDR_NO endorseNo, TO_CHAR(HD.ENDR_DATE, 'DDMONYY HH24:MI') endrDate, (
			  SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_QTY, 0), ', ')) 
			  FROM ULD_ENDR_DTL WHERE ENDR_NO = HD.ENDR_NO AND ULD_EQUIP = 'U' AND NVL(ULD_QTY, 0) > 0
			) endrUldQty,
			DECODE(HD.STATUS, 'VOID', 'Y', ' ') status
			FROM 
			ULD_ENDR_HD HD
			JOIN CUST_COMPANY CUST
			ON HD.AGENT_CUST_NO = CUST.CODE
			WHERE 1 = 1
		]]>
		<isNotEmpty property="agentName"><![CDATA[AND UPPER(CUST.CODE_DESC) = UPPER(#agentName#)]]></isNotEmpty>
		<isNotEmpty property="fltNo"><![CDATA[AND UPPER(HD.FLT_NO) = UPPER(#fltNo#)]]></isNotEmpty>
		<isNotEmpty property="fltDate"><![CDATA[AND HD.FLT_DATE = TO_DATE(#fltDate#, 'DDMONYY')]]></isNotEmpty>
		<dynamic prepend="ORDER BY ">
			HD.ENDR_NO           
		</dynamic>
	</select>
	<!-- Endorse URF Summary Detail by Agent and Flt/Date (Total) -->
	<select id="sqlGetEndorsedURFsForSummaryDetailTotal"
		parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO" resultClass="java.lang.String">
		<![CDATA[
			SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_QTY, 0), ', ')) total
			FROM (
			  SELECT
			  ULD_GROUP, ULD_TYPE, SUM(ULD_QTY) ULD_QTY
			  FROM ULD_ENDR_HD HD
			  JOIN ULD_ENDR_DTL DTL
			  ON HD.ENDR_NO = DTL.ENDR_NO AND DTL.ULD_EQUIP = 'U'
			  JOIN CUST_COMPANY CUST
			  ON HD.AGENT_CUST_NO = CUST.CODE
			  WHERE STATUS NOT IN('VOID')
		]]>
		<isNotEmpty property="agentName"><![CDATA[AND UPPER(CUST.CODE_DESC) = UPPER(#agentName#)]]></isNotEmpty>
		<isNotEmpty property="fltNo"><![CDATA[AND UPPER(HD.FLT_NO) = UPPER(#fltNo#)]]></isNotEmpty>
		<isNotEmpty property="fltDate"><![CDATA[AND HD.FLT_DATE = TO_DATE(#fltDate#, 'DDMONYY')]]></isNotEmpty>
		<dynamic>
			  GROUP BY ULD_GROUP, ULD_TYPE
			)
		</dynamic>
	</select>
	<!-- Request URF for Summary Detail by Agent and Flt/Date -->
	<select id="sqlGetRequestURFsForSummaryDetail" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[
			SELECT ISS.EIR_NO urfNo,
			TO_CHAR(EIR_EXPIRY_DATE, 'DDMONYY HH24:MI') urfExpiryDate,
			TO_CHAR(APR_DATE, 'DDMONYY HH24:MI') aprDate, 
			STAT.CODE_DESC status, (
			  SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_REQ_QTY, 0), ', ')) 
			  FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND ULD_EQUIP = 'U' AND NVL(ULD_REQ_QTY, 0) > 0
			) reqUldQty, (
			  SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_APR_QTY, 0), ', ')) 
			  FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND ULD_EQUIP = 'U' AND NVL(ULD_APR_QTY, 0) > 0
			) aprUldQty, (
			  SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_REL_QTY, 0), ', ')) 
			  FROM ULD_ISS_DTL WHERE EIR_NO = ISS.EIR_NO AND ULD_EQUIP = 'U' AND NVL(ULD_REL_QTY, 0) > 0
			) relUldQty    
			FROM
			ULD_ISS_HD ISS
			LEFT JOIN CUST_COMPANY AGT
			ON ISS.AGENT_CUST_NO = AGT.CODE
			LEFT JOIN MAST_CODE_DTL STAT
			ON ISS.STATUS = STAT.CODE AND STAT.CODE_TYPE = 'URF_STATUS'
			WHERE ISS.PURPOSE = 'Agt' AND ISS.STATUS NOT IN('VOID')
		]]>
		<isNotEmpty property="agentName"><![CDATA[AND UPPER(AGT.CODE_DESC) = UPPER(#agentName#)]]></isNotEmpty>
		<isNotEmpty property="fltNo"><![CDATA[AND UPPER(ISS.FLT_NO) = UPPER(#fltNo#)]]></isNotEmpty>
		<isNotEmpty property="fltDate"><![CDATA[AND ISS.FLT_DATE = TO_DATE(#fltDate#, 'DDMONYY')]]></isNotEmpty>
		<dynamic prepend="ORDER BY ">
			ISS.EIR_NO       
		</dynamic>
	</select>
	<!-- Request URF for Summary Detail by Agent and Flt/Date (Total Request ULD) -->
	<select id="sqlGetRequestURFsForSummaryDetailTotalReqULD"
		parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO" resultClass="java.lang.String">
		<![CDATA[
			SELECT
			STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_REQ_QTY, 0), ', ')) total
			FROM (
			  SELECT
			  ULD_GROUP, ULD_TYPE, 
			  SUM(NVL(ULD_REQ_QTY, 0)) ULD_REQ_QTY  
			  FROM
			  ULD_ISS_HD ISS
			  JOIN ULD_ISS_DTL DTL
			  ON ISS.EIR_NO = DTL.EIR_NO AND DTL.ULD_EQUIP = 'U'
			  LEFT JOIN CUST_COMPANY AGT
			  ON ISS.AGENT_CUST_NO = AGT.CODE
			  WHERE ISS.PURPOSE = 'Agt' AND ISS.STATUS NOT IN('VOID') AND NVL(ULD_REQ_QTY, 0) > 0
		]]>
		<isNotEmpty property="agentName"><![CDATA[AND UPPER(AGT.CODE_DESC) = UPPER(#agentName#)]]></isNotEmpty>
		<isNotEmpty property="fltNo"><![CDATA[AND UPPER(ISS.FLT_NO) = UPPER(#fltNo#)]]></isNotEmpty>
		<isNotEmpty property="fltDate"><![CDATA[AND ISS.FLT_DATE = TO_DATE(#fltDate#, 'DDMONYY')]]></isNotEmpty>
		<dynamic>
			  GROUP BY ULD_GROUP, ULD_TYPE
			)
		</dynamic>
	</select>
	<!-- Request URF for Summary Detail by Agent and Flt/Date (Total Approve ULD) -->
	<select id="sqlGetRequestURFsForSummaryDetailTotalAprULD"
		parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO" resultClass="java.lang.String">
		<![CDATA[
			SELECT
			STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_APR_QTY, 0), ', ')) total
			FROM (
			  SELECT
			  ULD_GROUP, ULD_TYPE, 
			  SUM(NVL(ULD_APR_QTY, 0)) ULD_APR_QTY  
			  FROM
			  ULD_ISS_HD ISS
			  JOIN ULD_ISS_DTL DTL
			  ON ISS.EIR_NO = DTL.EIR_NO AND DTL.ULD_EQUIP = 'U'
			  LEFT JOIN CUST_COMPANY AGT
			  ON ISS.AGENT_CUST_NO = AGT.CODE
			  WHERE ISS.PURPOSE = 'Agt' AND ISS.STATUS NOT IN('VOID') AND NVL(ULD_APR_QTY, 0) > 0
		]]>
		<isNotEmpty property="agentName"><![CDATA[AND UPPER(AGT.CODE_DESC) = UPPER(#agentName#)]]></isNotEmpty>
		<isNotEmpty property="fltNo"><![CDATA[AND UPPER(ISS.FLT_NO) = UPPER(#fltNo#)]]></isNotEmpty>
		<isNotEmpty property="fltDate"><![CDATA[AND ISS.FLT_DATE = TO_DATE(#fltDate#, 'DDMONYY')]]></isNotEmpty>
		<dynamic>
			  GROUP BY ULD_GROUP, ULD_TYPE		
			)
		</dynamic>
	</select>
	<!-- Request URF for Summary Detail by Agent and Flt/Date (Total Release ULD) -->
	<select id="sqlGetRequestURFsForSummaryDetailTotalRelULD"
		parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO" resultClass="java.lang.String">
		<![CDATA[
			SELECT
			STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_REL_QTY, 0), ', ')) total
			FROM (
			  SELECT
			  ULD_GROUP, ULD_TYPE, 
			  SUM(NVL(ULD_REL_QTY, 0)) ULD_REL_QTY   
			  FROM
			  ULD_ISS_HD ISS
			  JOIN ULD_ISS_DTL DTL
			  ON ISS.EIR_NO = DTL.EIR_NO AND DTL.ULD_EQUIP = 'U'
			  LEFT JOIN CUST_COMPANY AGT
			  ON ISS.AGENT_CUST_NO = AGT.CODE
			  WHERE ISS.PURPOSE = 'Agt' AND ISS.STATUS NOT IN('VOID') AND NVL(ULD_REL_QTY, 0) > 0
		]]>
		<isNotEmpty property="agentName"><![CDATA[AND UPPER(AGT.CODE_DESC) = UPPER(#agentName#)]]></isNotEmpty>
		<isNotEmpty property="fltNo"><![CDATA[AND UPPER(ISS.FLT_NO) = UPPER(#fltNo#)]]></isNotEmpty>
		<isNotEmpty property="fltDate"><![CDATA[AND ISS.FLT_DATE = TO_DATE(#fltDate#, 'DDMONYY')]]></isNotEmpty>
		<dynamic>
			  GROUP BY ULD_GROUP, ULD_TYPE		
			)
		</dynamic>
	</select>
	<!-- Maintain Endorse URF - Search Result -->
	<select id="sqlGetEndorsedURFs" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[
			SELECT
			HD.ENDR_NO endorseNo, TO_CHAR(HD.ENDR_DATE, 'DDMONYY HH24:MI') endrDate, 
			HD.CARR_CODE carrCode, HD.FLT_NO || '/' || TO_CHAR(HD.FLT_DATE, 'DDMONYY') fltNoDate,
			HD.FLT_NO fltNo, TO_CHAR(HD.FLT_DATE, 'DDMONYY') fltDate,
			CUST.CODE_DESC agentName, CUST.CODE agentCustNo, (
			  SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_QTY, 0), ', ')) 
			  FROM ULD_ENDR_DTL WHERE ENDR_NO = HD.ENDR_NO AND UPPER(ULD_EQUIP) = 'U' AND NVL(ULD_QTY, 0) > 0
			) uldQty,
			TO_CHAR(HD.LM_DATE, 'DDMONYY HH24:MI:SS') lmMultiUserTime,
			DECODE(HD.STATUS, 'VOID', 'Y', 'N') status
			FROM 
			ULD_ENDR_HD HD
			JOIN CUST_COMPANY CUST
			ON HD.AGENT_CUST_NO = CUST.CODE
			WHERE 1 = 1
		]]>
		<isNotEqual property="carrCode" compareValue="ALL"><![CDATA[AND	HD.CARR_CODE LIKE UPPER(#carrCode#)]]></isNotEqual>
		<isNotEmpty property="agentName"><![CDATA[AND UPPER(CUST.CODE_DESC) = UPPER(#agentName#)]]></isNotEmpty>
		<isNotEmpty property="fltNo"><![CDATA[AND UPPER(HD.FLT_NO) = UPPER(#fltNo#)]]></isNotEmpty>
		<isNotEmpty property="fromDate"><![CDATA[AND HD.FLT_DATE >= TO_DATE(#fromDate#, 'DDMONYY HH24:MI')]]></isNotEmpty>
		<isNotEmpty property="toDate"><![CDATA[AND HD.FLT_DATE <= TO_DATE(#toDate#, 'DDMONYY HH24:MI')]]></isNotEmpty>
		<isNotEmpty  property="endorseNo">AND HD.ENDR_NO = #endorseNo#</isNotEmpty>
		<isNotEmpty  property="endrURFStatus">AND HD.STATUS = #endrURFStatus#</isNotEmpty>	
			
		<dynamic prepend="ORDER BY ">
			HD.ENDR_NO           
		</dynamic>
	</select>
	<!-- Endorse URF Summary Data Modification Time -->
	<select id="sqlGetEndorsedURFRecordTime" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		<![CDATA[
			SELECT
			TO_CHAR(LM_DATE, 'DDMONYY HH24:MI:SS') lmMultiUserTime
			FROM ULD_ENDR_HD HD
			WHERE HD.ENDR_NO = #ENDORSE_NO#
		]]>
	</select>	
	<!-- Endorse URF ULD Details -->
	<select id="sqlGetEndorsedURFULDDetail" parameterClass="java.lang.String"
		resultClass="cargo.cms.uld.bo.URFRequestULDBO">
		<![CDATA[
			SELECT
			ULD_GROUP uldGroup, ULD_TYPE uldType, NVL(ULD_QTY, 0) uldEndrQty
			FROM ULD_ENDR_HD HD
			JOIN ULD_ENDR_DTL DTL
			ON HD.ENDR_NO = DTL.ENDR_NO AND DTL.ULD_EQUIP = 'U'
			WHERE HD.ENDR_NO = #PARAM#
		]]>
	</select>
	<!-- Endorse URF Equipment Details -->
	<select id="sqlGetEndorsedURFEquipDetail" parameterClass="java.lang.String"
		resultClass="cargo.cms.uld.bo.URFRequestAccessoryBO">
		<![CDATA[
			SELECT
			EQUIP_TYPE equipType, NVL(EQUIP_QTY, 0) equipEndrQty
			FROM ULD_ENDR_HD HD
			JOIN ULD_ENDR_DTL DTL
			ON HD.ENDR_NO = DTL.ENDR_NO AND DTL.ULD_EQUIP = 'E'
			WHERE HD.ENDR_NO = #PARAM#
		]]>
	</select>
	<!-- Find Total Available ULD Quantity after Endorsement Approval -->
	<select id="sqlGetEndorsedURFULDAvailQty" parameterClass="java.util.Map"
		resultClass="java.lang.Integer">
		<![CDATA[
			SELECT
			SUM(NVL(ENDR_QTY, 0)) - SUM(NVL(APR_QTY, 0))
			FROM ULD_ENDR_SUM
			WHERE AGENT_CUST_NO = #AGENT_NO# AND FLT_NO = #FLT_NO# AND FLT_DATE = TO_DATE(#FLT_DATE#, 'DDMONYY') AND
			ULD_EQUIP = 'U' AND (ULD_GROUP = #ULD_GROUP# OR ULD_TYPE = #ULD_TYPE#)
		]]>
	</select>
	<!-- Find Total Available Equipment Quantity after Endorsement Approval -->
	<select id="sqlGetEndorsedURFEquipAvailQty" parameterClass="java.util.Map"
		resultClass="java.lang.Integer">
		<![CDATA[
			SELECT
			SUM(NVL(ENDR_QTY, 0)) - SUM(NVL(APR_QTY, 0))
			FROM ULD_ENDR_SUM
			WHERE AGENT_CUST_NO = #AGENT_NO# AND FLT_NO = #FLT_NO# AND FLT_DATE = TO_DATE(#FLT_DATE#, 'DDMONYY') AND
			ULD_EQUIP = 'E' AND EQUIP_TYPE = #EQUIP_TYPE#
		]]>
	</select>
	<!-- Find Total Endorsed ULD Quantity for an URF Endorsement -->
	<select id="sqlGetEndorsedURFULDEndorseQty" parameterClass="java.util.Map"
		resultClass="java.lang.Integer">
		<![CDATA[
			SELECT
			SUM(NVL(ULD_QTY, 0)) uldEndrQty
			FROM ULD_ENDR_HD HD
			JOIN ULD_ENDR_DTL DTL
			ON HD.ENDR_NO = DTL.ENDR_NO AND DTL.ULD_EQUIP = 'U'
			WHERE HD.ENDR_NO = #ENDORSE_NO# AND (DTL.ULD_GROUP = #ULD_GROUP# OR DTL.ULD_TYPE = #ULD_TYPE#)
		]]>
	</select>
	<!-- Find Total Endorsed Equipment Quantity for an URF Endorsement -->
	<select id="sqlGetEndorsedURFEquipEndorseQty" parameterClass="java.util.Map"
		resultClass="java.lang.Integer">
		<![CDATA[
			SELECT
			SUM(NVL(ULD_QTY, 0)) equipEndrQty
			FROM ULD_ENDR_HD HD
			JOIN ULD_ENDR_DTL DTL
			ON HD.ENDR_NO = DTL.ENDR_NO AND DTL.ULD_EQUIP = 'E'
			WHERE HD.ENDR_NO = #ENDORSE_NO# AND DTL.EQUIP_TYPE = #EQUIP_TYPE#
		]]>
	</select>	
	<!-- Endorse URF Summary - Update Void ULD Qty -->
	<update id="sqlUpdateURFEndorseSummaryVoidULDQty"
		parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_ENDR_SUM SET
			VOID_QTY = VOID_QTY + NVL(#ULD_VOID_QTY#, 0),
			ENDR_QTY = ENDR_QTY - NVL(#ULD_VOID_QTY#, 0),
			LM_USER_ID = #USER_ID#, LM_DATE = SYSDATE
			WHERE AGENT_CUST_NO = #AGENT_NO# AND FLT_NO = #FLT_NO# AND FLT_DATE = TO_DATE(#FLT_DATE#, 'DDMONYY') AND
			ULD_EQUIP = 'U' AND (ULD_GROUP = #ULD_GROUP# OR ULD_TYPE = #ULD_TYPE#) 
		]]>
	</update>
	<!-- Endorse URF Summary - Update Void Equip Qty -->
	<update id="sqlUpdateURFEndorseSummaryVoidEquipQty"
		parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_ENDR_SUM SET
			VOID_QTY = VOID_QTY + NVL(#EQUIP_VOID_QTY#, 0),
			ENDR_QTY = ENDR_QTY - NVL(#EQUIP_VOID_QTY#, 0),
			LM_USER_ID = #USER_ID#, LM_DATE = SYSDATE
			WHERE AGENT_CUST_NO = #AGENT_NO# AND FLT_NO = #FLT_NO# AND FLT_DATE = TO_DATE(#FLT_DATE#, 'DDMONYY') AND
			ULD_EQUIP = 'E' AND EQUIP_TYPE = #EQUIP_TYPE#
		]]>
	</update>	
	<!-- Void URF Endorsement -->
	<update id="sqlUpdateURFVoidEndorsment" parameterClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[
			UPDATE ULD_ENDR_HD
			SET STATUS = 'VOID', LM_USER_ID = #lmUserId#, LM_DATE = SYSDATE
			WHERE ENDR_NO = #endorseNo#
		]]>
	</update>
	<!-- Search Endorsed URF for Approval Header Data -->
	<select id="sqlGetEndorsedURFHeaderForApprove" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFEndorseBO">
		<![CDATA[
			SELECT 
			FLT_NO fltNo, FLT_DATE fltDate, 
			SCH_DATE,
			SUBSTR(LPAD(FLT_TIME, 4, '0'), 1, 2) || ':' || SUBSTR(LPAD(FLT_TIME, 4, '0'), 3) fltTime,
			CODE_DESC agentName,
			STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_QTY, 0), ', ')) outstanding
			FROM (
				SELECT
				SUMM.FLT_NO FLT_NO, TO_CHAR(SUMM.FLT_DATE, 'DDMONYY') FLT_DATE,
				FLT.SCH_DATE, FLT.FLT_TIME, CUST.CODE_DESC,
				SUMM.ULD_GROUP, SUMM.ULD_TYPE, SUM(SUMM.ENDR_QTY) - SUM(SUMM.APR_QTY) ULD_QTY
				FROM 
				ULD_ENDR_SUM SUMM
				JOIN CUST_COMPANY CUST
				ON SUMM.AGENT_CUST_NO = CUST.CODE
        		JOIN (
        			SELECT OPR.*, NVL(OPR.EST_TIME, OPR.SCH_TIME) FLT_TIME FROM FLT_OPR OPR
        			WHERE SCH_DATE BETWEEN (TO_DATE(#fromDate#, 'DDMONYY HH24:MI') - 1) AND (TO_DATE(#toDate#, 'DDMONYY HH24:MI') + 1)
        		) FLT
        		ON SUMM.FLT_DATE = FLT.SCH_DATE AND SUMM.FLT_NO = FLT.FLT_KEY AND FLT.FLT_TYPE = 'D'	
				WHERE UPPER(SUMM.ULD_EQUIP) = 'U' AND
				TO_DATE(TO_CHAR(FLT.SCH_DATE, 'DDMONYY') || ' ' || SUBSTR(LPAD(FLT.SCH_TIME, 4, '0'), 1, 2) || ':' || SUBSTR(LPAD(FLT.SCH_TIME, 4, '0'), 3), 'DDMONYY HH24:MI')
					BETWEEN TO_DATE(#fromDate#, 'DDMONYY HH24:MI') AND TO_DATE(#toDate#, 'DDMONYY HH24:MI')
		]]>
		<isNotEmpty property="agentName"><![CDATA[AND UPPER(CUST.CODE_DESC) = UPPER(#agentName#)]]></isNotEmpty>
		<isNotEmpty property="fltNoOnly"><![CDATA[AND UPPER(SUMM.FLT_NO) = TRIM(UPPER(#fltNoCarr#) || UPPER(#fltNoOnly#))]]></isNotEmpty>
		<isNotEmpty property="fltDate"><![CDATA[AND SUMM.FLT_DATE = #fltDate#]]></isNotEmpty>
		<isEmpty property="fltNoOnly">	
			<isNotEmpty property="loginCarrier">
			 <![CDATA[
		       	AND ( 
		       		SUBSTR(SUMM.FLT_NO, 0, 2) = #loginCarrier#
					OR SUBSTR(SUMM.FLT_NO, 0, 2) IN (SELECT CARR_CODE FROM MAST_CARR_GRP WHERE GRP_CARR_CODE = #loginCarrier#)
				)
		      ]]>
			</isNotEmpty>
		</isEmpty>
		
		<dynamic>
        		GROUP BY FLT.SCH_DATE, FLT.FLT_TIME, CUST.CODE_DESC, SUMM.FLT_NO, SUMM.FLT_DATE, SUMM.ULD_GROUP, SUMM.ULD_TYPE
				ORDER BY FLT.SCH_DATE, FLT.FLT_TIME, CUST.CODE_DESC, SUMM.FLT_NO, SUMM.FLT_DATE, SUMM.ULD_GROUP, SUMM.ULD_TYPE
		    )
		    WHERE ULD_QTY > 0
		    GROUP BY SCH_DATE, FLT_TIME, FLT_DATE, FLT_NO, CODE_DESC
		    ORDER BY SCH_DATE, FLT_TIME, FLT_DATE, FLT_NO, CODE_DESC
		</dynamic>
	</select>		
	<!-- Search Endorsed URF for Endorse Approval -->
	<select id="sqlGetEndorsedURFsForApprove" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFMaintainRequestBO">
		<![CDATA[
			SELECT
			HD.ENDR_NO endorseNo, (
			  SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || NVL(ULD_QTY, 0), ', ')) 
			  FROM ULD_ENDR_DTL WHERE ENDR_NO = HD.ENDR_NO AND UPPER(ULD_EQUIP) = 'U' AND NVL(ULD_QTY, 0) > 0
			) uldCombined,  (
			  SELECT STRAGG(STRINGDELIM(EQUIP_TYPE || '-' || NVL(EQUIP_QTY, 0), ', ')) 
			  FROM ULD_ENDR_DTL WHERE ENDR_NO = HD.ENDR_NO AND UPPER(ULD_EQUIP) = 'E' AND NVL(EQUIP_QTY, 0) > 0
			) accessoryCombined,
			TO_CHAR(HD.ENDR_DATE, 'DDMONYY HH24:MI') endrDate, HD.ENDR_RMK eirRmk, HD.CR_USER_ID endrBy
			FROM 
			ULD_ENDR_HD HD
			JOIN (
        		SELECT * FROM FLT_OPR
        		WHERE SCH_DATE BETWEEN (TO_DATE(#fromDate#, 'DDMONYY HH24:MI') - 1) AND (TO_DATE(#toDate#, 'DDMONYY HH24:MI') + 1)
        	) FLT
        	ON HD.FLT_DATE = FLT.SCH_DATE AND HD.FLT_NO = FLT.FLT_KEY AND FLT.FLT_TYPE = 'D'
			JOIN CUST_COMPANY CUST
			ON HD.AGENT_CUST_NO = CUST.CODE
			WHERE HD.STATUS = 'PENDING' 
			AND TO_DATE(TO_CHAR(FLT.SCH_DATE, 'DDMONYY') || ' ' || SUBSTR(LPAD(FLT.SCH_TIME, 4, '0'), 1, 2) || ':' || SUBSTR(LPAD(FLT.SCH_TIME, 4, '0'), 3), 'DDMONYY HH24:MI')
				BETWEEN TO_DATE(#fromDate#, 'DDMONYY HH24:MI') AND TO_DATE(#toDate#, 'DDMONYY HH24:MI')
		]]>
		<isNotEmpty property="agentName"><![CDATA[AND UPPER(CUST.CODE_DESC) = UPPER(#agentName#)]]></isNotEmpty>
		<isNotEmpty property="fltNo"><![CDATA[AND UPPER(HD.FLT_NO) = UPPER(#fltNo#)]]></isNotEmpty>
		<isNotEmpty property="fltDate"><![CDATA[AND HD.FLT_DATE = #fltDate#]]></isNotEmpty>
		<dynamic prepend="ORDER BY ">
			HD.ENDR_NO           
		</dynamic>
	</select>
	<!-- Search Request URF for Endorse Approval -->
	<select id="sqlGetRequestURFsForApprove" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFMaintainRequestBO">
		<![CDATA[
			SELECT
			ISS.EIR_NO eirNo, TO_CHAR(ISS.EST_TIME, 'DDMONYY HH24:MI') estTime,ENDR_URF_MSG as endrseURFMsg
			FROM
			ULD_ISS_HD ISS
			JOIN (
        		SELECT * FROM FLT_OPR
        		WHERE SCH_DATE BETWEEN (TO_DATE(#fromDate#, 'DDMONYY HH24:MI') - 1) AND (TO_DATE(#toDate#, 'DDMONYY HH24:MI') + 1)
        	) FLT
        	ON ISS.FLT_DATE = FLT.SCH_DATE AND ISS.FLT_NO = FLT.FLT_KEY AND FLT.FLT_TYPE = 'D'
			LEFT JOIN CUST_COMPANY AGT
			ON ISS.AGENT_CUST_NO = AGT.CODE
			WHERE ISS.STATUS = 'PENDING' AND ISS.PURPOSE = 'Agt' AND NVL(ISS.EIR_EXPIRY_DATE,SYSDATE) >= SYSDATE
			AND TO_DATE(TO_CHAR(FLT.SCH_DATE, 'DDMONYY') || ' ' || SUBSTR(LPAD(FLT.SCH_TIME, 4, '0'), 1, 2) || ':' || SUBSTR(LPAD(FLT.SCH_TIME, 4, '0'), 3), 'DDMONYY HH24:MI')
				BETWEEN TO_DATE(#fromDate#, 'DDMONYY HH24:MI') AND TO_DATE(#toDate#, 'DDMONYY HH24:MI')
		]]>
		<isNotEmpty property="agentName"><![CDATA[AND UPPER(AGT.CODE_DESC) = UPPER(#agentName#)]]></isNotEmpty>
		<isNotEmpty property="fltNo"><![CDATA[AND UPPER(ISS.FLT_NO) = UPPER(#fltNo#)]]></isNotEmpty>
		<isNotEmpty property="fltDate"><![CDATA[AND ISS.FLT_DATE = #fltDate#]]></isNotEmpty>
		<dynamic prepend="ORDER BY ">
			ISS.EIR_NO           
		</dynamic>
	</select>
	<!-- Endorse URF - Approve ULD Quantity -->
	<update id="sqlUpdateURFEndorseULDApproveQty" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_ENDR_SUM SET
			APR_QTY = APR_QTY + NVL(#ULD_APR_QTY#, 0),
			LM_USER_ID = #USER_ID#, LM_DATE = SYSDATE
			WHERE AGENT_CUST_NO = #AGENT_NO# AND FLT_NO = #FLT_NO# AND FLT_DATE = TO_DATE(#FLT_DATE#, 'DDMONYY') AND
			ULD_EQUIP = 'U' AND (ULD_GROUP = #ULD_GROUP# OR ULD_TYPE = #ULD_TYPE#)
		]]>
	</update>
	<!-- Endorse URF - Approve Equipment Quantity -->
	<update id="sqlUpdateURFEndorseEquipApproveQty" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_ENDR_SUM SET
			APR_QTY = APR_QTY + NVL(#EQUIP_APR_QTY#, 0),
			LM_USER_ID = #USER_ID#, LM_DATE = SYSDATE
			WHERE AGENT_CUST_NO = #AGENT_NO# AND FLT_NO = #FLT_NO# AND FLT_DATE = TO_DATE(#FLT_DATE#, 'DDMONYY') AND
			ULD_EQUIP = 'E' AND EQUIP_TYPE = #EQUIP_TYPE#
		]]>
	</update>
	<!-- Endorse URF - Update Request Endorse ULD Quantity -->
	<update id="sqlUpdateURFRequestULDEndorseQty" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_ISS_DTL DTL SET
			ULD_ENDR_QTY = NVL((
			  SELECT SUM(SUMM.ENDR_QTY)
			  FROM ULD_ENDR_SUM SUMM
			  JOIN ULD_ISS_HD ISS
			  ON SUMM.AGENT_CUST_NO = ISS.AGENT_CUST_NO AND SUMM.FLT_NO = ISS.FLT_NO AND SUMM.FLT_DATE = ISS.FLT_DATE
			  WHERE ISS.EIR_NO = DTL.EIR_NO AND SUMM.ULD_EQUIP = 'U' AND (SUMM.ULD_GROUP = DTL.ULD_GROUP OR SUMM.ULD_TYPE = DTL.ULD_TYPE)
			), 0),
			LM_USER_ID = #USER_ID#, LM_DATE = SYSDATE
			WHERE EIR_NO = #URF_NO# AND	ULD_EQUIP = 'U' AND (ULD_GROUP = #ULD_GROUP# OR ULD_TYPE = #ULD_TYPE#)
		]]>
	</update>	
	<!-- Endorse URF - Update Request Approve ULD Quantity -->
	<update id="sqlUpdateURFRequestULDApproveQty" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_ISS_DTL SET
			ULD_APR_QTY = NVL(#ULD_APR_QTY#, 0),
			LM_USER_ID = #USER_ID#, LM_DATE = SYSDATE
			WHERE EIR_NO = #URF_NO# AND	ULD_EQUIP = 'U' AND (ULD_GROUP = #ULD_GROUP# OR ULD_TYPE = #ULD_TYPE#)
		]]>
	</update>
	<!-- Endorse URF - Update Request Endorse ULD Basic Equipment Quantity -->
	<update id="sqlUpdateURFRequestBasicEquipEndorseQty" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_ISS_DTL DTL SET
			EQUIP_ENDR_QTY = (
				SELECT SUM(ULD_ENDR_QTY)
				FROM ULD_ISS_DTL ULDREQ
				WHERE ULDREQ.EIR_NO = DTL.EIR_NO AND ULDREQ.ULD_EQUIP = 'U' AND
				(ULDREQ.ULD_GROUP = DTL.ULD_GROUP OR ULDREQ.ULD_TYPE = DTL.ULD_TYPE)
			) * (
				SELECT SUM(QTY)
				FROM ULD_BASIC_ACC
				WHERE ULD_CARR = (
					SELECT CARR_CODE FROM ULD_ISS_HD HD WHERE HD.EIR_NO = DTL.EIR_NO
				) AND ULD_GROUP = NVL(DTL.ULD_GROUP, (
					SELECT MAX(ULD_GROUP) FROM ULD_GROUP_TYPE WHERE ULD_TYPE = DTL.ULD_TYPE
				)) AND ACC_TYPE = DTL.EQUIP_TYPE
			),
			LM_USER_ID = #USER_ID#, LM_DATE = SYSDATE
			WHERE EIR_NO = #URF_NO# AND	ULD_EQUIP = 'B' AND
			NVL(ULD_GROUP, 'NULL') = NVL(#ULD_GROUP#, 'NULL') AND NVL(ULD_TYPE, 'NULL') = NVL(#ULD_TYPE#, 'NULL')
		]]>
	</update>	
	<!-- Endorse URF - Update Request Approve ULD Basic Equipment Quantity -->
	<update id="sqlUpdateURFRequestBasicEquipApproveQty" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_ISS_DTL DTL SET
			EQUIP_APR_QTY = NVL(#ULD_APR_QTY#, 0) * (
				SELECT SUM(QTY)
				FROM ULD_BASIC_ACC
				WHERE ULD_CARR = (
					SELECT CARR_CODE FROM ULD_ISS_HD HD WHERE HD.EIR_NO = DTL.EIR_NO
				) AND ULD_GROUP = NVL(DTL.ULD_GROUP, (
					SELECT MAX(ULD_GROUP) FROM ULD_GROUP_TYPE WHERE ULD_TYPE = DTL.ULD_TYPE
				)) AND ACC_TYPE = DTL.EQUIP_TYPE
			),
			LM_USER_ID = #USER_ID#, LM_DATE = SYSDATE
			WHERE EIR_NO = #URF_NO# AND	ULD_EQUIP = 'B' AND
			NVL(ULD_GROUP, 'NULL') = NVL(#ULD_GROUP#, 'NULL') AND NVL(ULD_TYPE, 'NULL') = NVL(#ULD_TYPE#, 'NULL')
		]]>
	</update>
	<!-- Endorse URF - Update Request Endorse Equipment Quantity -->
	<update id="sqlUpdateURFRequestEquipEndorseQty" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_ISS_DTL DTL SET
			EQUIP_ENDR_QTY = NVL((
			  SELECT SUM(SUMM.ENDR_QTY)
			  FROM ULD_ENDR_SUM SUMM
			  JOIN ULD_ISS_HD ISS
			  ON SUMM.AGENT_CUST_NO = ISS.AGENT_CUST_NO AND SUMM.FLT_NO = ISS.FLT_NO AND SUMM.FLT_DATE = ISS.FLT_DATE
			  WHERE ISS.EIR_NO = DTL.EIR_NO AND SUMM.ULD_EQUIP = 'E' AND SUMM.EQUIP_TYPE = DTL.EQUIP_TYPE
			), 0),
			LM_USER_ID = #USER_ID#, LM_DATE = SYSDATE
			WHERE EIR_NO = #URF_NO# AND	ULD_EQUIP = 'E' AND EQUIP_TYPE = #EQUIP_TYPE#
		]]>
	</update>	
	<!-- Endorse URF - Update Request Approve Equipment Quantity -->
	<update id="sqlUpdateURFRequestEquipApproveQty" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_ISS_DTL SET
			EQUIP_APR_QTY = NVL(#EQUIP_APR_QTY#, 0),
			LM_USER_ID = #USER_ID#, LM_DATE = SYSDATE
			WHERE EIR_NO = #URF_NO# AND	ULD_EQUIP = 'E' AND EQUIP_TYPE = #EQUIP_TYPE#
		]]>
	</update>
	<!-- Endorse URF - Update Request URF Status and Remarks -->
	<update id="sqlUpdateEndorseApproveInRequestURF" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE ULD_ISS_HD
			SET	STATUS = 'APPROVED',
			ENDR_DATE = TO_DATE(#ENDORSE_TIME#, 'DDMONYY HH24:MI'), APR_DATE = SYSDATE,
			ENDR_BY = #ENDORSE_BY#, APR_BY = #USER_ID#,
			ENDR_EST_TIME = NVL(REQ_EST_TIME,TO_DATE(#EST_TIME#, 'DDMONYY HH24:MI')) , APR_EST_TIME = NVL(REQ_EST_TIME,TO_DATE(#EST_TIME#, 'DDMONYY HH24:MI')), 
			REQ_EST_TIME = NVL(REQ_EST_TIME,TO_DATE(#EST_TIME#, 'DDMONYY HH24:MI')), EST_TIME = TO_DATE(#EST_TIME#, 'DDMONYY HH24:MI'), EIR_EXPIRY_DATE = TO_DATE(#EST_TIME#, 'DDMONYY HH24:MI'),
			ENDR_RMK = #ENDORSE_REMARKS#, APR_RMK = #APPROVE_REMARKS#,
			LM_USER_ID = #USER_ID#, LM_DATE = SYSDATE
			WHERE EIR_NO = #URF_NO#
		]]>
	</update>
<!-- URF Report -->
	<select id="sqlGetURFReportData" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[
			WITH RELEASE AS (
			  SELECT EIR_NO, MAX(CR_DATE) CR_DATE 
			  FROM ULD_REL_HD
			  WHERE CR_DATE BETWEEN TO_DATE(#from#, 'DDMONYY HH24:MI') AND TO_DATE(#to#, 'DDMONYY HH24:MI')
			  GROUP BY EIR_NO
			)
			SELECT
			ISS.EIR_NO urfNo,
			TO_CHAR(ISS.CR_DATE, 'DDMONYY HH24:MI')  reqDate,
			TO_CHAR(ISS.ENDR_DATE, 'DDMONYY HH24:MI') endrDate,
			TO_CHAR(ISS.APR_DATE, 'DDMONYY HH24:MI') aprDate,
			ISS.FLT_NO fltNo, TO_CHAR(ISS.FLT_DATE, 'DDMONYY') fltDate,
			PKG_COMMON.GET_FLT_STA(ISS.FLT_NO, ISS.FLT_DATE, 'D', 'DD') fltTime,
			TO_CHAR(ISS.APR_EST_TIME, 'DDMONYY HH24:MI') estTime, 
			TO_CHAR(REL.CR_DATE, 'DDMONYY HH24:MI') relDate, 
      		CASE
		       WHEN 
			      ROUND((TO_DATE((TO_CHAR(ISS.FLT_DATE, 'DDMONYY')||
			      PKG_COMMON.GET_FLT_STA(ISS.FLT_NO, ISS.FLT_DATE, 'D', 'DD')),'DDMONYYHH24:MI') -  REL.CR_DATE) * 24 *60) <0 THEN 0
		      ELSE 
			      ROUND((TO_DATE((TO_CHAR(ISS.FLT_DATE, 'DDMONYY')||
			      PKG_COMMON.GET_FLT_STA(ISS.FLT_NO, ISS.FLT_DATE, 'D', 'DD')),'DDMONYYHH24:MI') -  REL.CR_DATE) * 24 *60)
		      END durationFromStd,
		      		ROUND((REL.CR_DATE - ISS.APR_DATE) * 24 * 60) elapsedTime, (
			  SELECT CODE_DESC FROM MAST_CODE_DTL WHERE CODE_TYPE = 'URF_STATUS' AND CODE = ISS.STATUS
			) status, (
			  SELECT STRAGG(STRINGDELIM((SELECT ULD_GROUP FROM ULD_GROUP_TYPE GRP WHERE GRP.ULD_TYPE = RELULD.ULD_TYPE) || '-' || SUM(1), ', '))
			  FROM ULD_REL_DTL RELULD
			  WHERE RELULD.EIR_NO = ISS.EIR_NO AND UPPER(RELULD.ULD_EQUIP) = 'U'
			  GROUP BY RELULD.ULD_TYPE
			) uldQty
			FROM ULD_ISS_HD ISS
      		JOIN RELEASE REL
      		ON ISS.EIR_NO = REL.EIR_NO
			WHERE ISS.PURPOSE = 'Agt' AND ISS.STATUS IN('CLOSED', 'PARTRELEASED')
			AND (
				SELECT COUNT(1) FROM ULD_REL_DTL ULD
				WHERE ULD.EIR_NO = REL.EIR_NO AND ULD.ULD_EQUIP = 'U' AND ULD.ULD_KEY IS NOT NULL
			) > 0
		]]>
		<isNotEmpty property="agentName">
			<![CDATA[ 
				AND ISS.AGENT_CUST_NO = (
				  SELECT CODE FROM CUST_COMPANY WHERE UPPER(CODE_DESC) = UPPER(#agentName#)
				)
			]]>
		</isNotEmpty>
		<dynamic prepend="ORDER BY ">
			ISS.EIR_NO
		</dynamic>
	</select>
	<select id="sqlGetURFReportULDSummaryData" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFSearchResultBO">
		<![CDATA[
			WITH RELEASE AS (
			  SELECT EIR_NO, MAX(CR_DATE) CR_DATE 
			  FROM ULD_REL_HD
			  WHERE CR_DATE BETWEEN TO_DATE(#from#, 'DDMONYY HH24:MI') AND TO_DATE(#to#, 'DDMONYY HH24:MI')
			  GROUP BY EIR_NO
			)		
			SELECT
			TYP.ULD_GROUP uldGroup, COUNT(1) uldQty
			FROM RELEASE REL
			JOIN ULD_ISS_HD ISS
			ON REL.EIR_NO = ISS.EIR_NO
			JOIN ULD_REL_DTL DTL
			ON REL.EIR_NO = DTL.EIR_NO
			JOIN ULD_GROUP_TYPE TYP
			ON DTL.ULD_TYPE = TYP.ULD_TYPE
			WHERE ISS.PURPOSE = 'Agt' AND DTL.ULD_EQUIP = 'U'
		]]>
		<isNotEmpty property="agentName">
			<![CDATA[ 
				AND ISS.AGENT_CUST_NO = (
				  SELECT CODE FROM CUST_COMPANY WHERE UPPER(CODE_DESC) = UPPER(#agentName#)
				)
			]]>
		</isNotEmpty>
		<dynamic>
			GROUP BY TYP.ULD_GROUP
		</dynamic>
	</select>		
	<!-- URF -->
		<select id="validLSPNo" parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		select count(1) from LSP_INVENTORY where LSP_NO=#lspNo#
	</select>
	<select id="getLspUldTareWt" parameterClass="java.lang.String"  resultClass="java.lang.String">
	 select decode((select tare_weight from mast_uld_type where code = substr(#lspOrUld#,0,3)),null,(select tare_wt from mast_csd where code = #lspOrUld#),(select tare_weight from mast_uld_type where code = substr(#lspOrUld#,0,3))) from dual
	</select>
	
	<select id="checkLspInMaster" parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		select count(1) from MAST_CSD where code=#lspNo#
	</select>
	
	<select id="checkUldInInventory" parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		select count(1) from ULD_INVENTORY where ULD_KEY=#uldKey# and (LOC_CODE is not null OR nvl(OWNED_INV,'N')='Y')
	</select>
	<select id="validWhArea" parameterClass="java.lang.String"  resultClass="java.lang.Integer">
			select count(1) from MAST_WH_AREA where WH_AREA=#areaCode#
	</select>
	<select id="validateImpOrExpFlight" parameterClass="map"  resultClass="java.lang.Integer">
		select count(1) from FLT_OPR where flt_key = #fltKey# and sch_date = #fltDate# and flt_type = #fltType#
	</select>
	
	<select id="isValidCarrieCode" parameterClass="java.lang.String"  resultClass="java.lang.String">
		select nvl(owned_carr,'N')
        from mast_carrier
        where code = #CODE#
	</select>
	
	<select id="checkUldInInvForTransferCargo1" parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		select count(1) from ULD_INVENTORY
		where ULD_KEY=#uldKey# 
		AND NVL(OWNED_INV,'N') = 'Y'
	</select>
	
	<select id="checkUldInInvForTransferCargo2" parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		select count(1) from ULD_INVENTORY
		where ULD_KEY=#uldKey# 
		AND NVL(OWNED_INV,'N') = 'N'
	</select>
	
	<select id="isValidAirport" parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		select count(1) from MAST_ARPT where CODE = #origOrDest# 
	</select>
	<select id="getURFCarrierCode" parameterClass="java.lang.String"  resultClass="java.lang.String">
		select CARR_CODE  from ULD_ISS_HD where EIR_NO=#PARAM# 
	</select>
	<select id="getURFParentCarrierCode" parameterClass="java.lang.String"
		resultClass="java.lang.String">
		SELECT GRP_CARR_CODE FROM MAST_CARR_GRP WHERE CARR_CODE = #PARAM#
	</select>	
	
	<select id="sqlCheckUldProfileBasePalleteforEIC"  parameterClass="map"  resultClass="java.lang.String">
		SELECT NVL(count(1), 0) as count
			 FROM ULD_GROUP_CARR
			  WHERE CARR_CODE=#carrCode# AND ULD_TYPE=#uldType# and BASE_PAL_FLG='Y' 
   	</select>
   	
   	<select id="sqlgetetdPortofCall"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="cargo.cms.uld.bo.ULDEICBO">
   	 	SELECT  PKG_COMMON.GET_FLT_ETA(#fltKey#,#fltDate#,'D','DD') AS ata,
   	 	PKG_EXP_RPT.FLT_PORTS(#fltKey#,#fltDate#) portOfCall FROM DUAL
	</select>
	<select id="sqlGetULDDtlsMHCSChkin"  parameterClass="cargo.cms.uld.bo.MHCSCheckinBO"  resultClass="cargo.cms.uld.bo.MHCSCheckinBO">
		SELECT A.ULD_KEY uldKey,A.EMPTY_FLG emptyInd,A.EIC_FLG eicInd,A.DAM_IND damageInd,A.CONTR_CODE contourCode,
		A.FLT_KEY fltKey,NVL(TO_CHAR(A.FLT_DATE,'DDMONYY'),'') fltDate, 
		DECODE(A.TARGET,NULL,(case when #process#='IM' then (select RULE_VALUE from cmsrules where rule_code = 'TGT_MHCS_CHK_IN_IMP') else 
		case when #process#='EX' then (select RULE_VALUE from cmsrules where rule_code = 'TGT_MHCS_CHK_IN_EXP') else
		case when #process#='TR' then (select RULE_VALUE from cmsrules where rule_code = 'TGT_MHCS_CHK_IN_TR') else
		case when #process#='OT' then (select RULE_VALUE from cmsrules where rule_code = 'TGT_MHCS_CHK_IN_OTH') else
		case when #process#='OF' then (select RULE_VALUE from cmsrules where rule_code = 'TGT_MHCS_CHK_IN_OFF') end end end end end),A.TARGET) target ,
		(select code_desc from mast_code_dtl where code_type = 'ULD_STATE' and code = FUN_GET_ULD_STATE(A.ULD_KEY)) as uldStat,
		fun_get_uld_shc(A.ULD_KEY) shcCode  ,
		(case when #process#='IM' then (select orig from flt_opr where flt_key=A.FLT_KEY and sch_date=TO_CHAR(A.FLT_DATE,'DDMONYY') and flt_type='A') else 
		case when #process#='EX' then (select unldg_pt from exp_pmanifest_uld where flt_key=A.FLT_KEY and flt_date=TO_CHAR(A.FLT_DATE,'DDMONYY') and uld_bt_no=A.ULD_KEY) else
		case when #process#='TR' then (select orig from flt_opr where flt_key=A.FLT_KEY and sch_date=TO_CHAR(A.FLT_DATE,'DDMONYY') and flt_type='A') else
		case when #process#='OT' then '' else
		case when #process#='OF' then (select unldg_pt from exp_pmanifest_uld where flt_key=A.FLT_KEY and flt_date=TO_CHAR(A.FLT_DATE,'DDMONYY') and uld_bt_no=A.ULD_KEY) end end end end end) place,
		(CASE WHEN FUN_GET_TEMP_CAT4_CLASS(A.ULD_KEY,'') IS NOT NULL THEN 
   FUN_GET_TEMP_CAT4_CLASS(A.ULD_KEY,'') ELSE
   		 '' END) AS tempClass,
  DECODE(FUN_GET_ULD_STATE(A.ULD_KEY),'AL',TRIM(A.LOAD_TYPE),'') as loadType ,
  A.GEN_RMK as remarks		
		FROM ULD_INVENTORY A WHERE A.ULD_KEY=#uldKey# 
	</select>
	<parameterMap id="mhcsChkinMap" class="map" >
            <parameter property="LOCCODE"  	jdbcType="VARCHAR"      	javaType="java.lang.String"      								mode="IN"/>
            <parameter property="ULDKEY" 	jdbcType="VARCHAR"        	javaType="java.lang.String"       								mode="IN"/>
            <parameter property="HINT" 		jdbcType="VARCHAR"      	javaType="java.lang.String"      								mode="OUT"/>
            <parameter property="PROCESS" 	jdbcType="VARCHAR"          javaType="java.lang.String"       								mode="OUT"/>
      </parameterMap>
	  <procedure id="fetchMHCSCHKINDetails" parameterMap="mhcsChkinMap">
            { call PRC_GET_MHCS_CHK_STATUS(?,?,?,?)  }
      </procedure>
      
    <select id="getGroupCarrierOwner"  parameterClass="map"  resultClass="java.lang.Integer">
		select count(1) from dual where (select  FUN_GET_PARENT_CARR (#BASE_CARR#) from dual) =
	    (select  FUN_GET_PARENT_CARR (#TOP_CARR#) from dual)
   	</select>
   	<delete id="exportBasePaletteForExpDlsDtlWOFlt" parameterClass="cargo.cms.uld.bo.ULDEICBO">
		delete from exp_dls_dtl  
		where  flt_key = #fltKey#
		and    flt_date = to_date(#fltDate#,'DDMONYY')
		and    uld_key = #uldKey#
	</delete>
	<delete id="exportBasePaletteForExpFltUldWOFLT" parameterClass="cargo.cms.uld.bo.ULDEICBO">
		delete from exp_flt_uld 
		where  flt_key = #fltKey#
		and    flt_date = to_date(#fltDate#,'DDMONYY')
		and    uld_key = #uldKey#
	</delete>
	<delete id="updateExportBasePaletteForExpPreManUldWOFlt" parameterClass="cargo.cms.uld.bo.ULDEICBO">
		delete from EXP_PMANIFEST_ULD 
		where  flt_key = #fltKey#
		and    flt_date = to_date(#fltDate#,'DDMONYY')
		and    ULD_BT_NO = #uldKey#
	</delete>
	<select id="sqlGetExpFltULDCountforDelete"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="java.lang.Integer">
		select count(*) from exp_flt_uld where  flt_key = #fltKey#	and  flt_date = to_date(#fltDate#,'DDMONYY')	and    uld_key = #uldKey# and man_pcs>0
   	</select>
   	<select id="sqlGetExpPreManULDCountforDelete"  parameterClass="cargo.cms.uld.bo.ULDEICBO"  resultClass="java.lang.Integer">
		SELECT count(1) from  EXP_PMANIFEST_ULD where  flt_key = #fltKey#	and    flt_date = to_date(#fltDate#,'DDMONYY')	and    ULD_BT_NO = #uldKey# and BLDUP_START='Y'
   	</select>
   	<select id="sqlCheckULDRemoveInTowOut" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(*) from TOW_ORDER_OUT_DTL WHERE TO_NO IN (
		SELECT TO_NO from TOW_ORDER_OUT_DTL 
		WHERE ULD_KEY=#ULD_KEY# AND TO_NO IN (SELECT TO_NO FROM TOW_ORDER_OUT WHERE STATUS != 'COMPLETE'))
		AND REMOVE_DATE IS NULL 
	</select>
         <update id="updateHOandChkoutDetailsforMHCS" parameterClass="java.util.Map">
		UPDATE uld_inventory SET loc_code=#NEXT_HO_LOC# WHERE ULD_KEY=#ULD_KEY#
	</update>
	<update id="sqlUpdateULDStatusRemoveInTowOut" parameterClass="java.util.Map">
		<![CDATA[
			UPDATE TOW_ORDER_OUT  
			SET STATUS = 'COMPLETE', 
			LM_DATE = SYSDATE, LM_USER_ID = #USER_ID# 
			WHERE STATUS = 'ISSUED' 
			AND 
			TO_NO IN (SELECT TO_NO FROM TOW_ORDER_OUT_DTL WHERE ULD_KEY = #ULD_KEY#)
		]]>
	</update>
	<select id="gettowOrderExistCount"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		SELECT count(*) FROM
		TOW_ORDER_OUT a
		LEFT OUTER JOIN TOW_ORDER_OUT_DTL	b	ON a.TO_NO = b.TO_NO 
  		where b.uld_key=#PARAM#
   		AND STATUS = 'ISSUED'
   	</select>
   	<select id="getAllUldsRemovedCount"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		select count(*) from ULD_REL_DTL a,uld_inventory b where b.uld_key=a.uld_key and b.owned_inv='Y' and a.eir_no=#PARAM#
   	</select>
	
	<!-- To check Valid Target or Not :: Ranjith  :: Starts-->
		<select id="isValidTarget" parameterClass="java.lang.String" resultClass="java.lang.Integer">
			  SELECT COUNT(1) FROM DUAL WHERE EXISTS (SELECT NULL FROM MAST_WH_LOC WHERE CODE = #target#
        												UNION
        											  SELECT NULL FROM MAST_WH_GROUP WHERE WH_GROUP = #target#
        												UNION 
        											  SELECT NULL FROM MAST_WH_AREA WHERE WH_AREA = #target#) 
		</select>
	<!-- To check Valid Target or Not :: Ranjith :: Ends-->
		<parameterMap id="prcGetHintTextMap" class="java.util.HashMap">
		<parameter property="LOC_CODE" jdbcType="VARCHAR" javaType="java.lang.String"
			mode="IN" />
		<parameter property="ULD_KEY" jdbcType="VARCHAR" javaType="java.lang.String"
			mode="IN" />
		<parameter property="HINT_TEXT" jdbcType="VARCHAR" javaType="java.lang.String"
			mode="OUT" />
		<parameter property="PROCESS" jdbcType="VARCHAR" javaType="java.lang.String"
			mode="OUT" />		
	</parameterMap>	
	<procedure id="sqlPrcGetMHCSHintText" parameterMap="prcGetHintTextMap">
		{ call PRC_GET_MHCS_CHK_STATUS(?,?,?,?)}
	</procedure>
	<select id="sqlGetULDFFMDtlsMHCSChkin"  parameterClass="cargo.cms.uld.bo.MHCSCheckinBO"  resultClass="cargo.cms.uld.bo.MHCSCheckinBO">
		SELECT A.ULD_KEY uldKey,NVL(B.EMPTY_IND,A.EMPTY_IND) emptyInd,NVL(B.EIC_IND,NULL) eicInd,NVL(B.DAM_IND,A.DAM_IND) damageInd,NVL(B.CONTR,NULL) contourCode,
		A.FLT_KEY fltKey,NVL(TO_CHAR(A.FLT_DATE,'DDMONYY'),'') fltDate,
		(select code_desc from mast_code_dtl where code_type = 'ULD_STATE' and code = FUN_GET_ULD_STATE(A.ULD_KEY)) as uldStat,
		(case when #process#='IM' then (select RULE_VALUE from cmsrules where rule_code = 'TGT_MHCS_CHK_IN_IMP') else 
		case when #process#='EX' then (select RULE_VALUE from cmsrules where rule_code = 'TGT_MHCS_CHK_IN_EXP') else
		case when #process#='TR' then (select RULE_VALUE from cmsrules where rule_code = 'TGT_MHCS_CHK_IN_TR') else
		case when #process#='OT' then (select RULE_VALUE from cmsrules where rule_code = 'TGT_MHCS_CHK_IN_OTH') else
		case when #process#='OF' then (select RULE_VALUE from cmsrules where rule_code = 'TGT_MHCS_CHK_IN_OFF') end end end end end) target ,
		(case when #process#='IM' then (select STRAGG(STRINGDELIM(shc,',')) from v_imp_flt_uld_shc where uld_key=#uldKey# AND flt_key=A.FLT_KEY and flt_date = A.FLT_DATE AND ROWNUM &lt;= 7) else 
		case when #process#='EX' then (select STRAGG(STRINGDELIM(CODE,',')) from v_exp_uld_shc where uld_key=#uldKey#  AND ROWNUM &lt;= 7) else
		case when #process#='TR' then (select STRAGG(STRINGDELIM(shc,',')) from v_imp_flt_uld_shc where uld_key=#uldKey# AND flt_key=A.FLT_KEY and flt_date = A.FLT_DATE AND ROWNUM &lt;= 7) else
		case when #process#='OT' then (select STRAGG(STRINGDELIM(shc,',')) from v_imp_flt_uld_shc where uld_key=#uldKey# AND ROWNUM &lt;= 7) else
		case when #process#='OF' then (select STRAGG(STRINGDELIM(CODE,',')) from v_exp_uld_shc where uld_key=#uldKey# AND ROWNUM &lt;= 7) end end end end end) shcCode,
		(case when #process#='IM' then (select orig from flt_opr where flt_key=A.FLT_KEY and sch_date=TO_CHAR(A.FLT_DATE,'DDMONYY') and flt_type='A') else 
		case when #process#='EX' then (select unldg_pt from exp_pmanifest_uld where flt_key=A.FLT_KEY and flt_date=TO_CHAR(A.FLT_DATE,'DDMONYY') and uld_bt_no=A.ULD_KEY) else
		case when #process#='TR' then (select orig from flt_opr where flt_key=A.FLT_KEY and sch_date=TO_CHAR(A.FLT_DATE,'DDMONYY') and flt_type='A') else
		case when #process#='OT' then '' else
		case when #process#='OF' then (select unldg_pt from exp_pmanifest_uld where flt_key=A.FLT_KEY and flt_date=TO_CHAR(A.FLT_DATE,'DDMONYY') and uld_bt_no=A.ULD_KEY) end end end end end) place,
		(CASE WHEN FUN_GET_TEMP_CAT4_CLASS(A.ULD_KEY,'') IS NOT NULL THEN 
   FUN_GET_TEMP_CAT4_CLASS(A.ULD_KEY,'') ELSE
   '' END) AS tempClass
 	    FROM IMP_RAMP_INB_CHK_DTL A LEFT JOIN IMP_RAMP_CHK_DTL B ON A.ULD_KEY=B.ULD_KEY  
	   WHERE A.ULD_KEY=#uldKey# AND ROWNUM=1 ORDER BY A.TR_NO DESC 
	</select>
	<select id="sqlGetULDListforMHCS"  parameterClass="java.lang.String"  resultClass="cargo.cms.afw.bo.MasterBO">
		SELECT ULD_KEY codeId,ULD_KEY codeDesc FROM ULD_INVENTORY WHERE (ULD_KEY=#PARAM# or ULD_NO =#PARAM#) AND OWNED_INV='Y'
	</select>
	<select id="getProcessforMHCSChkin"  parameterClass="cargo.cms.uld.bo.MHCSCheckinBO"  resultClass="java.lang.String">
		SELECT FUN_GET_BUSINESS_PROCESS(#uldKey#) PROCESS FROM DUAL
	</select>
	
	<select id="getMHCSDBData"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		select count(1) from MHCS_ENOC where trim(FCTP)=#PARAM# 
	</select>
	
	<select id="sqlIsUldBUComplete" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT 
			COUNT(1) 
		FROM 
			ULD_INVENTORY ULD LEFT JOIN EXP_PMANIFEST_ULD PULD ON ULD.ULD_KEY=PULD.ULD_BT_NO AND ULD.FLT_KEY=PULD.FLT_KEY AND ULD.FLT_DATE=PULD.FLT_DATE 
		WHERE 
			ULD.FLT_TYPE='E' AND PULD.BLDUP_COMPLETE='Y' AND ULD.ULD_KEY=#uldKey#
	</select>
	<select id="isULDLocationInMHSChkIn" parameterClass="java.util.HashMap" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM ULD_INVENTORY,MAST_WH_LOC,MAST_WH_GROUP WHERE ULD_INVENTORY.LOC_CODE = MAST_WH_LOC.CODE AND
		MAST_WH_LOC.WH_GROUP = MAST_WH_GROUP.WH_GROUP AND MAST_WH_GROUP.WH_TYPE = 'MHS' AND
		ULD_KEY = #uldKey# AND ULD_INVENTORY.LOC_CODE != #locCode#
	</select>
		
	<select id="acptEmpUldCpctHdlgCarr"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM MAST_CARRIER WHERE CODE=#carr# and NVL(owned_carr,'N')='Y'
	</select>
	<select id="sqlGetURFTruckExitInd" parameterClass="cargo.cms.uld.bo.URFTruckRegisterBO" resultClass="java.lang.String">
		SELECT a.EXIT_IND FROM TRUCK_TRIP a	WHERE a.TRUCK_NO = #truckNo# AND a.TRIP_ID = (SELECT MAX(a.TRIP_ID) FROM TRUCK_TRIP a	WHERE a.TRUCK_NO = #truckNo# AND a.CLOSED = 'N')
	</select>
	
	<select id="getULDConstraintList" parameterClass="cargo.cms.uld.bo.EnquireConstriantULDBO" resultClass="cargo.cms.uld.bo.EnquireConstriantULDBO">		
		select DISTINCT uld_key as uldNumber, gross_weight as grossWeight, loc_code as location,
			transit_type as trfType,u.flt_key as fltKey, to_char(u.flt_date,'DDMONYY') as flightDate,			
			case when ( u.X_RAY_REQ = 'Y' and u.X_RAY_RES is not null) then 'Requested'
				   when ( u.X_RAY_REQ = 'Y' and u.X_RAY_RES is null ) then 'Pending/Processing'
          		   else DECODE(X_RAY_RES,01,'OK',99,'NOT OK','') end as xrayResult,
			FLT_TYPE AS fltType,
			decode(FLT_TYPE,'E',decode(u.flt_key,null,'',u.flt_key||'/'||TO_CHAR(u.flt_date,'DDMONYY')),decode(u.imp_flt_key,null,'', u.imp_flt_key||'/'||TO_CHAR(u.imp_flt_date,'DDMONYY'))) as flightDisplay,
			u.imp_flt_key as impFlightKey,TO_CHAR(u.imp_flt_date,'DDMONYY') as impFlightDate			   
			from uld_inventory u 
			join (select a.flt_type AS fltType, a.awb_no AS awbno, a.hawb_no AS hawbNumber, awb.orig AS orig,
		    		awb.dest AS dest,a.ref_no as refNum,a.cc_code AS ccCode,mCC.priority priority,b.uld_key uldKey FROM v_cst_cont_code a  
            JOIN mast_constraint_code mCC ON a.cc_code = mCC.code and constraint = 'Y'
            JOIN awb_inventory b ON a.awb_no = b.awb_no  
            JOIN awb ON awb.awb_no = b.awb_no and awb.awb_date = b.awb_date) C on c.uldKey = u.uld_key
		where   C.hawbNumber = NVL(#hawbNumber#,C.hawbNumber)	
		<isNotEmpty prepend="AND" property="ccCode">
			       C.ccCode = #ccCode#		      
		 </isNotEmpty>
	     <isNotEmpty prepend="AND" property="ccSeverity">
			       C.priority &gt; #ccSeverity#		    
			 </isNotEmpty>
	     <isNotEmpty prepend="AND" property="transferType">
			       u.transit_type = #transferType# 		      
			 </isNotEmpty>
	     <isNotEmpty prepend="AND" property="fltKey">
			       (u.flt_key = #fltKey#	OR 	u.imp_flt_key = #fltKey#)    
			 </isNotEmpty>
	     <isNotEmpty prepend="AND" property="flightDate">
			       (u.flt_date = #flightDate# OR u.imp_flt_date = #flightDate#)		      
			 </isNotEmpty>
	      <isNotEmpty prepend="AND" property="awbNumber">
			       C.awbno = #awbNumber#		      
			 </isNotEmpty>
	     <isNotEmpty prepend="AND" property="origin">
			       C.orig = #origin#	      
			 </isNotEmpty>
	     <isNotEmpty prepend="AND" property="destination">
			       C.dest = #destination# 		      
		 </isNotEmpty>
	     <isNotEmpty prepend="AND" property="ceRefNumber">
			       C.refNum = #ceRefNumber#		      
			 </isNotEmpty>
	     <isNotEmpty prepend="AND" property="xrayResult">
	     	<isEqual property="xrayResult" compareValue="01"> u.X_RAY_RES = #xrayResult# </isEqual>
	     	<isEqual property="xrayResult" compareValue="99"> u.X_RAY_RES = #xrayResult# </isEqual>
	     	<isEqual property="xrayResult" compareValue="Pending"> ( u.X_RAY_REQ = 'Y' and u.X_RAY_RES is null ) </isEqual>
	     	<isEqual property="xrayResult" compareValue="Requested"> ( u.X_RAY_REQ = 'Y' and u.X_RAY_RES is not null) </isEqual>      
		 </isNotEmpty>
	</select>
	
	<select id="getAWBConstraintList" parameterClass="cargo.cms.uld.bo.EnquireConstriantULDBO" resultClass="cargo.cms.uld.bo.EnquireConstriantULDBO">
		   select a.flt_key AS fltKey, to_char(a.flt_date, 'DDMONYY') AS flightDate, a.awb_no AS awbNumber, awb.orig AS origin,
		        awb.dest AS destination, b.hawb_no AS hawbNumber,a.uld_key AS uldNumber,b.ref_no AS ceRefNumber,b.cc_code AS ccCode,awb.content AS content
		        FROM awb_inventory a  
             	JOIN v_cst_cont_code b ON a.awb_no = b.awb_no  
           	 	JOIN awb ON awb.awb_no = a.awb_no and awb.awb_date = a.awb_date 
           		WHERE a.uld_key = #uldNumber#		
	</select>
	
	<update id="updateXrayRequest" parameterClass="java.util.HashMap">
		update ULD_INVENTORY set X_RAY_REQ = #XRAYREQ# , lm_user_id = #USERID#, lm_date = SYSDATE where uld_key = #ULDKEY#
	</update>
	
	<select id="getEportFlightDtl_AceptEmptyULD"  parameterClass="cargo.cms.uld.bo.ULDBO"  resultClass="cargo.cms.uld.bo.ULDBO">			  
		select ui.flt_key fltKey,to_char(ui.flt_date,'DDMONYY') fltDate
		from ULD_INVENTORY ui
		join FLT_OPR_EVENTS foe on foe.flt_key = ui.flt_key and foe.sch_date = ui.flt_date and foe.flt_type = 'D' 
		where ui.flt_type='E' and ui.uld_key=#suldNumber#
		and foe.ctm_out_date is null
	</select>
	
	<select id="uldServiceableCheck"  parameterClass="java.lang.String"  resultClass="java.lang.String">
		SELECT ser_ind FROM ULD_inventory where uld_key = #uldKey#
	</select>
	
	<select id="LUC_UldDescription" parameterClass="java.lang.String" resultClass="cargo.cms.common.ext.bo.LUCBO">
	 	select uld_key as uldKey, uld_type as uldType, uld_no as uldSerialNo, owner_id as owner_id,ULD_CARR as Uld_carr_code from uld_inventory where uld_key = #uldKey#
	</select>	
	<select id="LUC_ULDList" parameterClass="java.lang.String" resultClass="cargo.cms.common.ext.bo.LUCBO">
		select distinct uld_key as uldKey, (select cust_no from exp_rcl_hd where rcl_no = #rclNumber#) as agent_code from exp_uld_awb where rcl_no = #rclNumber#
    </select>
	
	<select id="checkMaxwtforthisuldtype" parameterClass="map" resultClass="java.lang.Integer">
		select count(1) from ULD_Group_Carr where carr_code=#carr# AND ULD_TYPE=#uldType# and max_weight >0
	</select>
 
     <select id="checkHouseContainer" parameterClass="java.lang.String" resultClass="java.lang.String">
		select case when (h_cont_ind = 'N' AND dummy_h_cont_ind= 'N' AND bt_ind = 'N' ) THEN
		'CONTAINER'
		else
		'HOUSECONTAINER'
		end funType
		from mast_uld_type where 
		code = (select uld_type from uld_inventory where uld_key = #uldKey#)
	</select>
	
	<select id="fetchAWBCarrForULD" parameterClass="java.lang.String" resultClass="java.lang.String">
		select carr_code from(
        select uld_key,carr_code,
        dense_rank() over (partition BY uld_key order by strg_date desc) rank
        from awb_inventory )
        where uld_key = #uldKey# and rank=1
	</select>
		
	<select id="fetchExportFlightForULD" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.EnquireULDBO">
		select flt_key as fltKey, to_char(flt_date,'DDMONYY') as fltDate from(
        select uld_key,flt_key,flt_date,flt_type,
        dense_rank() over (partition BY uld_key order by flt_date desc) rank
        from uld_inventory )
        where uld_key = #uldKey# and flt_type = 'E' and flt_key is not null and rank=1 and rownum = 1
	</select>	
	
	<select id="fetchImportFlightForULD" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.EnquireULDBO">
		select IMP_FLT_KEY as fltKey,to_char(IMP_FLT_DATE,'DDMONYY') as fltDate from(
        select uld_key,IMP_FLT_KEY,IMP_FLT_DATE,
        dense_rank() over (partition BY uld_key order by IMP_FLT_DATE desc) rank
        from uld_inventory )
        where uld_key = #uldKey# and IMP_FLT_KEY is not null and rank=1 and rownum = 1
	</select>	
	
	<select id="fetchFlightCarrForULD" parameterClass="java.util.HashMap" resultClass="java.lang.String">
		select carr_code from flt_opr where flt_key = #fltKey# and sch_date = #schDate#
	</select>	
	
	<select id="allowULDEnquiry" parameterClass="java.util.HashMap" resultClass="java.lang.String">
		select 
		case when 
		(#uldCarrier# = #loginCarrier# 
		OR #uldCarrier# IN (SELECT CARR_CODE FROM MAST_CARR_GRP WHERE GRP_CARR_CODE = #loginCarrier#))
		then 'TRUE'
		else 'FALSE'
		end 
		from dual
	</select>
	<select id="isValidMobileAirport" parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		select count(1) from MAST_ARPT where CODE = #origOrDest# and IATA_YN = 'Y'
	</select>

         <select id="checkULDForNoBreak" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM ULD_INVENTORY WHERE ULD_KEY = #uldKey# AND HANDLING_MODE IN ('NBK','PPK')
	</select> 
	<select id="sqlcountULD_Group_Carr"  parameterClass="cargo.cms.uld.bo.ULDProfileBO"  resultClass="java.lang.String">
		SELECT NVL(count(1), 0) as count
			 FROM ULD_GROUP_CARR
			  WHERE CARR_CODE=#strCarrierCode# AND ULD_TYPE=#strULDType#
   	</select>
	<select id="isRetrieveLocnMHS" parameterClass="java.lang.String" resultClass="java.lang.Integer">
	SELECT COUNT(1) FROM MAST_WH_LOC t1,  mast_wh_group t2 WHERE t1.wh_group = t2.WH_GROUP AND t2.wh_type    = 'MHS' AND t1.code       = #PARAM#
    </select>
	<select id="isRetrieveNonTargetLocnMHS" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select cnt1+cnt2+cnt3 from 
		(select COUNT(1) cnt1 from mast_wh_group where WH_GROUP = #PARAM# AND PREANNOUNCEMENT_IND = 'Y'),
		(select COUNT(1) cnt2 from mast_wh_area where WH_AREA = #PARAM# AND PREANNOUNCEMENT_IND = 'Y'),
    	(select COUNT(1) cnt3 from mast_wh_loc where code=#PARAM#  AND PREANNOUNCEMENT_IND = 'Y')
	</select>
	<select id="isRetrieveLocnValid" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM MAST_WH_LOC where code = #PARAM#
	</select>

	<select id="return_uldEmptyCheck" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from ULD_Inventory 	where ULD_Key = #ULD_No# and NVL(EMPTY_FLG,'N') = 'Y'
	</select>
        <select id="checkULDMixPpk_tm" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM ULD_INVENTORY WHERE ULD_KEY = #uldKey# AND (MIX_PPK_IND = 'Y' OR PPK_IND = 'Y')
	</select>
<select id="fetchDateListEmptyUldByAgentData" parameterClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO" resultClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO">
		SELECT to_char(EIRDATE,'DDMONYY') eirDate from (
			SELECT to_date(#fromDate#,'DDMONYY')+ROWNUM  EIRDATE
				FROM DUAL
				CONNECT BY ROWNUM &lt;=((TO_DATE(#toDate#,'DDMONYY')-TO_DATE(#fromDate#,'DDMONYY')))
				UNION
				SELECT TO_DATE(#fromDate#,'DDMONYY') EIRDATE
				FROM DUAL)
	</select>

<select id="numberOfULDreleasedByGroup" parameterClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO"  resultClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO">
			SELECT UMAP.ULD_GROUP as uldGroup, TO_CHAR(RHD.REL_DATE, 'DDMONYY') eirDate, COUNT(1) as totalULDqty
			FROM ULD_REL_DTL ULD
			JOIN ULD_REL_HD RHD
			ON RHD.TR_NO = ULD.TR_NO AND ULD.ULD_EQUIP = 'U'
			JOIN ULD_ISS_HD IHD
			ON IHD.EIR_NO = RHD.EIR_NO AND IHD.PURPOSE = 'Agt'
			JOIN ULD_GROUP_TYPE UMAP
			ON UMAP.ULD_TYPE = ULD.ULD_TYPE
			WHERE RHD.REL_DATE BETWEEN TO_DATE(#fromDate#, 'DDMONYY') AND TO_DATE(#toDate#, 'DDMONYY')
			and RHD.carr_code=#carrierCode#
			GROUP BY RHD.REL_DATE, UMAP.ULD_GROUP
			ORDER BY RHD.REL_DATE, UMAP.ULD_GROUP
	</select>

<select id="numberOfURF"  parameterClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO"  resultClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO">
		SELECT TO_CHAR(REL_DATE, 'DDMONYY') eirDate, COUNT(1) urfCount
			FROM (
			  SELECT DISTINCT IHD.EIR_NO, RHD.REL_DATE
			  FROM ULD_ISS_HD IHD
			  JOIN ULD_REL_HD RHD
			  ON RHD.EIR_NO = IHD.EIR_NO
			  WHERE IHD.PURPOSE = 'Agt' AND STATUS IN('RELEASED', 'CLOSED')
			 <!--  AND RHD.REL_DATE BETWEEN TO_DATE(#fromDate#, 'DDMONYY') AND TO_DATE(#toDate#, 'DDMONYY') -->
			  AND RHD.REL_DATE = TO_DATE(#eirDate#, 'DDMONYY')
			  and RHD.carr_code=#carrierCode#
			)
			GROUP BY REL_DATE
			ORDER BY REL_DATE
	</select>
	<select id="totlNumOfAirsideReleased"  parameterClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO"  resultClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO">
					
			SELECT TO_CHAR(RHD.REL_DATE, 'DDMONYY') as eirDate, COUNT(1) as airsideCount
			FROM ULD_REL_DTL ULD
			JOIN ULD_REL_HD RHD
			ON RHD.TR_NO = ULD.TR_NO AND ULD.ULD_EQUIP = 'U'
			JOIN ULD_ISS_HD IHD
			ON IHD.EIR_NO = RHD.EIR_NO AND IHD.PURPOSE = 'Agt' AND NVL(IHD.AIRSIDE_REL, 'N') = 'Y'
			WHERE RHD.REL_DATE =TO_DATE(#eirDate#, 'DDMONYY')
			and RHD.carr_code=#carrierCode#
			GROUP BY RHD.REL_DATE
			ORDER BY RHD.REL_DATE
	</select>
	<select id="totlNumOfLandsideReleased"  parameterClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO"  resultClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO">
			
			SELECT TO_CHAR(RHD.REL_DATE, 'DDMONYY') as eirDate, COUNT(1) as landSideCount
			FROM ULD_REL_DTL ULD
			JOIN ULD_REL_HD RHD
			ON RHD.TR_NO = ULD.TR_NO AND ULD.ULD_EQUIP = 'U'
			JOIN ULD_ISS_HD IHD
			ON IHD.EIR_NO = RHD.EIR_NO AND IHD.PURPOSE = 'Agt' AND NVL(IHD.AIRSIDE_REL, 'N') = 'N'
			WHERE RHD.REL_DATE =TO_DATE(#eirDate#, 'DDMONYY')
			and RHD.carr_code=#carrierCode#
			GROUP BY RHD.REL_DATE
			ORDER BY RHD.REL_DATE
	</select>
	<select id="totlNumOfAirsideAndLandsideReleased"  parameterClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO"  resultClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO">		
		SELECT TO_CHAR(RHD.REL_DATE, 'DDMONYY') as  eirDate, COUNT(1) as airLandSideCount
				FROM ULD_REL_DTL ULD
				JOIN ULD_REL_HD RHD
				ON RHD.TR_NO = ULD.TR_NO AND ULD.ULD_EQUIP = 'U'
				JOIN ULD_ISS_HD IHD
				ON IHD.EIR_NO = RHD.EIR_NO AND IHD.PURPOSE = 'Agt' 
				WHERE RHD.REL_DATE =TO_DATE(#eirDate#, 'DDMONYY')
				and RHD.carr_code=#carrierCode#
				GROUP BY RHD.REL_DATE
				ORDER BY RHD.REL_DATE
	</select>
	<select id="totlNumOfTruckReleased"  parameterClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO"  resultClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO">	
		SELECT TO_CHAR(REL_DATE, 'DDMONYY')  as eirDate, COUNT(1) as truckRelCount
				FROM (
				  SELECT
				  DISTINCT TRUCK.TRIP_ID, RHD.REL_DATE
				  FROM ULD_TRUCK_EIR TRUCK
				  JOIN ULD_REL_DTL ULD
				  ON ULD.EIR_NO = TRUCK.EIR_NO
				  JOIN ULD_REL_HD RHD
				  ON RHD.TR_NO = ULD.TR_NO AND ULD.ULD_EQUIP = 'U'
				  JOIN ULD_ISS_HD IHD
				  ON IHD.EIR_NO = RHD.EIR_NO AND IHD.PURPOSE = 'Agt'
				  WHERE RHD.REL_DATE =TO_DATE(#eirDate#, 'DDMONYY')
				  and RHD.carr_code=#carrierCode#
				)
				GROUP BY REL_DATE
				ORDER BY REL_DATE
	</select>
	<select id="uldForFltPerGroupPerDay"  parameterClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO"  resultClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO">
		select #eirDate# eirDate ,NVL(ULD.groupCount,0) as totalULDqty, mastGrp.uld_group as uldGroup, ULD.carrCode as carrierCode
				FROM
				MAST_ULD_GROUP mastGrp
				LEFT JOIN 
				(
				select  count(1) as groupCount, grp.uld_group,trunc(flt.flt_date) flt_date, inv.carr_code as carrCode
				from exp_flt_uld flt left join uld_inventory inv
				on flt.uld_key=inv.uld_key
				left join uld_group_type grp
				on inv.uld_type=grp.uld_type
				where
				flt.empty_YN='Y' and flt.flt_use='Y' and
				TO_DATE(TO_CHAR(flt.flt_date,'DDMONYY'),'DDMONYY') = #eirDate#
				and inv.carr_code=#carrierCode# 
				group by grp.uld_group,trunc(flt.flt_date), inv.carr_code
				)ULD ON ULD.ULD_GROUP=mastGrp.uld_group
				and mastGrp.uld_group is not null
				GROUP BY ULD.groupCount, mastGrp.uld_group, ULD.carrCode 
				ORDER BY mastGrp.uld_group
	</select>
	<select id="uldForFlttotalCountPerDay"  parameterClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO"  resultClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO">
		select  decode(count(1),0,' ',count(1)) as uldPerFltCount   from exp_flt_uld flt left join uld_inventory inv
		 on flt.uld_key=inv.uld_key
		 left join uld_group_type grp
		 on inv.uld_type=grp.uld_type
		where
		flt.empty_YN='Y' and flt.flt_use='Y' and
		TO_DATE(TO_CHAR(flt.flt_date,'DDMONYY'),'DDMONYY') = #eirDate#
		and inv.carr_code=#carrierCode# 
	</select>
	<select id="uldGroupforAgentList" parameterClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO"  resultClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO">
		SELECT distinct UMAP.ULD_GROUP as uldGroup
			FROM ULD_REL_DTL ULD
			JOIN ULD_REL_HD RHD
			ON RHD.TR_NO = ULD.TR_NO AND ULD.ULD_EQUIP = 'U'
			JOIN ULD_ISS_HD IHD
			ON IHD.EIR_NO = RHD.EIR_NO AND IHD.PURPOSE = 'Agt'
			JOIN ULD_GROUP_TYPE UMAP
			ON UMAP.ULD_TYPE = ULD.ULD_TYPE
			WHERE RHD.REL_DATE BETWEEN TO_DATE(#fromDate#, 'DDMONYY') AND TO_DATE(#toDate#, 'DDMONYY')
			and RHD.carr_code=#carrierCode#
			GROUP BY RHD.REL_DATE, UMAP.ULD_GROUP
			ORDER BY  UMAP.ULD_GROUP
	</select>
	<select id="uldGrouptoFlightList" parameterClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO"  resultClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO">
		select   distinct grp.uld_group as uldGroup
				from exp_flt_uld flt left join uld_inventory inv
				on flt.uld_key=inv.uld_key
				left join uld_group_type grp
				on inv.uld_type=grp.uld_type
				where
				flt.empty_YN='Y' and flt.flt_use='Y' and
				flt.flt_date  BETWEEN TO_DATE(#fromDate#, 'DDMONYY') AND TO_DATE(#toDate#, 'DDMONYY')
				and inv.carr_code=#carrierCode#
				group by grp.uld_group,trunc(flt.flt_date), inv.carr_code
        ORDER BY  grp.uld_group
	</select>
	<select id="uldForFltPerGroupPerDay1" parameterClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO"  resultClass="cargo.cms.uld.bo.ULDUsageSummaryFormBO">
		 select  count(1) as totalULDqty, grp.uld_group  as uldGroup,grp.uld_group,to_char(trunc(flt.flt_date),'DDMONYY') eirDate
				from exp_flt_uld flt left join uld_inventory inv
				on flt.uld_key=inv.uld_key
				left join uld_group_type grp
				on inv.uld_type=grp.uld_type
				where
				flt.empty_YN='Y' and flt.flt_use='Y' and
				flt.flt_date BETWEEN TO_DATE(#fromDate#, 'DDMONYY') AND TO_DATE(#toDate#, 'DDMONYY')
				and inv.carr_code=#carrierCode#
				group by grp.uld_group,trunc(flt.flt_date), inv.carr_code
        order by trunc(flt.flt_date), grp.uld_group
	</select>
	<select id="getReleaseCountPerDay" parameterClass="map"  resultClass="java.lang.String">
			SELECT COUNT(1) AS totalULDqty
				FROM ULD_REL_DTL ULD
				JOIN ULD_REL_HD RHD ON RHD.TR_NO  = ULD.TR_NO AND ULD.ULD_EQUIP = 'U'
				JOIN ULD_ISS_HD IHD ON IHD.EIR_NO = RHD.EIR_NO AND IHD.PURPOSE = 'Agt'
				JOIN ULD_GROUP_TYPE UMAP ON UMAP.ULD_TYPE = ULD.ULD_TYPE
				WHERE trunc(RHD.REL_DATE) = #EIRDATE#
				AND RHD.carr_code= #CARRIER#
	</select>
	<select id="sqlserviceerrorlogsearch5"  parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO"  resultClass="cargo.cms.uld.bo.ServiceErrorLogBO">
			<![CDATA[
			SELECT  to_char(TR_DATE, 'ddMonyy hh24:mi') as trDate, 
				CR_USER_ID as lmUserId, 
				ULD_KEY as uldKey, 
				ULD_KEY as uldKey1,
				TR_NO as trNo, 
				TR_NO as urfNo,
				TR_TYPE as trType,
			    (RMK1 || ' ' || RMK2) as errorReason, 
				SVC_USER_ID as svcUserId, 
				to_char(SVC_DATE, 'ddMonyy hh24:mi') as svcDate, 
				FLT_TYPE as fltType,
				DOC_LINE_NO as docLineNo,
			    to_char(FLT_DATE,'ddMonyy') as fltDate, 
				FLT_KEY as fltKey
			FROM SERVICE_ERR_LOG			
			WHERE TR_DATE >= to_date(#dateFrom#,'ddmonyy') and TR_DATE < (to_date(#dateTo#,'ddmonyy')+1)			
			and TR_TYPE = 'MH'
			]]>
			<dynamic prepend="ORDER BY ">
			 	  <isEmpty property="sortOrder.sortField">
                     TR_DATE DESC 
                  </isEmpty>
                  <isNotEmpty property="sortOrder.sortField">
                      $sortOrder.sortField$
                  </isNotEmpty>
            </dynamic>
		</select>
		<select id="sqlserviceerrorlogsearch5COUNT"  parameterClass="cargo.cms.uld.bo.ServiceErrorLogBO"  resultClass="java.lang.Integer">
			<![CDATA[
			SELECT COUNT(*) AS totalRowCount FROM (
			SELECT  to_char(TR_DATE, 'ddMonyy hh24:mi') as trDate, 
				CR_USER_ID as lmUserId, 
				ULD_KEY as uldKey, 
				ULD_KEY as uldKey1,
				TR_NO as trNo, 
				TR_NO as urfNo,
				TR_TYPE as trType,
			    (RMK1 || ' ' || RMK2) as errorReason, 
				SVC_USER_ID as svcUserId, 
				to_char(SVC_DATE, 'ddMonyy hh24:mi') as svcDate, 
				FLT_TYPE as fltType,
				DOC_LINE_NO as docLineNo,
			    to_char(FLT_DATE,'ddMonyy') as fltDate, 
				FLT_KEY as fltKey
			FROM SERVICE_ERR_LOG			
			WHERE TR_DATE >= to_date(#dateFrom#,'ddmonyy') and TR_DATE < (to_date(#dateTo#,'ddmonyy')+1)			
			and TR_TYPE = 'MH' order by TR_DATE DESC )
			]]>
		</select>
		<select id="LUC_ULDList_ULD" parameterClass="java.util.HashMap" resultClass="cargo.cms.common.ext.bo.LUCBO">
		select distinct uld_key as uldKey, (select cust_no from exp_rcl_hd where rcl_no = #RCL#) as agent_code from exp_uld_awb where rcl_no = #RCL# AND ULD_KEY = #ULD#
	</select>
<!-- CR 16052701  Enhancement on Assign Empty AKE for flight  By Rajasekhar  stop-->
	
	<!-- Validate ULD Exists in Agent INV Start -->
	<select id="validateAgentULDKey" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select COUNT(1) from ULD_INVENTORY where AGENT_INV='Y' and ULD_KEY= #uldKey#
	</select>
	<!-- Validate ULD Exists in Agent INV End -->
	<!-- Validate ULD exist in CSD Inventory Start-->
	<select id="validateCSDExist" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from LSP_INVENTORY where LSP_NO=#csdNo#
	</select>
	<!-- Validate ULD exist in CSD Inventory End-->
	<!-- Insert CSD Inventory Start-->
	<insert id="insertCSDForInventory" parameterClass="cargo.cms.uld.bo.CSDBO">
		INSERT INTO LSP_INVENTORY
	  (
	    LSP_NO,
	    EMPTY_FLG,
	    REF_TR_TYPE,
	    LOC_CODE,
	    REF_TR_EVENT,
	    REF_TR_DATE,
	    REF_DOC_LINE_NO,
	    REF_MOV_FROM,
	    REF_LOC_FROM,
	    REF_RMK,
	    TARGET,
	    STRG_DATE,
	    CR_USER_ID,
	    CR_DATE,
	    LM_USER_ID,
	    LM_DATE,
	    LSP_TYPE,
	    LOCKED
	  )
	  VALUES
	  (
	    #CSDNo#,
	    'Y',
	    'CC',
	    #location#,
	    '',
	    SYSDATE,
	    '1',
	    #location#,
	    #location#,
	    'INSERTING FROM CREATE CSD',
	    #location#,
	    SYSDATE,
	    #userID#,
	    SYSDATE,
	    #userID#,
	    SYSDATE,
	    SUBSTR(#CSDNo#,0,1),
	    'N'
	  )
	</insert>
	<!-- Insert CSD Inventory End-->
	<!-- Validate ULD exist in CSD Mast Inventory Start-->
	<select id="validateCSDExistMast" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from mast_csd where CODE=#csdNo#
	</select>
	<!-- Validate ULD exist in CSD Mast Inventory End-->
	<!-- Insert CSD Mast Inventory Start-->
	<insert id="insertCSDForMastInventory" parameterClass="cargo.cms.uld.bo.CSDBO">
		INSERT INTO mast_csd
		  	(CODE,
		     CODE_DESC,
		     TARE_WT,
		     CR_USER_ID,
		     CR_DATE,
		     LM_USER_ID,
		     LM_DATE)
		  VALUES
		  	(#CSDNo#,
		     #CSDNo#,
		     #tareWt#,
		     #userID#,
		     sysdate,
		     #userID#,
		     sysdate)
	</insert>
	<!-- Insert CSD Mast Inventory End-->
	<select id="emptyCheckinMHCS" parameterClass="java.util.HashMap" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM AWB_INVENTORY where ULD_KEY = #uldKey# 
	</select>
	<select id="getUITPrintList_EnqryULD" parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.EnquireULDBO" >
	SELECT CODE AS codeId, CODE_DESC AS codeDesc FROM MAST_PRT_DTL WHERE PRT_TYPE = 'ULD_TAG' or PRT_TYPE = 'ULD_TAG_6' ORDER BY CODE_DESC
</select>
	<select id="getTempUldResv"  parameterClass="java.lang.String"  resultClass="java.lang.Integer">
		select count(1) from uld_reserved where ULD_KEY=#uldKey#
	</select>
	
	<select id="uldKeyExistCPCT" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT count(1) FROM ULD_INVENTORY WHERE nvl(owned_inv,'N')='Y' and ULD_KEY = #PARAM# 
	</select>

	<select id="retrieveTempResrvRec"  parameterClass="java.lang.String"  resultClass="cargo.cms.uld.bo.ULDBO">
		 select ULD_KEY as suldNumber,RESV_FLG as sresvIndicator,RESV_RMK as sresvRem2 
         from ULD_RESERVED where ULD_KEY=#uldKey#
	</select>
	
	<update id="updateTempUldResrvFlag" parameterClass="java.util.HashMap">
	    update ULD_RESERVED set TR_TYPE=#trType#, RESV_FLG=#reserveFlag# , RESV_RMK=#remark#, LM_USER_ID=#userid# ,LM_DATE=sysdate
	    <isEqual prepend="," property="trType" compareValue="RSRVULD"> RESV_DATE=sysdate </isEqual>
	     where ULD_KEY=#uldKey#
	</update>
	
	<insert id="insertTempUldResv" parameterClass="cargo.cms.uld.bo.ULDBO" >
	INSERT INTO ULD_RESERVED
	  ( 
	  	TR_TYPE,
	  	ULD_KEY,
	    RESV_FLG,
	    RESV_RMK,
	    RESV_DATE,
	    CR_USER_ID,
	    CR_DATE,
	    LM_USER_ID,
	    LM_DATE)
	  VALUES
	  (	'UNRSRVULD',
	  	#suldNumber#,
	    #sresvIndicator#,
	    #sresvRem2#,
	    sysdate,
	    #userID#,
	    sysdate,
	    #userID#,
	    sysdate)
	</insert>
	
	<select id="getUldResrvRecFlag"  parameterClass="java.lang.String"  resultClass="java.util.HashMap">
		select RESV_FLG,RESV_RMK,LM_USER_ID from ULD_RESERVED where ULD_KEY=#uldKey#
	</select>
	
	<update id="updateUldResrvFlag" parameterClass="java.util.HashMap">
	    update ULD_INVENTORY set RESV_FLG=#reserveFlag#,RESV_RMK=#reservermk#,resv_date=sysdate,tr_type=#trType#,lm_user_id=#userID#,lm_date=sysdate,source_code='Reserve ULD'  where ULD_KEY=#uldKey#
	</update>
	
	<update id="updateUldReserveFlagforULDInventory" parameterClass="java.lang.String">
		update ULD_INVENTORY set CFM_STATUS = 'RESERVED' WHERE ULD_KEY = #uldKey#
	</update>
	
	<delete id="deleteUldResrvRec" parameterClass="java.lang.String" >
		delete from ULD_RESERVED where ULD_KEY=#uldKey#
	</delete>

	<select id="getUldTareWeightRange"  parameterClass="java.lang.String" resultClass="java.util.HashMap">
		select to_char(MIN_TARE_WEIGHT) MIN_TARE_WEIGHT,to_char(MAX_TARE_WEIGHT) MAX_TARE_WEIGHT from MAST_ULD_TYPE where code=#uldType#
	</select>
	
	<select id="checkURFReserved"  parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(1) from uld_inventory where uld_key=#dUldKey# and NVL(resv_flg,'N')='Y' and NVL(URF_RESV,'N')='N'
	</select>
	
	<insert id="insertIntoULDInv" parameterClass="cargo.cms.uld.bo.ULDBO" >
	insert into uld_inventory(
			uld_key,
			uld_type,
			uld_no,
			uld_carr,
			loc_code,
			DAM_IND,
			owner_id,
      		PARENT_OWNER,
			source_code,
			gen_rmk,
			dam_rmk,
			eic_flg,
			empty_flg,
			STRG_DATE,
			PPK_IND,
			LM_USER_ID,
			LM_DATE,
			AGENT_INV,
			CFM_STATUS,
			RESV_FLG,
			OWNED_INV,
			CONTR_CODE,
			REF_TR_NO, 
			REF_TR_TYPE, 
			REF_TR_DATE, 
			REF_IN_CARR, 
			REF_OUT_CARR, 
			REF_DOC_LINE_NO, 
			REF_LOC_FROM, 
			REF_TR_EVENT, 
			REF_RMK,
			BASE_PLT,
			AGENT_ID,
			SER_IND,
			EIC_TYPE ,
			BASE_PAL_FLG,
			OFLD_FLG,
			TRANSIT_FLG,
			BB_IND,
			MIX_PPK_IND,
			DG_IND,
			HANDLING_MODE,
			TRANSIT_TYPE,
			tare_weight,
     		gross_weight,
      		TR_TYPE,
      		FINAL_WEIGHT,
      		DOUBLE_WGT_RSLT,
			RESV_RMK,
      		X_RAY_RES,X_RAY_REQ ,ENTRY_TIME     
			)
			values (
			#suldNumber#,
			#uldType#,
			#uldNo#,
			#uldCarr#,
			'',
			'N',
			#uldCarr#,
      		'',
			'Reserve ULD',
			'',
			'',
			'N',
			'Y',
			SYSDATE,
			'N',
			#userID#,
			SYSDATE,
			'N',
			'',
			'N',
			'N',
			null,
			ULD_TR_SEQ.NEXTVAL,
			'',
			SYSDATE,
			'',
			null,
			1,
			'',
			'INSERT',
			'',
			'',
      		'',
			'N',
			'',
			'N',
			'N',
    		'N',
    		'N',
    		'N',
    		'N',
    		null,
    		null,
    		0,
			0,
			'',
			'',
    		null,
    		#sresvRem#,
   		 	null,null ,null  
			)
	</insert>
	<select id="sqlURFExpireCount" parameterClass="java.lang.String"
		resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM ULD_ISS_HD 
		WHERE EIR_NO = #PARAM# AND EIR_EXPIRY_DATE &lt; SYSDATE AND STATUS IN('PENDING', 'APPROVED', 'PARTRELEASED')
	</select>
	<select id="sqlCheckULDisremovedfromURF" parameterClass="java.lang.String" resultClass="java.lang.String">
		SELECT EIR_NO FROM (SELECT STATUS,EIR_NO FROM (SELECT STATUS,EIR_NO FROM ULD_REL_DTL WHERE ULD_KEY = #PARAM# ORDER BY EIR_NO DESC) B WHERE ROWNUM=1) C WHERE STATUS = 'RELEASED'
	</select>
	<select id="getULDLocnofULD" parameterClass="java.lang.String" resultClass="java.lang.String">
		SELECT LOC_CODE FROM ULD_INVENTORY WHERE ULD_KEY=#PARAM#
	</select>
	<select id="geturfpurposeanddsptodetails" parameterClass="java.util.Map" resultClass="cargo.cms.uld.bo.ULDBO">
	SELECT DECODE(
  (SELECT code_desc FROM mast_code_dtl WHERE code = A.PURPOSE AND rownum=1
  ),'',
  (SELECT code_desc
  FROM mast_code_dtl
  WHERE code_desc = A.PURPOSE
  AND rownum      =1
  ),(
  (SELECT code_desc FROM mast_code_dtl WHERE code = A.PURPOSE and code_type='URF_PURPOSE' AND rownum=1
  ))) AS purpose,
  DECODE(
  (SELECT code_desc FROM mast_code_dtl WHERE code = EXPHOVER.DSP_TO and code_type='URF_PURPOSE' AND rownum=1
  ),'',
  (SELECT code_desc
  FROM mast_code_dtl
  WHERE code_desc = EXPHOVER.DSP_TO and code_type='URF_PURPOSE'
  AND rownum      =1
  ),(
  (SELECT code_desc FROM mast_code_dtl WHERE code = EXPHOVER.DSP_TO and code_type='URF_PURPOSE' AND rownum=1
  ))) AS dspTo
FROM ULD_ISS_HD A,
  ULD_REL_HD B,
  ULD_REL_DTL C,
  EXP_ULD_HOVER_DTL EXPHOVER
WHERE A.EIR_NO = C.EIR_NO
AND B.EIR_NO   = C.EIR_NO
AND EXPHOVER.HO_FORM_NO = C.HO_FORM_NO (+)
AND EXPHOVER.ULD_KEY = C.ULD_KEY (+)
AND C.ULD_KEY  =#uldKey#
AND C.EIR_NO   =#eirNo#
	</select>
	<update id="updateHOandChkoutDetails" parameterClass="java.util.Map">
		UPDATE ULD_REL_DTL SET CHKOUT_LOCN=#location#,CHKOUT_USER = #userId#,CHKOUT_DATE=SYSDATE,CHKOUT_TIME=to_char(sysdate, 'HH24MI'),OB_HANDOVER_DATE=DECODE(CHKOUT_DATE,'',NVL(OB_HANDOVER_DATE,SYSDATE),TO_DATE(TO_CHAR(CHKOUT_DATE, 'DDMONYY') ||' '||DECODE(CHKOUT_TIME, NULL, '',SUBSTR(LPAD(CHKOUT_TIME,4,0), 1, 2)||SUBSTR(LPAD(CHKOUT_TIME,4,0),3)),'DDMONYY HH24MI')) WHERE ULD_KEY=#uldKey# AND EIR_NO=#eirNo#
	</update>
	<select id="CHECKuldDESTTOurf" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM ULD_ISS_HD A WHERE A.EIR_NO =#eirNo# AND  UPPER(A.PURPOSE) = UPPER(#sdest#)
	</select>

<select id="checkUldPkgType" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM uld_inventory
		WHERE uld_key     =#ULD_No#
		AND (ppk_ind      ='Y'
		OR mix_ppk_ind    ='Y'
		OR handling_mode IN('NBK','PPK'))
	</select>
	<select id="getAWBList" parameterClass="java.util.HashMap" resultClass="cargo.cms.export.bo.AWBBO">
		SELECT awb_no awbNo,To_CHAR(awb_date,'DDMONYY') awbDate FROM awb_inventory 
		WHERE uld_key=#uldKey#
	</select>
	<select id="isRecdCarrSameAsCTCarrForAWB" parameterClass="java.util.HashMap" resultClass="java.lang.String">
		<![CDATA[
		SELECT recd_carr FROM (
			SELECT hd.recd_carr FROM IMP_TRM_HD hd JOIN imp_trm_dtl dtl
			  ON hd.trm_no     =dtl.trm_no AND hd.trm_type  =dtl.trm_type
			  WHERE dtl.awb_no =#awbNo# AND dtl.awb_date =#awbDate#
			  AND hd.status   <> 'VOID'
			  order by hd.trm_no desc) WHERE rownum=1
	 	]]>	
	</select>
	<update id="sqlupdatechilduldprofile" parameterClass="cargo.cms.uld.bo.ULDProfileBO" >
		UPDATE ULD_TYPE_CARR_TARE_WT
			SET ULD_CARR    = #strCarrierCode#,
			  ULD_TYPE      = #strULDType#,
			  ULD_NO_FROM   = #strULDFrom#,
			  ULD_NO_TO     = #strULDTo#,
			  TARE_WEIGHT   = #strTareWeight#,
			  SPECIFICATION = #specification#,
			  CR_USER_ID    = #userId#,
			  CR_DATE       = TO_DATE(SYSDATE,'DD/MM/YYYY HH24MISS'),
			  LM_USER_ID    = #userId#,
			  LM_DATE       = TO_DATE(SYSDATE,'DD/MM/YYYY HH24MISS')
			WHERE ULD_CARR  = #strCarrierCode#
			AND ULD_TYPE    = #strULDType#
			AND ULD_NO_FROM =#oldstrULDFrom#
			AND ULD_NO_TO   =#oldstrULDTo#
			AND TARE_WEIGHT =#oldstrTareWeight#
    </update>
    
    <update id="updateChildLmUserULDProfile" parameterClass="cargo.cms.uld.bo.ULDProfileBO" >
		UPDATE ULD_TYPE_CARR_TARE_WT
			SET LM_USER_ID    = #userId#,
			    LM_DATE       = TO_DATE(SYSDATE,'DD/MM/YYYY HH24MISS')
			WHERE ULD_CARR  = #strCarrierCode#
			AND ULD_TYPE    = #strULDType#
			AND ULD_NO_FROM =#oldstrULDFrom#
			AND ULD_NO_TO   =#oldstrULDTo#
			AND TARE_WEIGHT =#oldstrTareWeight#
    </update>
    
    <select id="sqlgeteichd" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		select * from (
		SELECT TR_NO AS trNo,source as TYPE FROM EIC_SNAPSHOT_HD 
		WHERE ULD_KEY=#uldKey#
			<isEmpty property="offload">
				AND NVL(FLT_KEY,'N')  = NVL(#fltKey#,'N')
				<isNotEmpty property="fltDate">
					AND TO_CHAR(FLT_DATE,'DDMONYY') = #fltDate#
				</isNotEmpty> 
				AND NVL(FLT_TYPE,'N') = NVL(#fltType#,'N')
			</isEmpty>
			<isNotEmpty property="offload">
				AND NVL(offload_flt_key,'N') = NVL(#offloadFlt#,'N')
				<isNotEmpty property="offloadFltDate">
					AND TO_CHAR(offload_flt_date,'DDMONYY') = #offloadFltDate#
				</isNotEmpty>
				AND NVL(offload_flg,'N') = NVL(#offload#,'N')
			</isNotEmpty>
			ORDER BY cr_date desc
			) where rownum=1	
	</select>
	
    <insert id="sqlinserteichd" parameterClass="java.util.HashMap">
		 INSERT INTO EIC_SNAPSHOT_HD (TR_NO,ULD_KEY,FLT_KEY,FLT_DATE,FLT_TYPE,CHK_IN,OFFLOAD_FLG,offload_flt_key,offload_flt_date,EIC_FLG,EIC_DATE,DISMANTLE_FLG,SOURCE,CR_USER_ID,CR_DATE,LM_USER_ID,LM_DATE)
  		 VALUES (#trNo#,#uldKey#,#fltKey#,#fltDate#,#fltType#,#checkIn#,#offload#,#offloadFlt#,#offloadFltDate#,#eicFlag#,SYSDATE,#dismantle#,#source#,#user#,SYSDATE,#user#,SYSDATE)
	</insert>
	
	<insert id="sqlinserteicdtl" parameterClass="java.util.HashMap">
		INSERT INTO EIC_SNAPSHOT_DTL (TR_NO,ULD_KEY,CR_USER_ID,CR_DATE,LM_USER_ID,LM_DATE)
  		VALUES (#trNo#,#uldKey#,#user#,SYSDATE,#user#,SYSDATE)
	</insert>
	
	 <update id="sqlupdateeichd" parameterClass="java.util.HashMap" >
		UPDATE EIC_SNAPSHOT_HD
			SET LM_USER_ID =#user#,LM_DATE = SYSDATE
			<isNotEmpty property="dismantle">
				<isEqual property="dismantle" compareValue="Y" prepend=",">
					DISMANTLE_FLG    = #dismantle#,
					DISMANTLE_USER = #user#,
					DISMANTLE_DATE = SYSDATE,
					EIC_FLG       = #eicFlag#
				</isEqual>
			</isNotEmpty>
			<isNotEmpty prepend="," property="offload">
				OFFLOAD_FLG = #offload#,
			    OFFLOAD_FLT_KEY = #offloadFlt#,
			    OFFLOAD_FLT_DATE = TO_DATE(#offloadFltDate#,'DDMONYY'),
			    FLT_KEY = #fltKey#,
				FLT_DATE = #fltDate#,
				FLT_TYPE = #fltType#
			</isNotEmpty>
			WHERE TR_NO = #trNo#
			AND ULD_KEY = #uldKey#
			<isNotEmpty property="fltKey">
				AND FLT_KEY = #fltKey#
				AND FLT_DATE = #fltDate#
				AND FLT_TYPE = #fltType#
			</isNotEmpty>
    </update>
    
	<delete id="sqldeleteeicdtl" parameterClass="java.lang.String" >
		delete from EIC_SNAPSHOT_DTL WHERE TR_NO=#eicTrNo#
	</delete>

	<delete id="sqldeleteeichd" parameterClass="java.lang.String" >
		delete from EIC_SNAPSHOT_HD WHERE TR_NO=#eicTrNo#
	</delete>
	
	<delete id="sqldeletetopeicdtl" parameterClass="java.util.HashMap" >
		delete from EIC_SNAPSHOT_DTL WHERE TR_NO=#trNo# and ULD_KEY = #uldKey#
	</delete>
	
	<select id="getTrackEicRecords" parameterClass="cargo.cms.uld.bo.FlightDetailsBO"  resultClass="cargo.cms.uld.bo.EnquireULDBO">
	select strULDKey,
		  fltKey,
		  TO_CHAR(flt_date,'DDMONYY') fltDate,
		  cargoType,
		  strATA,
		  checkIn,
		  cpm,
		  TO_CHAR(eic_date,'DDMONYY HH24:MI') eicDate,
		  dismantle,
		  eic,
		  source from (
		SELECT snap.uld_key strULDKey,
		  snap.flt_key fltKey,
		  snap.flt_date flt_date,
		  snap.flt_type cargoType,
		  NVL(PKG_COMMON.GET_FLT_ATA(snap.flt_key,snap.flt_date,decode(snap.flt_type, 'I', 'A', 'E', 'D')),'') AS strATA,
		  snap.chk_in checkIn,
		  NVL(decode(snap.source,'E','NA','I', decode((select count(1) from edi_cpm_dtl cpm where cpm.uld_key = snap.uld_key and cpm.flt_key = snap.flt_key and cpm.flt_date=snap.flt_date),0,'N','Y')),'NA') cpm,
		  snap.eic_date eic_date,
		  NVL(snap.dismantle_flg,'N') dismantle,
		  NVL(snap.eic_flg,'N') eic,
		  snap.source source
		  FROM eic_snapshot_hd snap
		  WHERE
		  <isEqual property="selected" compareValue="F">
		  	snap.flt_key = #eicFlightKey#
			AND snap.flt_date  = to_date(#eicFlightDate#,'DDMONYY')
			<isNotEmpty property="eicFlightType1" prepend="AND">
				snap.flt_type  = decode(#eicFlightType1#,'A','I','D','E')
			</isNotEmpty>
			<isEqual property="source" compareValue="I">
			<isNotEqual property="eicFlightType1" compareValue="D">
		  	union
		    select 
			    cpm.uld_key strULDKey,
				cpm.flt_key fltKey,
				cpm.flt_date flt_date,
				'I' cargoType,
				NVL(PKG_COMMON.GET_FLT_ATA(cpm.flt_key,cpm.flt_date,decode('I', 'I', 'A', 'E', 'D')),'') AS strATA,
				'N' checkIn,
				'Y' cpm,
				cpm.cr_date eic_date,
				'N' dismantle,
				'Y' eic,
			    'I' source
		  	from edi_cpm_dtl cpm where cpm.load_type='E' and cpm.flt_key=#eicFlightKey# and cpm.flt_date=to_date(#eicFlightDate#,'DDMONYY')
		  	and cpm.uld_key not in (select uld_key from imp_ramp_chk_dtl where flt_key=#eicFlightKey# and flt_date=to_date(#eicFlightDate#,'DDMONYY')) 
		  	and cpm.uld_key not in (select uld_key from eic_snapshot_hd where flt_key=#eicFlightKey# and flt_date=to_date(#eicFlightDate#,'DDMONYY') and flt_type='I')
		  	</isNotEqual>
		  	</isEqual>
		  </isEqual> 
		  <isEqual property="selected" compareValue="U">
		  		trunc(snap.eic_date) BETWEEN to_date(#eicDateFrom#,'DDMONYY') AND to_date(#eicDateTo#,'DDMONYY')
			<isNotEmpty property="eicUld" prepend="AND">
				(snap.uld_key   = #eicUld# or snap.tr_no in (select tr_no from eic_snapshot_dtl where uld_key=#eicUld#))
			</isNotEmpty>
		  	<isNotEmpty property="eicFlightType2" prepend="AND">
				snap.flt_type  = decode(#eicFlightType2#,'A','I','D','E')
			</isNotEmpty>
		  </isEqual> 
		  <isEqual property="selected" compareValue="D">
		  	snap.flt_date BETWEEN to_date(#eicFlightDateFrom#,'DDMONYY') AND to_date(#eicFlightDateTo#,'DDMONYY')
		  	<isNotEmpty property="eicFlightType3" prepend="AND">
				snap.flt_type  = decode(#eicFlightType3#,'A','I','D','E')
			</isNotEmpty>
		  </isEqual>
		  ) order by eic_date desc,flt_date desc,source,strULDKey
	</select>
	
	<select id="getTrackEicTopPalletRecords" parameterClass="cargo.cms.uld.bo.FlightDetailsBO"  resultClass="cargo.cms.uld.bo.EnquireULDBO">
		select uld_key strULDKey from eic_snapshot_dtl where tr_no=#eicTrNo#
	</select>
	
	<select id="checkImpFlt" parameterClass="cargo.cms.uld.bo.FlightDetailsBO"  resultClass="java.lang.Integer">
		SELECT count(1) FROM flt_opr where flt_key=#eicFlightKey# AND sch_date=to_date(#eicFlightDate#,'DDMONYY') AND flt_type='A'
	</select>

	<select id="getTopPalletsOffload" parameterClass="java.util.HashMap" resultClass="java.lang.String">
		select uld_key from uld_inventory where base_plt=#uldKey# and eic_flg='Y'	
	</select>
	
	<select id="getMonthDiff" parameterClass="map"  resultClass="java.lang.String">
	   select trunc(months_between(to_date(#TO_DATE#,'DDMONYY'),to_date(#FROM_DATE#,'DDMONYY'))) mths from dual
	</select>
	
	<select id="sqllatesteictype" parameterClass="java.util.HashMap" resultClass="java.lang.String">
		select * from (
		SELECT source as TYPE FROM EIC_SNAPSHOT_HD 
		WHERE ULD_KEY=#uldKey# ORDER BY cr_date desc
			) where rownum=1	
	</select>
	
	<select id="sqlGetURFFltSchDate" parameterClass="cargo.cms.uld.bo.URFMaintainRequestBO"
		resultClass="java.lang.String">
		SELECT TO_CHAR(TO_DATE(TO_CHAR(SCH_DATE, 'DDMONYY') || ' ' || LPAD(SCH_TIME, 4, 0), 'DDMONYY HH24:MI'), 'DDMONYY HH24:MI') FROM FLT_OPR 
		WHERE FLT_KEY = UPPER(#fltNo#) AND TO_CHAR(SCH_DATE,'DDMONYY') = UPPER(#fltDate#) AND FLT_TYPE = 'D'
	</select>
	
	<select id="sqlGetURFExpiryDate" parameterClass="cargo.cms.uld.bo.URFMaintainRequestBO"
		resultClass="java.lang.String">
		select to_char(eir_expiry_date,'DDMONYY HH24:MI') from uld_iss_hd where eir_no=#eirNo#
	</select>

<select id="resditInfoListByUld" parameterClass="cargo.cms.imprt.bo.ULDCheckInBO" resultClass="cargo.cms.imprt.bo.ULDCheckInBO">
		SELECT B.AWB_NO awbNo,TO_CHAR(B.AWB_DATE,'DDMONYY') awbDate,C.TAG_NO tagNo FROM EDI_RESDIT_HD A 
	    JOIN EDI_RESDIT_AWB_DTL B ON A.TR_NO=B.TR_NO
	    JOIN EDI_RESDIT_TAG_DTL C ON C.TR_AWB_NO=B.TR_AWB_NO
	    WHERE A.FLT_KEY=#flightKey# AND A.FLT_DATE=to_date(#flightDate#,'DDMONYY')
	    AND C.CONTAINER_NO=#uldKey#
   	</select>
   	
   	<select id="isCarditTagExistByTag" parameterClass="cargo.cms.imprt.bo.ULDCheckInBO" resultClass="java.lang.Integer">
		SELECT COUNT(1) FROM EDI_CARDIT_HD A 
	    JOIN EDI_CARDIT_TAG_DTL B ON A.TR_NO=B.TR_NO
	    WHERE A.AWB_NO=#awbNo# AND A.AWB_DATE=to_date(#awbDate#,'DDMONYY') 
	    AND B.TAG_NO=#tagNo#
   	</select>
   <select id="sqlFetchTagByMovement" parameterClass="java.lang.String" resultClass="cargo.cms.uld.bo.EnquireTagByMovementBO">
		SELECT distinct * FROM (SELECT  AWB.EVENT_AWB_ID as awbId,mov.event_awb_mov_id as movId,HD.EVENT_ID as eventId,TO_CHAR(hd.event_date_time,'DDMONYY HH24:MI') AS actnDate,
       DECODE((SELECT UNICODE_DESC FROM I18N_LABELS WHERE LABEL_KEY = TRIM(HD.FUNCTION_CODE) AND LANG_CODE ='en_US' AND ROWNUM =1  ),'',NVL(  (DECODE((SELECT MILESTONE_CODE_DESC FROM SEC_MENU_CTRL WHERE CODE = HD.FUNCTION_CODE AND ROWNUM=1),'RESTORE_AWB_STORAGE_MS','Restore AWB Storage (HHT)','RAMP_MENU_ULD_UN_CHK_OUT_MS','Un-Check out ULD (HHT)','AMEND_LSP_STORGE_MS','Amend CSD Storage (HHT)','MENU_MHCS_CHKIN_MS','MHCS Check-in (HHT)','ISSUE_RCL_PPK_MIX_MS','Issue RCL PPK / Mix (HHT)','ISSUE_RCL_BULK_MS','Issue RCL Bulk (HHT)','LOAD_SHIPMENT_ULD_MS','Load Shipment to ULD (HHT)','CHECKIN_OFFLOAD_ULD_MS','Check-in Offloaded ULD (HHT)','RAMP_MENU_CRE_ULD_CHK_IN_MS','Create ULD Check-in (HHT)','RAMP_MENU_ULD_UN_CHK_IN_MS','ULD Uncheck-in (HHT)','LOAD_SHIPMENT_ULD','Load Shipment to ULD (HHT)','CONFIRM_OFFLOAD_MS','Confirm Offloaded Cargo (HHT)','RAMP_MENU_ULD_CHK_OUT_MS','Check Out ULD (HHT)','AMEND_ULD_STORAGE_MS','Amend ULD Storage (HHT)','CREATE_AWB_STORAGE_MS','Create AWB Storage (HHT)','CAPTURE_SRF_DLV_LOC_MS','Capture SRF Dlv by Locn (HHT)',(SELECT MILESTONE_CODE_DESC FROM SEC_MENU_CTRL WHERE CODE = HD.FUNCTION_CODE AND ROWNUM=1))  ),DECODE(HD.FUNCTION_CODE,'MHS_MSG','MHCS Message','TRK_FLT_ARR','Truck Flight Arrival','LOAD_SHPMT_ULD','Load Shipment to ULD (HHT)','RAMP_MENU_CRE_ULD_CHK_IN_MS','Create ULD Check-in (HHT)','RAMP_MENU_ULD_UN_CHK_IN_MS','ULD Uncheck-in (HHT)',HD.FUNCTION_CODE)),  (SELECT UNICODE_DESC  FROM I18N_LABELS  WHERE LABEL_KEY = TRIM(HD.FUNCTION_CODE)  AND LANG_CODE   ='en_US'  AND ROWNUM      =1  )) || DECODE(HD.ACTION,'','',NULL,'','('||HD.ACTION||')') AS funcName,
       hd.cr_user_id AS userID,
       AWB.AWB_NO AS awbNo,
       mov.from_loc_code AS fromLocn,
       mov.from_csd_uld AS fromCsdULD,
       mov.to_loc_code AS toLocn,
       mov.to_csd_uld AS toCsdULD
       FROM EVENT_AWB AWB,
            EVENT_HD HD,
            EVENT_AWB_MOV MOV,
            EVENT_AWB_TAG_MOV TAG
             WHERE HD.EVENT_ID    = AWB.EVENT_ID
             AND AWB.EVENT_AWB_ID = MOV.EVENT_AWB_ID
             AND MOV.EVENT_AWB_MOV_ID = TAG.EVENT_AWB_MOV_ID
             AND NVL(tag.from_loc_tag,tag.to_loc_tag) = #tagNoSearch#
             UNION ALL
             SELECT AWBLIST.EVENT_ULD_AWB_LIST_ID as awbId,mov.EVENT_ULD_MOV_ID as movId,HD.EVENT_ID as eventId,
        TO_CHAR(hd.event_date_time,'DDMONYY HH24:MI') AS actnDate,
        DECODE((SELECT UNICODE_DESC FROM I18N_LABELS WHERE LABEL_KEY = TRIM(HD.FUNCTION_CODE) AND LANG_CODE ='en_US' AND ROWNUM =1  ),'',NVL(  (DECODE((SELECT MILESTONE_CODE_DESC FROM SEC_MENU_CTRL WHERE CODE = HD.FUNCTION_CODE AND ROWNUM=1),'RESTORE_AWB_STORAGE_MS','Restore AWB Storage (HHT)','RAMP_MENU_ULD_UN_CHK_OUT_MS','Un-Check out ULD (HHT)','AMEND_LSP_STORGE_MS','Amend CSD Storage (HHT)','MENU_MHCS_CHKIN_MS','MHCS Check-in (HHT)','ISSUE_RCL_PPK_MIX_MS','Issue RCL PPK / Mix (HHT)','ISSUE_RCL_BULK_MS','Issue RCL Bulk (HHT)','LOAD_SHIPMENT_ULD_MS','Load Shipment to ULD (HHT)','CHECKIN_OFFLOAD_ULD_MS','Check-in Offloaded ULD (HHT)','RAMP_MENU_CRE_ULD_CHK_IN_MS','Create ULD Check-in (HHT)','RAMP_MENU_ULD_UN_CHK_IN_MS','ULD Uncheck-in (HHT)','LOAD_SHIPMENT_ULD','Load Shipment to ULD (HHT)','CONFIRM_OFFLOAD_MS','Confirm Offloaded Cargo (HHT)','RAMP_MENU_ULD_CHK_OUT_MS','Check Out ULD (HHT)','AMEND_ULD_STORAGE_MS','Amend ULD Storage (HHT)','CREATE_AWB_STORAGE_MS','Create AWB Storage (HHT)','CAPTURE_SRF_DLV_LOC_MS','Capture SRF Dlv by Locn (HHT)',(SELECT MILESTONE_CODE_DESC FROM SEC_MENU_CTRL WHERE CODE = HD.FUNCTION_CODE AND ROWNUM=1))  ),DECODE(HD.FUNCTION_CODE,'MHS_MSG','MHCS Message','TRK_FLT_ARR','Truck Flight Arrival','LOAD_SHPMT_ULD','Load Shipment to ULD (HHT)','RAMP_MENU_CRE_ULD_CHK_IN_MS','Create ULD Check-in (HHT)','RAMP_MENU_ULD_UN_CHK_IN_MS','ULD Uncheck-in (HHT)',HD.FUNCTION_CODE)),  (SELECT UNICODE_DESC  FROM I18N_LABELS  WHERE LABEL_KEY = TRIM(HD.FUNCTION_CODE)  AND LANG_CODE   ='en_US'  AND ROWNUM      =1  )) || DECODE(HD.ACTION,'','',NULL,'','('||HD.ACTION||')') AS funcName,
        hd.cr_user_id AS userID,
        AWBLIST.AWB_NO AS awbNo,
        MOV.FROM_LOC_CODE AS fromLocn,
        DECODE(MOV.FROM_LOC_CODE,'','',decode(ULD.ULD_KEY,'',ULD.csd,ULD.uld_key)) AS fromCsdULD,
        MOV.TO_LOC_CODE AS toLocn,
       DECODE(HD.FUNCTION_CODE,'MBLE_INT_10',decode(ULD.ULD_KEY,'',ULD.csd,ULD.uld_key),'MBLE_INT_11',decode(ULD.ULD_KEY,'',ULD.csd,ULD.uld_key),DECODE(MOV.TO_LOC_CODE,'','',decode(ULD.ULD_KEY,'',ULD.csd,ULD.uld_key))) AS toCsdULD
       FROM 
       EVENT_ULD ULD,
       EVENT_HD HD,
       EVENT_ULD_MOV MOV,
       EVENT_ULD_AWB_LIST AWBLIST,
       EVENT_ULD_AWB_TAG_MOV TAG
       WHERE ULD.EVENT_ID_AWB_LIST      = AWBLIST.EVENT_ID
       AND HD.EVENT_ID = ULD.EVENT_ID
       AND MOV.EVENT_ULD_ID = ULD.EVENT_ULD_ID
       AND AWBLIST.EVENT_ULD_AWB_LIST_ID = TAG.EVENT_ULD_AWB_LIST_ID
       AND HD.FUNCTION_CODE NOT IN ('EDI_1','EDI_2')
       AND NVL(tag.from_loc_tag,tag.to_loc_tag) = #tagNoSearch#
      ) A ORDER BY A.eventId,A.awbId,A.movId ASC
	</select>

	
	
	
<select id="sqlUldServicebility" parameterClass="java.util.HashMap" resultClass="java.lang.String">
		SELECT
		  CASE
		  	WHEN DAM_IND = 'Y'
		    THEN 'DAM'
		    WHEN SER_IND = 'Y'
		    THEN 'SER'
		    WHEN SER_IND = 'N'
		    THEN 'UNS'
		    ELSE ''		    
		  END
		FROM ULD_INVENTORY
		WHERE ULD_KEY = #ULD_KEY#	
</select>

<select id="getFlightInfo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap" >
		SELECT ORIG , DEST , TO_CHAR(nvl(act_date, sch_date), 'DDMONYY') as AT_DATE FROM FLT_OPR WHERE FLT_NO = #FLT_NO# AND SCH_DATE = TO_DATE(#FLT_DATE#,'DDMONYY') AND CARR_CODE=#FLT_CARR# AND FLT_TYPE = #FLT_TYPE#
</select>
	
   
   <select id="getTruckRegistrationEnquiryList" parameterClass="cargo.cms.uld.bo.TruckRegistrationEnquiryBO" resultClass="cargo.cms.uld.bo.TruckRegistrationEnquiryBO">
		SELECT UPPER(TRK_REG_STATUS) truckStatus, hd.TR_NO trNumber,
		CASE WHEN hd.TRIP_ID IS NOT NULL THEN 
		  (SELECT TO_CHAR(TRUCK_PARK_ENTRY_TIME, 'DDMONYY HH24:MI') FROM TRUCK_TRIP_EVENTS WHERE TRIP_ID = hd.TRIP_ID )    
		  ELSE
		  (SELECT TO_CHAR(TRUCK_PARK_ENTRY_TIME, 'DDMONYY HH24:MI') FROM TRUCK_TRIP_EVENTS 
				WHERE TRIP_ID = ( SELECT TRIP_ID from ( SELECT * FROM TRUCK_TRIP where TRUCK_NO = UPPER(trk_num) AND CLOSED = 'N' order by CR_DATE desc) where rownum = 1 )) 
		END as truckParkEntryTime,
		trk_num as truckNo,
		(SELECT MAX(TRUCK_DOCK) TRUCK_DOCK FROM TCS_DOCK_ALLOCATION
		WHERE TRIP_ID = (SELECT MAX(TRIP.TRIP_ID) FROM TRUCK_TRIP TRIP WHERE TRIP.CLOSED = 'N' AND TRIP.TRUCK_NO = UPPER(trk_num))) as truckDock,
		dtl.URF_NUM urfNo,
		iss.flt_no || '/' || to_char(iss.flt_date,'DDMONYY')|| ' ' || ( select decode(pkg_common.get_flt_eta(iss.flt_no, iss.flt_date,  'D', 'DD'),null,pkg_common.get_flt_sta(iss.flt_no, iss.flt_date,  'D', 'DD'),
    	pkg_common.get_flt_eta(iss.flt_no, iss.flt_date,  'D', 'DD')) from dual)  as urfFlight,
		hd.reg_user_id as firstPhone,
		hd.assigned_trucker as secondPhone,
		( (SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || (NVL(ULD_APR_QTY, 0) - NVL(ULD_REL_QTY, 0)), ', ')) 
		     FROM ULD_ISS_DTL WHERE EIR_NO = iss.EIR_NO AND UPPER(ULD_EQUIP) = 'U' AND (NVL(ULD_APR_QTY, 0) - NVL(ULD_REL_QTY, 0)) > 0)
		     || NVL2((SELECT STRAGG(STRINGDELIM(ULD_GROUP || ULD_TYPE || '-' || (NVL(ULD_APR_QTY, 0) - NVL(ULD_REL_QTY, 0)), ', ')) 
		     FROM ULD_ISS_DTL WHERE EIR_NO = iss.EIR_NO AND UPPER(ULD_EQUIP) = 'U' AND (NVL(ULD_APR_QTY, 0) - NVL(ULD_REL_QTY, 0)) > 0),',','') ||
		     (SELECT STRAGG(STRINGDELIM(EQUIP.EQUIP_TYPE || '-' || (SUM(NVL(EQUIP.EQUIP_APR_QTY, 0)) - SUM(NVL(EQUIP.EQUIP_REL_QTY, 0))), ', '))FROM ULD_ISS_DTL EQUIP
		    WHERE UPPER(ULD_EQUIP) IN ('E', 'B') AND EQUIP.EIR_NO = iss.EIR_NO AND (EQUIP.EQUIP_APR_QTY - NVL(EQUIP.EQUIP_REL_QTY, 0)) > 0 GROUP BY EQUIP.EQUIP_TYPE)) urfApprovedQty
		FROM URF_TRUCK_REGD_HD hd
		JOIN URF_TRUCK_REGD_DTL dtl ON hd.TR_NO = DTL.TR_NO
		JOIN ULD_ISS_HD iss ON iss.EIR_NO = dtl.URF_NUM
		JOIN FLT_OPR opr  ON opr.flt_key = iss.flt_no AND opr.sch_date = iss.flt_date and opr.flt_type = 'D'
		WHERE hd.CR_DATE BETWEEN to_date(#truckRegistrationFrom# || '0000','DDMONYYHH24MI') and to_date(#truckRegistrationTo# || '2359','DDMONYYHH24MI')
		<isNotEmpty property="truckNo">
		AND hd.trk_num = #truckNo#
		</isNotEmpty>
		AND UPPER(hd.TRK_REG_STATUS) = UPPER(#truckStatus#)		
   	</select>
   		
	<select id="sqlGetTruckURFReleaseULDs" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFReleaseULDBO">
		select hd.urf_num eirNo,dtl.uld_type uldType,dtl.uld_no uldNo,dtl.uld_carr uldCarr,dtl.uld_key uldKey,'' status
    	from URF_COLLECTION_HD HD 
    	join URF_COLLECTION_DTL DTL on HD.TR_NO=DTL.TR_NO 
    	join URF_TRUCK_REGD_HD trk_hd on trk_hd.TRK_REG_ID= HD.TRK_REG_ID 
    	where HD.URF_NUM = #eirNo# AND UPPER(ULD_EQUIP) = 'U' AND HD.trk_num=#truckRegNo#
    	AND NOT EXISTS (SELECT ULD_KEY FROM ULD_REL_DTL WHERE eir_no = hd.urf_num and uld_key=dtl.uld_key and UPPER(ULD_EQUIP) = 'U')
    	AND trk_hd.TRK_REG_STATUS != 'Completed'
	</select>
	
	<select id="sqlGetTruckURFReleaseAccessories" parameterClass="cargo.cms.uld.bo.URFSearchCriteriaBO"
		resultClass="cargo.cms.uld.bo.URFReleaseAccessoryBO">
			<![CDATA[
			with relDtl as (
		            SELECT DTL.EQUIP_TYPE equipType,SUM(NVL(DTL.EQUIP_REL_QTY, 0)) equipQty
		              	FROM ULD_ISS_HD HD JOIN ULD_ISS_DTL DTL
		              	ON hd.EIR_NO          =DTL.EIR_NO
		              	WHERE HD.EIR_NO       = #eirNo# 
		              	AND UPPER(ULD_EQUIP) IN ('E', 'B')		              	
		              	GROUP BY DTL.EQUIP_TYPE
	              ),
	      	truckRegDtl as (
	              		select hd.urf_num eirNo,dtl.EQUIP_TYPE equipType,SUM(NVL(dtl.EQUIP_QTY, 0))  equipQty
	    				from URF_COLLECTION_HD HD 
	    				join URF_COLLECTION_DTL DTL on HD.TR_NO=DTL.TR_NO
	    				join URF_TRUCK_REGD_HD trk_hd on trk_hd.TRK_REG_ID= HD.TRK_REG_ID 
	    				where HD.URF_NUM = #eirNo# AND UPPER(ULD_EQUIP) = 'E'
	    				GROUP BY  hd.urf_num,dtl.EQUIP_TYPE
	              ),
	      	finals as (
		            select truckRegDtl.eirNo eirNo, truckRegDtl.equipType,
		            	case when (truckRegDtl.equipQty-NVL(relDtl.equipQty,0)) <= 0 then 0
		            	Else (truckRegDtl.equipQty-NVL(relDtl.equipQty,0)) END equipQty 
		            	from truckRegDtl join relDtl on upper(truckRegDtl.equipType) = upper(relDtl.equipType)
            		)
	      	select * from finals where equipQty >0
	      	]]>
	</select>
	

	<insert id="insertURFAck" parameterClass="cargo.cms.uld.bo.URFUCOCheckListBO">
	     INSERT INTO ULD_ISS_ACK_LOG (SEQ_NO,TRIP_ID, URF_NO,ACK_DATE, CR_USER_ID, LM_DATE,CR_DATE, LM_USER_ID)
			 VALUES (ULD_ISS_ACK_LOG_SEQ.nextval,#acktripId#, #urfNo#,SYSDATE, #luserId#, SYSDATE,SYSDATE, #luserId#
			)
	</insert>
	
	<select id="verifiedsrfcount" parameterClass="java.lang.String"	resultClass="java.lang.Integer">
		<![CDATA[
				select count(1) from IMP_SRF where verified = 'N'  and srf_no = #srfNo# 
		]]>
	</select>
		
</sqlMap>